import{a as kf,b as mf,e as ff,f as Ef,h as Gf,i as Sf}from"https://app.framerstatic.com/chunk-DXGLR7XE.mjs";import{b as ns,c as bf,k as Cf,p as vf,q as Tf,u as Pf}from"https://app.framerstatic.com/chunk-ALMIM4K3.mjs";import{i as Hn,s as Mf}from"https://app.framerstatic.com/chunk-PSALBDCX.mjs";import{e as ss}from"https://app.framerstatic.com/chunk-UTK4JR6V.mjs";import{a as Vf}from"https://app.framerstatic.com/chunk-AR73BNYO.mjs";import{a as Jf}from"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import{a as xf}from"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{a as qf}from"https://app.framerstatic.com/chunk-EWEZCJKH.mjs";import{b as PA,c as $f}from"https://app.framerstatic.com/chunk-ZWQYHZGP.mjs";import{a as ce}from"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{i as rs}from"https://app.framerstatic.com/chunk-GFDNSHBH.mjs";import{u as pf}from"https://app.framerstatic.com/chunk-TVZZ4XBH.mjs";import{a as w6,b as K7,c as L6,e as Bf,f as hf,g as JR,h as se,i as If,k as Ff,n as yf,q as sc}from"https://app.framerstatic.com/chunk-SXPCJYOO.mjs";import{c as Lf}from"https://app.framerstatic.com/chunk-QFF2HNPA.mjs";import{a as Rf,d as os,g as Or,h as Of,i as wf,l as ds}from"https://app.framerstatic.com/chunk-2BBEOARH.mjs";import{a as Xe}from"https://app.framerstatic.com/chunk-5RPZUZJP.mjs";import{$a as Gm,$b as Pm,$c as Hm,B as pk,Bc as Za,C as kk,Ce as tf,Ec as Nm,Ed as js,Ef as es,F as Qt,Fa as yk,Fd as Ym,G as mk,Gc as Om,H as Na,Ha as Xa,Hc as wm,He as rf,Hg as Vn,I as VR,Ie as Mr,Ig as df,J as hk,Jc as Lm,Je as of,Jg as ts,K as gk,Ke as nf,Lg as uf,Ma as Ya,N as Oa,Ne as af,O as vl,Oa as Ul,Oc as qm,P as wa,Pa as $m,Pb as Me,Pc as Zt,Pe as Zl,Pf as ec,Qa as Bm,Qc as Rt,Qf as sf,Ra as hm,Rf as qn,Sf as tc,Ta as gm,Te as Dr,Tf as lf,Wc as Po,Xf as rc,Ya as Rm,Yb as Tm,Yc as Vm,Ye as Ac,Za as Im,Zc as Km,_ as Fo,_a as Fm,_c as Jm,_d as Zm,a as Gn,ab as ym,ac as _m,ad as _o,ae as Af,bc as xm,cb as bm,cc as Xl,cd as Yl,e as gl,ed as Pj,fb as Wl,fc as Mm,ga as Ik,hb as Cm,ia as Fk,ja as Sk,jd as Qm,je as jf,kd as As,ke as ef,lf as jc,n as Sn,od as Um,pa as Tn,pd as Wm,pf as Nr,q as Il,r as Fl,ra as Pn,rd as zm,re as It,s as br,sa as La,sd as Xm,se as ae,t as Gl,tc as Dm,u as Sl,v as bn,w as yl,x as bl,xb as zl,xg as cf,y as Cn,z as go}from"https://app.framerstatic.com/chunk-GVEIL7AP.mjs";import{e as yr,g as Fn,h as hl,l as Ln,q as Sm,u as vm,v as De}from"https://app.framerstatic.com/chunk-HQZYWAIC.mjs";import{a as KR,f as mA}from"https://app.framerstatic.com/chunk-TQ6SMIXL.mjs";import{Ke as oc}from"https://app.framerstatic.com/chunk-SJWII7XM.mjs";import{a as Wi,b as J7,c as Df,d as ls,e as cs,g as Nf,h as ij,i as us,l as lc,n as le}from"https://app.framerstatic.com/chunk-VRLR7CB2.mjs";import{a as Jn,b as is,c as as,d as _f}from"https://app.framerstatic.com/chunk-QKG7LG2J.mjs";import{j as Kf}from"https://app.framerstatic.com/chunk-7I74MBRW.mjs";import{Ac as Go,Ad as Re,Bc as So,Bd as tm,Be as nm,C as Wt,Cc as yo,Cd as Ll,Ce as Ua,Dc as qk,De as Wa,E as vj,Eb as bk,Ec as Vk,Ed as Tr,Ee as im,Ei as Em,F as vn,Fb as qa,Fc as Kk,Fe as za,Fg as Ie,Gb as _l,Hb as Ck,Jc as Jk,K as Cl,Kc as Hk,La as zt,Ma as Tl,Mb as vk,Nc as xe,Nf as cm,Ob as Va,Oc as Ol,Od as rm,Oe as YA,Pc as CA,Qc as Ja,Qf as dm,R as fk,Rb as Ka,Sb as Tk,Sc as bo,T as Ek,Tb as Pk,Tc as Qk,U as $k,Uc as Uk,Ue as am,Uf as um,V as Bk,Vc as Cr,Wc as Wk,Wf as Jl,Xc as vr,Yc as zk,Ye as sm,Yf as pm,_d as Nn,a as xa,ab as Rk,ac as _k,af as ql,ag as Hl,b as dk,c as uk,cc as xl,cd as Xk,dd as Xt,dg as vo,e as yn,ec as Ml,ef as lm,fa as Wj,g as Rl,gh as km,id as Co,k as TA,kc as xk,kf as Pr,l as Ro,ld as Am,le as Qa,lf as Yt,mc as ge,md as jm,me as om,nb as Pl,nh as mm,o as Ma,od as Ha,p as Da,pc as Dl,ph as wn,qc as Dk,qf as Vl,r as ze,rc as _n,rg as NA,rh as fm,ri as Ql,sc as xn,sd as em,sg as To,tc as Mn,tg as On,ua as Bt,ub as qj,uc as Nk,ug as gt,v as Io,vc as Ok,wb as Gk,wc as wk,xc as Dn,xf as Tj,y as Ut,yc as Nl,yd as wl,yf as Kl,zc as Lk,zg as _r,zi as xr}from"https://app.framerstatic.com/chunk-JQGQBMDT.mjs";import{$b as aA,$c as oa,$d as sa,$g as qu,$l as pl,$s as bj,$t as jk,$u as sk,A as U6,Ab as gA,Ad as sn,Ah as Ku,Al as ha,B as lA,Bb as cu,Bd as ln,Bj as Ap,Bu as ok,C as Au,Cb as du,Cd as XA,Ce as Du,Cg as ua,Cj as $a,Cl as pt,Cn as mp,Db as on,Dd as W,Di as ct,Dk as jp,Dm as pp,Dr as fo,Du as nk,Ed as cn,Eg as Ot,El as Lt,En as El,Es as We,F as Aa,Fc as Fu,Fd as xt,Fe as sj,Fi as fa,Fm as ml,Gc as io,Gd as fj,Gg as pa,Go as yp,Gr as Rr,Gu as ik,Gv as Et,H as ju,Hd as $e,He as $A,Hi as Ij,Hv as $t,I as q,Ic as an,Id as RA,Ie as tl,Ii as fn,Iu as ak,J as W6,Jb as uu,Jd as dn,Ji as Fj,Jk as ll,Ju as VA,Kb as pu,Kc as HA,Kd as Mt,Kl as ap,Ko as bp,Kt as Yp,Ku as V,Lj as ol,Lk as QA,Ln as fp,Lr as Ir,Ls as qp,Lt as Ta,M as tn,Ma as z6,Mb as ku,Mk as co,Mr as Mp,Mt as Pa,Mu as Lj,Mv as ht,Nb as ta,Nc as ao,Np as _p,Nr as Dp,Oc as Ae,Oi as zu,Or as Pe,Os as Vp,Ou as Cj,Ov as Yk,Pi as Xu,Pj as nl,Pl as sp,Pp as mo,Pr as Np,Pu as h,Pv as Zk,Qb as mu,Qd as Su,Qp as Ga,Qr as Op,Qs as Kp,Qu as Sr,Rd as yu,Ri as Yu,Rp as gr,Rs as Jp,Rt as ie,Sk as cl,Sl as ga,Sm as hn,Sn as Ep,Ta as iu,Tb as nn,Th as Ju,Ti as Ea,To as Cp,Tp as gn,Ts as ba,Tt as Zp,U as Nj,Ua as X6,Uc as Gu,Ue as Nu,Uh as lt,Uk as ep,Ur as wp,Va as Y6,Vb as fr,Vc as ra,Vd as ia,Vr as Rn,Vs as Bl,Vu as _e,Wa as au,Wb as fu,Wc as Ke,Wk as tp,Wl as Ra,Ws as Hp,Wt as Jt,Wu as Ht,Xa as Z6,Xk as nj,Xm as mt,Xs as Qp,Yb as be,Yk as Ba,Ys as Up,Yt as _a,Z as ja,Zc as Ce,Zd as aa,Zh as $r,Zj as ut,Zs as Wp,_b as nt,_c as ve,_d as bu,_k as En,_l as kt,_s as Vt,_t as Ak,ac as re,ae as so,ag as un,ah as kn,ai as Hu,at as Ca,au as ek,bt as va,c as q6,ce as je,cm as lp,ct as Kt,cu as tk,d as Se,dc as $u,de as lo,di as rl,dl as $n,e as V6,ee as Cu,el as rp,em as kl,ev as ho,fe as Uj,fi as Qu,fk as Ue,fl as hr,fo as $p,fv as lk,ga as oo,ge as Dt,gi as ka,gj as dt,gl as op,gm as cp,go as Bp,gq as Sa,gs as he,h as H7,hc as Bu,he as la,hh as Vu,hi as Uu,hm as dp,ho as hp,ib as su,ic as hu,ie as vu,il as dl,io as gp,is as In,jo as Rp,js as ya,k as Q7,kc as gu,kd as Je,ke as He,km as up,ko as Ip,kt as zp,l as L,ld as _t,le as ne,lg as yj,li as mn,lj as Br,lk as il,lo as Fp,m as vA,md as pA,me as Nt,mg as pn,mm as DA,ms as Fr,nd as WA,ne as Tu,nm as Ej,nt as $o,od as it,oe as ca,om as Ia,op as Tp,oq as ft,ou as rk,pc as Ru,pd as Te,pe as at,pg as Ou,pm as uo,ps as kA,pu as Gr,qd as el,qn as kp,qo as Gp,qp as ko,r as en,re as Qe,rk as al,rq as xp,rt as Bo,s as K6,sb as ea,sd as na,se as Pu,si as Wu,sn as po,tb as Zj,td as eA,te as _u,tg as wu,tj as Zu,tm as Bn,ua as tu,ub as no,ud as tj,ue as st,ug as Lu,ul,um as Be,us as Eo,ut as Xp,uv as ck,vb as rn,vd as Ee,ve as xu,vm as $j,vo as Sp,wb as lu,wd as w,we as Mu,wg as da,ws as Lp,xb as dj,xi as ee,xk as sl,xl as np,xm as IA,y as mj,yc as Iu,yd as oe,yh as Er,yi as ma,yn as Fa,z as Q6,zb as oj,zd as hj,zh as wt,zl as ip,zn as fl}from"https://app.framerstatic.com/chunk-HOZEDTF7.mjs";import{f as Pp}from"https://app.framerstatic.com/chunk-4DUBS6C5.mjs";import{a as ac,b as Kn}from"https://app.framerstatic.com/chunk-R42SKB5P.mjs";import{s as Eu}from"https://app.framerstatic.com/chunk-65SNUELI.mjs";import{a as Mk}from"https://app.framerstatic.com/chunk-LH43QRIB.mjs";import{a as mr,b as Xi}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import{a as gf,c as nc,d as ic}from"https://app.framerstatic.com/chunk-FNEHAGV6.mjs";import{a as $l,d as vp}from"https://app.framerstatic.com/chunk-MGFLWLOD.mjs";import{b as kj}from"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{b as Yi,d as U7,e as J6,f as W7,j as Zi,l as H6,p as z7,q as X7,r as Y7,t as Z7}from"https://app.framerstatic.com/chunk-VYQ6DBUD.mjs";import{b as Al,d as jl,p as yA}from"https://app.framerstatic.com/chunk-BMR3NPHE.mjs";import{a as Pt,b as x,d as Y,e as Oj,f as cj,g as ru,i as sA,j as fe,k as ou,l as wj,o as ye,q as nu}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Gc as eu,a as zi,ae as qt,b as ro}from"https://app.framerstatic.com/chunk-T3QWMIW2.mjs";import{g as Ge}from"https://app.framerstatic.com/chunk-YSPPHHKT.mjs";import{a as Tt,b as L7,c as q7,d as V7,e as to,g as Ui}from"https://app.framerstatic.com/chunk-YH364MAV.mjs";import{c as O6,f as ot}from"https://app.framerstatic.com/chunk-N2ANBFPI.mjs";import{A as M7,B as Fe,C as ej,D as Sj,F as me,G as Ki,H as tt,I as Ji,J as pr,K as oA,L as D7,M as eo,P as Hi,Q as N6,R as N7,S as rt,T as O7,U as w7,X as qA,_ as Ve,a as P7,ca as Qi,da as kr,e as M6,i as jo,l as GA,n as D6,o as _7,p as Le,r as x7,u as hA,y as ur,z as ke}from"https://app.framerstatic.com/chunk-QQLWBJFN.mjs";import{a as $,b as iA}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as qe}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as Dj,j as g,k as rA,l as LA,m as FA,n as jn,o as x6}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Qf=Dj(KR());var Uf=Dj(zi());var Hv=Uf.default.createContext("not-defined");var Hf={store_internal:2,store_browse:2,store_use_installed:2},cc={},ps=new Qf.FramerTracking({sourceName:"framer-x",trackingURL:qe().events+"/track",verbose:window.localStorage&&window.localStorage.getItem("debug-metrics")==="active",addContext:j=>{for(let A in cc)j[A]===void 0&&(j[A]=cc[A])}}),HR;(t=>(t.init=function(r){let{appVersion:o,projectId:n}=r;Object.assign(cc,{appVersion:o,projectId:n}),ps.setUserId(r.userId)},t.push=function(r){let{name:o,type:n,...a}=r;r.type==="store_internal"?(delete a.action,ps.track({type:"track",event:o,version:2,...a})):ps.track({type:"track",event:n,version:Hf[n],name:o,...a})},t.pushEvent=function(r){let{event:o,...n}=r;ps.track({...n,type:"track",event:o,version:Hf[o]})}))(HR||={});var QR=new Set(nn({fillImageLocalized:!0,formInputPlaceholderLocalized:!0,htmlLocalized:!0,altAttributeLocalized:!0,titleLocalized:!0,descriptionLocalized:!0,linkLocalized:!0}));function dc(j){return QR.has(j)}function ks(j){return j.map(A=>Oj(A)?ms(A):cj(A)?ks(A):A)}function UR(j){return j.endsWith("Localized")}function ms(j){let A={};for(let e in j){if(UR(e))continue;let t=j[e];Oj(t)?A[e]=ms(t):cj(t)?A[e]=ks(t):A[e]=t}return A}function Zv(j){let A={};for(let e in j){if(dc(e))continue;if(!ll(e)){A[e]=j[e];continue}let t=j[e];Oj(t)?A[e]=ms(t):cj(t)?A[e]=ks(t):A[e]=t}return A}function Wf(j){let A={};for(let e in j){if(dc(e))continue;if(!ll(e)){A[e]=j[e];continue}let t=j[e];Oj(t)?A[e]=ms(t):cj(t)?A[e]=ks(t):A[e]=t}return A}var{onewayMethodTemplate:uT,voidMethodTemplate:zf,valueMethodTemplate:uc,streamMethodTemplate:pT}=Ui,pc;(A=>A.service={id:"__ElectronWebRendering__",fingerprint:"55e7a2685b81eb6008c3d91a35ec44f1",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{}},newOutgoingWrapper:e=>({collectMetrics:uc.bind(-1,"collectMetrics",!1,e),openSaveDialog:uc.bind(-1,"openSaveDialog",!0,e),willOpenWindow:uc.bind(-1,"willOpenWindow",!0,e),writeToClipboard:zf.bind(-1,"writeToClipboard",!0,e),writeToDisk:zf.bind(-1,"writeToDisk",!0,e)})})(pc||={});var kc;(t=>{t.service=pc.service;function A(r){let o=Tt.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){Tt.shared().unregister(r)}t.unregister=e})(kc||={});var{onewayMethodTemplate:vT,voidMethodTemplate:Xf,valueMethodTemplate:fs,streamMethodTemplate:TT}=Ui,mc;(A=>A.service={id:"__ElectronWebRenderingV2__",fingerprint:"6c902a5850607b51714e2b27dafbde81",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{},getImageData:{}},newOutgoingWrapper:e=>({collectMetrics:fs.bind(-1,"collectMetrics",!1,e),openSaveDialog:fs.bind(-1,"openSaveDialog",!0,e),willOpenWindow:fs.bind(-1,"willOpenWindow",!0,e),writeToClipboard:Xf.bind(-1,"writeToClipboard",!0,e),writeToDisk:Xf.bind(-1,"writeToDisk",!0,e),getImageData:fs.bind(-1,"getImageData",!0,e)})})(mc||={});var fc;(t=>{t.service=mc.service;function A(r){let o=Tt.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=A;async function e(r){Tt.shared().unregister(r)}t.unregister=e})(fc||={});var WR={track:!0};function Yf(j){let A={...j,event:"canvas_page_add"};kj(A,WR)}var zR={track:!0};function Zf(j){let A={...j,event:"canvas_page_select"};kj(A,zR)}var XR={track:!0};function AE(j){let A={...j,event:"component_canvas_create"};kj(A,XR)}var YR={track:!0};function jE(j){let A={...j,event:"component_canvas_enter"};kj(A,YR)}var ZR={track:!0};function eE(j){let A={...j,event:"component_canvas_variant_create"};kj(A,ZR)}var AI={track:!0};function Ec(j){let A={...j,event:"component_design_instance"};kj(A,AI)}var jI={track:!0};function $c(j){let A={...j,event:"export_bitmap"};kj(A,jI)}var eI={track:!0};function tE(j){let A={...j,event:"external_component_insert"};kj(A,eI)}var tI={track:!0};function rE(j){let A={...j,event:"property_layout_update"};kj(A,tI)}var rI={track:!0};function oE(j){let A={...j,event:"variable_reference_create"};kj(A,rI)}function nE(j,A,e){return Pt(e)?e:$A(A)?A.constraintsLocked:!1}function gP(j,A,e,t){let r=j.tree,o={x:Math.round(e.x-t.width/2),y:Math.round(e.y-t.height/2)},n=r.getNode(A);if(!A||!n)return{left:o.x,top:o.y};let a=Yp(j.tree,A),i=a?j.tree.getViewportRect(a):null,s=r.getRect(n),l=r.convertPointToNode(n,o),c={x:l.x,y:l.y,width:t.width,height:t.height},u=c.width/c.height,p=xl(c,{sizing:s,positioning:s,viewport:i,layout:Je(n)},null,{aspectRatio:u,shouldGuessPinToBottom:It(r,null,n),shouldGuessPinToRight:ae(r,null,n)});return p.aspectRatio=u,p}var Bc=(j,A,e,t)=>{let r=A.getGroundNodes().map(o=>j.getRect(o));return t!==void 0&&r.push(...t),r.find(o=>q.intersects(e,o))===void 0},oI=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(i=>j.getRect(i));t!==void 0&&o.push(...t);let a=o.sort((i,s)=>q.maxX(i)>q.maxX(s)?-1:1)[0];return a!==void 0?Rc(a,e,r):null},nI=(j,A,e,t,r)=>{let o=A.getGroundNodes().map(s=>j.getRect(s));t!==void 0&&o.push(...t);let i=o.filter(s=>s.width===e.width&&s.height===e.height||s.height===e.width&&s.width===e.height).sort((s,l)=>q.maxX(s)>q.maxX(l)?-1:1)[0];return i!==void 0?Rc(i,e,r):null},iI=(j,A,e)=>A.map(t=>j.getNode(t)).filter(t=>da.equals(t.rect(null),e));function gc({tree:j,activeScope:A,node:e,size:t,filledRects:r,offsetDistance:o}){let n={...j.getRect(e),...t},a=A.getGroundNodes().map(l=>l.rect());r&&a.push(...r);let i=n,s=0;for(;i;){if(sA(o.x)||(n.x=hc("x",i,o.x)),sA(o.y)||(n.y=hc("y",i,o.y)),i=a.find(l=>q.intersects(l,n)),s>a.length)return n;s++}return n}var aE=(j,A,e,t,r={x:100,y:void 0},o)=>gc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:r}),Qn=(j,A,e,t,r=100,o)=>gc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{x:r}}),RP=(j,A,e,t,r=100,o)=>gc({tree:j,activeScope:A,node:e,size:t,filledRects:o,offsetDistance:{y:r}});function hc(j,A,e){return(j==="x"?q.maxX:q.maxY)(A)+e}function Rc(j,A,e=100){return{...j,x:hc("x",j,e),...A}}var aI=(j,A,e,t,r,o,n)=>{if(o){let s=j.getNode(o);if(s)return Qn(j,A,s,e,n,r)}if(t){let s=iI(j,t,e);if(s.length){let c=s.map(p=>Rc(p.rect(),e,n)).find(p=>Bc(j,A,p,r));if(c)return c;let u=s[0];return $(u,"Equal frame must be defined"),Qn(j,A,u,e,n,r)}}let a=nI(j,A,e,r,n);if(a!==null&&Bc(j,A,a,r))return a;let i=oI(j,A,e,r,n);return i!==null&&Bc(j,A,i,r)?i:{...e,x:0,y:0}},IP=(j,A,e,t,r)=>{let o=j.getRect(e),n=j.getParent(e.id),a;RA(e)&&(a=Math.min(o.width,100));let i=aI(j,A,o,t,r,e.id,a);return r.push(i),xl(i,null,Vt(e)?Kt(e):null,{shouldGuessPinToBottom:!0,shouldGuessPinToRight:ae(j,e,n)})},FP=(j,A,e,t)=>{if(e.length>0){let r=e[e.length-1],o=j.getGroundFrameAncestor(r,!0);if(o)return o.id}for(let r of j.sortVisually(j.getNodesAtPoint(A,t)).reverse())if(r instanceof Me&&j.getParent(r.id)===Ij){if(gA(r))continue;return r.id}return Ij},GP=(j,A,e)=>{let r=j.tree.newId(),o={top:A.y,left:A.x,width:A.width,height:A.height,overflow:Ue(),isScreen:!0};return o.framePreset=e,j.createFrame(Ij,{id:r,...o}),r},SP=(j,A)=>{let e=j.tree,t=e.newId(),r={top:A.y,left:A.x,width:A.width,height:A.height,overflow:Ue(),isScreen:!0};return j.createFrame(Ij,{id:t,...r}),j.stores.scopeStore.active.getGroundNodes(n=>{let a=e.getRect(n);return n.id!==t&&q.containsRect(A,a)}).forEach(n=>{let a=e.getParent(n.id),i=e.getRect(n),s=q.offset(i,lA.reverse(A));j.moveNode(n.id,t),j.tree.current(n)?.set(n.updateForRect({rect:s,parentSizeInfo:{sizing:A,positioning:A,viewport:null,layout:Je(a)},constraintsLocked:nE(j,n),shouldGuessPinToBottom:!0,shouldGuessPinToRight:ae(j.tree,n,a)}))}),t},iE=["#9ef","#4cf","#3af","#38f","#26f"],yP=(()=>{let j=-1,A=iE.length;return()=>(j++,iE[j%A])})();function PP(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!yu(t)&&!Su(t)&&!(!t&&e.added==="RedirectRouteNode"))return!1}return!0}function lE(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);return!t||!kt(t)?!1:"variables"in e.from}return!0}function cE(j,A){if(!j||j.changes.length===0)return!1;for(let e of j.changes){let t=A.get(e.id);if(!_t(t))return!1;let r="locales";return!!(r in e.from||e.from._deleted?.includes(r))}return!0}var dE=class extends ge{constructor(){super(...arguments);g(this,"active",0)}};function wP(){let j=Tp();return $(Ic(j),"Expected OnPageEngine"),j}function Ic(j){return j.name==="OnPageEngine"}var uE=j=>[j.loadingStore,...ff(j)],Fc=([j,...A])=>({isReady:j.isReady,...Ef(A)});function sI(j,A){if(!j.isReady||j.userIsViewer)return!0;let e=kf(j);return!new mf(e)[A]}function Un(j,A){return ko(j)?sI(Fc(uE(j.stores)),A):!Ic(j)}function HP(j,A,e,{signal:t}){let r=uE(j),o=Fc(r),n=A.changes.observe(...r,()=>{let a=Fc(r);be(o,a)||(o=a,e(a))});t.addEventListener("abort",()=>{A.changes.removeObserver(n)},{once:!0})}var pE=class extends ge{constructor(e,t){super();this.addChanges=e;this.effectsStore=t;g(this,"update",0);g(this,"tooltip");g(this,"shapeToolActive",!1);g(this,"feedbackModeActive",!1);g(this,"handle",null);g(this,"straightLineAnchorIndex",0);g(this,"proseMirrorView",null);g(this,"proseMirrorState",null);g(this,"textLink",null);g(this,"editedTextLink");g(this,"stackInsertionIndicator",null);g(this,"replaceableFloatingPositionNode",null);g(this,"activeTool",0);g(this,"nodeInTextEditorId",Ij);g(this,"nodeInPathEditorOffset",null);g(this,"dragAndDropPlaceholders",null);g(this,"codeComponentInProgressInsertionIndicatorNodeIDs",new Set)}get tool(){return this.activeTool}postProcess(e){this.update=e}get isDefaultToolActive(){return this.tool===0||this.tool===1}updateDragAndDropPlaceholder(e){if(e){let t=e.cache.placeholders,r=t?{id:e.id,placeholders:t}:null;if(oo(r,this.dragAndDropPlaceholders))return;this.dragAndDropPlaceholders=r}else this.dragAndDropPlaceholders=null}setTool(e){vn.canEditTree(e)&&e!==6&&this.effectsStore.exitPreview(),this.shapeToolActive=cI(e),dI(e)||(this.feedbackModeActive=!1),this.tool===6&&e!==6&&this.addChanges("ExitMove"),this.tool!==e&&this.addChanges("Tool"),this.activeTool=e}};function lI(j){switch(j){case 31:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 47:case 29:case 30:case 41:case 46:case 27:case 40:case 28:case 25:return!1;case 42:case 43:case 15:case 17:case 16:case 18:case 1:case 38:case 34:case 44:case 0:case 45:case 9:case 39:case 6:case 32:case 3:case 35:case 37:case 7:case 26:case 8:case 36:case 48:case 2:case 49:case 33:case 4:case 5:return!0;default:iA(j)}}function cI(j){switch(j){case 31:case 42:case 43:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 47:case 1:case 38:case 34:case 44:case 0:case 45:case 41:case 46:case 39:case 6:case 32:case 3:case 37:case 7:case 26:case 27:case 28:case 29:case 30:case 8:case 36:case 48:case 2:case 40:case 25:case 49:case 33:case 4:case 5:return!1;case 15:case 17:case 16:case 18:case 9:case 35:return!0;default:iA(j)}}function dI(j){switch(j){case 42:case 43:case 3:case 4:case 5:return!0;case 0:case 1:case 2:case 6:case 7:case 48:case 8:case 9:case 31:case 10:case 11:case 12:case 47:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 44:case 49:case 33:case 45:case 46:return!1;default:iA(j)}}function e_(j){switch(j){case 4:case 5:return!0;case 0:case 1:case 2:case 3:case 6:case 7:case 48:case 8:case 9:case 31:case 10:case 11:case 12:case 47:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 49:case 33:case 45:case 46:return!1;default:iA(j)}}function fE(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 42:case 43:case 49:case 46:return!0;case 7:case 48:case 8:case 9:case 31:case 10:case 11:case 12:case 47:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 44:case 33:case 45:return!1;default:iA(j)}}function t_(j){switch(j){case 3:case 4:case 46:return!0;case 5:case 6:case 0:case 1:case 2:case 42:case 43:case 49:case 7:case 48:case 8:case 9:case 31:case 10:case 11:case 12:case 47:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 44:case 33:case 45:return!1;default:iA(j)}}function EE(j){switch(j){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 49:return!0;case 42:case 43:case 7:case 48:case 8:case 9:case 31:case 10:case 11:case 12:case 47:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 44:case 33:case 45:case 46:return!1;default:iA(j)}}function r_(j,A){return j.stores.historyStore.isLoadingDocument?A===46:Un(j,"canDesign")?fE(A):j.stores.chromeStore.isPreviewingFeaturedTemplate?EE(A):!0}function o_(j,A){return A==="VectorSet"?lI(j):!(A==="WebPage"&&j===41)}function n_(j,A){if(Un(j,"canDesign")&&!fE(A))throw Error("Viewer mode: Tool "+A+" is a forbidden action.");if(j.stores.chromeStore.isPreviewingFeaturedTemplate&&!EE(A))throw Error("Previwing template mode: Tool "+A+" is a forbidden action.")}var i_=j=>j===20||j===21||j===22||j===24||j===23||j===19;function a_(j){return j===8||j===7||j===48||j===32||j===34}var uI={0:!0,1:!0,2:!0,3:!0,4:!0,6:!0,5:!0};function d_(j){return Y(j)&&uI[j]===!0}var Gc=new Map;function p_(j,A){Gc.set(j,A)}function k_(j){Gc.delete(j)}function $E(j){Gc.get(j)?.()}var pI="__page_input";function kI(j){return`${pI}_${j}`}function Es(j){let A=kI(j);$E(A)}function $s(j){return eA(j)||w(j)}async function BE({messages:j,model:A,schema:e,signal:t}){let r=await rs.post("/ai/v2/chat/",{model:A,messages:j,response_format:{type:"json_schema",json_schema:{strict:!0,name:"schema",schema:e}}},t);try{return JSON.parse(r?.choices?.[0]?.message?.content??"")}catch(o){throw new Error(`Could not process JSON response: ${o}`,{cause:r})}}function Wn(j,A){if(sA(j))return j;let e=[];for(let t of j)e.push(A.get(t)??t);return e.length>0?e:void 0}function Ye(j,A){if(!$j(A))return null;let e=j.getNode(A.originalid);return $(e,"The original variant node should exist"),e}function mI(j,A,e){let t=kA.inheritedReplicaNode(j,A.replicaInfo.inheritsFrom),r=Fr(A.replicaInfo.overrides,t?.replicaInfo.overrides);for(let o of e.walk()){let n=r[o.id];if(!n)continue;let{_deleted:a,itemsOrder:i,...s}=n;a?.forEach(l=>s[l]=void 0),j.current(o)?.set(s)}}function hE(j,A){let e=j.getNode(A.originalid),t=kA.getReplicaForTemplateNode(j,A);if(!e||!t||!DA(t))return[];if(!t.replicaInfo.inheritsFrom)return[e];let r=j.getNode(t.replicaInfo.inheritsFrom);if(!r)return[e];let o=he(r.id,e.id),n=j.getNode(o);return n?[e,n]:[e]}function __(j,A,e,t){let r=kA.getReplicaForTemplateNode(j.tree,A);$(r,"replica should exist when moving node out of replica"),$(DA(r),"replica must be a variant"),mI(j.tree,r,e),A.isVisible()&&!e.isVisible()&&j.tree.current(e)?.set({visible:!0}),t.delete(A.id),t.add(e.id)}function zn(j,A,e,t,r){if(!e||!t)return A.id;$(gA(e),"Fail to update variant nodes: parent must be a replica");let o=kA.getReplicaForTemplateNode(j.tree,e);if($(o,"Fail to update variant nodes: replica should exist"),$(DA(o),"Fail to update variant nodes: replica must be an variant"),_a(j.tree,e)){j.tree.current(A)?.set({visible:!1});let a={visible:!0};Gr(A)&&r&&(a.itemsOrder=Wn(A.itemsOrder,r)),Vn(j.tree,o,A.id,a)}return he(o.id,A.id)}function Sc(j,A,e,t,r,o){let n=zn(j,A,e,t,o);return r.delete(A.id),r.add(n),n}function x_(j,A,e){let t=hE(j.tree,A),r=hE(j.tree,e),o=t.find((n,a)=>!n.isVisible()||n.cache.visible===!0?!1:r[a]?.cache.visible??!1);o&&(j.tree.get(o.id)?.set({visible:!1}),A.set({visible:!0},j.tree,!0))}function gE(j,A,e){Jt(j.tree,A).forEach(({replicaRoot:t})=>{if(Object.keys(t.replicaInfo.overrides).every(i=>!e.has(i)))return;let n={...t.replicaInfo},a={...n.overrides};n.overrides=a,e.forEach((i,s)=>{if(s in a){let l={...a[s]},c=l.itemsOrder;"itemsOrder"in l&&Array.isArray(c)&&(l.itemsOrder=Wn(c,e)),a[i]=Wf(l)}}),j.tree.get(t.id)?.set({replicaInfo:n})})}var fI={type:{type:en.type,value:K6.type},variantId:{type:en.variantId,value:void 0},pauseOffscreen:{type:en.pauseOffscreen,value:K6.pauseOffscreen}},K_={type:"type",variantId:"variantId",pauseOffscreen:"pauseOffscreen"},EI={cycle:!0,set:!0};function J_(j){return x(j)&&j in EI}function Ze(j){return fa(j)&&j.actionIdentifier==="framer/useSetVariant"}function RE(j){return j.controls.type?.value!=="set"?null:j.controls.variantId?.value??null}function H_(j){return Array.isArray(j)&&j.some(Ze)}function Q_(j){return Array.isArray(j)&&j.some(A=>Ze(A)&&A.controls.type?.value==="set"&&!A.controls.variantId?.value)}function U_(j,A){return Jp(j,Ze,A)}function W_(j,A,e){let t=Kp(A,Ze,e),r=[];return t.forEach(o=>{switch(o.controls.type?.value){case"set":{let a=o.controls.variantId?.value;a&&r.push(a);break}case"cycle":{let a=j.getScopeNodeFor(A);if(!eA(a))return;let i=a.getTopLevelVariants();if(i.length<=1)return;let s=j.getGroundNodeFor(A),l=i.findIndex(f=>f.id===s.id);if(l===-1)return;let c=l+1,u=c>=i.length?0:c,p=i[u];p&&r.push(p.id);break}}}),r}function z_(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]=t?.value}),A}function $I(j,A){return!(j?.inputValue!==A?.inputValue||j?.delay!==A?.delay||j?.key!==A?.key)}function X_(j,A,e){let t=Array.isArray(j)?[...j]:[],r=t.findIndex(Ze),o=t[r];if(Ze(o)&&$I(o.meta,e)){let n={...o.controls,...IE(A)},a={...o,controls:n,meta:{...o.meta,...e}};t[r]=a}else{let n=BI(A,void 0,e);t.push(n)}return t}function IE(j){let A={};return Object.entries(j).forEach(([e,t])=>{A[e]={type:en[e],value:t}}),A}function BI(j,A,e){let t=IE({...j}),r={identifier:A||qt(),actionIdentifier:"framer/useSetVariant",controls:{...fI,...t}};return e&&Object.assign(r,{meta:e}),r}function Y_(j,A){let e={...j.controls,...A};return{...j,controls:e}}function FE(j,A){let e=A.get(j);return ia(e)?e:null}function yc(j,A,e="transparent"){if(sA(j))return e;if(!pt(j))return j;let t=ha(j);return(t?FE(t,A):null)?.light??e}function wr(j,A,e,t=!1){if(kk(A)){j.has(A)||j.ensureEntityTypeRootNode(A);return}let r=t?La(e):Pn(e);if(j.has(r))return;let o=new Tn({id:r});j.insertNode(o,A)}function hI(j,A){let e=j.tree.get(A);if(wj(e))return;let t=j.tree.get(e.parentid);if(!wj(t))return t.children?.findIndex(r=>r.id===A)}function lx(j,A,e){let t=j.tree.getEntityReferenceNode(A);if(wj(t))return;let r=Pn(e),o=new Tn({id:r}),n=hI(j,t.id),a=fe(n)?n+1:void 0;j.tree.insertNode(o,t.parentid,a)}function cx(j,A){let e=j.tree.get(A);wj(e)||(j.tree.removeNode(e),gI(j,A))}function gI(j,A,e){let{isCodeFile:t=!1}=e??{},r=t?La(A):Pn(A);j.tree.remove(r)}function Bs(j,A){return j===br?La(A):Pn(A)}function RI(j){return A=>Qe(A)&&A.name===j}function GE(j,A){return j.children.find(RI(A))??null}function hx(j,A){return j.children.find(e=>Qe(e)&&e.getName()===A)??null}function gx(j,A){let t=GI(j.tree,A).map(n=>j.tree.get(n));$(t.length>0,"unreferenced nodes parent node must exist");let r=t.flatMap(n=>n?.children??[]);if(!r||r.length===0)return;let o=II[A];j.tree.beginAllowPartialScopeAccess();for(let n of r){if(!o(n))continue;let a=Bs(A,n.id);if(j.tree.get(a))continue;let i=new Tn({id:a});j.tree.insertNode(i,A)}j.tree.endAllowPartialScopeAccess()}function SE(j){return Tr(j)&&j.save.type==="codeFile"}var II={[Il]:j=>vu(j),[Gl]:j=>ne(j),[yl]:j=>Uj(j),[bl]:j=>lo(j),[Fl]:j=>He(j)||la(j)||so(j),[br]:j=>SE(j),[bn]:j=>eA(j)||SE(j),[Sl]:j=>ia(j),[Cn]:j=>tj(j),[go]:j=>Ee(j)},FI={[Il]:Zt,[Gl]:Zt,[yl]:Zt,[bl]:Zt,[Fl]:Zt,[br]:Re,[Sl]:Ya};function GI(j,A){return A===Cn||A===go?[j.root.id]:A===bn?[j.root.id,Re]:[FI[A]]}var SI="__entity_input";function Rx(j,A){return`${SI}_${j}_${A?"popout":"panel"}`}function bc(j){return pk(j)||Qe(j)}function Ix(j,A,e){let t=e;for(let[r,o]of A.entries()){let n=r===A.length-1,a=j.getNode(t);if(!a||!bc(a))return!1;let i=!1;for(let s of a.children){if(Pu(s)&&o===s.getName())return!0;if(Qe(s)&&o===s.getName()){if(n)return!0;i=!0,t=s.id;break}}if(!i)return!1}return!1}function hs(j,A,e){let t=cj(A)?A:yI(A);if(t.length===0)return e;let r=j.get(e);$(r&&bc(r),"A reference must be in a folder.");for(let o of t){let n=GE(r,o);if(n){r=n;continue}r=j.insertNode(new Bm({name:o}),r.id)}return r.id}function _x(j,A){let e=j.tree.get(A);if(!Qe(e))return"";let t=[e.name];for(let r of e.ancestors()){if(!Qe(r))break;t.unshift(r.name)}return`/${t.join("/")}`}function xx(j,A,e){let t=j.tree.get(A);$(t,"Node must exist");let r=Bs(e,A),o=j.tree.get(r),n=[t.name];if(o)for(let a of o.ancestors()){if(!Qe(a))break;n.unshift(a.name)}return`/${n.join("/")}`}function yI(j){return wl(j).slice(0,-1)}function Mx(j,A,e,t){let r=wl(e);if(r.length===0)return;let o=r.pop(),n=hs(j.tree,e,t),a=t===br;return wr(j.tree,n,A.id,a),A.set({name:o}),n}function xo(j){return pn(j)}function yE(j,A){if(!En(A))return!1;let e=Rl(A.codeComponentIdentifier);if(!e)return!1;let t=j.getNode(e);return!!(t&&w(t))}function Kx(j,A){let e=Rl(A.codeComponentIdentifier);$(e,"WebPageInstance should have a local canvas component id");let t=j.getNode(e);return $(t,"SmartComponentInstance should have a local WebPageNode"),$(w(t),"WebPageInstance its WebPageNode should be a web page"),t}var Yn=(j,A)=>j.length===0?[]:typeof j[0]=="string"?A.withoutDescendants(A.getNodes(j)):j;function gs(j,A){let e=A.reactComponentForIdentifier(j.codeComponentIdentifier);return e?em(e.properties,j.getControlProps(e.properties)):{}}var bI={type:"None",source:"undefined"},bE=class extends ge{constructor(e){super();this.scheduler=e;g(this,"_stack",[]);g(this,"dismiss",()=>{this._stack=Ve.pop(this._stack)});g(this,"isVisible",()=>this.active.type!=="None");g(this,"shouldBlockUndoRedo",(e,t)=>{switch(this.active.type){case"None":return!1;case"Variables":return!lE(e,t);case"LocaleSettings":return!cE(e,t);default:return!0}})}get stack(){return this._stack}get active(){return this._stack[this._stack.length-1]??bI}trackModalOpen({type:e,source:t}){mA("modal_open",{modalType:e,source:t})}push(e){this._stack=Ve.push(this._stack,e),this.trackModalOpen(e)}set(e){this._stack=[e],this.trackModalOpen(e)}dismissAll(){this._stack.length!==0&&(this._stack=[])}dismissModal(e){this._stack=Ve.filter(this._stack,t=>t.type!==e)}displayComponentIsolationModal({source:e}){let t="componentIsolationModal",r="1";Ge.isAutomation||Ge.isE2E||Ge.isTest||localStorage.getItem(t)!==r&&(localStorage.setItem(t,r),setTimeout(()=>{this.scheduler.processWhenReady(()=>{this.set({type:"ComponentIsolationModal",source:e})})},0))}};function CE(j){if(x(j))return[j];if("id"in j)return[j.id];let A=[];for(let e of j)x(e)?A.push(e):A.push(e.id);return A}function Zn(j,A){if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0}var vE=class extends ge{constructor(e,t,r){super();this.guides=e;this.chromeStore=t;this.overlayStore=r;g(this,"_previousIds",[]);g(this,"_ids",[]);g(this,"_nodes",[]);g(this,"_isSticky",!1);g(this,"_commonGroundNode");g(this,"gradientStopId")}get ids(){return this._ids}get nodes(){return this._nodes}get isSticky(){return this._isSticky}get commonGroundNode(){return this._commonGroundNode}get commonGroundNodeId(){return this._commonGroundNode?.id??null}get previousIds(){return this._previousIds}set(e,t={}){let r=CE(e);if(Zn(this._ids,r))return;this._previousIds=this._ids,this._ids=r,this._isSticky=t.sticky??r.length>1,r.length>0&&this.guides.clearSelected();let{switchToLayers:n=!1,tree:a}=t;this.chromeStore.onCanvasSelectionChange(r,n),this.overlayStore.onCanvasSelectionChange(r,{tree:a})}toggle(e,{switchToLayers:t=!1}={}){let r=CE(e),o=new Set(this.ids);for(let n of r)o.has(n)?o.delete(n):o.add(n);this._ids=Array.from(o),this.chromeStore.onCanvasSelectionChange(this.ids,t),this.overlayStore.onCanvasSelectionChange(o,{toggle:!0})}clear(){this.set([])}updateNodes(e){let t=e.getNodes(this.ids),r=!fr(this.nodes,t);r&&(this._nodes=t),(r||this.commonGroundNode&&!e.isGroundNode(this.commonGroundNode))&&this.updateCommonGroundNode(e)}updateCommonGroundNode(e){let t;for(let r of this.nodes){let o=e.getGroundNodeFor(r);if(!t)t=o;else if(t!==o){t=void 0;break}}this._commonGroundNode=t}postProcess(e,t,r,o=this.gradientStopId,n=this._ids){this.gradientStopId=o;let a=[];for(let i of n){let s=e.getNode(i);if(s){e.isAncestorOfNode(s,t.id)&&a.push(i);continue}let l=r.getNode(i);if(!$e(l))continue;let c=e.getNode(l.parentid);if(fj(c)){a.splice(0,a.length,c.id);break}}this.set(a,{tree:e}),this.updateNodes(e)}};function Cc(j){let A=L.componentForIdentifier(j.codeComponentIdentifier);if(!A?.properties)return null;let e=Object.entries(A.properties).find(([,n])=>n&&n.title==="Variant"&&n.type==="enum");if(!e)return null;let[t,r]=e;if(r.options.length<=1)return null;let o=r.defaultValue??r.options[0];return x(o)?{key:t,control:r,defaultVariant:o}:null}function vc(j,{control:A}){let e=j.toLowerCase().trim(),r=(A.optionTitles??A.options).findIndex(n=>x(n)&&n.toLowerCase()===e);if(r===-1)return null;let o=A.options[r];return x(o)?o:null}function TE(j,A,e){let t={};for(let r of e.walk()){if(!W(r))continue;let o=Cc(r);if(!o)continue;let n=vc(A,o);if(!n)continue;let a=r;if(oj(r)&&(a=j.tree.getNode(r.originalid)),!a||(a.getRawControlProp(o.key)??o.defaultVariant)===n)continue;let s={type:"enum",value:n};t[a.id]={[QA(o.key)]:s}}return Object.keys(t).length>0?t:null}var PE=["blur","backgroundBlur","brightness","contrast","grayscale","hueRotate","invert","saturate","sepia"];var Is={left:"position",right:"position",top:"position",bottom:"position",centerAnchorX:"position",centerAnchorY:"position",constraintsLocked:"position",x:"position",y:"position",width:"size",widthType:"size",height:"size",heightType:"size",aspectRatio:"size",itemsOrder:"itemsOrder",layout:"layout",gap:"layout",gridAlignment:"layout",gridColumnCount:"layout",gridColumnWidthType:"layout",gridColumnWidth:"layout",gridColumnMinWidth:"layout",gridRowHeightType:"layout",gridRowHeight:"layout",gridRowCount:"layout",stackDirection:"layout",stackDistribution:"layout",stackAlignment:"layout",stackWrapEnabled:"layout",gridItemFillCellWidth:"size",gridItemFillCellHeight:"size",gridItemHorizontalAlignment:"position",gridItemVerticalAlignment:"position",gridItemColumnSpan:"size",gridItemRowSpan:"size",minHeight:"sizeConstraints",minWidth:"sizeConstraints",maxHeight:"sizeConstraints",maxWidth:"sizeConstraints",paragraphSpacing:"paragraphSpacing",position:"positionType",positionStickyTop:"positionType",positionStickyRight:"positionType",positionStickyBottom:"positionType",positionStickyLeft:"positionType",intrinsicWidth:"intrinsicSize",intrinsicHeight:"intrinsicSize",fillColor:"fill",fillEnabled:"fill",fillImage:"fill",fillImageOriginalName:"fill",fillImagePixelHeight:"fill",fillImagePixelWidth:"fill",fillImageResize:"fill",fillImagePositionX:"fill",fillImagePositionY:"fill",fillImageTileSize:"fill",fillType:"fill",fillRadialGradient:"fill",fillLinearGradient:"fill",fillConicGradient:"fill",tapHighlightColor:"tapHighlight",textSelection:"textSelection",masks:"mask",radius:"radius",radiusBottomLeft:"radius",radiusBottomRight:"radius",radiusIsRelative:"radius",radiusPerCorner:"radius",radiusTopLeft:"radius",radiusTopRight:"radius",borderTop:"border",borderBottom:"border",borderLeft:"border",borderRight:"border",borderEnabled:"border",borderWidth:"border",borderStyle:"border",borderColor:"border",borderPerSide:"border",rotation:"rotation",rotate3d:"rotation",rotateX:"rotation",rotateY:"rotation",blendingMode:"blending",opacity:"opacity",backgroundBlur:"backgroundBlur",overflow:"overflow",overflowY:"overflowY",overflowX:"overflowX",overscrollBehavior:"overscroll",visible:"visibility",brightness:"brightness",contrast:"contrast",grayscale:"grayscale",hueRotate:"hueRotate",invert:"invert",saturate:"saturate",sepia:"sepia",blur:"blur",boxShadows:"shadows",shadows:"shadows",guidesX:"canvasSettings",guidesY:"canvasSettings",exportOptions:"canvasSettings",overlayGrid:"canvasSettings",gesture:"canvasSettings",sizeToFit:"canvasSettings",framePreset:"canvasSettings",isVariant:"canvasSettings",onTap:"action",onTapStart:"action",onClick:"action",onMouseUp:"action",onMouseDown:"action",onMouseEnter:"action",onMouseLeave:"action",onAppear:"action",onKeyDown:"action",padding:"padding",paddingPerSide:"padding",paddingTop:"padding",paddingRight:"padding",paddingBottom:"padding",paddingLeft:"padding",name:"name",strokeEnabled:"stroke",strokeAlignment:"stroke",strokeWidth:"stroke",strokeColor:"stroke",lineJoin:"stroke",lineCap:"stroke",strokeMiterLimit:"stroke",strokeDashArray:"stroke",strokeDashOffset:"stroke",html:"richText",htmlLocalized:"richText",htmlContent:"richText",textFitScale:"richText",textFitViewBoxSize:"richText",textFitViewBoxSizeLocalized:"richText",stylePresetHeading1:"stylePresets",stylePresetHeading2:"stylePresets",stylePresetHeading3:"stylePresets",stylePresetHeading4:"stylePresets",stylePresetHeading5:"stylePresets",stylePresetHeading6:"stylePresets",stylePresetParagraph:"stylePresets",stylePresetLink:"stylePresets",stylePresetAnchorLink:"stylePresets",stylePresetBlockquote:"stylePresets",stylePresetTable:"stylePresets",stylePresetInlineCode:"stylePresets",stylePresetImage:"stylePresets",anchorLinkOffsetY:"anchorLinkOffsetY",styledText:"styledText",getStyledText:"styledText",font:"font",rootFontSize:"rootFontSize",textColor:"textColor",textBackgroundColor:"textBackgroundColor",textBackgroundRadius:"textBackgroundRadius",textBackgroundPadding:"textBackgroundPadding",fontSize:"fontSize",letterSpacing:"letterSpacing",textTransform:"textTransform",textDecoration:"textDecoration",textDecorationColor:"textDecoration",textDecorationThickness:"textDecoration",textDecorationStyle:"textDecoration",textDecorationSkipInk:"textDecoration",textDecorationOffset:"textDecoration",lineHeight:"lineHeight",textAlignment:"textAlignment",textStrokeWidth:"textStroke",textStrokeColor:"textStroke",textWrapBalance:"textWrapBalance",openTypeFontFeatures:"openTypeFontFeatures",link:"link",linkOpenInNewTab:"link",linkSmoothScroll:"link",linkClickTrackingId:"link",linkLocalized:"link",linkRelValues:"link",linkPreserveParams:"link",getLink:"link",linkFont:"linkStyle",linkTextColor:"linkStyle",linkFontSize:"linkStyle",linkTextTransform:"linkStyle",linkTextDecoration:"linkStyle",linkTextDecorationColor:"linkStyle",linkTextDecorationThickness:"linkStyle",linkTextDecorationStyle:"linkStyle",linkTextDecorationSkipInk:"linkStyle",linkTextDecorationOffset:"linkStyle",linkTextBackgroundColor:"linkStyle",linkTextBackgroundRadius:"linkStyle",linkTextBackgroundPadding:"linkStyle",linkHoverFont:"linkStyle",linkHoverTextColor:"linkStyle",linkHoverFontSize:"linkStyle",linkHoverTextTransform:"linkStyle",linkHoverTextDecoration:"linkStyle",linkHoverTextDecorationColor:"linkStyle",linkHoverTextDecorationThickness:"linkStyle",linkHoverTextDecorationStyle:"linkStyle",linkHoverTextDecorationSkipInk:"linkStyle",linkHoverTextDecorationOffset:"linkStyle",linkHoverTextBackgroundColor:"linkStyle",linkHoverTextBackgroundRadius:"linkStyle",linkHoverTextBackgroundPadding:"linkStyle",linkCurrentFont:"linkStyle",linkCurrentTextColor:"linkStyle",linkCurrentFontSize:"linkStyle",linkCurrentTextTransform:"linkStyle",linkCurrentTextDecoration:"linkStyle",linkCurrentTextDecorationColor:"linkStyle",linkCurrentTextDecorationThickness:"linkStyle",linkCurrentTextDecorationStyle:"linkStyle",linkCurrentTextDecorationSkipInk:"linkStyle",linkCurrentTextDecorationOffset:"linkStyle",linkCurrentTextBackgroundColor:"linkStyle",linkCurrentTextBackgroundRadius:"linkStyle",linkCurrentTextBackgroundPadding:"linkStyle",textContent:"textContent",textVerticalAlignment:"textVerticalAlignment",variantTransition:"transition",pathSegments:"vectorPath",pathClosed:"vectorPath",spikeCount:"vectorPath",spikeDepth:"vectorPath",polygonSides:"vectorPath",elementId:"scrollTarget",scrollMarginTop:"scrollTarget",scrollTargetEnabled:"scrollTarget",altAttribute:"accessibility",altAttributeLocalized:"accessibility",cursor:"cursor",customCursorSmartComponentId:"customCursor",customCursorFollow:"customCursor",customCursorOffsetX:"customCursor",customCursorOffsetY:"customCursor",customCursorVariant:"customCursor",customCursorType:"customCursor",customCursorTransitionEnabled:"customCursor",customCursorTransition:"customCursor",customCursorPlacement:"customCursor",customCursorAlignment:"customCursor",pointerEvents:"pointerEvents",userSelect:"userSelect",zIndex:"zIndex",draggable:"draggable",imageRendering:"imageRendering",viewportHeight:"canvasSettings",isBreakpoint:"canvasSettings",backdropFill:"overlay",backdropFillEnabled:"overlay",backdropDismissible:"overlay",blockDocumentScrolling:"overlay",backdropExitTransition:"overlayTransition",backdropEnterTransition:"overlayTransition",backdropTransitionLocked:"overlayTransition",hideScrollbars:"scrollbars",customizations:"customizations",customizationsDescription:"customizations",customizationsSectionId:"customizations",isApplyingCustomizations:"customizations",translateZ:"translateZ",scale:"scale",skewX:"skew",skewY:"skew",backfaceVisibility:"backfaceVisibility",perspective:"perspective",transformStylePreserve3d:"transformStylePreserve3d",transformOriginX:"transformOrigin",transformOriginY:"transformOrigin",transition:"transition",formInputFontSize:"formInputFont",formInputFontFamily:"formInputFont",formInputFontSelector:"formInputFont",formInputFontWeight:"formInputFont",formInputFontStyle:"formInputFont",formInputPlaceholderColor:"formPlaceholderColor",formInputFontColor:"formInputColor",formInputFontLetterSpacing:"formInputFont",formInputFontLetterSpacingUnit:"formInputFont",formInputFontLineHeight:"formInputFont",formInputFontLineHeightUnit:"formInputFont",formInputFontTextAlignment:"formInputFont",formInputOpenTypeFontFeatures:"formInputFont",formTextInputType:"formTextInputType",formTextAreaResizable:"formInputTextAreaResize",formTextInputMinNumber:"formTextInputTypeMin",formTextInputMaxNumber:"formTextInputTypeMax",formInputMaxLength:"formInputMaxLength",formInputStep:"formInputStep",formBooleanInputType:"formBooleanInputType",formBooleanInputValue:"formBooleanInputValue",formBooleanInputCheckedBorderColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderWidth:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderStyle:"formBooleanInputCheckedEffect",formBooleanInputCheckedBoxShadow:"formBooleanInputCheckedEffect",formBooleanInputCheckedFillColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedTransition:"formBooleanInputCheckedEffect",formInputFocusedBackgroundColor:"formInputFocusedFill",formInputFocusedBorderColor:"formInputFocusedBorder",formInputFocusedBorderStyle:"formInputFocusedBorder",formInputFocusedBorderWidth:"formInputFocusedBorder",formInputFocusedBoxShadow:"formInputFocusedBoxShadow",formInputFocusedTransition:"formInputFocusedTransition",formInputInvalidTextColor:"formInputInvalidTextColor",formInputIconImage:"formInputIcon",formInputIconColor:"formInputIcon",viewTransitionNone:"viewTransitionNone"};function $M(j){let A=[],e;for(e in Is){let t=Is[e];j.includes(t)&&A.push(e)}return A}function _E(j,A){let e=L.componentForIdentifier(A.codeComponentIdentifier);if(!e?.properties)return{};let t={};return Object.entries(e.properties).forEach(([r,o])=>{if(!o||Be(A)&&o.type==="slot")return;let n=QA(r),a=j[n];ka(a)&&a.type&&fp(o.type,a.type)&&(o.type==="enum"&&!Zu(o,a.value)||(t[n]=a))}),t}function U(j,A){return A?new Set(cj(A)?A:[A]).has(j):!0}function Fs(j,A,e,t,r,o){let n=j.getScopeNodeFor(e);function a(s){return!aA(s)||n&&kt(n)&&n.hasVariable(s.id)?s:r?.[s.id]??s}let i={};if(Ta(j,e)||Pe(A)&&(A.widthType===4&&(i.widthType=1),A.heightType===4&&(i.heightType=1)),U("visibility",o)&&vo(A)&&vo(e)&&(i.visible=a(A.visible)),U("border",o)&&Bt(A)&&Bt(e)&&(i.borderEnabled=A.borderEnabled,i.borderWidth=A.borderWidth,i.borderColor=A.borderColor,i.borderStyle=A.borderStyle,i.borderPerSide=A.borderPerSide,i.borderLeft=A.borderLeft,i.borderTop=A.borderTop,i.borderRight=A.borderRight,i.borderBottom=A.borderBottom),U("border",o)&&Bt(A)&&Ie(e))if(HA(A.borderEnabled)){let s=A.resolveValue("borderEnabled");Br(s)?(i.strokeEnabled=!0,i.strokeWidth=s.borderWidth,i.strokeColor=s.borderColor):i.strokeEnabled=!1}else i.strokeEnabled=A.borderEnabled,i.strokeWidth=A.borderWidth,i.strokeColor=A.borderColor;if(U("stroke",o)&&Ie(A)&&Ie(e)&&(i.strokeEnabled=A.strokeEnabled,i.strokeColor=A.strokeColor,i.strokeWidth=A.strokeWidth,i.strokeAlignment=A.strokeAlignment,i.lineJoin=A.lineJoin,i.lineCap=A.lineCap,i.strokeMiterLimit=A.strokeMiterLimit,i.strokeDashArray=A.strokeDashArray,i.strokeDashOffset=A.strokeDashOffset),U("stroke",o)&&Ie(A)&&Bt(e)&&(i.borderEnabled=A.strokeEnabled,i.borderWidth=A.resolveValue("strokeWidth"),i.borderColor=A.resolveValue("strokeColor")),U("formInputTextAreaResize",o)&&jp(A)&&(i.formTextAreaResizable=A.formTextAreaResizable),U("formInputFocusedFill",o)&&mt(A)&&mt(e)&&(i.formInputFocusedBackgroundColor=A.formInputFocusedBackgroundColor),U("formInputFocusedBorder",o)&&mt(A)&&mt(e)&&(i.formInputFocusedBorderColor=A.formInputFocusedBorderColor,i.formInputFocusedBorderWidth=A.formInputFocusedBorderWidth,i.formInputFocusedBorderStyle=A.formInputFocusedBorderStyle),U("formInputFocusedBoxShadow",o)&&mt(A)&&mt(e)&&(i.formInputFocusedBoxShadow=A.formInputFocusedBoxShadow?[...A.formInputFocusedBoxShadow]:void 0),U("formInputFocusedTransition",o)&&mt(A)&&mt(e)&&(i.formInputFocusedTransition=A.formInputFocusedTransition),U("formInputColor",o)&&Nr(A)&&Nr(e)&&(i.formInputFontColor=A.formInputFontColor),U("formPlaceholderColor",o)&&jc(A)&&jc(e)&&(i.formInputPlaceholderColor=A.formInputPlaceholderColor),U("formInputPadding",o)&&lt(A)&&lt(e)&&(i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("shadows",o)&&hr(A)&&hr(e)){let s=a(A.boxShadows);rp(e)?i.boxShadows=s:HA(s)||(i.boxShadows=s?.filter(l=>l.type!=="realistic"))}if(U("shadows",o)&&dl(A)&&dl(e)&&(i.shadows=A.shadows),U("rotation",o)&&Ut(A)&&Ut(e)&&(i.rotation=A.rotation,Tj(e)&&Tj(A)&&(i.rotate3d=A.rotate3d,i.rotateX=A.rotateX,i.rotateY=A.rotateY)),U("overflow",o)&&ut(A)&&ut(e)&&(i.overflow=a(A.overflow)),U("overscroll",o)&&il(A)&&il(e)&&(i.overscrollBehavior=a(A.overscrollBehavior)),U("cursor",o)&&hn(A)&&hn(e)&&(i.cursor=a(A.cursor)),U("customCursor",o)&&hn(A)&&hn(e)&&(i.customCursorType=A.customCursorType,i.customCursorSmartComponentId=A.customCursorSmartComponentId,i.customCursorVariant=A.customCursorVariant,i.customCursorFollow=A.customCursorFollow,i.customCursorOffsetX=A.customCursorOffsetX,i.customCursorOffsetY=A.customCursorOffsetY,i.customCursorTransitionEnabled=A.customCursorTransitionEnabled,i.customCursorTransition=A.customCursorTransition,i.customCursorPlacement=A.customCursorPlacement,i.customCursorAlignment=A.customCursorAlignment),Nn(A)&&Nn(e))for(let s of PE){let l=Is[s];U(l,o)&&(i[s]=a(A[s]))}if(U("blending",o)&&ol(A)&&ol(e)&&(i.blendingMode=a(A.blendingMode)),U("transition",o)&&Jl(A)&&Jl(e)){let s=DA(A)?A.variantTransition:A.transition;DA(e)?i.variantTransition=s:i.transition=s}if(U("fill",o)&&_e(A)&&_e(e)){i.fillColor=a(A.fillColor),i.fillType=A.fillType,i.fillLinearGradient=A.fillLinearGradient,i.fillRadialGradient=A.fillRadialGradient,i.fillConicGradient=A.fillConicGradient,i.fillType==="conic-gradient"&&!sk(e)&&(i.fillType=e.fillType??"color");let s=a(A.fillImage);HA(s)?HA(s)&&e.supportsDynamicValues()&&(i.fillImage=s):i.fillImage=s,i.fillImageResize=A.fillImageResize,i.fillImagePixelWidth=A.fillImagePixelWidth,i.fillImagePixelHeight=A.fillImagePixelHeight,i.fillImagePositionX=A.fillImagePositionX,i.fillImagePositionY=A.fillImagePositionY,i.fillImageTileSize=A.fillImageTileSize}if(U("fill",o)&&Ht(A)&&Ht(e)&&(i.fillEnabled=A.fillEnabled),(U("size",o)||U("fill",o))&&Pe(A)&&Pe(e)){let s=i.fillType??(_e(e)?e.fillType:void 0),l=i.heightType??e.heightType;(i.widthType??e.widthType)===5&&s!=="image"&&(i.width=e.rect().width,i.widthType=0),l===5&&s!=="image"&&(i.height=e.rect().height,i.heightType=0)}if(U("opacity",o)&&Vl(A)&&Vl(e)&&(i.opacity=a(A.opacity)),U("radius",o)&&zt(A)&&zt(e)&&(i.radius=a(A.radius),Tl(A)&&Tl(e)&&(i.radiusIsRelative=A.radiusIsRelative),$r(A)&&$r(e)&&(i.radiusPerCorner=A.radiusPerCorner,i.radiusBottomLeft=A.radiusBottomLeft,i.radiusBottomRight=A.radiusBottomRight,i.radiusTopLeft=A.radiusTopLeft,i.radiusTopRight=A.radiusTopRight)),U("pointerEvents",o)&&al(A)&&al(e)&&!hj(n)&&(i.pointerEvents=a(A.pointerEvents)),U("draggable",o)&&ql(A)&&ql(e)&&(i.draggable=a(A.draggable)),U("userSelect",o)&&sl(A)&&sl(e)&&(i.userSelect=a(A.userSelect)),U("imageRendering",o)&&nl(A)&&nl(e)&&(i.imageRendering=a(A.imageRendering)),U("overflowX",o)&&ut(A)&&ut(e)&&(i.overflowX=a(A.overflowX)),U("overflowY",o)&&ut(A)&&ut(e)&&(i.overflowY=a(A.overflowY)),U("zIndex",o)&&ml(A)&&ml(e)&&(i.zIndex=a(A.zIndex)),U("scrollbars",o)&&zl(A)&&zl(e)&&(i.hideScrollbars=a(A.hideScrollbars)),U("textVerticalAlignment",o)&&Yl(A)&&Yl(e)&&(i.textVerticalAlignment=A.textVerticalAlignment),U("textWrapBalance",o)&&Pl(A)&&Pl(e)&&(i.textWrapBalance=A.textWrapBalance),U("styledText",o)&&qj(A)&&wp(e)){i.font=A.getFonts(!1)[0],i.textColor=A.getTextColors(!1)[0];let s=A.getFontSizes(!1)[0];i.fontSize=kn(s)?s[0]:s;let l=A.getLetterSpacings(!1)[0];i.letterSpacing=sA(l)?l:Vu(l),i.textTransform=A.getTextTransforms(!1)[0],i.textDecoration=A.getTextDecorations(!1)[0],i.lineHeight=A.getLineHeights(!1)[0],i.textAlignment=A.getTextAlignments(!1)[0],i.styledText=e.styledText.setFont(void 0,!1).setTextColor(void 0,!1).setFontSize(void 0,!1).setLetterSpacing(void 0,!1).setTextTransform(void 0,!1).setTextDecoration(void 0,!1).setLineHeight(void 0).setTextAlignment(void 0)}if(U("link",o)&&qj(A)&&qj(e)&&(i.linkFont=A.linkFont,i.linkTextColor=A.linkTextColor,i.linkFontSize=A.linkFontSize,i.linkTextTransform=A.linkTextTransform,i.linkTextDecoration=A.linkTextDecoration,i.linkHoverFont=A.linkHoverFont,i.linkHoverTextColor=A.linkHoverTextColor,i.linkHoverFontSize=A.linkHoverFontSize,i.linkHoverTextTransform=A.linkHoverTextTransform,i.linkHoverTextDecoration=A.linkHoverTextDecoration,i.linkCurrentFont=A.linkCurrentFont,i.linkCurrentTextColor=A.linkCurrentTextColor,i.linkCurrentFontSize=A.linkCurrentFontSize,i.linkCurrentTextTransform=A.linkCurrentTextTransform,i.linkCurrentTextDecoration=A.linkCurrentTextDecoration),U("mask",o)&&Cl(A)&&Cl(e)&&(i.masks=A.masks),XA(A)&&XA(e)){if(U("fontSize",o)&&(i.textFitScale=A.textFitScale,i.textFitViewBoxSize=A.textFitViewBoxSize),U("paragraphSpacing",o)&&(i.paragraphSpacing=A.paragraphSpacing),U("styledText",o)){let s=A.getTextStrokeWidths(!1)[0],l=A.getTextStrokeColors(!1)[0];sA(s)||(i.textStrokeWidth=s),l&&(i.textStrokeColor=l)}if(U("richText",o))for(let s of _o){let l=A[s];j.has(l)&&(i[s]=l)}}if(U("codeComponentProps",o)&&En(A)&&En(e)){let s=_E(A,e);Object.assign(i,s)}if(U("codeOverride",o)&&fo(A)&&fo(e)&&(i.codeOverrideEnabled=A.codeOverrideEnabled,i.codeOverrideIdentifier=A.codeOverrideIdentifier),U("formInputFont",o)&&Nr(A)&&Nr(e)&&(i.formInputFontFamily=A.formInputFontFamily,i.formInputFontWeight=A.formInputFontWeight,i.formInputFontStyle=A.formInputFontStyle,i.formInputFontSize=A.formInputFontSize,i.formInputFontSelector=A.formInputFontSelector,i.formInputFontLetterSpacing=A.formInputFontLetterSpacing,i.formInputFontLetterSpacingUnit=A.formInputFontLetterSpacingUnit,i.formInputFontLineHeight=A.formInputFontLineHeight,i.formInputFontLineHeightUnit=A.formInputFontLineHeightUnit,i.formInputFontTextAlignment=A.formInputFontTextAlignment,i.formInputOpenTypeFontFeatures=A.formInputOpenTypeFontFeatures),U("layout",o)&&WA(A)&&pA(e)&&($j(e)||(i.layout=A.layout),i.stackDirection=A.stackDirection,i.stackDistribution=A.stackDistribution,i.stackAlignment=A.stackAlignment,i.gap=A.gap,i.padding=A.padding,i.paddingPerSide=A.paddingPerSide,i.paddingTop=A.paddingTop,i.paddingRight=A.paddingRight,i.paddingBottom=A.paddingBottom,i.paddingLeft=A.paddingLeft),U("position",o)&&Object.assign(i,Io(A,t)),U("perspective",o)&&Tj(A)&&Tj(e)&&(i.perspective=a(A.perspective)),U("overlay",o)&&bj(A)&&bj(e)&&t){let s=Kt(A);Object.assign(i,s)}if(U("effects",o)&&wn(A)&&wn(e)&&Object.assign(i,fm(e,A)),U("transformOrigin",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{transformOriginX:A.transformOriginX,transformOriginY:A.transformOriginY}),U("backfaceVisibility",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{backfaceVisibility:A.backfaceVisibility}),U("transformStylePreserve3d",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{transformStylePreserve3d:A.transformStylePreserve3d}),U("translateZ",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{translateZ:A.translateZ}),U("scale",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{scale:A.scale}),U("skew",o)&&Tj(A)&&Tj(e)&&Object.assign(i,{skewX:A.skewX,skewY:A.skewY}),U("formBooleanInputType",o)&&Dr(A)&&Dr(e)&&Object.assign(i,{formBooleanInputType:A.formBooleanInputType}),U("formBooleanInputValue",o)&&Dr(A)&&Dr(e)&&Object.assign(i,{formBooleanInputValue:A.formBooleanInputValue}),U("formBooleanInputCheckedEffect",o)&&Dr(A)&&Dr(e)){let s={formBooleanInputCheckedBorderColor:A.formBooleanInputCheckedBorderColor,formBooleanInputCheckedBorderWidth:A.formBooleanInputCheckedBorderWidth,formBooleanInputCheckedBorderStyle:A.formBooleanInputCheckedBorderStyle,formBooleanInputCheckedFillColor:A.formBooleanInputCheckedFillColor,formBooleanInputCheckedBoxShadow:A.formBooleanInputCheckedBoxShadow,formBooleanInputCheckedTransition:A.formBooleanInputCheckedTransition};Object.assign(i,s)}return U("formInputIcon",o)&&Ac(A)&&Ac(e)&&Object.assign(i,{formInputIconImage:A.formInputIconImage,formInputIconColor:A.formInputIconColor}),U("viewTransitionNone",o)&&Hl(A)&&Hl(e)&&(i.viewTransitionNone=A.viewTransitionNone),i}function xE(j,A,e,t,r){if(at(t))return;let o=nj(A)?2:0,n=mj(e.x,o),a=mj(e.y,o);if(wt(r.x)?(r.x=n,r.y=a):(!ke(r.x)&&r.x!==n&&(r.x=ur),!ke(r.y)&&r.y!==a&&(r.y=ur)),!$A(A)||!t)return;let i=j.getParentSizeInfo(A);if(!i?.positioning)return;let s=i.positioning,l=mj(s.width-q.maxX(e),o),c=mj(s.height-q.maxY(e),o);wt(r.right)?(r.right=l,r.bottom=c):(!ke(r.right)&&r.right!==l&&(r.right=ur),!ke(r.bottom)&&r.bottom!==c&&(r.bottom=ur))}var Vj={padding:0,gridRowCount:2,gridColumnCount:2,gridRowHeight:200,gridColumnWidth:200};Object.freeze(Vj);function BN(j){switch(j){case 20:return 0;case 21:return 1;case 23:return 4;case 24:return 3;case 22:return 2;case 19:return 5}}var CI=(j,A,e=!0)=>{let t=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:A,stackDistribution:"start",stackAlignment:"center",gap:t,stackWrapEnabled:!1,paddingPerSide:!1,padding:e?t:Vj.padding,paddingTop:Vj.padding,paddingBottom:Vj.padding,paddingLeft:Vj.padding,paddingRight:Vj.padding}},vI={gridItemFillCellWidth:!0,gridItemFillCellHeight:!0,gridItemHorizontalAlignment:"center",gridItemVerticalAlignment:"center",gridItemColumnSpan:1,gridItemRowSpan:1},TI=j=>({layout:"grid",gridColumnCount:Vj.gridColumnCount,gridAlignment:"center",gridColumnWidthType:"minmax",gridColumnWidth:Vj.gridColumnWidth,gridColumnMinWidth:50,gridRowHeightType:"auto",gridRowCount:Vj.gridRowCount,gridRowHeight:Vj.gridRowHeight,gap:j.stores.persistedUserDefaults.layoutGap,paddingPerSide:!1,padding:Vj.padding,paddingTop:Vj.padding,paddingBottom:Vj.padding,paddingLeft:Vj.padding,paddingRight:Vj.padding}),DE=new Set(["#BDF","#CEF","#9DF"]);function PI(j){let A=Array.from(DE).filter(e=>e!==j);return A.length=2,A}var NE=(j,A={},e={})=>{let{index:t=0,lastColor:r,parentColor:o,source:n}=e,a=PI(o),i=a.length,s=a[0];if(t>0)s=a[Math.ceil(t/i)%i];else if(x(r))if(DE.has(r)){let c=(a.indexOf(r)+1)%i;s=a[c]}else s=r;n&&mA("layout_frame",{source:n});let l={fillEnabled:!0,fillColor:s};return WA(j)&&!j.stackWrapEnabled&&(j.widthType!==2&&(l.width=1,l.widthType=3),j.heightType!==2&&(l.height=1,l.heightType=3)),Object.assign(l,A),new Me(l)},hN=(j,A)=>{switch(j){case 0:case 1:{A.layout="stack",A.stackDirection=j===0?"vertical":"horizontal";break}case 2:case 3:case 4:A.overflow=Ue();break}},_I=(j,A,e,t,r,o)=>{let n=new Me({...CI(j,e,r),fillEnabled:!1,...A});$(WA(n));let a=o?{widthType:0,width:o.width,heightType:0,height:o.height}:void 0;for(let i=0;i<t;i++){let s=NE(n,a,{index:i});n.addChild(s)}return n},ME=(j,A,e,t)=>{let r=new Me({...TI(j),fillEnabled:!1,...A});$(it(r));for(let o=0;o<e;o++){let n={};switch(t){case 3:o===0&&(n.gridItemRowSpan=2);break;case 4:o+1===e&&(n.gridItemColumnSpan=2);break;default:break}let a=NE(r,{...vI,...n},{index:o});r.addChild(a)}return r},gN=(j,A,e,t=!1)=>{if(A===2)return ME(j,e,t?0:4);if(A===3||A===4)return ME(j,e,t?0:3,A);let r=t?0:2;return _I(j,e,e.stackDirection??"horizontal",r,!1)},OE=zp.width,xI=(j,A,e,t,r,o)=>{let n={x:Er,y:Er,right:Er,bottom:Er};xE(j,A,e,t,n),Yi(n.x)&&Yi(n.right)&&r-n.x-n.right<200&&(o.left=0,o.right=0)},MI=(j,A)=>{j.stackDirection==="horizontal"&&!j.stackWrapEnabled&&(A.stackDirection="vertical"),j.stackWrapEnabled&&j.stackDistribution==="start"&&(A.stackDistribution="center")},DI=j=>{let A={};return j.children?.forEach(e=>{if(!Bo(e))return;let t=e.originalid??e.id;A[t]={maxWidth:"100%"}}),A},NI=(j,A)=>{Yi(j.gridColumnCount)&&(A.gridColumnCount=1)},OI=(j,A,e,t,r,o)=>{xI(j,A,e,t,r,o),!(r>OE)&&(WA(A)&&MI(A,o),it(A)&&NI(A,o))},Tc=(j,A,e,t,r,o)=>{let n=A.originalid??A.id,a={};if(OI(j,A,e,t,r,a),o[n]=a,ve(A)&&A.stackWrapEnabled&&r<=OE){let s=DI(A);for(let l in s)o[l]={...o[l],...s[l]}}};function RN(j,A,e){let t=j.tree.getNode(A);if(!t||!Te(t))return;let r=j.tree.getNode(e);if(!r||!Ej(r)||!IA(r))return;let o=j.tree.getScopeNodeFor(r);if(!o||!w(o))return;let n=j.tree.getRect(t),a=o.getBreakpointValues();for(let i in a){if(i===e)continue;let s=j.tree.getNode(i);if(!s||!dj(s)||!sj(s))continue;let l={};Tc(j.tree,t,n,r,s.width,l),df(j.tree,s,l)}}function wE(j,A){let e={width:{2:!0,0:!0,3:!0,1:!0,4:!0,5:!0},height:{2:!0,0:!0,3:!0,1:!0,4:!0,5:!0}},t=j.getParent(A.id);if(!t||!$A(A)||tf(A)&&A.autoSize===!0||bj(A)?(e.width[1]=!1,e.height[1]=!1,e.width[3]=!1,e.height[3]=!1,e.width[4]=!1,e.height[4]=!1):it(t)?ze(A,t)?(e.width[3]=!0,e.height[3]=t.gridRowHeightType!=="fit"):(e.width[3]=!1,e.height[3]=!1):WA(t)?(ze(A,t)||(e.width[3]=!1),ze(A,t)||(e.height[3]=!1)):(e.width[3]=!1,e.height[3]=!1),Gk(A)&&Oj(A.textFitViewBoxSize)&&(e.height[2]=!0,e.width[2]=!1,e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1),ho(A)||(e.width[5]=!1,e.height[5]=!1),W(A)){let o=A.getSupportedLayout(L);Se(o.width)||(e.width[2]=!1),Se(o.height)||(e.height[2]=!1),V6(o.width)||(e.width[0]=!1,e.width[1]=!1,e.width[3]=!1,e.width[4]=!1),V6(o.height)||(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1)}else if(pA(A)){if(IA(A)){e.width[2]=!1,fl(A)&&(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1);let o=j.get(A.parentid);tj(o)&&(e.height[2]=!1)}A.children.length===0&&(e.width[2]=!1,e.height[2]=!1)}else pA(A)||ln(A)||XA(A)||(e.width[2]=!1,Rk(A)||(e.height[2]=!1));return Ke(A)&&sA(A.layout)&&oj(A)&&!$j(A)&&(e.width[2]=!1,e.height[2]=!1),Ta(j,A)||(e.width[4]=!1,e.height[4]=!1),(IA(t)&&Pe(t)&&tn(t.heightType)||fl(t))&&(e.height[3]=!1,e.height[1]=!1),at(t)&&(e.width[3]=!1,e.width[1]=!1,e.height[3]=!1,e.height[1]=!1),e}var LE=j=>{let A=[];return j.forEach((e,t)=>{for(let r=t+1;r<j.length;r++){let o=j[r];A.push([e,o])}}),A};function qE(j,A,e){let t=A.map(c=>j.convertFrameToCanvas(c));if(t.length===2){let[c,u]=t,p=qI(c,u),f=VI(c,u);if(p&&!f)return"vertical";if(f&&!p)return"horizontal"}let r=t.map(c=>q.center(c));if(r.length<=1){if(t.length===1){let[c]=t,u=e.width/Math.max(1,c.width),p=e.height/Math.max(1,c.height);return u<p?"vertical":"horizontal"}return e.width<e.height?"vertical":"horizontal"}let o=LE(r),n=[],a=[];o.forEach(([c,u])=>{n.push(Math.abs(c.x-u.x)),a.push(Math.abs(c.y-u.y))});let i=n.reduce((c,u)=>c+u,0),s=a.reduce((c,u)=>c+u,0);return i>s?"horizontal":"vertical"}function VE(j,A,e){return[...A].sort((t,r)=>{let o=j.tree.getRect(t),n=j.tree.getRect(r);return e==="horizontal"?o.x-n.x:o.y-n.y})}function wI(j){if(HA(j))return!0;switch(j){case"start":case"center":case"end":return!0;default:return!1}}function Pc(j,A,e){let t=qE(j.tree,A,e),r=j.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:t,gap:r,stackDistribution:Gu,stackAlignment:ra,stackWrapEnabled:!1,padding:0,paddingPerSide:!1,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}function LI(j,A){A.forEach((e,t)=>{j.tree.moveNodeIndex(e,t)})}function KE(j,A,e,t,r){e==="horizontal"&&A.heightType===2||e==="vertical"&&A.widthType===2||JE(j,t,e,r,{})}function JE(j,A,e,t,r){if(e==="horizontal"||HA(r.padding))return;let o={...t};if(r.paddingPerSide)r.paddingLeft&&(o.width-=r.paddingLeft),r.paddingRight&&(o.width-=r.paddingRight),r.paddingTop&&(o.height-=r.paddingTop),r.paddingBottom&&(o.height-=r.paddingBottom);else if(r.padding){let a=r.padding*2;o.width-=a,o.height-=a}o.width=Math.max(0,o.width),o.height=Math.max(0,o.height);let n=o.width;n>0&&A.forEach(a=>{if(!$A(a)||RA(a)||Da(a)||Ma(a)||a.widthType===2||a.widthType===4)return;if(j.tree.getRect(a).width/n>.96){let l=j.tree.getParent(a.id),c=j.tree.getParentSizeInfo(a);c.sizing&&a.heightType===4&&(c.sizing={...o,height:c.sizing.height});let u=j.tree.getRect(a),p=a.updateForRect({rect:u,parentSizeInfo:c,constraintsLocked:!0,shouldGuessPinToBottom:It(j.tree,a),shouldGuessPinToRight:ae(j.tree,a,l)});p.width=1,a.width!==1&&(p.widthType=3),a.set(p)}})}function HE(j,A,e,t,r){if(!j.tree.getNode(A))return;VE(j,t,r).forEach(a=>{if(tp(a)&&Yt(a)||$n(a))return;let i=j.tree.getParent(a.id),s=j.tree.getRect(a),l=q.offset(s,lA.reverse(e));j.moveNode(a.id,A);let c={...e},u=j.tree.getParentSizeInfo(a);Np(a)&&u.sizing&&(c.width=u.sizing.width),Op(a)&&u.sizing&&(c.height=u.sizing.height),j.tree.current(a)?.set({...a.updateForRect({rect:l,parentSizeInfo:{sizing:c,positioning:e,viewport:u?.viewport??null,layout:Je(i)},constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:ae(j.tree,a,i)}),top:null,left:null,bottom:null,right:null,position:void 0}),Jt(j.tree,a).forEach(({replicaRoot:f,relatedNode:E})=>{kA.resetOverridesByProperty(j.tree,f,E,["position"])})})}function qI(j,A){let e=q.maxX(j),t=q.maxX(A);return e>A.x&&t>j.x}function VI(j,A){let e=q.maxY(j),t=q.maxY(A);return e>A.y&&t>j.y}function _c(j,A,e){if(!TA(e))return;let t=A==="width"?"widthType":"heightType";e.children.forEach(r=>{if($A(r)&&(r[t]===3||r[t]===1)){let o=j.getRect(r),n={[t]:0,[A]:o[A]};$o(r)&&(n.aspectRatio=null),j.current(r)?.set(n)}})}function XN(j,A){if(!TA(A)||!$A(A))return;let e=new Set;A.children.forEach(t=>{if(!$A(t)||!Bo(t))return;let r=j.getRect(t),o={};A.widthType===2&&(t.widthType===3||t.widthType===1)&&(o.minWidth=r.width,e.add(t)),A.heightType===2&&(t.heightType===3||t.heightType===1)&&(o.minHeight=r.height),Object.keys(o).length>0&&(e.add(t),j.current(t)?.set(o))}),e.size>0&&KI()}function KI(){PA({type:"add",variant:"info",key:"setting-stack-direction-causes-children-change",text:"Layers in this stack received min-sizing to prevent a collapse",icon:"thumbnail",duration:5e3,showCloseButton:"always"})}function Gs(j,A,e={}){if(!Ke(A)||!TA(A)||ve(A))return;let t={layout:"stack",...e},r=j.tree.getRect(A),o=j.tree.getScopeNodeFor(A),n=vm(A)||DA(A)&&w(o)||A.__unsafeIsGroundNode(j.tree)&&oe(o),a=n?"vertical":qE(j.tree,A.children,r),i=VE(j,A.children,a);gA(A)||LI(j,i);let s=oa(A),l=A.gap??j.stores.persistedUserDefaults.layoutGap,c=n?"start":"center";t.stackDirection=s?A.stackDirection??a:a,t.stackDistribution=s?A.stackDistribution??c:c,t.gap=s||wI(c)?l:0,t.stackAlignment=s?A.stackAlignment??ra:ra,t.stackWrapEnabled=s?A.stackWrapEnabled??!1:!1;let u=s&&lt(A)?{padding:A.padding,paddingPerSide:A.paddingPerSide,paddingLeft:A.paddingLeft,paddingRight:A.paddingRight,paddingTop:A.paddingTop,paddingBottom:A.paddingBottom}:{...Ju};if(a==="horizontal"&&e.heightType===2||a==="vertical"&&e.widthType===2||JE(j,A.children,a,r,u),u.paddingPerSide){let{paddingTop:f,paddingRight:E,paddingBottom:F,paddingLeft:R}=u;f===E&&f===F&&f===R&&(u.paddingPerSide=!1,u.padding=f)}A.set({...t,...u})}var WE=900;function mO(j){return j.intrinsicWidth>=WE}function Ss(j,A,e){if(qj(A))return!1;let t=e??j.getParent(A.id);return!!(t&&IA(t))}function fO(j){return j<=.5}function JI(j,A,e){if(!pA(A)||!Ej(A)||!IA(A)||Ce(A)||!Ss(j,e,A))return!1;let t=sj(e)&&Pe(e)&&e.widthType===1&&e.width===1;if(sj(e)&&e.width<WE&&!t)return!1;let r=A.children.filter(l=>l.id!==e.id);if(r.length===0)return!0;let n=j.getRect(A).width||1,a=r.map(l=>j.getRect(l));return a.some(l=>l.width/n<.5)?!1:a.every((l,c)=>a.every((u,p)=>c===p?!0:!q.intersects(l,u)))}function zE(j,A,e,t){if(!Ke(A)||!JI(j.tree,A,e))return;let r={};t.height>500&&(r.heightType=2),Gs(j,A,r),A.set({gap:0})}function QE(j,A){for(let e of Object.values(j.variables))if(e?.type==="collectionreference"&&e.dataIdentifier===A)return e}function UE(j,A){return Object.values(j.variables).find(e=>e?.type==="multicollectionreference"&&e.dataIdentifier===A)}function HI(j,A){let e=Yk(A);if(el(e))return{targetDataIdentifier:e.dataIdentifier,targetProviderId:e.id};let t=j.stores.scopeStore.active;if(Ae(t))return{targetDataIdentifier:t.dataIdentifier,targetProviderId:t.id}}function XE(j,A,e){if(!el(e))return;let t=HI(j,A);if(!t)return;let{targetDataIdentifier:r,targetProviderId:o}=t,n=gn(j.tree,e.dataIdentifier),a=gn(j.tree,r);if(!n||!a)return;let i=QE(n,r),s=UE(n,r),l=QE(a,e.dataIdentifier),c=UE(a,e.dataIdentifier),u;c?u={id:Fj(),itemKey:"id",transforms:[{id:Fj(),type:"valueTransform",name:"isIncludedIn",value:re(c.id,o)}]}:l?u={id:Fj(),itemKey:"id",transforms:[{id:Fj(),type:"valueTransform",name:"equals",value:re(l.id,o)}]}:s?u={id:Fj(),itemKey:s.id,transforms:[{id:Fj(),type:"valueTransform",name:"contains",value:re("id",o)}]}:i&&(u={id:Fj(),itemKey:i.id,transforms:[{id:Fj(),type:"valueTransform",name:"equals",value:re("id",o)}]}),u&&e.set({collectionFilters:{filters:[u]}})}function YE(j,A,e,t){if(!pA(A)||!Ej(A)||!IA(A)||!ve(A)||A.stackDirection!=="vertical"||!Ss(j.tree,e,A)||A.heightType===2||!wE(j.tree,A).height[2])return;let o=A.children.filter(s=>s.id!==e.id);if(o.length===0)return;let n=j.tree.getRect(A),a=o.map(s=>j.tree.getRect(s));q.merge(...a).height+t.height<=n.height||(A.set({height:n.height,heightType:2}),o.forEach((s,l)=>{let c=a[l];$(c,"Child rect must be defined"),sj(s)&&Pe(s)&&s.heightType===3&&s.set({height:c.height,heightType:0})}))}var ZE=Dj(JR());var bs=Dj(ro()),Dc=Dj(zi());function ys(j){let A=j.name||De(j);return/^\s*$/u.test(A)?j instanceof af?"Text":"Layer":A}function A$({node:j,renderTarget:A=Aa.export,addNames:e=!1,isDarkMode:t,combinedVariableValueMap:r}){if(xt(j))return j.svg;let o=[],n=!0,a=null;RA(j)?(a=j,j.children.map(E=>{nj(E)&&o.push(E)})):(n=!1,o.push(j));let i=j.tree();$(i,"cannot render nodes to svg without a tree"),o=o.map(E=>Bf(E,i,t)),hf(i,r,t);let s={needsXlinks:!1},l=o.map(E=>(Mc(E,s),xc(E,n,e,r))),c=null,u=a?.fillEnabled&&a.exportIncludesBackground&&!lk(a);if(u&&a){let E=new lf(a.raw({__class:"RectangleShapeNode"}));Mc(E,s),c=xc(E,!1,!1,r)}let p=(0,bs.jsx)(eu,{isStatic:!0,children:(0,bs.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:s.needsXlinks?"http://www.w3.org/1999/xlink":void 0,width:Q6(j.width,3),height:Q6(j.height,3),fill:"none",overflow:RA(j)?void 0:"visible",children:[u&&c,l]})});return Au({target:A},()=>ZE.renderToStaticMarkup(p))}function j$(j){return j.replace(/[\f\n\r\t\v\xa0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/gu," ").replace(/(?:\/|^)(?:\.+\/)+/gmu,"/")}function xc(j,A,e,t){if(Mt(j)){let o=j.getProps(t);return(0,Dc.createElement)(Lu,{...o,key:j.id,isRootVectorNode:!1,includeTransform:A},j.children.map(n=>xc(n,!0,e,t)))}let r=j.getProps(t);return(0,Dc.createElement)(wu,{...r,key:j.id,isRootVectorNode:!1,includeTransform:A})}function Mc(j,A){if(A.needsXlinks||((Mt(j)||dn(j))&&j.children&&j.children.map(u=>Mc(u,A)),Mt(j)))return;let{strokeEnabled:e,strokeAlignment:t,strokeWidth:r,fillEnabled:o,fillType:n,fillImage:a,boxShadows:i}=j,s=t==="inside"&&e&&e&&!!r,l=o&&n==="image"&&a!==null,c=i&&!HA(i)&&i.length>0&&i.some(u=>u!==void 0);(s||c||l)&&(A.needsXlinks=!0)}var e$=x7({canvas:()=>{let j=QI();return ic(j),nc(j)},onPageCanvas:()=>{let j=UI();return ic(j),nc(j)}});function QI(){let j=Ge.isDebugBuild?"canvas-sandbox.debug.html":"canvas-sandbox.html",A=Dl(`./${j}`),e=JSON.stringify(qe());return A+`#services=${encodeURIComponent(e)}`}function UI(){let j=Ge.isDebugBuild?"canvas-sandbox-on-page.debug.html":"canvas-sandbox-on-page.html",A=Dl(`./${j}`),e=JSON.stringify(qe());return A+`#services=${encodeURIComponent(e)}`}var gj=class gj{constructor(A,e,t,r){this.log=A;this.windowService=e;this.windowRef=t;this.contentWindow=r}static async serviceIfAvailable(){gj.deprecatedServicePromise=gj.deprecatedServicePromise??kc.on(to).discover({timeout:1e3}),gj.servicePromise=gj.servicePromise??fc.on(to).discover({timeout:1e3});try{return await Promise.any([gj.servicePromise,gj.deprecatedServicePromise])}catch{return}}static async isAvailable(){return!!await gj.serviceIfAvailable()}static async new(A){gj.currentWindow&&(gj.currentWindow.contentWindow.close(),gj.currentWindow=void 0);let e=await gj.serviceIfAvailable();$(e,"CustomWindow is not available");let t=hA("electron-window"),r=await e.willOpenWindow(A);t.debug("opening window...");let o=window.open(A.url,"_blank")??void 0;return $(o,"Couldn't open a new DOM window"),t.debug("opened window",o),gj.currentWindow=new gj(t,e,r,o),gj.currentWindow}async openSaveDialog({count:A,pathname:e}){return this.windowService.openSaveDialog({count:A,pathname:e})}async collectMetrics(){return this.windowService.collectMetrics()}async writeToClipboard(A){return this.windowService.writeToClipboard({...A,ref:this.windowRef})}async writeToDisk(A){return this.log.debug("capture....",this.windowRef),this.windowService.writeToDisk({...A,ref:this.windowRef})}async getImageData(A){return"getImageData"in this.windowService?(await this.windowService.getImageData({...A,ref:this.windowRef})).imageData:Promise.reject(new Error("getImageData is not available"))}};g(gj,"deprecatedServicePromise"),g(gj,"servicePromise"),g(gj,"currentWindow");var Ai=gj;var Cs=class{constructor(){g(this,"controller");g(this,"renderer");g(this,"modules");g(this,"modulesRuntime");g(this,"assets");g(this,"controlsVisibility");g(this,"flags");yA.isOn("newRpc")&&(this.controller=new Rf(se),this.renderer=this.controller.getRemote(se.channels.renderer),this.modules=this.controller.getRemote(se.channels.modules),this.modulesRuntime=this.controller.getRemote(se.channels.modulesRuntime),this.controlsVisibility=this.controller.getRemote(se.channels.controlsVisibility),this.assets=this.controller.getRemote(se.channels.assets),this.flags=this.controller.getRemote(se.channels.flags))}setLocal({componentsStore:A,loadedExternalModulesStore:e},t){this.controller&&(this.controller.setLocal(se.channels.rendererListener,t),this.controller.setLocal(se.channels.componentsStore,A),this.controller.setLocal(se.channels.loadedExternalModulesStore,e))}};var ji=class{constructor(A){this.callbacks=A;g(this,"experimentListeners",new Map);g(this,"employeesOnlySettingsListeners",new Map);g(this,"projectFeaturesListeners",new Map)}startUpdatesStream(){Object.keys(jl).forEach(A=>{let e=t=>{this.callbacks.updateExperiments({[A]:t})};yA.addListener(A,e),this.experimentListeners.set(A,e)}),Object.keys(Al).forEach(A=>{let e=t=>{this.callbacks.updateEmployeesOnlySettings({[A]:t})};Xe.addListener(A,e),this.employeesOnlySettingsListeners.set(A,e)})}getInitialExperiments(){let A={};return Object.keys(jl).forEach(e=>{A[e]=yA.get(e)}),A}getInitialEmployeesOnlySettings(){let A={};return Object.keys(Al).forEach(e=>{A[e]=Xe.get(e)}),A}initProjectFeatures(){Kn.updated.then(()=>{let A={};Object.keys(ac).forEach(e=>{A[e]=Kn.get(e)}),this.callbacks.updateProjectFeatures(A),this.projectFeaturesListeners.size===0&&Object.keys(ac).forEach(e=>{let t=r=>{this.callbacks.updateProjectFeatures({[e]:r})};Kn.addListener(e,t),this.projectFeaturesListeners.set(e,t)})}).catch(GA)}stopUpdatesStream(){for(let[A,e]of this.experimentListeners)yA.removeListener(A,e);for(let[A,e]of this.employeesOnlySettingsListeners)Xe.removeListener(A,e);for(let[A,e]of this.projectFeaturesListeners)Kn.removeListener(A,e);this.experimentListeners.clear(),this.employeesOnlySettingsListeners.clear(),this.projectFeaturesListeners.clear()}},vs=class{constructor(A){this.remoteFlags=A;let e=new ji(this.remoteFlags);e.startUpdatesStream(),this.remoteFlags.updateExperiments(e.getInitialExperiments()),this.remoteFlags.updateEmployeesOnlySettings(e.getInitialEmployeesOnlySettings())}};var Mo=class{constructor(){g(this,"experimentsUpdatesEmitter",new ot);g(this,"employeesOnlySettingsUpdatesEmitter",new ot);g(this,"projectFeaturesUpdatesEmitter",new ot);g(this,"flagsUpdater",new ji(this));this.flagsUpdater.startUpdatesStream(),this.experimentsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialExperiments()}},this.employeesOnlySettingsUpdatesEmitter.onNewStream=A=>{if(A?.replay==="latest")return{latest:this.flagsUpdater.getInitialEmployeesOnlySettings()}},this.projectFeaturesUpdatesEmitter.onNewStream=A=>{this.flagsUpdater.initProjectFeatures()}}updateExperiments(A){this.experimentsUpdatesEmitter.emit(A)}updateEmployeesOnlySettings(A){this.employeesOnlySettingsUpdatesEmitter.emit(A)}updateProjectFeatures(A){this.projectFeaturesUpdatesEmitter.emit(A)}stopUpdatesStream(){this.flagsUpdater.stopUpdatesStream()}experimentsUpdatesStream(A){return this.experimentsUpdatesEmitter.newStream(A)}employeesOnlySettingsUpdatesStream(A){return this.employeesOnlySettingsUpdatesEmitter.newStream(A)}projectFeaturesUpdatesStream(A){return this.projectFeaturesUpdatesEmitter.newStream(A)}};var Ts=hA("setup-rpc-connection"),Nc=3e4;function r$(j,A){if(!j)return Promise.resolve();let e=performance.now(),t=qt(),r=j.connect(A);return r.then(()=>{Ts.debug("Connected to controller",j.channelInterface.name),mA("connected_to_sandbox",{correlationId:t,durationMs:Math.round(performance.now()-e),userAgent:navigator.userAgent,visibility:document.visibilityState})}).catch(()=>{Ts.debug("Failed to connect to controller",j.channelInterface.name),mA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:"failed to connect"})}),new Oc(Nc,()=>{if(j.isConnected)Ts.debug("Controller connected within timeout");else{mA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:`not connected within ${Nc}ms`});let o=new Error(`RPC connection timeout after ${Nc}ms`);Ts.reportCriticalError(o)}}),r}var t$=10,Oc=class{constructor(A,e){this.millis=A;this.callback=e;g(this,"round",0);g(this,"timer",0);g(this,"arm",()=>{this.round>=t$?this.callback():(this.round+=1,this.timer=window.setTimeout(this.arm,this.millis/t$))});this.arm()}cancel(){this.timer&&(clearTimeout(this.timer),this.timer=0)}};async function o$(j,A,e,t,r){if(!e)throw Error("ServiceSandbox: no trusted sandbox origin");if(j){await r$(j,{target:A,url:e}),await j.getRemote(se.channels.renderer).initialize(Sn,t);return}let o=!1,n=new V7(A,e),a=await L6.on(n).discover({timeout:3e4}),i=new Mo;j||Wi.on(n).register(i);let s=Sn;await a.initialize({renderTarget:t,upgradeToMessagePortChannel:o,treeVersion:s}),r.debug("ServiceSandbox: ready to initialize contentWindow. Establishing channel\u2026");let l=new MessageChannel,c=L6.service.fingerprint;return A.postMessage(c,e,[l.port2]),o&&(i.stopUpdatesStream(),r.debug("ServiceSandbox: unregistering initializer"),await Tt.shared().unregister(n)),r.debug("ServiceSandbox: service channel ready"),o?new q7(l.port1):n}var n$=new WeakMap,wc=new Set;function i$(j){return n$.get(j())?Promise.resolve():new Promise((A,e)=>{let t=setTimeout(()=>{e(new Error("waitForReadyToInitialize timed out"))},1e4);wc.add({source:j,resolveReady(){clearTimeout(t),A()}})})}window.addEventListener("message",j=>{if(j.data!==If)return;let A=j.source;if(A){n$.set(A,!0);for(let e of wc)e.source()===A&&(wc.delete(e),e.resolveReady())}},!1);var ei=class extends Cs{constructor(e,t,r){super();g(this,"log",hA("window-sandbox"));g(this,"channelPromise");g(this,"windowPromise",kr());this.channelPromise=(async()=>{let o=await Ai.new({...r,url:e.url});return this.log.debug("WindowSandbox: created custom window"),this.windowPromise.resolve(o),this.controller||(await i$(()=>o.contentWindow),this.log.debug("WindowSandbox: loaded")),o$(this.controller,o.contentWindow,e.origin,t,this.log)})()}static async isAvailable(){return Ai.isAvailable()}waitForServiceChannel(){return this.channelPromise}async openSaveDialog({count:e,pathname:t}){return(await this.windowPromise).openSaveDialog({count:e,pathname:t})}async collectMetrics(){return(await this.windowPromise).collectMetrics()}async writeToClipboard(e){return(await this.windowPromise).writeToClipboard(e)}async writeToDisk(e){return(await this.windowPromise).writeToDisk(e)}async getImageData(e){return(await this.windowPromise).getImageData(e)}};var ti=class{constructor(){g(this,"metricsMap",new Map)}static trackError(A){$c({exportCount:0,success:!1,scope:"selection",errorReason:A})}createErrorReason({sizeKb:A,hasSavedToDisk:e}){if(!e)return"Export success, but no file was written";if(A===0)return"Export success, but the file is 0kb"}createId({nodeId:A,pixelRatio:e}){return A+"-"+e}mergeElectronMetrics(A){for(let e of A){let t=this.createId({nodeId:e.nodeId,pixelRatio:e.pixelRatio}),r=this.metricsMap.get(t);r&&this.metricsMap.set(t,{...r,sizeKb:e.kb,success:e.hasSavedToDisk})}}add(A,e){let t=this.createId({nodeId:A.nodeId,pixelRatio:A?.pixelRatio??1}),r=this.metricsMap.get(t)??{};this.metricsMap.set(t,{...r,...e})}track(){for(let[A,e]of this.metricsMap){let t=this.createErrorReason({sizeKb:e.sizeKb??0,hasSavedToDisk:e.hasSavedToDisk??!1});$c({durationMs:e.durationMs,format:e.format,exportCount:e.exportCount,success:e.success,scope:e.scope,sizeKb:e.sizeKb,errorReason:e.errorReason??t})}this.metricsMap.clear()}};function a$(j){for(let A of j.walk())if(ho(A))return!1;return nj(j)||RA(j)||xt(j)}function s$(j){return A$({...j})}var WI=3,Kj=hA("PartialTreeSender"),l$=jo();function c$(){return new Promise((j,A)=>{if(typeof MessageChannel<"u"){let e=new MessageChannel;e.port1.onmessage=()=>j(),e.port1.onmessageerror=()=>A(),e.port2.postMessage(null)}else setTimeout(j,0)})}var _s=class{constructor(A,e,t){this.timeline=A;g(this,"name");g(this,"currentScopeId","");g(this,"timelineCursor");g(this,"scopeBufferMap",new Map);g(this,"chunkQueue",[]);g(this,"chunkIndex",0);g(this,"chunkingConfig");g(this,"drainingPromise");this.name=e+"-"+String(Math.round(Math.random()*1e3)),this.chunkingConfig={maxNodesPerChunk:t?.maxNodesPerChunk??1e3}}shouldUseChunking(A,e){if(this.timelineCursor)return!1;let t=A.chunkingHints;if(!t||t.size===0)return!1;let r=Ps();e&&r.add(e);for(let o of r)if(t.has(o))return Kj.debug(this.name,`chunking required - large page hint: ${o}`),!0;return!1}serializeTreeChunks(A,e){let t=[],r=crypto.randomUUID(),o=new Map,n=new Map,a=0,i=Ps();e&&i.add(e);let s=()=>{o.size>0&&(t.push({name:this.name,timestamp:Date.now(),treeChunks:{chunkId:r,chunkIndex:t.length,totalChunks:-1,nodes:o,childrenMap:n,rootId:t.length===0?A.root.id:void 0}}),o=new Map,n=new Map)},l=R=>{let S=wa.valueFromNode(R);o.set(R.id,S);let v=R.children?R.children.map(P=>P.id):[];if(n.set(R.id,v),a++,S.children&&(S.children=l$),o.size>=this.chunkingConfig.maxNodesPerChunk&&s(),R.children)for(let P of R.children)l(P)},c=A.root,u,p={};for(u in c)cl[u]||(p[u]=c[u]);let f=A.getNodes(i),E={...p,__class:"RootNode",id:A.root.id,children:l$};o.set(A.root.id,E),n.set(A.root.id,f.map(R=>R.id)),a++,o.size>=this.chunkingConfig.maxNodesPerChunk&&s();for(let R of f)l(R);s();let F=t.length;for(let R of t)R.treeChunks.totalChunks=F;return Kj.debug(this.name,`directly chunked tree into ${t.length} chunks with ${a} total nodes`),t}getNextChunk(){if(this.chunkQueue.length===0)return;let A=this.chunkQueue[this.chunkIndex];return this.chunkIndex++,this.chunkIndex>=this.chunkQueue.length&&(this.chunkQueue=[],this.chunkIndex=0),A}hasMoreChunks(){return $(this.chunkIndex>=0,"Chunk index should not be negative"),$(this.chunkIndex<=this.chunkQueue.length,"Chunk index should not exceed queue length"),this.chunkIndex<this.chunkQueue.length}async*drainChunks(A){if(!this.hasMoreChunks())return;let e=this.drainingPromise;this.drainingPromise=new Qi,e&&(Kj.debug(this.name,"drainChunks already in progress, waiting for it to finish"),await e),Kj.debug(this.name,"drainChunks started");let t=0,r=performance.now();try{for(;this.hasMoreChunks();){if(A?.aborted){Kj.debug(this.name,"drainChunks aborted, clearing chunk queue"),this.chunkQueue=[],this.chunkIndex=0;return}let o=this.getNextChunk();o&&(t++,Kj.debug(this.name,`sending chunk ${o.treeChunks.chunkIndex+1} of ${o.treeChunks.totalChunks}`),yield o),await c$()}}finally{await c$(),this.timelineCursor=this.timeline.getChangeTrackingCursor();let o=performance.now()-r,n=o>1e3?`${(o/1e3).toFixed(2)}s`:`${Math.round(o)}ms`;Kj.debug(this.name,`completed sending ${t} chunks in ${n}`),Kj.debug(this.name,"drainChunks completed"),this.drainingPromise?.resolve(),this.drainingPromise=void 0}}resetScopeBuffer(A){this.scopeBufferMap.clear(),this.currentScopeId=A??"",A&&(this.timelineCursor=void 0,this.scopeBufferMap.set(A,performance.now()))}updateScopeBuffer(A){if(this.currentScopeId===A)return[void 0,void 0];if(A===Gn)return[void 0,void 0];if(this.currentScopeId=A,this.scopeBufferMap.has(this.currentScopeId))return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[void 0,void 0];let e;if(this.scopeBufferMap.size>=WI){let t=Ps(),r=1/0,o;for(let[n,a]of this.scopeBufferMap)t.has(n)||r>a&&(r=a,o=n);o&&(this.scopeBufferMap.delete(o),e=o)}return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[e,A]}reset(A){let e=this.timeline.tree;if(this.resetScopeBuffer(A),this.shouldUseChunking(e,A))return this.chunkQueue=this.serializeTreeChunks(e,A),this.chunkIndex=0,Kj.debug(this.name,"initiated direct chunked transfer for tree"),null;let t=u$(e,A);return this.chunkQueue=[],this.chunkIndex=0,t}update(A){if(!A)return{};if(this.hasMoreChunks())return{};let e=this.timeline.tree,t=this.timeline.fetchForwardChanges(this.timelineCursor);if(!t){if(this.timeline.invalidatedByLoadCompletedDocument(this.timelineCursor))return Kj.debug(this.name,"cursor invalidated, sending empty update for load completed document"),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{};if(this.resetScopeBuffer(A),this.shouldUseChunking(e,A)){this.chunkQueue=this.serializeTreeChunks(e,A),this.chunkIndex=0;let i=this.getNextChunk();if(i)return Kj.debug(this.name,`starting direct chunked resend with ${this.chunkQueue.length} chunks`),i}let a=u$(e,A);return Kj.debug(this.name,"cursor invalidated, sending tree with scope:",A),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{name:this.name,tree:a,timestamp:Date.now()}}let[r,o]=this.updateScopeBuffer(A);r&&(Kj.debug(this.name,"deleting scope by diff:",r),d$(r,t)),t.length===0&&(t=void 0);let n;if(o&&(Kj.debug(this.name,"adding scope by subtree:",o),n=this.getScopeSubTree(e,o)),t){let a=this.getAffectedScopeIDsAfterCrossScopeMove(e,t);for(let i of a){if(i!==this.currentScopeId){this.scopeBufferMap.has(i)&&(Kj.debug(this.name,"deleting scope due to cross-scope move:",i),d$(i,t),this.scopeBufferMap.delete(i));continue}n||(Kj.debug(this.name,"resending tree with scope due to cross-scope move:",i),n=this.getScopeSubTree(e,i))}}return{changes:t,scopes:n?[n]:void 0,timestamp:Date.now()}}getScopeSubTree(A,e){let t=A.get(e);return yr(t)&&$(t.isLoaded(),"Scope must be loaded"),zI(t)}getAffectedScopeIDsAfterCrossScopeMove(A,e){let t=new Set;for(let r of e){if(!r.previousScope||!r.to.parentid)continue;let o=A.get(r.id),n=A.getScopeNodeFor(o);n&&t.add(n.id)}return t}};function d$(j,A){A.push({id:j,removed:"CanvasNode",to:{}})}function zI(j){if(j)return wa.valueFromNode(j)}function Ps(){return new Set([Zt,Ya,ef,Re,Rm,Gn])}function u$(j,A){let e=Ps();A&&e.add(A);let t=j.getNodes(e).map(a=>wa.valueFromNode(a)),r=j.root,o,n={};for(o in r)cl[o]||(n[o]=r[o]);return{version:Sn,root:{...n,__class:"RootNode",id:j.root.id,children:t}}}function p$(j,A){let e=mo(j);if(!e)return A;let t=new Map(A.map(o=>[o.id,o])),r=[];for(let o of e.walk()){if(!Nt(o)||!o.webPageId)continue;let n=t.get(o.webPageId);n&&r.push(n)}return r}function k$(j,A,e=!1,t=!1){let r=A?.[j];if(r)return r;if(j===Lp&&e)return t?"Key":"Key & Gamepad";if(t&&j==="onMouseEnter")return"Enter";let n=(j.startsWith("on")&&j.length>2?j.substring(2):j).replace("Tap","Click");return nt(n)}function XI(){let j=null,A=null;return e=>{let t=L.componentForIdentifier(e.codeComponentIdentifier);if(t===j)return A;if(!t||!t.properties)return null;let r={},o=Object.keys(t.properties);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=t.properties[i];s?.type==="eventhandler"&&s.title&&(r[i]=s.title)}return j=t,A=r,r}}var j1=XI();function YI(j){if(j.type!=="controlReference"&&j.type!=="nodePropertyControlReference")return;let{expectedType:A}=j;$(A==="enum"||A==="segmentedenum"||A==="file")}function s1({galleryImageId:j,isSmartComponent:A}){return A?Array(4).fill(null).map(()=>({id:Fj(),type:"object",value:{[j]:{type:"image",value:void 0}}})):[]}function m$(j,A){return $(j.type!=="responsiveimage",`Image variables are compiled to be responsive images. To
        prevent confusion we don't allow creation of type responsive images.
        Because that would mean that two different types represent the same thing.`),YI(j),j.type!=="trackingid"&&j.type!=="vectorsetitem"&&mA("variable_create",{scopeType:A,variableType:j.type}),j.type==="image"&&(x(j.initialValue)?H6(j.initialValue)||(j.initialValue=void 0):fe(j.initialValue)&&x(j.initialValue.value)&&(H6(j.initialValue.value)||(j.initialValue=void 0))),j.type==="array"&&A==="canvas_component"&&($(j.minCount===void 0,"minCount should not be lifted to component"),$(j.maxCount===void 0,"maxCount should not be lifted to component")),{id:Fj(),...j}}function ZI(j,A){let e=new Set(j.variables.map(t=>t.name));return Pj(nt(A),e)}function AF(j){switch(j.type){case"controlReference":case"nodePropertyControlReference":switch(j.expectedType){case"enum":return"Type";case"file":return"File";default:throw Error(`getFallbackNameForCreateVariableOptions(), unsupported file reference type: ${j.expectedType}`)}default:return cp(j.type)}}function jF(j,A){if(j==="richtext")return A.length;let e=Er;return A.forEach((t,r)=>{if(!ke(e)){if(t.type!=="richtext"){Y(e)&&(e=ur);return}Ku(e)||(e=r)}}),Y(e)?e:A.length}function eF(j){return fj(j)?"collection":tj(j)?"layout_template":(eA(j)||$(!0,"Should not be able to create variables on invalid scope",j.__class),"canvas_component")}function Lc(j,A){let{scopeId:e,isAssigned:t=!0,useUniqueName:r=!0,...o}=A,n=j.get(e);if(!n||!kt(n))return null;let a=A.name.trim(),i=a||AF(A),s=r?ZI(n,i):i,l=m$({...o,name:s},eF(n));if(l.type==="eventhandler"&&!eA(n))return null;let c=jF(l.type,n.variables),u=Ve.insert(n.variables,c,l);return n.set({variables:u}),t&&oE({variableType:l.type,variableId:l.id}),re(l.id,n.id)}function I1(j){let{engine:A,showModal:e=!0,...t}=j,r=Lc(A.tree,t);if(!r)return null;let o=A.tree.get(j.scopeId);return!o||!kt(o)?null:(ko(A)&&e&&(A.stores.variablesStore.selectedVariableId=r.id,A.stores.modalStore.set({type:"Variables",source:"properties"})),re(r.id,o.id))}var tF=hA("createAndAssignActionVariableToNode");function f$(j,A,e,t,r){if(!(We(A)||W(A)))return null;let o=j.getScopeNodeFor(A);if(!o||!eA(o))return null;let n=j.getGroundNodeFor(A);if(!n||!Ej(n))return null;let a=L.componentForIdentifier("framer/useTriggerEvent");if(!a)return null;let i=Lc(j,{scopeId:o.id,type:"eventhandler",name:t??k$(e,null),initialValue:void 0});if(!i)return null;Wa(j,A,e,a,{id:{type:"string",value:i.id}});let s=o.getTopLevelReplicaVariants();for(let l of s){let{overrides:c}=l.replicaInfo;c[A.id]&&im(j,l,A.id,e,a,{id:{type:"string",value:i.id}})}return r&&r.updateComponent(o.id).catch(l=>tF.error(l)),i.id}function rF(j){let A=Ua(j);if(Object.keys(A).length!==0)for(let t in A){let r=A[t];if(r&&r.length===0)return t}}function oF(j,A,e){switch(A){case"framer/useShowOverlay":return j.create(qm,e);case"framer/useShowRelativeOverlay":return j.create(Me,e,{width:200,height:150,radius:10,boxShadows:[Yu({x:0,y:10,blur:20,color:"rgba(0,0,0,0.05)",spread:0})],floatingPositionEnabled:!0,floatingPlacement:Ca,floatingAlignment:va,floatingOffsetX:Qp,floatingOffsetY:Up,floatingCollisionDetection:!0,floatingCollisionPadding:Hp});default:iA(A)}}function nF(j,A,e,t){e&&$(A==="framer/useShowOverlay"&&cn(e)||A==="framer/useShowRelativeOverlay"&&(pA(e)||W(e)),"Invalid overlay type: ",e.__class,"for overlay action: ",A);let r=e??oF(j,A,t.id);return bj(r)&&r.set({zIndex:pp,styleAppearEffectEnabled:!0,styleAppearEffectTrigger:"onMount",overflow:Ue(),position:"absolute",...cm.fadeIn()}),r}function iF(j,A,e,t,r){$(yn(e),"Parent is not a local smart component instance, events can't be created");let o=dk(j,e);j.loadScopes([o],([n])=>{if(!n)return;let a=n.getPrimaryVariant();$(a,"SmartComponentNode should have a primary variant");let i=f$(j,a,t,t==="onMouseEnter"?"Hover":void 0,A);$(i,"Should be able to create event key for local smart component node"),r(i)})}function E$(j,A,e,t,r){let o=L.componentForIdentifier(A);$(o,"Cannot find overlay action definition"),Wa(j,r,t,o,{overlay:{type:"string",value:e.id}},!0)}function aF(j){switch(j){case"framer/useShowOverlay":return"fixed";case"framer/useShowRelativeOverlay":return"relative";default:iA(j)}}function xs({treeStore:j,codeGenerationStore:A},e,t,r){let o=j.tree.get(t);if(!o)return;let n=gA(o)?j.tree.get(o.originalid):o;if(!n||!We(n)&&!W(n))return;let a=e==="framer/useShowRelativeOverlay"?"onMouseEnter":"onTap",i=W(n)?rF(n):a,s=yn(n);if(!i&&!s)return;let l=nF(j.tree,e,r,n);return i?E$(j.tree,e,l,i??a,n):iF(j.tree,A,n,a,c=>E$(j.tree,e,l,c,n)),mA("overlay_create",{source:r?"duplicate":"events_panel",overlayType:aF(e)}),l}var $$=hA("ScopeStore");function ri(j){return hj(j,!0)||w(j,!0)||oe(j,!0)}function B$(j){if(hj(j))return"CanvasPage";if(w(j))return"WebPage";if(eA(j))return"SmartComponent";if(sn(j))return"ContentManagement";if(tj(j))return"LayoutTemplate";if(Ee(j))return"VectorSet";if(xu(j))return"Analytics";if(Mu(j))return"LocalizationGlossary";if(oe(j))return"DesignPage";throw Error(`Failed to return scope type, invalid scope: ${j.__class}`)}var Lr,qr,Vr,Kr,Do,de,Gt,Ar,No,Oo,wo,h$=class extends ge{constructor(e,t,r,o,n,a,i,s,l,c,u,p){super();this.scheduler=e;this.treeStore=t;this.canvasStore=r;this.selection=o;this.chromeStore=n;this.contentManagementStore=a;this.modalStore=i;this.overlayStore=s;this.codeGenerationStore=l;this.insertSidebarStore=c;this.modulesStore=u;this.aiGenerationStore=p;LA(this,Lr,0);g(this,"isCheckingActivePage",!0);LA(this,qr,"");LA(this,Vr,"");LA(this,Kr,"");LA(this,Do,"");LA(this,de,[]);LA(this,Gt,!1);LA(this,Ar,!1);LA(this,No,new Map);LA(this,Oo,new Map);g(this,"loadingActiveId");g(this,"_activeId");g(this,"scopeSwitchStart",0);g(this,"scopeSwitchPending",!1);g(this,"scopeIdToSelectedCollectionItem",new Map);g(this,"rootScopeType","CanvasPage");LA(this,wo,[]);g(this,"canGoBack",()=>rA(this,Gt));g(this,"goBack",()=>{let e=Array.from(this.isolatedCanvasNodes());e.pop();let t=e.pop();t&&this.select(t.id,{keepHistory:!1})});let f=this.getFirstPageNodeAccordingToUI();this._activeId=f.id,Fn(f),hj(f)?FA(this,qr,f.id):w(f)?FA(this,Vr,f.id):oe(f)&&FA(this,Kr,f.id);let E=this.getScopeNodes();FA(this,Lr,E.indexOf(f)),$(f.loaded,"Scope must be fully loaded"),c.onScopeChange({scope:f.loaded,hasCanvasPageNodes:this.hasCanvasPageNodes(),hasWebPageNodes:this.hasWebPageNodes()}),this.modulesStore.setActiveScope(this._activeId)}get activeId(){return this._activeId}get active(){let e=this.getScopeNode(this._activeId);return $(e.isLoaded(),"Scope must be fully loaded"),e}get rootNode(){return this.treeStore.tree.root}get checkingActivePage(){return this.isCheckingActivePage}documentDidLoad(){this.isCheckingActivePage=!1}get scopeType(){return B$(this.active)}getScopeNode(e){let t=this.treeStore.tree.get(e);return $(t instanceof hl,"Node, ",e,"is not a ScopeNode"),t}getScopeNodes(){return this.rootNode.children.filter(yr)}getCanvasPageNodes(){return this.rootNode.children.filter(hj)}getDesignPageNodes(){return this.rootNode.children.filter(oe)}getKitPageNodes(){let e=[];for(let t of this.rootNode.children)w(t)&&t.kitPage&&e.push(t);return e}getSmartComponentNodes(){return this.rootNode.children.filter(eA)}getLayoutTemplateNodes(){return this.rootNode.children.filter(tj)}getWebPageNodes(){return this.rootNode.children.filter(w)}getWebPageNodesWithoutCollection(){return this.rootNode.children.filter(e=>w(e,!0)&&!e.dataIdentifier)}getWebPageNodesWithCollection(e=!1){let t=this.rootNode.children.filter(r=>!!(w(r)&&r.dataIdentifier));return e?p$(this.treeStore.tree,t):t}hasPages(){let e=!1,t=!1,r=!1,o=!1,n=!1;for(let a of this.rootNode.children)if(hj(a)&&(r=!0),oe(a)&&(o=!0),w(a)&&(a.kitPage?n=!0:a.dataIdentifier?t=!0:e=!0),e&&t&&r&&o&&n)break;return{hasSitesPages:e,hasCMSPages:t,hasCanvasPages:r,hasDesignPages:o,hasKitPages:n}}hasCanvasPageNodes(){return this.rootNode.children.some(hj)}hasWebPageNodes(){return this.rootNode.children.some(w)}getRootScopeNodes(){return this.rootNode.children.filter(ri)}getFirstPageNodeAccordingToUI(e=this.treeStore.tree){let{children:t,homePageNodeId:r}=e.root;return Gf(t,r)}getFirstWebPageNode(){try{let e=this.getFirstPageNodeAccordingToUI();if(w(e))return e}catch{}}changeActive(e,t,r){if(this._activeId){let i=e.get(this._activeId),s=w(i)&&i.abTestingParentId?i.abTestingParentId:this._activeId;rA(this,No).set(s,{zoom:this.canvasStore.zoom,offset:this.canvasStore.offset}),rA(this,Oo).set(this._activeId,this.selection.ids),eA(i)&&mA("component_canvas_exit",{componentId:this._activeId})}if(FA(this,Do,this._activeId),FA(this,Lr,r),this._activeId=t.id,Fn(t),this.codeGenerationStore.changeScope(),this.modulesStore.changeScope(t),oe(t))this.rootScopeType="DesignPage",FA(this,Kr,t.id),FA(this,de,[]),FA(this,Gt,!1),FA(this,Ar,!1);else if(hj(t))this.rootScopeType="CanvasPage",FA(this,qr,t.id),FA(this,de,[]),FA(this,Gt,!1),FA(this,Ar,!1);else if(w(t))this.rootScopeType="WebPage",FA(this,Vr,t.id),FA(this,de,[]),FA(this,Gt,!1),FA(this,Ar,Ae(t));else if(eA(t)||tj(t)||Ee(t)){let i=rA(this,de).indexOf(t.id);i===-1?rA(this,de).push(t.id):rA(this,de).splice(i+1),FA(this,Gt,rA(this,de).length>0),FA(this,Ar,!1),jE({componentId:t.id}),eA(t)&&this.chromeStore.mainView===0&&this.modalStore.displayComponentIsolationModal({source:"automatic"})}let o=rA(this,No).get(w(t)&&t.abTestingParentId?t.abTestingParentId:t.id);o?this.canvasStore.updateCanvas(o.offset,o.zoom):this.canvasStore.zoomAfterScopeSwitch(e,t);let n=rA(this,Oo).get(t.id);n?this.selection.set(n):this.selection.clear(),this.overlayStore.hideAll(),this.insertSidebarStore.onScopeChange({scope:t,hasWebPageNodes:this.hasWebPageNodes(),hasCanvasPageNodes:this.hasCanvasPageNodes()}),this.treeStore.setHighlight(null);let a=B$(t);this.chromeStore.onChangeScopeType(a),this.contentManagementStore.onChangeScopeType(a),this.aiGenerationStore.setCurrentSessionId(a==="DesignPage"?t.id:void 0)}select(e,{keepHistory:t,activateContentPanel:r,collectionItemId:o}){this.loadingActiveId=e,this.scopeSwitchStart=performance.now();let n=()=>{if(this.scopeSwitchPending=!1,this.loadingActiveId!==e||this._activeId===e)return;let s=this.getScopeNodes().findIndex(p=>p.id===e);$(s!==-1,"Tree must contain scope node");let c=this.treeStore.tree.latestTree().getNode(e);$(yr(c),"Tree must contain scope node",e);let u;if(c.isLoaded())u=c.loaded;else if(!this.treeStore.tree.getService("loader"))$$.reportError(new ReferenceError("Loader service is not available in the tree but scope is not loaded"),{message:"Scope must be fully loaded"},{shallowScopes:"true"}),u=c;else throw new TypeError("Scope must be fully loaded");t||FA(this,de,[]),x(o)&&w(c)&&this.setSelectedCollectionItemForWebPage(c.id,o),r&&(this.chromeStore.contentPanelTab=r),this.changeActive(this.treeStore.tree,u,s)},a=this.treeStore.tree.getService("loader");if(a&&!a.hasLoadedScope(e)){this.scopeSwitchPending=!0,a.prioritizeLoadingScope(e,()=>this.scheduler.processWhenReady(n));return}n()}selectByNode(e){let t=this.treeStore.tree.get(e);if(t===null)return;let r=this.treeStore.tree.getScopeNodeFor(t);r!==null&&this.select(r.id,{keepHistory:!1})}selectPreviousActiveScope(){let e=this.treeStore.tree.get(rA(this,Do));this.select(e?.id??this.getFirstPageNodeAccordingToUI().id,{keepHistory:!1})}findNextActiveScope(e=this.treeStore.tree){let t=e.root,r=t.children.filter(yr);$(t.children.some(ri),"validateActiveScope: Tree must contain at least one Canvas Page or Web Page");let o=r.findIndex(n=>n.id===this._activeId);return o===-1&&(o=this.findNextAvailablePageIndex(r,rA(this,Lr))),[r[o],o]}validateActiveScope(e=this.treeStore.tree,t=!1){let[r,o]=this.findNextActiveScope(e);$(r,"ScopeNode must be defined"),t||$(r.isLoaded(),"Scope must be fully parsed"),FA(this,Lr,o);let n=r;return r.id!==this._activeId&&(this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,n,o)),n}findNextAvailablePageIndex(e,t){let r=[],o=[];for(let s=0;s<e.length;s++){let l=e[s];w(l)?o.push(s):hj(l)&&r.push(s)}let n=this.rootScopeType==="WebPage",a=n?o:r,i=n?r:o;return sF(a.length>0?a:i,t)}renameScope(e,t){this.getScopeNode(e).set({name:t})}getActiveScopeNodeForReset(e=this.treeStore.tree,t=null){if(t){let o=e.getScopeNodeFor(e.get(t));if(Sf(o)&&o?.isValid())return o}let r=this.getFirstPageNodeAccordingToUI(e);if(w(r)&&r.isValid()&&r.loaded||hj(r)&&r.loaded)return r.loaded;$$.warn("getActiveScopeNodeForReset: falling back to scanning for a useful scope to make active");for(let o of e.root.children)if(hj(o)&&o.isValid()&&o.loaded||w(o)&&o.isValid()&&o.loaded)return o.loaded;for(let o of e.root.children)if(eA(o)&&o.isValid()&&o.loaded)return o.loaded;throw Error("Document does not have any scopes that can be set to active.")}resetActiveScope(e=this.treeStore.tree,t=void 0){let r=this.getActiveScopeNodeForReset(e,t);if(r.id===this._activeId)return;this._activeId="",FA(this,qr,""),FA(this,Kr,""),FA(this,Vr,""),FA(this,Do,""),rA(this,No).clear(),rA(this,Oo).clear(),$(r.isLoaded(),"Scope must be fully parsed");let o=e.root.children.indexOf(r);this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,r,o)}movePage(e,t){let r=this.getScopeNode(e),o=this.getAllPageNodesOfScope(r),n=o[t];$(n,`Trying to move a page node to an invalid index: ${t}, total: ${o.length} page nodes.`);let a=this.rootNode.children.findIndex(i=>i.id===n.id);$(r.parentid,"Scope node has no parentid"),$(a!==-1,"Cant find scope in root node"),this.treeStore.tree.moveNode(r,r.parentid,a)}getAllPageNodesOfScope(e){return oe(e)?this.getDesignPageNodes():hj(e)?this.getCanvasPageNodes():w(e)&&e.kitPage?this.getKitPageNodes():($(!e,"Scope is not movable"),jo())}getParentId(e,t){let r=this.rootNode.id;if(e instanceof hl||no(e))return r;let o=this.active,n=o.id;return sn(o)&&$(Ba(e),"ContentManagementNode only accepts content nodes"),t===r?n:t??n}insertNode(e,t,r,o){t=this.getParentId(e,t),ie(e)&&xs({codeGenerationStore:this.codeGenerationStore,treeStore:this.treeStore},bj(e)?"framer/useShowRelativeOverlay":"framer/useShowOverlay",t,e),this.treeStore.tree.insertNode(e,t,r,o)}insertNodes(e){for(let t of e)this.insertNode(t,t.parentid)}moveNode(e,t,r,o){t=this.getParentId(e,t),this.treeStore.tree.moveNode(e,t,r,o)}removeNode(e){this.treeStore.tree.removeNode(e),e.id===this._activeId&&this.validateActiveScope(this.treeStore.tree,!0)}setSelectedCollectionItemForWebPage(e,t){if(this.scopeIdToSelectedCollectionItem.get(e)===t)return;let o=new Map(this.scopeIdToSelectedCollectionItem);o.set(e,t),this.scopeIdToSelectedCollectionItem=o}getSelectedCollectionItemForScope(e){if(w(e))return this.scopeIdToSelectedCollectionItem.get(e.id)}getMostRecentPage(){switch(this.rootScopeType){case"CanvasPage":{let e=this.treeStore.tree.get(rA(this,qr));if(hj(e))return e;break}case"DesignPage":{let e=this.treeStore.tree.get(rA(this,Kr));if(oe(e))return e;break}case"WebPage":{let e=this.treeStore.tree.get(rA(this,Vr));if(e&&yr(e)&&w(e))return e;break}}return this.getFirstPageNodeAccordingToUI()}getComponentHistory(){if(rA(this,de).length===0)return[];let e=this.active;if(!(eA(e)||tj(e)||Ee(e)))return[];let t=[],r;for(let o of rA(this,de)){let n=this.treeStore.tree.getNode(o);(eA(n)||tj(n)||Ee(n))&&n.isLoaded()&&(t.push(n),r=n)}return r===e?t:[e]}get onIsolatedCanvas(){return rA(this,Gt)}get onCollectionPage(){return rA(this,Ar)}isolatedCanvasNodes(){let e=this.active,t;return ri(e)?t=[e]:t=[this.getMostRecentPage(),...this.getComponentHistory()],fr(rA(this,wo),t)?rA(this,wo):(FA(this,wo,t),t)}getTopMostWebPageNode(){for(let e of this.isolatedCanvasNodes())if(w(e))return e}};Lr=new WeakMap,qr=new WeakMap,Vr=new WeakMap,Kr=new WeakMap,Do=new WeakMap,de=new WeakMap,Gt=new WeakMap,Ar=new WeakMap,No=new WeakMap,Oo=new WeakMap,wo=new WeakMap;function sF(j,A){for(let e of j)if(!(e<A))return e;return Math.max(...j)}var bw=to,g$=Ge.isAutomation?to:L7;var Ms=class{constructor(A,e){g(this,"sandbox");g(this,"log");g(this,"engine");g(this,"wantsEngineUpdates");g(this,"renderState");g(this,"partialTreeSender");g(this,"timelineCursor");g(this,"chunkAbortController");g(this,"chunkSessionId");g(this,"drainingPromise");g(this,"onSandboxServicesReady");g(this,"onSandboxStateChange",A=>{typeof A!="boolean"&&this.log.reportError(A)});g(this,"onSandboxRender");g(this,"fail",A=>{this.chunkAbortController?.abort(),this.readyForRenderingPromise.reject(A),this.onSandboxStateChange?.(A)});g(this,"renderServiceIfDiscovered");g(this,"readyForRenderingPromise",kr());g(this,"flagsService",new Mo);g(this,"lastSandboxTreeUpdate",0);g(this,"onRenderedUpdate",A=>{this.lastSandboxTreeUpdate&&(this.lastSandboxTreeUpdate<A.update?(this.fail(new Error(`dropped tree update: ${this.lastSandboxTreeUpdate} < ${A.update}`)),this.lastSandboxTreeUpdate=0):this.lastSandboxTreeUpdate===A.update&&(this.lastSandboxTreeUpdate=0)),this.onSandboxRender&&(this.onSandboxRender(A),this.updateGroundNodeOverflowSizes());let{scopeId:e,scopeSwitchStartTime:t,renderEndTime:r,updateEndTime:o}=A;if(t&&o&&r){let n=Math.round(o-t),a=Math.round(r-t),{scopeStore:i}=this.engine.stores,{scopeSwitchStart:s,scopeSwitchPending:l,activeId:c}=i,u=a,p=!1;c===e&&(u=performance.now()-s,p=l);let f=this.engine.tree.get(e);f&&ri(f)&&Zf({pageId:e,renderDurationMs:a,updateDurationMs:n,totalDurationMs:u,neededLoading:p})}});g(this,"onChannelReady",async A=>{if(A){let r=await K7.on(A).discover({timeout:3e4});this.log.debug("Discovered render service"),this.renderServiceIfDiscovered=r,r.renderedUpdateStream({oneway:!0}).read(this.onRenderedUpdate).catch(this.fail),Wi.on(A).register(this.flagsService)}let{modulesStore:e}=this.engine.stores;this.sandbox.modules?e.getModulesUpdatesService().moduleUpdatesStream({replay:"latest"}).read(r=>this.sandbox.modules?.updateModules(r.patches,r.dependentModules,r.prioritizedModules,r.initialized,r.revision)).catch(this.fail):($(A,"neither old or new rpc defined for modules"),J7.on(A).register(e.getModulesUpdatesService()));let t=new ot;t.emit({}),A&&w6.on(A).register({assetUpdatesStream:t.newStream}),Z7(w6.on(g$).discover(),async r=>{this.sandbox.assets?r.assets&&this.sandbox.assets.oneway.updateAssets(r.assets):t.emit(r)}),this.onSandboxServicesReady&&(this.renderServiceIfDiscovered?await this.onSandboxServicesReady(A,this.renderServiceIfDiscovered):this.sandbox.renderer&&await this.onSandboxServicesReady(A,this.sandbox.renderer)),this.wantsEngineUpdates&&(this.engine.addSandbox(this),this.engine.scheduler.changes.observe("PendingBundle",()=>this.update(!0)),this.engine.loadWasCalled&&this.update(!0)),this.log.debug("Initialized render sandbox"),this.onSandboxStateChange?.(!0),this.renderServiceIfDiscovered?this.readyForRenderingPromise.resolve(this.renderServiceIfDiscovered):this.sandbox.renderer&&this.readyForRenderingPromise.resolve(this.sandbox.renderer)});g(this,"previousTransform");g(this,"previousActiveLocaleId");g(this,"previousIsReadyToRender");g(this,"previousPerformanceMode");g(this,"previousLoadedAllUserData");g(this,"previousRenderScope");g(this,"previousRenderNodes");g(this,"previousSelection");g(this,"previousNodeInTextEditor");g(this,"previousNodeInEffectPreview");g(this,"previousActiveEffect");g(this,"previousActiveEffectIds");g(this,"previousNodesInMoveToolRootFontSize");g(this,"previousActiveOverlays");g(this,"previousPlaceholder");g(this,"previousRootFontSize");g(this,"previousIsDarkMode");g(this,"previousScopeIdToSelectedCollectionItem");g(this,"previousShouldSetMinHeight");g(this,"previousActiveLinkStyle");g(this,"update",(A=!0)=>{if(this.drainingPromise)return!1;let e=this.renderState(),t=e.transform,r=!be(t,this.previousTransform);if(this.previousTransform=t,!A)return this.sendSandboxUpdate(void 0,r?t:void 0);let o=!1,n={},a=this.engine,{treeStore:i,loadingStore:s,chromeStore:l,persistedUserDefaults:c}=a.stores,u=i.timeline,p="renderScope"in e?e.renderScope:void 0;p!==this.previousRenderScope&&(this.previousRenderScope=p,o=!0,n.renderScope=p),this.previousRenderScope||(this.previousRenderScope=u.tree.root.children[0]?.id??"");let f=!Xe.isOn("disablePartialTreeInSandbox");if(!this.partialTreeSender&&f?(this.partialTreeSender=new _s(u,"sandbox"),this.timelineCursor=void 0):this.partialTreeSender&&!f&&(this.partialTreeSender=void 0),this.partialTreeSender){u.legacyMode=!1;let T=this.partialTreeSender.update(this.previousRenderScope);n.partialTreeUpdate=T,T.tree?(o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded):T.changes||T.scopes?o=!0:T.treeChunks&&(o=!0,this.partialTreeSender.hasMoreChunks()?this.drainChunksAsync():(n.loadedSomeUserData=s.isDocumentLoaded,r=!0))}else{let T=u.fetchForwardChanges(this.timelineCursor);u.legacyMode=!0,T?(this.log.trace("change tracking cursor changes:",T.length),T.length>0&&(n.changes=T,o=!0)):(this.timelineCursor=u.getChangeTrackingCursor(),this.log.debug("change tracking cursor invalidated, sending full tree:",u.tree.size()),u.tree.beginAllowPartialScopeAccess(),n.tree=u.tree.toJS(),u.tree.endAllowPartialScopeAccess(),o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded)}let E=yA.isOn("debugEditWhileNeverLoadingRest")?s.hasMinimalEditableData:s.hasFullDocumentData;!this.previousLoadedAllUserData&&E&&(this.previousLoadedAllUserData=!0,o=!0,n.loadedAllUserData=!0);let F=l.canvasLocaleId;F!==this.previousActiveLocaleId&&(this.previousActiveLocaleId=F,o=!0,n.activeLocaleId=F);let R=s.assetMapLoaded;R!==this.previousIsReadyToRender&&(this.previousIsReadyToRender=R,o=!0,n.isReadyToRender=R);let S=c.performanceMode;S!==this.previousPerformanceMode&&(this.previousPerformanceMode=S,o=!0,n.performanceMode=S);let v="renderNodes"in e?e.renderNodes:void 0;be(v,this.previousRenderNodes)||(this.previousRenderNodes=v,o=!0,n.renderNodes=v);let P="isDarkMode"in e?e.isDarkMode:void 0;P!==this.previousIsDarkMode&&(this.previousIsDarkMode=P,o=!0,n.isDarkMode=P);{let T=e.editor,D=T?.selection;D!==this.previousSelection&&(this.previousSelection=D,o=!0,n.selection=D);let K=T?.nodeInTextEditorId;K!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=K,o=!0,n.nodeInTextEditorId=K);let Q=T?.nodesInEffectPreview;be(Q,this.previousNodeInEffectPreview)||(this.previousNodeInEffectPreview=Q,o=!0,n.nodesInEffectPreview=Q);let Z=T?.nodesInMoveToolRootFontSize;be(Z,this.previousNodesInMoveToolRootFontSize)||(this.previousNodesInMoveToolRootFontSize=Z,o=!0,n.nodesInMoveToolBaseFontSize=Z);let H=T?.activeEffect;H!==this.previousActiveEffect&&(this.previousActiveEffect=H,o=!0,n.activeEffect=H);let AA=T?.activeEffectIds;be(AA,this.previousActiveEffectIds)||(this.previousActiveEffectIds=AA,o=!0,n.activeEffectIds=AA?new Set(AA):null);let jA=T?.activeOverlayNodes;jA!==this.previousActiveOverlays&&(this.previousActiveOverlays=jA,o=!0,n.activeOverlayNodes=jA);let N=T?.dragAndDropPlaceholders;N!==this.previousPlaceholder&&(this.previousPlaceholder=N,o=!0,n.placeholder=N);let z=T?.rootFontSize;z!==this.previousRootFontSize&&(this.previousRootFontSize=z,o=!0,n.rootFontSize=z);let J=T?.scopeIdToSelectedCollectionItem;J&&J!==this.previousScopeIdToSelectedCollectionItem&&(this.previousScopeIdToSelectedCollectionItem=J,o=!0,n.scopeIdToSelectedCollectionItem=J,p&&p===this.previousRenderScope&&(n.renderScope=p));let nA=T?.shouldSetMinHeight;nA!==this.previousShouldSetMinHeight&&(this.previousShouldSetMinHeight=nA,o=!0,n.shouldSetMinHeight=nA);let BA=T?.activeLinkStyle;BA!==this.previousActiveLinkStyle&&(this.previousActiveLinkStyle=BA,o=!0,n.activeLinkStyle=BA??null)}return this.sendSandboxUpdate(o?n:void 0,r?t:void 0)});g(this,"groundNodeOverflowSizes",{});this.sandbox=A,this.log=e.log,this.engine=e.engine,this.wantsEngineUpdates=e.wantsEngineUpdates,this.renderState=e.renderState,A.setLocal(e.engine.stores,{renderedUpdate:this.onRenderedUpdate,error:e.handleSandboxError??(()=>{}),heartbeat:e.heartbeat??(()=>{})}),A.waitForServiceChannel().then(this.onChannelReady).catch(this.fail),A.controller&&A.controller.waitUntilConnected().then(()=>{A.flags&&new vs(A.flags)}).catch(t=>{this.log.error("Error while waiting for flags service",t)})}sendSandboxUpdate(A,e){if(A||e){let{scheduler:t}=this.engine;A?.tree&&(this.lastSandboxTreeUpdate=t.update),A&&(A.timestamp=Date.now());let r={type:"SandboxUpdate",update:t.update,document:A,transform:e};return this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:r}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox(r),!0}return!1}command(A,e){this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:{command:A,args:e}}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox({command:A,args:e})}async drainChunksAsync(){if(this.drainingPromise)return this.drainingPromise;this.drainingPromise=this._performDraining();try{await this.drainingPromise}finally{this.drainingPromise=void 0}}async _performDraining(){this.chunkAbortController?.abort(),this.chunkAbortController=new AbortController;let A=crypto.randomUUID();this.chunkSessionId=A;let e=this.chunkAbortController.signal,t=this.previousRenderScope;try{if(!this.partialTreeSender)return;for await(let r of this.partialTreeSender.drainChunks(e)){if(e.aborted||this.chunkSessionId!==A||this.previousRenderScope!==t)break;let o={partialTreeUpdate:r,timestamp:Date.now()};this.partialTreeSender.hasMoreChunks()?this.sendSandboxUpdate(o,void 0):(o.loadedSomeUserData=this.engine.stores.loadingStore.isDocumentLoaded,this.sendSandboxUpdate(o,this.previousTransform))}this.update(!0)}catch(r){if(r instanceof Error&&r.name==="AbortError")return;throw r}finally{this.log.debug("Chunk draining completed or aborted"),this.chunkSessionId===A&&(this.chunkAbortController=void 0,this.chunkSessionId=void 0)}}updateGroundNodeOverflowSizes(){let A=this.engine.tree.get(this.previousRenderScope);Fn(A);let e=A?.children;if(!e)return;let t=!1;for(let o of e){let n=o.cache,a=this.groundNodeOverflowSizes[o.id];Ff(n,a)||(t=!0,this.groundNodeOverflowSizes[o.id]={minX:n.minX,maxX:n.maxX,minY:n.minY,maxY:n.maxY})}let r=Object.keys(this.groundNodeOverflowSizes);if(r.length>e.length){t=!0;let o=new Set(r);for(let n of e)o.delete(n.id);for(let n of o)delete this.groundNodeOverflowSizes[n]}t&&this.command("updateGroundNodeOverflowSizes",this.groundNodeOverflowSizes)}async renderUpdates(A){let e=await this.readyForRenderingPromise;await e.willStartUpdates(),A(),this.update(),await e.waitForCompleteRenderAfterUpdates()}get renderService(){return this.renderServiceIfDiscovered||this.sandbox.renderer||void 0}async measureNodes(A){return this.renderService?.measureNodes(A)}async getFitTextViewBoxes(A){return this.renderService?.getFitTextViewBoxes(A)}async fetchJSON(A){return this.renderService?.fetchJSON(A)}async getComponentRenderingError(A){return this.renderService?.getComponentRenderingError(A)}async preloadFonts(A){return this.renderService?.preloadFonts(A)}async waitUntilPlaceholdersSettled(){await this.renderService?.waitUntilPlaceholdersSettled()}};var Ds=class{constructor(A,e){g(this,"log",hA("node-snapshots"));g(this,"engine");g(this,"renderer");g(this,"renderState",{renderNodes:{},transform:[0,0,1],isDarkMode:!1});this.engine=e,this.renderer=new Ms(A,{log:this.log.extend("renderer"),engine:this.engine,wantsEngineUpdates:!1,renderState:()=>this.renderState})}renderToSVG({nodeId:A}){this.log.debug("preparing SVG");let t=this.engine.tree.getNode(A);if(!t)throw Error(`Node ${A} doesn't exist`);if(!a$(t))throw Error(`Node ${A} must be exportable as SVG`);return s$({node:t,isDarkMode:this.engine.stores.documentSettingsStore.hasDarkAppearance,combinedVariableValueMap:t.cache.getUnsafeCombinedVariableValueMap()})}async prepareNodeSnapshot({nodeId:A,zoom:e=1,pixelRatio:t=1}){this.log.debug("preparing snapshot");let r=this.engine.tree,o=r.getNode(A);if(!o)throw Error(`Node ${A} doesn't exist`);let n=r.getRect(o),a=lF(r,o),i=yf(r,o),s={...n,x:a.x-i.x,y:a.y-i.y};t!==1&&(e*=t),this.log.debug("rendering");let l=this.engine.stores.scopeStore.active;return await this.renderer.renderUpdates(()=>{let{treeStore:c,toolStore:u,scopeStore:p,modulesStore:f,documentSettingsStore:E,propertiesPanelStore:F,overlayStore:R,selectionStore:S,effectStore:v}=this.engine.stores;this.renderState.renderScope=c.treeIndex.getScopeIdFor(o.id),this.renderState.renderNodes={[o.id]:s},this.renderState.transform=[0,0,e],this.renderState.isDarkMode=E.hasDarkAppearance,this.renderState.editor={selection:S.ids,nodeInTextEditorId:u.nodeInTextEditorId,nodesInEffectPreview:v.nodesInEffectPreview,nodesInMoveToolRootFontSize:this.engine.getNodesInMoveToolRootFontSize(),activeEffect:v.activeEffect,activeEffectIds:v.activeEffectIds,activeOverlayNodes:R.activeOverlays,dragAndDropPlaceholders:u.dragAndDropPlaceholders,rootFontSize:mp(l,c.tree,f)??null,scopeIdToSelectedCollectionItem:p.scopeIdToSelectedCollectionItem,shouldSetMinHeight:!1,activeLinkStyle:F.activeLinkStyle}}),q.multiply(q.atOrigin(i),e)}};function lF(j,A){if(j.isGroundNode(A))return j.getRect(A);let e=j.getGroundNodeFor(A);return j.getCanvasBoundingRectCached(e)}function R$(){PA({type:"add",variant:"warning",text:"This file format is currently unsupported",key:"image-export-unsupported",icon:"warning",duration:2e3})}function I$(){PA({type:"add",variant:"error",text:"Please update to the latest version",key:"image-export-not-available",icon:"error",duration:2e3})}async function F$(j,A){j=j.filter(i=>{for(let s of i.exportOptions)if(s.enabled)return!0;return!1});let e=j.length,t=j[0];$(t,"Node must be defined");let r=ys(t),o=new Set;for(let i of j)for(let s of i.exportOptions)s.enabled&&o.add(s.type);let n=Array.from(o).join(", "),a={key:"export-nodes-progress",progress:{variant:"progress",text:e===1?`${r} is exporting as ${n}`:`${e} layers are exporting as ${n}`},success:{variant:"success",text:e===1?`${r} has been exported`:`${e} layers have been exported`},error:{variant:"error",text:e===1?`Unable to export ${r}`:"Unable to export layers"}};await $f(a,A)}var dF=hA("export"),Vc=Tk?"\\":"/",Kc=new Set;Kc.add("html");Kc.add("webp");var Lo=class Lo extends Ds{constructor(e){super(new ei(e$.canvas,Aa.export,{width:100,height:100,offscreen:!Xe.isOn("sandboxExportDebugging")}),e);g(this,"exportMetrics",new ti)}static async whenAvailable({toastIfNot:e}={toastIfNot:!1},t){let r=await ei.isAvailable();if(this.isAvailable&&r)return this.shared=this.shared??new Lo(t),this.shared;e&&(ti.trackError("ServiceChannel miss-match error. Unable to establish a connection."),I$())}static async exportNodes(e,t){let r=await Lo.whenAvailable({toastIfNot:!0},t);if($(r,"Expected image exporter to be available"),r.hasUnsupportedFiles(e))return R$();let a=(await r.openSaveDialog(e))?.filePath;a&&await F$(e,async()=>{await r.exportNodes(e,a)})}hasUnsupportedFiles(e){for(let t of e)for(let r of t.exportOptions)if(Kc.has(r.type)&&r.enabled)return!0;return!1}async exportNodes(e,t){let r=[],o=this.getCount(e);for(let i of e)for(let s of i.exportOptions){if(!s.enabled)continue;let l=s.type,c=this.createNamePath(i,s),u=i.id,p=s.scale,f=o===1?this.verifyNamePath(c,t):c;switch(l){case"png":r.push({nodeId:u,pixelRatio:p,type:"image/png",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"jpg":r.push({nodeId:u,pixelRatio:p,type:"image/jpeg",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"svg":r.push({nodeId:u,pixelRatio:p,type:"image/svg+xml",pathname:f,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;default:iA(l)}}let n;for(let i of r){let s=performance.now();dF.debug("snapshotting export",i);try{await this.writeToDisk(i),this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:null,format:i.type,exportCount:o,success:!0,scope:"selection"})}catch(l){this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:"Exporting snapshoting failed",format:i.type,exportCount:o,success:!1,scope:"selection"}),n=l}}let{metrics:a}=await this.renderer.sandbox.collectMetrics();if(this.exportMetrics.mergeElectronMetrics(a),this.exportMetrics.track(),n)throw n}createNamePath(e,t){let r=j$(ys(e))||"export",o=t.nameExtension.lastIndexOf("/"),n=o>=0?t.nameExtension.slice(0,o+1):"",a=t.nameExtension.slice(o+1),i=t.type;return n+r+a+"."+i}getCount(e){let t=0;for(let r of e)for(let o of r.exportOptions)o.enabled&&t++;return t}async openSaveDialog(e){for(let t of e)for(let r of t.exportOptions)if(r.enabled)return this.renderer.sandbox.openSaveDialog({count:this.getCount(e),pathname:this.createNamePath(t,r)})}verifyNamePath(e,t){let r=e.split("/"),o=r[r.length-1];$(x(o),`Filename must be defined: ${r}`);let n=t.split(Vc),a=n[n.length-1];if($(x(a),`Filename must be defined: ${n}`),o.toLowerCase()!==a.toLowerCase()){let s=r.slice(0,-1).join(Vc);return s?s+Vc+a:a}return e}async writeToDisk(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG(e);return this.renderer.sandbox.writeToDisk({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToDisk({...e,rect:t})}async writeToClipboard(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG({nodeId:e.nodeId});return this.renderer.sandbox.writeToClipboard({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToClipboard({...e,rect:t})}async getImageData(e){let t=await this.prepareNodeSnapshot(e);return e.type==="image/svg+xml"?this.renderToSVG({nodeId:e.nodeId}):this.renderer.sandbox.getImageData({...e,rect:t})}};g(Lo,"isAvailable",Pk),g(Lo,"shared");var oi=Lo;var Ns=Dj(VR());function Jc(j){let A=Wj.boundingBox(j),e=j.pathSegments.map(t=>t.merge({x:t.x-A.x,y:t.y-A.y}));return[{pathClosed:j.pathClosed,pathSegments:e},A]}function G$(j,A,e,t){let r=hA("app:importSVG"),o=j,n,a;if(t&&t.colorable){let E=un(j,"image/svg+xml").documentElement;if(!E)throw new Error(`Unsupported SVG: ${j}}`);let F=E.getAttribute("fill"),R=!(F&&F.toLowerCase()==="none");if(R){if(t.fillType==="linear-gradient"&&t.fillLinearGradient instanceof $k)n={fillType:"linear-gradient",fillLinearGradient:t.fillLinearGradient};else if(t.fillType==="image"&&t.fillImage)n={fillType:"image",fillImage:t.fillImage,fillImageResize:t.fillImageResize,fillImagePixelWidth:t.fillImagePixelWidth,fillImagePixelHeight:t.fillImagePixelHeight};else if(t.fillType==="color"&&x(t.fillColor)){let S=(0,Ns.getPaperLazily)(),P=new S.Color(t.fillColor).toCSS(!1);R&&E.setAttribute("style",`fill: ${P}; color: ${P}`);let T=E.getAttribute("stroke");T&&T.toLowerCase()==="currentcolor"&&E.setAttribute("stroke",P)}o=E}}let i=pF(o);o=i.svgElement,a=i.svgSize;let s=!1,c=(0,Ns.getPaperLazily)().project.importSVG(o,{expandShapes:!0,insert:!1,size:e,onError:f=>{r.reportError(f),s=!0;let E=document&&document.getElementsByTagName("body");if(E&&E[0]){let F=E[0].lastElementChild;for(;F&&F.tagName==="svg";)F.remove(),F=E[0].lastElementChild}}});if(s)return null;let u;try{u=S$({item:c,fillOverrides:n,tree:A()})}catch(f){return r.reportError(f),null}let p=u[0];return p?(sj(p)&&a&&p.set({width:a.width,height:a.height}),A().insertNodes(u).getNode(p.id)):null}function S$({item:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=lA(0,0),fillOverrides:o}){let n=(0,Ns.getPaperLazily)();return j instanceof n.Group?fF({group:j,nodes:e,parent:t,parentAbsolutePosition:r,tree:A,fillOverrides:o}):j instanceof n.PathItem?mF({item:j,nodes:e,parent:t,parentAbsolutePosition:r,fillOverrides:o}):(console.warn("Unhandled Paper item:",j),e)}function pF(j){let A=x(j)?un(j,"image/svg+xml").documentElement:j;if(!A)throw new Error(`Unsupported SVG: ${j}}`);let e,t=A.getAttribute("viewBox"),r=A.getAttribute("width"),o=A.getAttribute("height");if(t){let[n,a,i,s]=t.split(" ");i&&s&&(A.setAttribute("width",i),A.setAttribute("height",s),e={width:parseInt(i),height:parseInt(s)})}else r&&o&&(e={width:parseInt(r),height:parseInt(o)});return y$(A),{svgElement:A,svgSize:e}}function y$(j){kF(j);for(let A of j.children)y$(A)}function kF(j){let A=j.getAttribute("rx"),e=j.getAttribute("ry");!A&&!e||A&&e||(A?j.setAttribute("ry",A):e&&j.setAttribute("rx",e))}function mF({item:j,nodes:A=[],parent:e=null,parentAbsolutePosition:t=lA(0,0),fillOverrides:r}){let o=hk({item:j,parentAbsolutePosition:t}),n=gk(j),a=e?e.id:Ij;if(o.length===1){let s=o[0];$(s,"Path must be defined");let[{pathSegments:l,pathClosed:c},u]=Jc(s),p=new qn({parentid:a,pathSegments:l,pathClosed:c,...n,...r,...u});A.push(p)}else if(o.length){let s=b$(j),l=s.x-t.x,c=s.y-t.y,u=j.fillRule==="evenodd"?3:4,p=new es({parentid:a,pathBoolean:u,...n,...r,x:l,y:c,width:s.width,height:s.height});A.push(p),o.forEach(f=>{let[{pathSegments:E,pathClosed:F},R]=Jc(f),S=new qn({parentid:p.id,pathSegments:E,pathClosed:F,...r,x:R.x-l,y:R.y-c,width:R.width,height:R.height});A.push(S)})}return A}function fF({group:j,tree:A,nodes:e=[],parent:t=null,parentAbsolutePosition:r=lA(0,0),fillOverrides:o}){let n=b$(j),a=t?t.id:Ij,i,s;return a?(i=new of({parentid:a,x:n.x-r.x,y:n.y-r.y,width:n.width,height:n.height}),s=lA(n.x,n.y)):(i=new Mr({parentid:a,left:0,top:0,width:n.x+n.width,height:n.y+n.height,fillEnabled:!1}),s=lA(0,0)),e.push(i),j.children.forEach(l=>{S$({item:l,nodes:e,parent:i,parentAbsolutePosition:s,tree:A,fillOverrides:o})}),e}function b$(j){let{x:A,y:e,width:t,height:r}=j.bounds;return{x:A,y:e,width:t,height:r}}function EF(j){return Oj(j)&&"iconURL"in j}function M4(j){return Oj(j.icon)?j.id==="WorkspacePluginsCategory"?!0:EF(j.icon):!1}var $F={DefaultCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function D4(j){return x(j)?Object.hasOwn($F,j):!1}var BF={FindNodesCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function N4(j){return Object.hasOwn(BF,j)}function O4(j){return j?.kind==="item"}function C$(j){if(j!==void 0)switch(j){case 2:return"auto";case 0:return"fixed";case 3:return"fraction";case 1:return"percentage";case 4:return"viewport";case 5:return"fit-image";default:iA(j)}}function v$(j,{widthType:A,heightType:e},t){if(!$A(j))return;let r=A!==void 0&&j.widthType!==A,o=e!==void 0&&j.heightType!==e;!r&&!o||rE({widthType:C$(A),heightType:C$(e),source:t,nodeType:j.__class,componentId:W(j)?j.codeComponentIdentifier:void 0})}function qo(j,A,e=!1){let t={};for(let r in j){let o={...j[r]};"itemsOrder"in o&&Array.isArray(o.itemsOrder)&&e&&(o.itemsOrder=Wn(o.itemsOrder,A)),t[A.get(r)??r]=o}return t}var Os=class extends Map{get(A){let e=super.get(A);for(;e;){let t=super.get(e);if(t===void 0)break;e=t}return e}};function hF(j,A){if(Qa(j)){if(!j.controls.target?.value)return;let e=A.get(j.controls.target.value);return e?{target:{...j.controls.target,value:e}}:void 0}if(Ze(j)){if(!j.controls.variantId?.value)return;let e=A.get(j.controls.variantId.value);return e?{variantId:{...j.controls.variantId,value:e}}:void 0}if(Bl(j)){if(!j.controls.overlay?.value)return;let e=A.get(j.controls.overlay.value);return e?{overlay:{...j.controls.overlay,value:e}}:void 0}}function T$(j,A,e,t){let r=W(A),o={},n=!1,a=Ua(A);for(let i in a){let s=r?QA(i):i;if(!YA(j,A,s))continue;let l=a[i];if(!cj(l))continue;let c=[],u=!1;for(let p of l){if(t&&(Bl(p)||ba(p))){u=!0;continue}let E=hF(p,e);if(!E){c.push(p);continue}c.push({...p,controls:{...p.controls,...E}}),u=!0}u&&(r?o[QA(i)]={type:"eventhandler",value:c}:o[i]=c,n=!0)}n&&A.set(o,j)}function gF(j,A,e){let t={};function r(a){let i=j.get(a);i&&j.linkNodeChangesTo(i,A.id)}let o=cf(A,L);for(let a of o){if(!YA(j,A,QA(a)))continue;let i=A.getRawControlProp(a);if(i){if(i.type==="slot"&&cj(i.value)){let s=!1,l=i.value.map(c=>{if(!Oj(c))return c;let u="reference";if(!x(c[u]))return c;let p=e.get(c.reference);return p?(s=!0,r(p),{...c,[u]:p}):c});if(!s)continue;t[a]={type:"slot",value:l}}else if((i.type===null||i.type==="componentinstance")&&x(i.value)){let s=e.get(i.value);if(!s)continue;t[a]={type:"slot",value:[{id:"first-item",reference:s}]},r(s)}else if(cj(i.value)){let s=!1,l=[];for(let c=0;c<i.value.length;c++){let u=i.value[c];if(!ka(u)||u.type!==null&&u.type!=="componentinstance"||!x(u.value))continue;let p=Uu(u)?u.id:Fj(),f=e.get(u.value);l.push({id:p,reference:f??u.value}),f&&(r(f),s=!0)}if(!s)continue;t[a]={type:"slot",value:l}}}}if(Le(t))return;let n=co(t);A.set(n,j)}function RF(j,A,e){let t={},r=L.componentForIdentifier(A.codeComponentIdentifier)?.properties;for(let o in r){if(!YA(j,A,QA(o)))continue;let n=r[o];if(n?.type!=="scrollsectionref")continue;let a=A.getRawControlProp(o);if(!a)continue;let i=Ep(n,a);if(!i||aA(i)||!x(i.target))continue;let s=e.get(i.target);s&&(t[o]={type:"scrollsectionref",value:{...i,target:s}})}Le(t)||A.set(co(t),j)}function IF(j,A){if(pm(j)&&cj(j.appearEffectScrollTargets)){let e=j.appearEffectScrollTargets.map(t=>{if(!t.target||aA(t.target))return t;let r=A.get(t.target);return r?{id:Fj(),variant:t.variant,target:r}:t});j.set({appearEffectScrollTargets:e})}if(dm(j)&&x(j.styleAppearEffectScrollTarget)){let e=A.get(j.styleAppearEffectScrollTarget);e&&j.set({styleAppearEffectScrollTarget:e})}if(um(j)&&cj(j.styleTransformEffectScrollTargets)){let e=j.styleTransformEffectScrollTargets.map(t=>{if(!t.target||aA(t.target))return t;let r=A.get(t.target);return r?{id:Fj(),style:t.style,target:r}:t});j.set({styleTransformEffectScrollTargets:e})}if(sm(j)&&j.dragEffectConstraintElement){let e=A.get(j.dragEffectConstraintElement);e&&j.set({dragEffectConstraintElement:e})}if(km(j)&&x(j.textEffectScrollTarget)){let e=A.get(j.textEffectScrollTarget);e&&j.set({textEffectScrollTarget:e})}}function Ne(j,A,e,t){if(A=A.draftOrCurrent(),(We(A)||qp(A))&&T$(j,A,e,t),W(A)&&(T$(j,A,e,t),gF(j,A,e),RF(j,A,e)),wn(A)&&IF(A,e),Eo(A)&&A.formSubmitButtonId){let o=e.get(A.formSubmitButtonId);o&&A.set({formSubmitButtonId:o})}if(Cm(A)&&A.dataSourceLoaderId){let o=e.get(A.dataSourceLoaderId);o&&A.set({dataSourceLoaderId:o})}if(na(A)&&A.collectionRepeatedItemId){let o=e.get(A.collectionRepeatedItemId);o&&A.set({collectionRepeatedItemId:o})}if(Ae(A)){let o=P$(A.dataIdentifier,e);o&&A.set({dataIdentifier:o})}if(fj(A)){let o=A.variables.map(n=>{if(!ga(n))return n;let a=P$(n.dataIdentifier,e);return a?{...n,dataIdentifier:a}:n});fr(A.variables,o)||A.set({variables:o})}$e(A)&&FF(A,e);let r=Dm(j,A,o=>{if(!o.providerId)return;let n=e.get(o.providerId);if(n)return re(e.get(o.id)??o.id,n)});if(r&&A.set(r),A.children)for(let o of A.children)Ne(j,o,e,t);return A}function P$(j,A){let e=oA(j);if(!ej(e))return null;let t=A.get(e.localIdName);return t?pr(e.type,t,e.exportSpecifier).value:null}function FF(j,A){let e=j.getControlProps();for(let[t,r]of Object.entries(e)){if(r?.type==="collectionreference"&&x(r.value)){let o=A.get(r.value);o&&j.setControlProp(t,{...r,value:o})}if(r?.type==="multicollectionreference"&&!sA(r.value)&&!aA(r.value)){let o=r.value.map(n=>A.get(n)??n);fr(r.value,o)||j.setControlProp(t,{...r,value:o})}}}function ws(j){if(!j)return!1;let A=oA(j);return A?A.kind==="externalModuleExport"||A.kind==="localModuleExport":!1}function Ls(j,A){W(j)&&ws(j.codeComponentIdentifier)&&A(j.codeComponentIdentifier),ao(j)&&j.dataIdentifier&&A(j.dataIdentifier),fo(j)&&ws(j.codeOverrideIdentifier)&&A(j.codeOverrideIdentifier),Wl(j)&&j.codeOverrides?.forEach(e=>{A(e.identifier)}),$e(j)&&Pf(j).forEach(A)}function qs(j,A){let e={};if(W(j)&&ws(j.codeComponentIdentifier)){let r=A(j.codeComponentIdentifier);r&&(e.codeComponentIdentifier=r)}if(ao(j)&&j.dataIdentifier){let r=A(j.dataIdentifier);r&&($(Sj(r)),e.dataIdentifier=r)}if(fo(j)&&ws(j.codeOverrideIdentifier)){let r=A(j.codeOverrideIdentifier);r&&(e.codeOverrideIdentifier=r)}if(Wl(j)&&j.codeOverrides){let r=!1,o=j.codeOverrides.map(n=>{let a=A(n.identifier);return a?(r=!0,{...n,identifier:a}):n});r&&(e.codeOverrides=o)}if($e(j)){let r=vf(j,A);r&&Object.assign(e,r)}if(Object.keys(e).length!==0)return e}function _$(j){return $s(j)||fj(j)}async function x$(j,A,e){return(await rs.post(`/web/projects/${e}/assets/duplicate-module`,{moduleId:j,saveId:A})).assets}var D$=75,GF={mutable:!0,update:0};function Jr(j,A,e,t,r=!1){function o(n,a,i=!1){let s=new n.constructor;s.assign(n,GF,{cache:s.cache,id:s.id}),rk(s)&&(s.itemsOrder=void 0),n.cache.insideVariant=i;let l=Gr(n)?n.getChildrenInVisualOrder():n.children;l&&(s.children=l.map(p=>o(p,s.id,i)));let c={parentid:a},u=qs(n,p=>{let f=oA(p);if(f.kind==="localModuleExport"){let E=A.get(f.localId);if(E)return`${E}:${f.exportSpecifier}`}else if(f?.kind==="externalModuleExport"){let E=e.get(f.moduleId);if(E)return eo(f,E).value}});if(u&&Object.assign(c,u),dj(n)&&!DA(n)&&Object.assign(c,{replicaInfo:void 0,originalid:void 0,...n.replicaInfo.overrides[n.replicaInfo.master],_deleted:void 0}),r&&Object.assign(c,{duplicatedFrom:ya(n.duplicatedFrom,n.id)}),s.assign(c),t){if(t.has(n.id)){let p=t.get(n.id);p&&t.set(p,s.id)}t.set(n.id,s.id),n.originalid&&!t.has(n.originalid)&&t.set(n.originalid,s.id)}return s}return o(j,void 0,DA(j))}function SF(j){let A=new Map;for(let e of j)if(e.type==="local"){let t=e.moduleId;A.set(e.localId,me(t,e.saveId,e.file).value)}return A}async function N$(j){let A=new Map;for await(let e of j)if(e.type==="local"&&e.moduleType==="css"){let t=await w$({moduleId:e.moduleId,saveId:e.saveId}),{__treeSerializationVersion:r,...o}=t,n=r||D$,{root:a}=gl({root:o,version:n}),i=rc(a);je(i)&&A.set(i.id,i)}return[...A.values()]}function O$(j,A,e){let t=SF(e.imports),r=new Map,o=[];for(let n of j.walk())Ls(n,a=>{let i=oA(a);if(ej(i)){let s=t.get(i.localId);if(!s)return;let{moduleId:l,saveId:c,file:u}=oA(s);i=D7(i,l,c,u)}if(i.kind==="externalModuleExport"){let s=A.getPersistedModuleByGlobalId(i.moduleId);s?r.set(i.moduleId,s.localId):o.push(i)}});return{identifiers:o,localIdsToExternalIdentifiers:t,externalModuleIdsToLocalIds:r}}async function w$({moduleId:j,saveId:A}){try{return await(await fetch(`${qe().modulesCDN}/${j}/${A}/tree.json`)).json()}catch(e){GA(e)}}async function L$(j,A){let[e,t]=await Promise.all([w$(A),j.stores.modulesStore.getModuleDependencies(A)]);$(e,"Can't get tree.json for module identifier"),$(t,"Can't get dependencies for module identifier");let{__treeSerializationVersion:r,...o}=e,n=r||D$,{root:a}=gl({root:o,version:n}),i=rc(a);return $(_$(i),"Node should be un-linkable."),{node:i,dependencies:t}}async function q$(j,A,e){let t=j.remoteDocument?.projectId;if(t&&A.assets.length>0)try{let r=await x$(e.moduleId,e.saveId,t);j.stores.assetStore.assetService?.addAssets(r)}catch{}}function Qc(j){if(!TA(j)||RA(j))return 0;let A=0,e=j.children.length;return A+=e,j.children.forEach(t=>{A+=Qc(t)}),A}function V$(j,A,e,t){let r=gs(e,L),o=new Map(Object.entries(r)),n=new Map;n.set(t,o);let a={};for(let i of j.walk()){let s=Za(A,t,i,n);s&&(a[i.originalid??i.id]=s)}return a}function K$(j){let{left:A,top:e,right:t,bottom:r,centerAnchorX:o,centerAnchorY:n,constraintsLocked:a,width:i,widthType:s,height:l,heightType:c,aspectRatio:u,name:p,...f}=j;return f}function J$(j){let A=L.reactComponentForIdentifier(j.codeComponentIdentifier);if(!A)return;let e={},t=Object.keys(A.properties);for(let r of t){let o=A.properties[r];if(!o||o.type!=="eventhandler")continue;let n=j.getRawControlProp(r);if(!n)continue;let{value:a}=n;!Array.isArray(a)||a.length===0||(e[r]=a)}return e}function Vs(j,{opacity:A,rotation:e}){if(aA(A))j.opacity=A;else if(j?.opacity||A){let t=Y(A)?A:1;j.opacity=(j.opacity??1)*t}if(aA(e))j.rotation=e;else if(j?.rotation||e){let t=Y(e)?e:0;j.rotation=(j.rotation??0)+t}}function Bq(j){return j.every(A=>pA(A)||qj(A)||W(A))}function hq(j,A){return A?!1:j.every(e=>{if(!pA(e)&&!W(e)&&!XA(e)||IA(e)||pA(e)&&Ro(e).length===0)return!1;if(W(e)){let t=e.getSupportedLayout(L);if(!Se(t.width)||!Se(t.height))return!1}return e.widthType!==2||e.heightType!==2})}function H$(j,A,e){for(let t of A)if(qj(t)||W(t))t.set({widthType:2,heightType:2}),qj(t)&&e&&mA("layout_fit_text",{source:e});else if(pA(t)){let r={widthType:2,heightType:2,aspectRatio:null};ve(t)||Gs(j,t,r),_c(j.tree,"width",t),_c(j.tree,"height",t),ym(t)&&(r.framePreset=null),t.set(r),e&&mA("layout_stack",{layoutType:"stack",source:e})}}function Fq(j){return dj(j)&&!DA(j)}function Q$(j){return gA(j)&&!$j(j)}function U$(j){return oj(j)&&!$j(j)}function Ks(j,A){return ea(A)&&(hA("app").warn("Inserting a symbol is no longer supported."),A.isMaster=!1,A.replicaInfo=null,A.originalid=null),$(!j.tree.has(A.id),"Tree should not contain node with same id as inserted template"),j.stores.scopeStore.insertNode(A),A}function X$(j){let A={width:200,height:200,codeComponentIdentifier:j.identifier,intrinsicWidth:null,intrinsicHeight:null,slotsAreChildNodes:yA.isOn("componentSlotsAreChildNodes")},{defaultProps:e,annotations:t}=j;if(e!==void 0&&(W6(e.width)&&(A.width=e.width,A.intrinsicWidth=e.width),W6(e.height)&&(A.height=e.height,A.intrinsicHeight=e.height)),t){let r=bk(t);r.width&&(A.width=r.width),r.height&&(A.height=r.height)}return new xr(A)}function wq(j){return j.sort(yF)}var W$=new Map;function z$(j){let A=W$.get(j);if(A)return A;let e=j.split("/").map(t=>t.trim()).join("");return W$.set(j,e),e}function yF(j,A){if(j.name===null)return-1;if(A.name===null)return 1;let e=z$(j.name),t=z$(A.name);return e.localeCompare(t,void 0,{numeric:!0})}function Lq(j){if(Q7(j)&&j.file==="./canvas.tsx"||j.identifier==="framer/Stack")return!1;let A=oA(j.identifier);return ej(A)&&A.type==="screen"?!1:j.type==="component"||j.type==="master"}function qq(j){let A=j.split("/"),e=A[A.length-1];return $(fe(e),"Last section is required"),e.trim()}function Vq(j,A){return j.name?j.name:A?De(A):"Unknown"}function Kq(j){let A=[];for(let e of L.getAllLocalModules())e.type==="component"&&e.file===j&&A.push(e);return A}function Js(j,{allowVariants:A,allowLockedNodes:e}={}){return!e&&Yt(j)||Zj(j)||!A&&(DA(j)||$j(j))||U$(j)||ln(j)||RA(j)||Du(j)?!1:$A(j)}async function Y$(j,A,e,t){function r(){TF(j,[A],e,t)}if(!W(e)){r();return}let o=oA(e.codeComponentIdentifier);if(!o||o.kind!=="externalModuleExport"){r();return}await j.stores.modulesStore.addExternalModulesToProject([o],{onTreeUpdate:r})}function bF(j,A,e){if(!yn(A))return;let t=uk(j.tree,A);if(!eA(t))return;$(t.isLoaded(),"smart component must be loaded"),e.set({formSubmitButtonId:A.id});let r=t.getPrimaryVariant();t.getReplicaVariants().forEach(o=>{kA.resetOverridesByProperty(j.tree,o,o,["htmlTag","link"])}),lm(r)&&r.set({htmlTag:"button",link:void 0})}function CF(j,A,e){if(!W(j)||!W(A)||!j.cache.formContainerAncestorId)return;let t=e.tree.get(j.cache.formContainerAncestorId);Eo(t)&&bF(e,A,t)}function vF(j,A,e){let t=Zk(e.tree,j);t&&am(j,t)&&t.set({dataSourceLoaderId:A.id})}function TF(j,A,e,t){let r={},o=new Set;A.forEach(n=>{let a=null;if(oj(n)){if(!Be(n))return;let f=Ye(j.tree,n),E=kA.getReplicaForTemplateNode(j.tree,n);if(!f||!E||!DA(E))return;n=f,a=E}let i=Ks(j,e);CF(n,i,j),vF(n,i,j);let s=j.tree.getNodeParent(n),l=s||j.tree.getScopeNodeFor(n)||j.stores.scopeStore.active,c=l.children.indexOf(n),u=Fs(j.tree,n,i,l);if(i.set(u),s&&bj(n)&&Vt(i)){i.set(Kt(n));let f=new Os([[n.id,i.id]]);Ne(j.tree,s,f,ie(s)||Pa(s)),o.add(i.id)}if(W(i)&&_F(n,i,new Set(Object.keys(u))),dj(n)&&!DA(n)&&W(i)&&PF(j,n,i),xF(j,l,n,i),TA(n))for(let f of n.children)ie(f)&&j.moveNode(f.id,i.id);j.deleteNode(n.id),j.moveNode(i.id,l.id,c);let p=MF(j.tree,n,i);$A(i)&&p&&(t?j.tree.current(i)?.set({left:p.left,right:p.right,top:p.top,bottom:p.bottom,centerAnchorX:p.centerAnchorX,centerAnchorY:p.centerAnchorY}):j.tree.current(i)?.set(p)),a?r[n.id]=he(a.id,i.id):r[n.id]=i.id});for(let n of j.stores.selectionStore.ids)o.add(r[n]??n);j.stores.selectionStore.set(Array.from(o))}function PF(j,A,e){if(DA(A))return;let t=e.getLocalSmartComponentNodeId();if(!t)return;let r=j.tree.getNode(t);if(!(!r||!eA(r))&&r.originalSymbolId===A.replicaInfo.master){for(let o of A.walk())if(!(!bm(o)||!o.isTarget)&&o.originalid){if(pA(o)&&o.fillType==="image"&&x(o.fillImage)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="image"&&(n.value=o.fillImage)}else if(ln(o)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="string"&&(n.value=o.styledText.text)}}}}function _F(j,A,e){let t;A:for(let o of j.walk()){if(!We(o)&&!W(o))continue;let n=za(o);for(let[,a]of Object.entries(n))if(t===void 0)t=a;else if(t){t=null;break A}}if(!t)return;let r=L.componentForIdentifier(A.codeComponentIdentifier);if(r?.properties)for(let o in r.properties){if(e?.has(o)||r.properties[o]?.type!=="eventhandler")continue;let a={type:"eventhandler",value:t};A.set({[QA(o)]:a});return}}function xF(j,A,e,t){let r=A?on(A):null;if(!r||!Ej(r))return;let o=j.tree.getSmartComponentNodeFor(r);if(o)for(let n of o.getReplicaVariants()){let a=n.replicaInfo;if(!(e.id in a.overrides))continue;let i={...a};i.overrides={...i.overrides};let s={},l=i.overrides[e.id];for(let c in l){let u=l[c];if(c==="_deleted"){if(!cj(u))continue;let p=u.filter(f=>f in t);p.length&&(s._deleted=p)}else c in t&&(s[c]=u)}delete i.overrides[e.id],i.overrides[t.id]=s,j.tree.current(n)?.set({replicaInfo:i})}}function MF(j,A,e){if(!$A(A)||!$A(e))return;let t=A.constraintValues();if(Ir(A)&&Ir(e)&&(Dp(A)&&(t.gridItemFillCellWidth=!0),Mp(A)&&(t.gridItemFillCellHeight=!0)),!W(e))return t;if(vk(A)){let r=e.getSupportedLayout(L),o=j.getRect(A);A.widthType===2&&!Se(r.width)&&(t.widthType=0,t.width=o.width),A.widthType===5&&(t.widthType=Se(r.width)?2:0),A.heightType===2&&!Se(r.height)&&(t.heightType=0,t.height=o.height),A.heightType===5&&(t.heightType=Se(r.height)?2:0)}return t}function Z$(j){return H7(j)?X$(j):null}var AB=Dj(tl());function jB(j){let A={};for(let e of j.walk()){let t={};Ie(e)&&(t.strokeDashArray=e.strokeDashArray,t.strokeDashOffset=e.strokeDashOffset,HA(e.strokeWidth)||(t.strokeWidth=e.strokeWidth)),hr(e)&&(t.boxShadows=e.boxShadows),zt(e)&&(t.radius=e.radius),$r(e)&&(t.radiusTopLeft=e.radiusTopLeft,t.radiusTopRight=e.radiusTopRight,t.radiusBottomRight=e.radiusBottomRight,t.radiusBottomLeft=e.radiusBottomLeft),pn(e)&&(t.pathSegments=e.pathSegments),_e(e)&&e.fillType==="image"&&e.fillImageResize==="tile"&&(t.fillImageTileSize=e.fillImageTileSize??1),A[e.id]=t}return(0,AB.Map)(A)}function Uc(j,A,e){A.forEach((t,r)=>{let o=j.getNode(r);if(!o)return;let n={};Ie(o)&&(Y(t.strokeWidth)&&(n.strokeWidth=mj(t.strokeWidth*e,2)),x(t.strokeDashArray)&&(n.strokeDashArray=NF(t.strokeDashArray,e)),Y(t.strokeDashOffset)&&(n.strokeDashOffset=mj(t.strokeDashOffset*e,2))),op(o)&&Xu(t.boxShadows)&&(n.boxShadows=DF(t.boxShadows,e)),zt(o)&&(Y(t.radius)&&(n.radius=mj(t.radius*e,2)),Y(t.radiusTopLeft)&&(n.radiusTopLeft=mj(t.radiusTopLeft*e,2)),Y(t.radiusTopRight)&&(n.radiusTopRight=mj(t.radiusTopRight*e,2)),Y(t.radiusBottomRight)&&(n.radiusBottomRight=mj(t.radiusBottomRight*e,2)),Y(t.radiusBottomLeft)&&(n.radiusBottomLeft=mj(t.radiusBottomLeft*e,2))),pn(o)&&t.pathSegments&&(n.pathSegments=o.pathSegments.map((a,i)=>{let l=t.pathSegments[i].radius*e;return a.merge({radius:l})})),_e(o)&&Y(t.fillImageTileSize)&&(n.fillImageTileSize=t.fillImageTileSize*e),o.set(n)})}function DF(j,A){if(!(!j||HA(j)))return j.map(e=>Ea(e,{x:mj(e.x*A,2),y:mj(e.y*A,2),blur:mj(e.blur*A,2),spread:mj(e.spread*A,2)}))}function NF(j,A){let e=[],t=j.split(",");for(let r of t){let o=parseFloat(r);if(!Y(o))continue;let n=mj(o*A,2);e.push(n)}return e.join(", ")}var N2=(j,A)=>{if(j===A)return!0;if(j.length!==A.length)return!1;let e=new Set(j);for(let t of A)if(!e.has(t))return!1;return!0},O2=(j,A,e)=>{let t=[];for(let r of j)Wc(A,r,e)!==-1&&t.push(r);return t},eB=(j,A,e)=>{if(!e)return Array.from(new Set([...j,...A]));let t=[...j];for(let r of A)Wc(t,r,e)===-1&&t.push(r);return t},w2=(j,A,e)=>j.filter(t=>Wc(A,t,e)===-1);function Wc(j,A,e){return e?j.findIndex(t=>e(t,A)):j.indexOf(A)}function OF(j,A){let e=[];for(let r of A.segmentSelection){let o=j.getNode(r.id);!o||r.index>=o.pathSegments.length||e.push(r)}let t=A.segmentHandle;if(t){let r=j.getNode(t.id);(!r||t.index>=r.pathSegments.length)&&(t=null)}return{...A,segmentSelection:e,segmentHandle:t}}var tB=class{constructor(A){this.addChanges=A;g(this,"state",{segmentSelection:[],selectionType:0,segmentHandle:null,segmentHovered:null,closestCurve:null,pointRounding:.5,snapConstraint:null})}validateSegmentSelection(A){this.state=OF(A,this.state),this.addChanges("PathSelection")}setSegmentSelection(A,e){this.state={...this.state,segmentSelection:A,selectionType:e},this.addChanges("PathSelection")}toggleSegmentSelection(A,e){this.state.selectionType!==e&&(this.state={...this.state,segmentSelection:A,selectionType:e});let t=A.filter(o=>this.state.segmentSelection.find(n=>o.id===n.id&&o.index===n.index)===void 0),r=this.state.segmentSelection.filter(o=>A.find(n=>n.id===o.id&&n.index===o.index)===void 0);this.state={...this.state,segmentSelection:eB(t,r)},this.addChanges("PathSelection")}setSegmentHandle(A){this.state={...this.state,segmentHandle:A},this.addChanges("PathSelection")}setHoveredSegment(A){this.state={...this.state,segmentHovered:A},this.addChanges("PathSelection")}setClosestCurve(A){this.state={...this.state,closestCurve:A},this.addChanges("PathSelection")}setPathPointRounding(A){this.state={...this.state,pointRounding:A},this.addChanges("PathSelection")}setPathConstraint(A){this.state={...this.state,snapConstraint:A},this.addChanges("PathSelection")}};var ni=Dj(tl());function oB(j,A){return Un(j,"canDesign")||A.length===0?!1:A.find(e=>!(!xo(e)&&Wt(e)&&!Mt(e)&&!e.originalid))===void 0}function EV(j,A,e,t){let r=A.map(o=>Xc(j,o,e,t)[0]);j.stores.selectionStore.set(r)}function Xc(j,A,e,t){let r=j.tree,o;ec.isBasicShape(A)?o=ec.createPath(A):o=A.calculatedPaths();let n=mk(A,o),a=ai(r,A,o),i=r.newId(),s=Wj.boundingBox(n),l=aB(A),c=mm(A);if(l.fillType==="linear-gradient"&&l.fillLinearGradient){l.fillType="linear-gradient";let p=Y(A.rotation)?A.rotation:0;l.fillLinearGradient=l.fillLinearGradient.updated({angle:l.fillLinearGradient.angle+p})}if(n.length===1){let p=Wj.offset(n[0],lA.reverse(s));j.createPath(A.parentid,{id:i,...p,...s,...l,...c})}else{let p=[],f=new es({id:i,parentid:A.parentid,pathBoolean:4,...s,...l,...c});p.push(f);for(let E of n){let F=Wj.boundingBox(E),R={...F,...lA.subtract(F,s)},S=Wj.offset(E,lA.reverse(F)),v=new qn({parentid:i,...R,...S,...l});p.push(v)}j.tree.insertNodes(p)}let u=r.getParent(A.id);if(u!==null&&TA(u)){let p=u.children.indexOf(A);j.moveNode(i,u.id,p)}return j.deleteNode(A.id),t||j.stores.selectionStore.set(i),e===!0&&j.setTool(35),[i,a]}function wF(j){let A={};return j.forEach(e=>{A[e.id]||(A[e.id]=[]),A[e.id].push(e.index)}),A}function $V(j,A){let e=1/A;return{x:Math.round(j.x*e)/e,y:Math.round(j.y*e)/e}}function BV(j,A){let e=j.getNode(A.id);if(!e||!e.pathSegments)return null;let t=e.pathSegments[A.index],r=A.handle===0?yj.calculatedHandleIn(t):yj.calculatedHandleOut(t);return j.convertPointToCanvas(e,r)}function rB(j,A){return A.handle===0?{x:j.handleOutX,y:j.handleOutY}:{x:j.handleInX,y:j.handleInY}}function hV(j,A,e,t,r){let o=j.getNode(A.id),n=o.pathSegments[A.index];return e=j.convertPointToNode(o,e),e=lA.subtract(e,n),Ve.update(o.pathSegments,A.index,a=>{let i=rB(a,A),s=a.handleMirroring==="straight",l=a.handleMirroring;t&&(i=rB(t,A),s=t.handleMirroring==="straight",l=t.handleMirroring),s&&(l="symmetric"),t&&r&&(l==="disconnected"||l==="asymmetric"?l="symmetric":l="disconnected"),l==="symmetric"&&(i=lA.reverse(e));let c=A.handle===0,u=c?e.x:i.x,p=c?e.y:i.y,f=c?i.x:e.x,E=c?i.y:e.y;return a.merge({handleOutX:f,handleOutY:E,handleInX:u,handleInY:p,handleMirroring:l})})}function ii(j,A,e=!1,t){let r=j.tree,o=(0,ni.Map)(),n=(0,ni.Map)();if(!Wt(A)&&!RA(A))return{descendantPaths:o,descendantBasicShapes:n};let a={};Yc(r,A,a);let i=Object.keys(a);for(let c=0,u=i.length;c<u;c++){let p=i[c],f=a[p];o=o.set(p,f)}let s={};Zc(r,A,s,e);let l=Object.keys(s);for(let c=0,u=l.length;c<u;c++){let p=l[c],f=s[p];n=n.set(p,f)}return n.forEach((c,u)=>{if(c!==null)return;let p=r.getNode(u);if(!p||!oB(j,[p]))return;let[f,E]=Xc(j,p,!1,!0),F=E[0];o=o.set(f,F),t&&t.includes(u)&&j.stores.selectionStore.toggle(f)}),{descendantPaths:o,descendantBasicShapes:n}}function nB(j,A){let e=j.tree,t=(0,ni.Map)(),r=(0,ni.Map)();if(!RA(A))return{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r};let o={};Yc(e,A,o,A);let n=Object.keys(o);for(let s=0,l=n.length;s<l;s++){let c=n[s],u=o[c];t=t.set(c,u)}let a={};Zc(e,A,a,!1,!1,A);let i=Object.keys(a);for(let s=0,l=i.length;s<l;s++){let c=i[s],u=a[c];r=r.set(c,u)}return r.forEach((s,l)=>{if(s!==null)return;let c=e.getNode(l);if(!c||!oB(j,[c]))return;let[u,p]=Xc(j,c,!1,!0),f=p[0],E=jr(e,A,[f])[0];t=t.set(u,{pathSegments:E,pathClosed:!0})}),{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r}}function Yc(j,A,e,t){if(Mt(A)||dn(A)||RA(A))for(let r of A.children)Wt(r)&&Yc(j,r,e,t);else if(xo(A)){let r=ai(j,A,A)[0].pathSegments;t&&(r=jr(j,t,[{pathSegments:r,pathClosed:A.pathClosed}])[0]),e[A.id]={pathSegments:r,pathClosed:A.pathClosed}}}function Zc(j,A,e,t=!1,r=!1,o){if(Mt(A)||dn(A)||RA(A))for(let n of A.children){let i=Ut(n)&&Y(n.rotation)&&n.rotation%90!==0||t;Wt(n)&&Zc(j,n,e,i,r,o)}else if(!xo(A)&&Wt(A))if(t||r)e[A.id]=null;else{let n=q.pointsAtOrigin(j.getRect(A));e[A.id]=n.map(a=>{let i=j.convertPointToCanvas(A,a);return o?j.convertPointToNode(o,i,!0):i})}}function ai(j,A,e,t=1){let r=[];return Array.isArray(e)?r=e:r=[e],r.map(({pathSegments:o,pathClosed:n})=>({pathSegments:o.map(i=>zc(j,A,i,t,void 0)),pathClosed:n}))}function zc(j,A,e,t=1,r){let o=lA.multiply(j.convertPointToCanvas(A,e,!0,r),t),n=lA.multiply(j.convertPointToCanvas(A,yj.calculatedHandleIn(e),!0,r),t),a=lA.multiply(j.convertPointToCanvas(A,yj.calculatedHandleOut(e),!0,r),t),i=lA.subtract(n,o),s=lA.subtract(a,o);return e.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}function jr(j,A,e){return e.map(({pathSegments:t})=>t.map(r=>{let o=j.convertPointToNode(A,r),n=j.convertPointToNode(A,yj.calculatedHandleIn(r)),a=j.convertPointToNode(A,yj.calculatedHandleOut(r)),i=lA.subtract(n,o),s=lA.subtract(a,o);return r.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}))}function iB(j,A,e,t){return t.map(({pathSegments:r})=>r.map(o=>{let n={x:o.x,y:o.y},a=j.convertPointFromNodeToDescendant(A,e,n),i=j.convertPointFromNodeToDescendant(A,e,yj.calculatedHandleIn(o)),s=j.convertPointFromNodeToDescendant(A,e,yj.calculatedHandleOut(o)),l=lA.subtract(i,a),c=lA.subtract(s,a);return o.merge({...a,handleOutX:c.x,handleOutY:c.y,handleInX:l.x,handleInY:l.y})}))}function Ad(j,A){return A.map(({pathSegments:e})=>e.map(t=>{let r=vj.convertPoint(j,t),o=vj.convertPoint(j,yj.calculatedHandleIn(t)),n=vj.convertPoint(j,yj.calculatedHandleOut(t)),a=lA.subtract(o,r),i=lA.subtract(n,r);return t.merge({...r,handleOutX:i.x,handleOutY:i.y,handleInX:a.x,handleInY:a.y})}))}function LF(j,A,e){let t=A.updateForPath(e);j.tree.current(A)?.set(t)}function gV(j,A,e,t,r){let o=j.getParent(e.id),n=e.updateForPath(t);A.createPath(o?o.id:Ij,{...n,id:r,rotation:e.rotation,...aB(e)})}function RV(j,A,e){if(e===0)return A;let t=[],r=wF(A),o=Object.keys(r);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=[],l=j.getNode(i),c=r[i],u=l.pathSegments.length;for(let p=0,f=c.length;p<f;p++){let E=c[p];s.push(E);let F=E+1;F===u?s.push(0):s.push(F)}for(let p=0,f=s.length;p<f;p++){let E=s[p];t.push({id:l.id,index:E})}}return t}function IV(j,A,e){for(let t of j)if(t.id===A&&t.index===e)return!0;return!1}function FV(j,A,e,t,r,o){let n=ai(j,r,r),a=jr(j,e,n)[0],i=!Wj.isLastSegment(e.pathSegments,e.pathClosed,t.index),s=Wj.isLastSegment(r.pathSegments,r.pathClosed,o.index);(!i&&s||i&&!s)&&(a=Wj.reverse(a));let c;i?c=Ve.unshift(e.pathSegments,...a):c=Ve.push(e.pathSegments,...a),A.deleteNode(r.id),LF(A,e,{pathSegments:c})}function qF(j,A,e){let t=Ou(j,A);if(e===0){if(t)return lA.subtract(A,j);if(j.handleOutX!==0||j.handleOutY!==0){let o=yj.calculatedHandleOut(j);return lA.subtract(o,j)}let r=yj.calculatedHandleIn(A);return lA.subtract(r,j)}else{if(t)return lA.subtract(j,A);if(A.handleInX!==0||A.handleInY!==0){let o=yj.calculatedHandleIn(A);return lA.subtract(o,A)}let r=yj.calculatedHandleOut(j);return lA.subtract(r,A)}}function GV(j,A){let e=j.getNode(A.id);if(!e)return null;let t=e.pathSegments[A.segmentIndex],r=e.pathSegments[A.segmentIndex+1];if(!t||!r)return null;let o=zc(j,e,t),n=zc(j,e,r),i=A.projectedTime<.5?yj.point(o):yj.point(n),s=qF(o,n,0);return ju(i,lA.add(i,s))}var VF=15;function SV(j,A,e,t){let r=5/t,o=VF/t,n=A.cache.canvasRect;if(n&&(n.x-e.x>r||n.y-e.y>r||e.x-(n.x+n.width)>r||e.y-(n.y+n.height)>r))return null;let a=Wj.toBezierJS(A,A),i=j.convertPointToNode(A,e),s=-1,l=1/0,c=0;for(let F=0,R=a.length;F<R;F++){let v=a[F].project(i),P=v.d,T=v.t;P>=l||T===0||T===1||(l=P,s=F,c=T)}if(s===-1)return null;let u=a[s],p=u.get(c),f=u.get(.5),E=lA.distance(i,f)<o;return{id:A.id,segmentIndex:s,distance:l,projectedPoint:p,projectedTime:c,midPoint:f,midPointInRange:E}}function aB(j){return{strokeEnabled:j.strokeEnabled,strokeAlignment:j.strokeAlignment,strokeWidth:j.strokeWidth,strokeColor:j.strokeColor,lineJoin:j.lineJoin,lineCap:j.lineCap,strokeMiterLimit:j.strokeMiterLimit,strokeDashArray:j.strokeDashArray,strokeDashOffset:j.strokeDashOffset,fillEnabled:j.fillEnabled,fillType:j.fillType,fillColor:j.fillColor,fillLinearGradient:j.fillLinearGradient,fillRadialGradient:j.fillRadialGradient,fillImage:j.fillImage,fillImageResize:j.fillImageResize,fillImageOriginalName:j.fillImageOriginalName,fillImagePixelWidth:j.fillImagePixelWidth,fillImagePixelHeight:j.fillImagePixelHeight,fillImagePositionX:j.fillImagePositionX,fillImagePositionY:j.fillImagePositionY,fillImageTileSize:j.fillImageTileSize,boxShadows:j.boxShadows,opacity:j.opacity}}function sB(j,A){let e=j.getRect(A),t={width:e.width,height:e.height};if(!pA(A)||!Ce(A))return t;let r=Fo(A);if(r.perSide)r.top&&(t.height-=r.top),r.bottom&&(t.height-=r.bottom),r.right&&(t.width-=r.right),r.left&&(t.width-=r.left);else if(r.top){let o=r.top*2;t.width-=o,t.height-=o}return t.width=Math.max(1,t.width),t.height=Math.max(1,t.height),t}function UV(j,A,e,t){j.getNodesWithTrait(e,nj).forEach(o=>{let{descendantPaths:n}=ii(A,o,!0,e),a=n.valueSeq().toArray(),i=Wj.boundingBox(a),s={...i};t==="horizontal"?(s.x=i.x+i.width,s.width=-i.width):(s.y=i.y+i.height,s.height=-i.height);let l=s.width>-1&&s.width<1?1:s.width,c=s.height>-1&&s.height<1?1:s.height,u=[i.x,i.x+i.width],p=[s.x,s.x+l],f=[i.y,i.y+i.height],E=[s.y,s.y+c],F=l/i.width,R=c/i.height;n.forEach((S,v)=>{let P=S.pathSegments.map(H=>H.merge({x:Nj(H.x,u,p,!1),y:Nj(H.y,f,E,!1),handleOutX:H.handleOutX*F,handleOutY:H.handleOutY*R,handleInX:H.handleInX*F,handleInY:H.handleInY*R}));$(A.tree===j);let T=j.get(v);if(!T)return;let D={pathSegments:P,pathClosed:T.pathClosed},Q={pathSegments:jr(j,T,[D])[0],pathClosed:T.pathClosed},Z=T.updateForPath(Q);T.set(Z)})})}function WV(j,A,e){let{tree:t}=j;A.forEach(r=>{let o=t.getRect(r),n=e(o);if(n.width&&n.width<1&&(n.width=1),n.height&&n.height<1&&(n.height=1),RA(r))KF(j,r,n);else if(Wt(r))JF(j,r,n);else{let a=t.getParent(r.id),i=a?sB(t,a):null,s=r.updateForSize(n,i?{sizing:i,positioning:i,viewport:r.cache.viewportRect,layout:Je(a)}:null);t.current(r)?.set(s)}})}function KF(j,A,e){let{tree:t}=j,r=t.getParent(A.id),o=r?t.getRect(r):null,n=A.updateForSize(e,o?{sizing:o,positioning:o,viewport:null,layout:Je(r)}:null);n.sizeToFit=!1,t.current(A)?.set(n)}function JF(j,A,e){let{tree:t}=j,r=t.getRect(A),o=da.update(r,e,$o(A)?Y(A.aspectRatio):!1),n={...r,...o},a=n.width>-1&&n.width<1?1:n.width,i=n.height>-1&&n.height<1?1:n.height,s=[r.x,r.x+r.width],l=[n.x,n.x+a],c=[r.y,r.y+r.height],u=[n.y,n.y+i],p=a/r.width,f=i/r.height,{descendantPaths:E,descendantBasicShapes:F}=ii(j,A);E.forEach((R,S)=>{let P=jr(t,A,[R])[0].map(H=>H.merge({x:Nj(H.x+r.x,s,l,!1)-r.x,y:Nj(H.y+r.y,c,u,!1)-r.y,handleOutX:H.handleOutX*p,handleOutY:H.handleOutY*f,handleInX:H.handleInX*p,handleInY:H.handleInY*f})),T=ai(t,A,{pathSegments:P,pathClosed:!0});$(j.tree===t);let D=t.get(S);if(!D)return;let Q={pathSegments:jr(t,D,T)[0],pathClosed:D.pathClosed},Z=D.updateForPath(Q);D.set(Z)}),F.forEach((R,S)=>{if(R===null)return;let T=R.map(jA=>t.convertPointToNode(A,jA)).map(jA=>({x:Nj(jA.x+r.x,s,l,!1)-r.x,y:Nj(jA.y+r.y,c,u,!1)-r.y})).map(jA=>t.convertPointToCanvas(A,jA)),D=t.get(S);if(!D)return;let K=T.map(jA=>t.convertPointToNode(D,jA)),Q=q.boundingRectFromPoints(K),Z=q.center(Q),H=Na(D,Z),AA={x:H.x-Q.width/2,y:H.y-Q.height/2,width:Q.width,height:Q.height};D.set(AA)})}function lB(j,A,e,t,r,o){let{tree:n}=j,a=n.getNode(A.id),i=o.width>-1&&o.width<1?1:o.width,s=o.height>-1&&o.height<1?1:o.height,l=i/r.width,c=s/r.height;e.forEach((u,p)=>{let f=n.getNode(p);if(!f)return;let F={pathSegments:u.pathSegments.map(P=>P.merge({x:P.x*l,y:P.y*c,handleOutX:P.handleOutX*l,handleOutY:P.handleOutY*c,handleInX:P.handleInX*l,handleInY:P.handleInY*c})),pathClosed:u.pathClosed},S={pathSegments:iB(n,a,f,[F])[0],pathClosed:f.pathClosed},v=f.updateForPath(S);f.set(v)}),t.forEach((u,p)=>{if(u===null)return;let f=u.map(S=>({x:S.x*l,y:S.y*c})),E=n.getNode(p),F=f.map(S=>n.convertPointFromNodeToDescendant(a,E,S,!1)),R=q.boundingRectFromPoints(F);j.tree.get(p)?.set(R)})}function cB(j,A,e,t,r,o=n=>n.canvasMatrix()){let n=t.width>-1&&t.width<1?1:t.width,a=t.height>-1&&t.height<1?1:t.height,i=[e.x,e.x+e.width],s=[t.x,t.x+n],l=[e.y,e.y+e.height],c=[t.y,t.y+a],u=n/e.width,p=a/e.height,f=r?{x:0,y:0}:A.rect;A.descendantPaths&&A.descendantPaths.forEach((E,F)=>{let S=(r?E.pathSegments:Ad(A.canvasMatrix.inverse(),[E])[0]??[]).map(Q=>Q.merge({x:Nj(Q.x+f.x,i,s,!1)-f.x,y:Nj(Q.y+f.y,l,c,!1)-f.y,handleOutX:Q.handleOutX*u,handleOutY:Q.handleOutY*p,handleInX:Q.handleInX*u,handleInY:Q.handleInY*p})),v=r?{pathSegments:S,pathClosed:E.pathClosed}:{pathSegments:Ad(A.canvasMatrix,[{pathSegments:S,pathClosed:E.pathClosed}])[0]??[],pathClosed:E.pathClosed},P=j.get(F);if(!P)return;let D={pathSegments:jr(j,P,[v])[0],pathClosed:P.pathClosed},K=P.updateForPath(D);P.set(K)}),A.descendantBasicShapes&&A.descendantBasicShapes.forEach((E,F)=>{if(E===null)return;let S=(r?E:E.map(H=>vj.convertPoint(A.canvasMatrix.inverse(),H))).map(H=>({x:Nj(H.x+f.x,i,s,!1)-f.x,y:Nj(H.y+f.y,l,c,!1)-f.y})),v=r?S:S.map(H=>vj.convertPoint(A.canvasMatrix,H)),P=j.get(F);if(!P)return;let T=v.map(H=>vj.convertPoint(o(P).inverse(),H)),D=q.boundingRectFromPoints(T),K=q.center(D),Q=Na(P,K),Z={x:U6(Q.x-D.width/2),y:U6(Q.y-D.height/2),width:D.width,height:D.height};P.set(Z)})}function uB(j,A,e,t,r){if(e!==1)for(let[o]of t.parentsInitialState){let n=t.parentsInitialState.get(o);if(!n)continue;let a=[];for(let i of A)n.selectedNodeIds.has(i.id)&&a.push(i);kB(a,e,WF(j,o,e,t,r),!0)}}function pB(j,A){let e=new Map,t=new Map,r={},o=new Set;for(let n of j.tree.withoutDescendants(A)){let a=n.parentid;if(!a)continue;let i=j.tree.getNode(a);$(i,"Parent must exist"),HF(j,n,t,o),UF(j,n,i,e),r[a]??=[],r[a].push(n)}for(let[n,a]of e){let i=r[n];$(i,"Nodes must exist"),a.selectionBoundingFrame=j.tree.getBoundingFrameForNodes(i)}return{parentsInitialState:e,nodesInitialState:t,nonScalableNodes:o}}function HF(j,A,e,t){for(let{node:r,skipChildren:o}of A.walkWithSkipChildren()){if(e.has(r.id))continue;let n=r.id===A.id,a=j.tree.isInlineVectorNode(r),i=nj(r)&&(a||n);if(!nG(r,n)){t.add(r.id),o();continue}let s=i?ii(j,r):void 0,l=RA(r)?nB(j,r):void 0,c=RA(r)||i?jB(r.draftOrCurrent()):void 0,u=W(r)?QF(r):void 0;e.set(r.id,{rect:q.round(j.tree.getRect(r,!1),2),matrix:j.tree.transformMatrixToNode(r),codeComponentControlProps:u,scalableShapeStylesMap:c,...s,...l}),RA(r)&&o()}}function QF(j){let A=L.reactComponentForIdentifier(j.codeComponentIdentifier);if(!(!A||!A.properties))return j.getControlProps(A.properties)}function UF(j,A,e,t){let r=t.get(e.id)??{matrix:j.tree.transformMatrixToNode(e).invertSelf(),selectedNodeIds:new Set,selectionBoundingFrame:{x:0,y:0,width:0,height:0}};r.selectedNodeIds.add(A.id),t.set(e.id,r)}function WF(j,A,e,t,r){let o=t.parentsInitialState.get(A);$(o,"Parent must be present in initial state");let n=o.selectionBoundingFrame,a={...n,width:n.width*e,height:n.height*e};return{initialRect:n,resizedRect:a,engine:j,tree:j.tree,initialState:t,anchorPoint:r??{x:.5,y:.5}}}function kB(j,A,e,t){if(j.length===0)return!1;let r=!1;for(let o of j){if(e.initialState.nonScalableNodes.has(o.id))continue;let n=iG(o)&&kB(o.children,A,e,!1),a=zF(o,e,A,n,t);r||=a||n}return r}function zF(j,A,e,t,r){let o=rG(j,e,r),n=XF(j,A,e,t,r,o);return j.set(o),(n||t)&&AG(j,A,e,r),n}function XF(j,A,e,t,r,o){return XA(j)?YF(j,e,A,r,o):RA(j)?ZF(j,e,A,r,o):nj(j)?aG(j,e,A):W(j)?sG(j,e,A,r,o):sj(j)?mB(j,e,A,t,r,o):!1}function YF(j,A,e,t,r){let o=!1;if(!j.textFitViewBoxSize){oG(j,e.tree);let n=j.draftOrCurrent().updateForScale(A);Object.assign(r,n),o=!0}return j.widthType!==2&&(o=Vo("width",j,A,e,!1,t,r)||o),j.heightType!==2&&(o=Vo("height",j,A,e,!1,t,r)||o),o}function ZF(j,A,e,t,r){let o=e.initialState.nodesInitialState.get(j.id),n=o?.shapeContainerDescendantPaths,a=o?.shapeContainerDescendantBasicShapes,i=o?.scalableShapeStylesMap;return $(i,"Shape container styles should be available in initial state"),$(n,"Shape container paths should be available in initial state"),$(a,"Shape container shapes should be available in initial state"),lB(e.engine,j,n,a,j,{width:j.width*A,height:j.height*A}),Uc(e.tree,i,A),Vo("width",j,A,e,!0,t,r),Vo("height",j,A,e,!0,t,r),!0}function AG(j,A,e,t){if(t)jG(j,e,A);else if($A(j)){let r={};j.left&&(r.left=tA(j.left,e)),j.right&&(r.right=tA(j.right,e)),j.top&&(r.top=tA(j.top,e)),j.bottom&&(r.bottom=tA(j.bottom,e)),j.set(r)}}function jG(j,A,e){if(!$A(j)&&!Va(j))return;let t=e.initialState.nodesInitialState.get(j.id);$(t,"Node must be present in initial state");let r=j.parentid?e.initialState.parentsInitialState.get(j.parentid):void 0;$(r,"Node parent must be present in the initial state"),r.selectedNodeIds.size===1?eG(j,A,e,t):tG(j,e,t,r)}function eG(j,A,e,t){let r=t.rect,o={...r,width:r.width*A,height:r.height*A},a=nj(j)||RA(j)?j.clone({rotation:0}):j,i=Qs(r,e.anchorPoint),s=Qs(o,e.anchorPoint),l=vj.convertPoint(a.originAdjustedMatrix(null,r),i),c=vj.convertPoint(a.originAdjustedMatrix(null,o),s),u=lA.subtract(l,c),p=q.round(q.offset(o,u),2);if($A(j)){let{widthType:f,heightType:E,maxHeight:F,minHeight:R,maxWidth:S,minWidth:v,...P}=Ml(j.constraints(),p,e.tree.getParentSizeInfo(j,e.tree.getParent(j.id)),null,!1);j.set(P)}else j.set({x:p.x,y:p.y})}function tG(j,A,e,t){let r=lA.add(Qs(A.initialRect,A.anchorPoint),A.initialRect),o=lA.add(Qs(A.resizedRect,A.anchorPoint),A.resizedRect),n=lA.subtract(r,o),a=t.matrix??null,i=dB(a,A.initialRect),s=dB(a,q.offset(A.resizedRect,n)),l=[i.x,i.x+i.width],c=[s.x,s.x+s.width],u=[i.y,i.y+i.height],p=[s.y,s.y+s.height],f=e.rect,E={x:Nj(f.x,l,c,!1),y:Nj(f.y,u,p,!1)},F={x:Nj(f.x+f.width,l,c,!1),y:Nj(f.y+f.height,u,p,!1)},R=q.round(q.fromTwoPoints(E,F));if($A(j)){let S=Ml(j.constraints(),R,A.tree.getParentSizeInfo(j,A.tree.getParent(j.id)),null,!1);delete S.widthType,delete S.heightType,j.set(S)}else j.set({x:R.x,y:R.y})}function dB(j,A){if(!j)return A;let e=vj.convertPointsWithClipping(j,q.cornerPoints(A));return q.boundingRectFromPoints(e)}function rG(j,A,e){let t={};return Bt(j)&&(t.borderWidth=tA(j.borderWidth,A),t.borderBottom=tA(j.borderBottom,A),t.borderLeft=tA(j.borderLeft,A),t.borderTop=tA(j.borderTop,A),t.borderRight=tA(j.borderRight,A)),hr(j)&&(t.boxShadows=EB(j.boxShadows,A)),Ie(j)&&(t.strokeWidth=tA(j.strokeWidth,A)),lt(j)&&(t.padding=tA(j.padding,A),t.paddingBottom=tA(j.paddingBottom,A),t.paddingLeft=tA(j.paddingLeft,A),t.paddingTop=tA(j.paddingTop,A),t.paddingRight=tA(j.paddingRight,A)),$r(j)&&(t.radiusBottomLeft=tA(j.radiusBottomLeft,A),t.radiusBottomRight=tA(j.radiusBottomRight,A),t.radiusTopLeft=tA(j.radiusTopLeft,A),t.radiusTopRight=tA(j.radiusTopRight,A)),zt(j)&&(t.radius=tA(j.radius,A)),oa(j)&&(t.gridColumnMinWidth=tA(j.gridColumnMinWidth,A),t.gridColumnWidth=tA(j.gridColumnWidth,A),j.gridRowHeightType==="fixed"&&(t.gridRowHeight=tA(j.gridRowHeight,A))),Ce(j)&&(t.gap=fB(j.gap,A)),Nr(j)&&(t.formInputFontSize=$B(j.formInputFontSize,A),j.formInputFontLetterSpacingUnit==="px"&&(t.formInputFontLetterSpacing=tA(j.formInputFontLetterSpacing,A)),j.formInputFontLineHeightUnit==="px"&&(t.formInputFontLineHeight=tA(j.formInputFontLineHeight,A))),Nn(j)&&(t.blur=tA(j.blur,A,0),t.backgroundBlur=tA(j.backgroundBlur,A,0)),_e(j)&&j.fillType==="image"&&j.fillImageResize==="tile"&&(t.fillImageTileSize=tA(j.fillImageTileSize??1,A)),Bo(j)&&(t.minWidth=Hs(j.minWidth,A,e),t.maxWidth=Hs(j.maxWidth,A,e),t.minHeight=Hs(j.minHeight,A,e),t.maxHeight=Hs(j.maxHeight,A,e)),t}function mB(j,A,e,t,r,o){if(!Pe(j))return o.width=tA(j.width,A),o.height=tA(j.height,A),!0;let n=!1;return n=Vo("width",j,A,e,t,r,o)||n,n=Vo("height",j,A,e,t,r,o)||n,n}function oG(j,A){let e=j.getTextStylePresets(!1);for(let t of e){let r=A.getNode(t);je(r)&&j.draftOrCurrent().detachTextStylePreset(r,!1)}}function Vo(j,A,e,t,r,o,n){let a=j==="width"?"widthType":"heightType",i=A[a],s=t.initialState.nodesInitialState.get(A.id)?.rect;$(s,"node should have cached rect");let l=j==="width"?"gridItemFillCellWidth":"gridItemFillCellHeight";if(Ir(A)&&A[l]&&o)return n[l]=!1,n[j]=tA(s[j],e),n[a]=0,!0;switch(i){case 0:return n[j]=tA(A[j],e),!0;case 4:return n[j]=tA(A[j],e,4),!0;case 1:return o?(n[j]=tA(A[j],e,4),!0):!1;case 3:return o?(n[j]=tA(s[j],e),n[a]=0,!0):!1;case 2:if(!r){let u=t.tree.getNodeParent(A),f=(u&&Ke(u)?u.layout:void 0)==="grid"?s[j]:A[j];return n[j]=tA(f,e),n[a]=0,!0}return!1;case 5:return!0;default:iA(i)}}function nG(j,A){let e=W(j)?j.getSupportedLayout(L):void 0;return!(e?.width==="auto"&&e?.height==="auto"||IA(j)||ie(j)&&!A)}function iG(j){return!(!j.children||RA(j)||nj(j))}function tA(j,A,e=2){return Y(j)?mj(j*A,e):j}function fB(j,A){return Y(j)?tA(j,A):x(j)?pa(j,e=>tA(e,A)):j}function Hs(j,A,e){if(sA(j))return j;let[t,r]=Xp(j);return Number.isNaN(t)||r==="%"&&!e?j:Ot(tA(t,A,0),r)}function EB(j,A){if(!(!j||HA(j)))return j.map(e=>e.type==="realistic"?e:Ea(e,{x:tA(e.x,A),y:tA(e.y,A),spread:tA(e.spread,A)}))}function aG(j,A,e){let t=e.initialState.nodesInitialState.get(j.id);return t?(cB(e.tree,{canvasMatrix:t.matrix,rect:t.rect,descendantPaths:t.descendantPaths,descendantBasicShapes:t.descendantBasicShapes},e.initialRect,e.resizedRect,!0,r=>{let o=e.initialState.nodesInitialState.get(r.id);return $(o,"Basic shape initial state must exist"),o.matrix}),t.scalableShapeStylesMap&&Uc(e.tree,t.scalableShapeStylesMap,A),!0):!1}function Qs(j,A){return{x:j.width*A.x,y:j.height*A.y}}function sG(j,A,e,t,r){let o=sj(j)?mB(j,A,e,!1,t,r):!1,n=e.initialState.nodesInitialState.get(j.id)?.codeComponentControlProps;if(!n)return o;for(let a in n){let i=n[a];if(!(!i||HA(i.value)))switch(i.type){case"borderradius":r[QA(a)]={...i,value:cG(i.value,A)};break;case"padding":r[QA(a)]={...i,value:dG(i.value,A)};break;case"gap":r[QA(a)]={...i,value:fB(i.value,A)};break;case"boxshadow":r[QA(a)]={...i,value:EB(i.value,A)};break;case"font":r[QA(a)]={...i,value:pG(i.value,A)};break;case"border":r[QA(a)]={...i,value:kG(i.value,A)};break;case"array":case"boolean":case"collectionreference":case"color":case"slot":case"cursor":case"customcursor":case"date":case"enum":case"eventhandler":case"file":case"link":case"linkrelvalues":case"multicollectionreference":case"number":case"object":case"pagescope":case"richtext":case"scrollsectionref":case"string":case"transition":case"fusednumber":case"image":case"trackingid":case"vectorsetitem":break;default:iA(i)}}return o}function lG(j){return j.includes("%")}function cG(j,A){return HA(j)||lG(j)?j:pa(j,e=>tA(e,A))}function dG(j,A){return HA(j)?j:pa(j,e=>tA(e,A))}var uG={px:2,rem:3};function $B(j,A){if(sA(j))return j;let[e,t]=Y(j)?[j,"px"]:ua(j);return Ot(tA(e,A,uG[t]),t)}function pG(j,A){if(sA(j))return j;let e=$B(j.fontSize,A);return{...j,fontSize:e,lineHeight:j.lineHeight?.[1]==="px"?[tA(j.lineHeight[0],A),"px"]:j.lineHeight,letterSpacing:j.letterSpacing?.[1]==="px"?[tA(j.letterSpacing[0],A),"px"]:j.letterSpacing}}function kG(j,A){return!j||aA(j)?j:{...j,borderWidth:tA(j.borderWidth,A),borderTop:tA(j.borderTop,A),borderRight:tA(j.borderRight,A),borderBottom:tA(j.borderBottom,A),borderLeft:tA(j.borderLeft,A)}}var rd;(vt=>{function j(d){return d.some(m=>FB(m))}vt.canCopyNodes=j;function A(d){return d.some(m=>BB(m))}vt.canDuplicateNodes=A;function e(d,m){return j(m)&&a(d,m)}vt.canCutNodes=e;function t(d,m,k=void 0,B=!0){let{documentSettingsStore:I,codeGenerationStore:G,modalStore:y,canvasStore:C,scopeStore:b,treeStore:M}=d.stores,_=M.tree,O=_.withoutDescendants(_.getNodes(m)),fA=b.active,dA=O.length===1?O[0]:void 0;if(!sA(dA)&&Ia(dA)&&!IA(dA)&&pA(dA)&&eA(fA)){let cA=_.getRect(dA),pj=Qn(_,fA,dA,cA),Hj=vt.createVariant(d.stores,fA,dA,pj);return Hj?new Set([Hj.id]):void 0}let JA=O.find(cA=>IA(cA));if(JA){let cA=M.tree.getScopeNodeFor(JA);if(cA&&w(cA)){y.set({type:"DuplicateWebPage",source:"context_menu",duplicateFromId:cA.id});return}}let EA=O.map(cA=>_.getRect(cA)),uA=new Map,SA=new Set,aj=[],MA=new Map,bA=new Map,Jj=0;if(O.forEach((cA,pj)=>{if(!BB(cA))return;let Hj=_.getParent(cA.id);if(cn(cA))if(Hj&&W(Hj)){if(!Vp(Hj,L))return}else return;for(let jj of cA.walk())pA(jj)&&Jj++;let Aj=d.cloneNode(cA,!1,!0,uA);if(uA.set(cA.id,Aj.id),bA.set(cA.id,Aj.id),SA.add(Aj.id),MA.set(cA,Aj),cA.isMaster)Ec({});else if(cA.replicaInfo){let{master:jj}=cA.replicaInfo,Rj=jj&&_.getNode(jj);Rj&&rn(Rj)||Ec({})}else cu(cA)&&(!k||k.node&&du(k.node))&&gE(d,cA,uA);if(k){let jj=_.getParent(cA.id);if(k.node){let Rj=k.node;if(gA(k.node)&&(Rj=Ye(_,k.node),!Rj))return;if(Qt(d.tree,Rj,Aj,b.active.id,L)){let Oe=jj&&WA(jj)&&WA(Rj),Yj=jj&&pA(jj)&&pA(Rj);if(Oe||Yj)d.moveNode(Aj.id,Rj.id,k.insertionIndex);else if($A(Aj)){d.moveNode(Aj.id,Rj.id,k.insertionIndex);let Ao=_.getParentSizeInfo(Aj,Rj,!0,!1),dr=Aj.updateForSize(EA[pj]??{},Ao);jj||(dr.left=0,dr.top=0),d.tree.current(Aj)?.set(dr)}else vt.convertNodeToNewParent(d,Aj,jj,k.node,k.insertionIndex,cA);if($j(k.node)){Sc(d,Aj,k.node,Rj,SA,uA);let we=kA.getReplicaForTemplateNode(_,k.node);if(we){let Ao=he(we.id,Aj.id);bA.set(cA.id,Ao)}}}}else vt.convertNodeToNewParent(d,Aj,jj,k.node,k.insertionIndex,cA),WA(jj)&&EA[pj]&&d.tree.current(Aj)?.set(Aj.updateForSize(EA[pj],null))}}),!k){let cA=O.some(Hj=>_.isGroundNode(Hj)),pj=O.some(Hj=>Ut(Hj)&&Hj.resolveValue("rotation")!==0);if(O.length){let Hj=O.map(Qj=>_.convertFrameToCanvas(Qj)),Aj=q.merge(...Hj),jj,Rj=K(d,m),Oe=Q(_,O),Yj=O.some(Qj=>nj(Qj)),we=I.lastDuplicationMap,Ao=!1;if(!Yj&&Rj&&!Oe&&!pj&&we){let Qj=we.keys(),_6=d.tree.getBoundingFrameForNodes(_.getNodes(Qj));Ao=!0,jj=lA.subtract(Aj,_6)}let dr=jj||{y:0,x:0},P6=O[0];if(!Yj&&cA&&!Ao&&P6){let Qj=aE(_,b.active,P6,Aj,O.every(ht)?{x:d.tree.getRect(P6).width}:jj);dr=lA.subtract(Qj,Aj)}for(let Qj of O){let{x:_6,y:DR,width:NR,height:OR}=_.getRect(Qj),et=MA.get(Qj);if(!et)continue;let Zo=d.tree.getParent(Qj.id),An=d.tree.getParent(et.id);if(An&&Zo&&$j(Zo)){Sc(d,et,Zo,An,SA,uA);let T7=kA.getReplicaForTemplateNode(_,Zo);if(T7){let qR=he(T7.id,et.id);bA.set(Qj.id,qR)}}if(An&&WA(An))continue;let C7=_6+dr.x,v7=DR+dr.y,wR=d.tree.getParentSizeInfo(Qj,Zo),LR=et.updateForRect({rect:{x:nj(Qj)?C7:Math.round(C7),y:nj(Qj)?v7:Math.round(v7),width:NR,height:OR},parentSizeInfo:wR,constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:ae(d.tree,et,An)});d.tree.current(et)?.set(LR),cA&&_.isGroundNode(et)&&aj.push(et.rect())}}}I.lastDuplicationMap=bA;let Gj=[];for(let cA of MA.values())Ne(_,cA,uA,!1),ht(cA)&&Gj.push(cA);if(Gj.length&&G.createVectorSet(Gj),aj.length){let cA=q.merge(...aj);C.scrollToCenter(q.center(cA))}return B&&SA.size>0&&d.stores.selectionStore.set(SA,{sticky:!0}),Jj>0&&mA("layout_frame",{source:"duplication",count:Jj}),SA}vt.duplicateNodes=t;function r(d){if(d.length>=50)return!0;let k=d.length;return d.forEach(B=>{k+=Qc(B)}),k>=50}function o(d,m,k){let B=d.tree.withoutDescendants(m);function I(){let G=[],y=[];B.forEach(C=>{if(Be(C))if(_a(d.tree,C))y.push(C);else{let b=d.tree.get(C.originalid);b&&td(b)&&G.push(b.id)}else td(C)&&G.push(C.id)}),y.forEach(C=>C.set({visible:!1})),d.deleteNodes(G),d.stores.selectionStore.clear(),d.stores.treeStore.setHighlight(null)}k&&r(B)?d.stores.modalStore.set({type:"Confirmation",variant:"destructive",title:"Delete Selection",description:"You are about to delete the selected layers for all project collaborators.",confirmLabel:"Delete",onConfirm:I,source:"delete_node"}):I()}vt.deleteOrHideNodes=o;function n(d,m){d.tool.deleteAction?d.tool.deleteAction():m&&o(d,m,!0)}vt.deleteAction=n;function a(d,m){return d.tool.deleteAction?!!d.tool.canDelete&&d.tool.canDelete():!!m&&m.some(k=>EG(k))}vt.canDeleteOrHideNodes=a;function i(d,m){return at(m)?!1:oj(m)?Be(m):!uo(m)}vt.canRenameNode=i;function s(d,m){return m.filter(k=>i(d,k)).length===1}vt.canRename=s;function l(d,m){return d.stores.chromeStore.contentPanelTab!=="Pages"||d.stores.scopeStore.active.id===d.tree.root.homePageNodeId||m.length!==0?!1:w(d.stores.scopeStore.active)||hj(d.stores.scopeStore.active)}vt.canRenameActivePage=l;function c(d,m){if(l(d,m)){let k=d.stores.scopeStore.active.id,B=gr(d.tree,k)?.id||k;Es(B)}else m.length===1&&(d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",d.scheduler.runBeforeNextFrame(()=>{let k=document.querySelectorAll(".layerPanelPlaceholder.active");if(k.length===1&&k[0]){let B=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),I=k[0].parentElement;I&&I.dispatchEvent(B)}}))}vt.rename=c;async function u(d,m){if(!oi.isAvailable)return;let k=hA("generateLayerNames");PA({type:"add",key:"generate-layer-names",text:"Snapshotting layer\u2026",variant:"progress",duration:1/0});let B=await oi.whenAvailable({toastIfNot:!0},d);if(B){let I=await B.getImageData({nodeId:m.id,type:"image/png",pixelRatio:1});k.debug("imageData",I);let G=JSON.stringify(m.toJS()),y="Here is an image and the document structure for a webpage section. Please provide me a nice and short name for every node in this hierarchy to display in the layer panel. Make them specific to their visual content and avoid generic names like 'Frame' or 'Stack'. Also avoid numbering them, as they do not have to be unique.";PA({type:"add",key:"generate-layer-names",text:"Generating layer names\u2026",variant:"progress",duration:1/0});let C=await BE({messages:[{role:"user",content:y},{role:"user",content:I},{role:"user",content:G}],model:"google/gemini-2.0-flash-001",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"array",items:{type:"object",properties:{nodeId:{type:"string"},name:{type:"string"}},required:["nodeId","name"]}}});PA({type:"add",key:"generate-layer-names",text:"Updating layers\u2026",variant:"progress",duration:1/0}),await d.scheduler.processWhenReadyAsync(()=>{for(let b of C){let{nodeId:M,name:_}=b;if(typeof M!="string"||typeof _!="string")continue;let O=d.tree.get(M);k.debug("nodeId",O,_),O&&O.set({name:_})}}),PA({type:"remove",key:"generate-layer-names"})}}vt.generateLayerNames=u;function p(d,m){let k=d.tree,B=k.withoutDescendants(m),I=Zr(B);S(k,m,I)&&I7(d,I,"front")}vt.sendToFront=p;function f(d,m){let k=d.tree,B=k.withoutDescendants(m),I=Zr(B);R(k,m,I)&&I7(d,I,"back")}vt.sendToBack=f;function E(d,m){let k=d.tree,B=k.withoutDescendants(m),I=Zr(B);S(k,m,I)&&F7(d,I,1)}vt.sendForward=E;function F(d,m){let k=d.tree,B=k.withoutDescendants(m),I=Zr(B);R(k,m,I)&&F7(d,I,-1)}vt.sendBackward=F;function R(d,m,k){if(R7(m))return!1;if(!k){let B=d.withoutDescendants(m);k=Zr(B)}return G7(d,k,-1)}vt.sendBackwardEnabled=R;function S(d,m,k){if(R7(m))return!1;if(!k){let B=d.withoutDescendants(m);k=Zr(B)}return G7(d,k,1)}vt.sendForwardEnabled=S;function v(d,m){return nA(d,m,0)}vt.addFrame=v;function P(d,m){return nA(d,m,1)}vt.addStack=P;function T(d,m){let k=d.stores.scopeStore.active,B=d.tree.withoutDescendants(m);return B.length>1&&ZA(d,B)&&(!w(k)||B.every(I=>d.tree.isGroundNode(I)))}vt.canWrapInAutoSizedFrame=T;function D(d,m,k){let B=v(d,m);$(B!==void 0,"new frame ID must be defined");let I=d.tree.getNode(B);$(I!==null,"new frame must exist");let G=d.tree.withoutDescendants([I]);return H$(d,G,k),I}vt.wrapInAutoSizedFrame=D;function K(d,m){let{documentSettingsStore:k,selectionStore:B}=d.stores;if(!k.lastDuplicationMap||!Zn(m,B.ids))return!1;let I=[...k.lastDuplicationMap.values()];if(!Zn(B.ids,I))return!1;let G=[...k.lastDuplicationMap.keys()];return Zn(B.previousIds,G)}function Q(d,m){let k=d.getCommonGroundNode(m);return!!k&&WA(k)}function Z(d,m,k){if(k!==null){let B=m.flatMap(C=>d.convertCornerPointsToCanvas(C)),I=d.transformMatrixToNode(k),G=(Kl(k)?I:vj.flatProjectionMatrix(I)).invertSelf(),y=B.map(C=>vj.convertPoint(G,C));return q.roundToOutside(q.boundingRectFromPoints(y))}return q.roundToOutside(q.merge(...m.map(B=>d.convertFrameToCanvas(B))))}vt.getUntransformedBoundingRect=Z;function H(d,m,k,B,I,G){let y={top:k.y,left:k.x,width:k.width,height:k.height,fillEnabled:!1},C=I.length===1?I[0]:null;$(C!==void 0,"node must be defined",I),B&&Object.assign(y,AA(m,k,B,C,G));let b=B===null,M=w(d.stores.scopeStore.active);return y.overflow=b||M?Ue():"visible",y}function AA(d,m,k,B,I){let G=d.getViewportRect(k),y=d.getRect(k),C=B?d.getParentSizeInfo(B,k):{sizing:y,positioning:y,viewport:G,layout:Je(k)},b=!!B&&$A(B),M=jA(B,I),_=_k({rect:m,parentSizeInfo:C,currentConstraints:M,constraintsLocked:b,shouldGuessPinToBottom:It(d,null,k),shouldGuessPinToRight:ae(d,null,k),floatingPosition:null});return I&&k?{...Io(B,k),...N(B),..._,widthType:Ce(k)?3:1,heightType:2,width:1,left:0}:{...Io(B,k),...N(B),..._}}function jA(d,m){let B=!!d&&$A(d)?d.constraints():void 0;if(!B)return;let I={...B};return m?(I.widthType===5&&(I.widthType=2),I.heightType===5&&(I.heightType=2)):(tn(I.widthType)&&(I.widthType=0),tn(I.heightType)&&(I.heightType=0)),I}function N(d){if(!(!d||!sj(d)))return{width:d.width,height:d.height}}function z(d,m,k,B,I,G,y,C,b){let M=G?.id??Ij;switch(m){case 0:{let _=d.createFrame(M,{id:k,...b},B);return d.moveNode(_.id,M,y),$(_&&TA(_),"Fail to create a wrapping frame: the created frame should have the `children` field"),C.forEach(O=>{let fA=Yo(d.tree,O,G,_);d.moveNode(O.id,_.id),d.tree.current(O)?.set(fA)}),_}case 1:{let _=J(d,k,M,b,C,I);return d.moveNode(_.id,M,y),_}case 2:{let _=d.createShapeContainer(M,{id:k,...b});return d.moveNode(_.id,M,y),$(_&&TA(_),"Fail to create a wrapping frame: the created frame should have the `children` field"),C.forEach(O=>{let fA=Yo(d.tree,O,G,_);d.moveNode(O.id,_.id),d.tree.current(O)?.set(fA)}),_}default:iA(m)}}function J(d,m,k,B,I,G,y){let C=Pc(d,I,G),b=d.createNode(Me,{id:m,...B,...C},k,y);$(ve(b),"Fail to create stack: the created node should have stack layout");let{stackDirection:M}=C;return HE(d,m,G,I,M),b}function nA(d,m,k){let B=d.tree;if(!ZA(d,m))return;let I=B.sortVisually(B.withoutDescendants(m)),G=I[0]?B.getParent(I[0].id):null,y=G&&$j(G),C=y?d.tree.getNode(G.originalid):G,b=!0,M=y?I.map(uA=>{if(!oj(uA))return uA;let SA=d.tree.getNode(uA.originalid);return $(SA,"Fail to create a wrapping frame: the original node must exist"),b&&(b=!SA.cache.visible),SA}):I,_=G?.children.findIndex(uA=>I.includes(uA))??-1,O=B.newId(),fA=Z(B,M,C),dA=H(d,B,fA,C,M,k===1),JA=z(d,k,O,M[0]?.id,fA,C,_,M,dA),EA=O;if(y){$(G,"Fail to create a wrapping frame: parentNode should not be null"),$(gA(G),"Fail to create a wrapping frame: parentNode should be a replica node"),b&&zn(d,JA,G,C);let uA=kA.getReplicaForTemplateNode(d.tree,G);$(uA,"Fail to create a wrapping frame: replica must exist");let SA=Z(B,I,G),aj=H(d,B,SA,G,I,k===1);Vn(B,uA,JA.id,aj),kA.replicaWithChanges(d.tree,uA.draftOrCurrent());let MA=he(uA.id,O);EA=MA;let bA=d.tree.get(MA);if($(bA&&TA(bA),"Fail to create a wrapping frame: replica wrapping node should exist and should have the `children` field"),k===0||k===2)I.forEach(Jj=>{let Gj=Yo(B,Jj,G,bA);d.tree.current(Jj)?.set(Gj)});else if(k===1){$(pA(JA),"Fail to create a wrapping frame: the wrapping node should be a FrameNode"),$(ve(JA),"Fail to create a wrapping frame: the wrapping node should have stack layout");let Jj=Pc(d,I,SA);Vn(B,uA,JA.id,Jj),KE(d,JA,Jj.stackDirection,I,SA)}}return d.stores.selectionStore.set(EA),O}function BA(d){return $n(d)||DA(d)||bj(d)||ca(d)||at(d)||cn(d)?!1:oj(d)?Be(d):!0}function ZA(d,m){if(m.length===0)return!1;switch(d.tool.enum){case 0:case 1:case 6:break;default:return!1}if(!m.every(y=>BA(y)))return!1;let k=d.tree,B=k.withoutDescendants(m),[I,G]=B.reduce(([y,C],b)=>{let M=k.isInlineVectorNode(b)||!nj(b)&&!bj(b),_=B[0]?k.getParentId(B[0]):void 0,O=k.getParentId(b);return[y&&_===O,C&&M]},[!0,!0]);return I&&G}vt.wrappingEnabled=ZA;function zA(d){return d.some(ut)}vt.overflowEnabled=zA;function xj(d){d.stores.chromeStore.removePanelOverrides(),d.stores.chromeStore.chromeIsVisible=!0,d.stores.chromeStore.pagesExpanded=!0,d.stores.chromeStore.contentPanelTab="Pages";let m=new Set(d.stores.scopeStore.getDesignPageNodes().map(B=>B.name??"")),k=d.createNode($m,{name:Pj("Design",m,{startIndex:m.size+1,omitCountIfFirst:!0})},d.tree.root.id);return d.stores.scopeStore.select(k.id,{keepHistory:!1}),d.scheduler.runAtEndOfFrame(()=>Es(k.id)),k.id}vt.createDesignPage=xj;function uj(d){d.stores.chromeStore.removePanelOverrides(),d.stores.chromeStore.chromeIsVisible=!0,d.stores.chromeStore.pagesExpanded=!0,d.stores.chromeStore.contentPanelTab="Pages";let m=new Set(d.stores.scopeStore.getCanvasPageNodes().map(G=>G.name??"")),k=d.createNode(yk,{name:Pj("Canvas",m,{startIndex:m.size+1,omitCountIfFirst:!1})},d.tree.root.id),B=Sm("iPhone_390_844"),I=d.createFrame(k.id,{width:B.screenWidth,height:B.screenHeight,name:B.title,framePreset:B.id,isScreen:!0});d.stores.codeGenerationStore.updateComponent(I.id).catch(GA),d.stores.scopeStore.select(k.id,{keepHistory:!1}),Yf({pageId:k.id}),d.scheduler.runAtEndOfFrame(()=>Es(k.id))}vt.createCanvasPage=uj,vt.toggleContentManagementScope=d=>{let{chromeStore:m,selectionStore:k,scopeStore:B,analyticsStore:I,siteSettingsStore:G,codeEditorStore:y}=d.stores,C=m.mainView;if(C===2){B.selectPreviousActiveScope();return}switch(C){case 0:d.cancelTool();break;case 5:m.setLocalizationsVisible(!1);break;case 6:I.close();break;case 4:G.close();break;case 1:y.closeEditor();break;case 3:break;default:iA(C)}let b=d.tree.getContentManagementNode()?.loaded;if(b&&b.children.length>0){let M=B.active,_=k.nodes.at(0);B.select(b.id,{keepHistory:!1});let O=$G(d,M,_);if(O){k.set(O);return}if(k.ids.length===0){let fA=b.children[0];fA&&k.set(fA.id)}}else m.toggleContentManagementSidebar()};function ue(d,m){d.stores.chromeStore.chromeIsVisible=!0,d.stores.scopeStore.select(Gn,{keepHistory:!1}),d.stores.selectionStore.set(m)}vt.openContentCollection=ue;function pe(d,m,k,B){d.stores.modalStore.set({type:"CreateComponent",source:m,onSuccess:I=>{if(wj(I.name)||wj(d.tree.getEntityRootNode()))return;let G=hs(d.tree,I.name,k??bn);wr(d.tree,G,I.id),B?.(I)}})}vt.makeComponent=pe;function cr(d,m){return xR(d,m)}vt.canMakeComponent=cr;function wi(d,m){if(m.length!==1||Rr(d.stores.scopeStore.active))return;let k=m[0];k&&ea(k)&&kA.canMakeMaster(k)&&d.tree.current(k)?.set({isMaster:!0,replicaInfo:null,originalid:null})}vt.makeMaster=wi;function v6(d,m){for(let k of m)if(k.originalid&&gA(k)&&kA.overrideKeys(d,[k]).size>0)return!0;return!1}vt.canResetToMasterValues=v6;function k7(d,m){for(let k of m){if(!k.originalid)continue;let I=kA.getReplicaForTemplateNode(d,k);I&&kA.resetOverrides(d,I,k)}}vt.resetToMasterValues=k7;function m7(d,m,k){for(let B of m){if(!gA(B))continue;let I=kA.getReplicaForTemplateNode(d,B);I&&kA.resetOverridesByProperty(d,I,B,k)}}vt.resetPropertiesToMasterValues=m7;function f7(d,m){if(m.length===0)return!1;for(let k of m){if(Ej(k))return!1;if(Ia(k)){let B=d.tree.getScopeNodeFor(k);if(!B)return!1;if(eA(B)){let{hover:I,pressed:G}=B.getGesturesForTopLevelVariant(k);return!(I||G)}return w(B)&&!IA(k)}if(dj(k))return!0}return!1}vt.canDetachFromMaster=f7;function T6(d,m){let k=new Map;m.filter(dj).forEach(I=>{if(!Js(I,{allowVariants:!0}))return;let G=I.clone({parentid:null});G.replicaInfo=null,up(G)&&(G.isVariant=void 0);for(let b of G.walk())b.originalid=null;$(I.id!==G.id),d.tree.insertNode(G);let y=d.tree.getParent(I.id)||d.stores.scopeStore.active,C=y.children.indexOf(I);d.tree.removeNode(I),d.moveNode(G.id,y.id,C),d.tree.current(G)?.set(G.constraintValues()),k.set(I.id,G.id)}),Ne(d.tree,d.tree.root,k,!1);let B=d.stores.selectionStore.ids.map(I=>k.get(I)??I);return d.stores.selectionStore.set(B),k}vt.detachFromMaster=T6;function Li(d,m){if(!qi(m))return;let k=Xo(m);m.filter(vo).forEach(I=>I.set({visible:!k})),d.stores.treeStore.setHighlight(Ij)}vt.visibility=Li;function qi(d){return d.some(vo)}vt.visibilityEnabled=qi;let Xo=d=>d.every(m=>m.isVisible());function Vi(d){return Xo(d)?"Hide":"Show"}vt.visibilityTitle=Vi;function jv(d,m){let k=d.withoutDescendants(m);if(!hR(k))return;let B=!E7(k),I=new Set;for(let G of k){if(!Pr(G))continue;let y=G.cache.lockedByParent,C=B===y?void 0:B;G.set({locked:C});for(let b of G.descendants())I.add(b)}for(let G of I)Pr(G)&&G.locked!==void 0&&G.set({locked:void 0})}vt.toggleLock=jv;function hR(d){return d.some(Pr)}vt.toggleLockEnabled=hR;function E7(d){return d.some(m=>Pr(m)&&Yt(m))}function ev(d){return E7(d)?"Unlock":"Lock"}vt.toggleLockTitle=ev;function tv(d){return d.every(ht)}vt.copyURLEnabled=tv;function rv(d){return d.length>0&&d.every(I=>$7(I))?`Remove ${d.length>1?"Viewboxes":"Viewbox"}`:`Remove ${d.length>0&&d.find(I=>!WA(I))===void 0?"Stack":"Frame"}${d.length>1?"s":""}`}vt.removeFrameTitle=rv;function ov(d,m){gR(d,m)&&SR(d,m)}vt.removeFrame=ov;function gR(d,m){if(m.length===0)return!1;let k=d.stores.scopeStore.active.id;return m.every(B=>{if(!pA(B)&&!WA(B)&&!$7(B)||!B.children||B.children.length===0||Zj(B)||dj(B)||oj(B)&&!Be(B))return!1;let I=d.tree.getParent(B.id);if(!I)return!0;for(let G of B.children)if(!Qt(d.tree,I,G,k,L))return!1;return!0})}vt.removeFrameEnabled=gR;function $7(d){return RA(d)&&!ht(d)}function nv(d,m){m.forEach(k=>{let B=d.getParentSizeInfo(k);if(k.intrinsicWidth!==null&&k.intrinsicHeight!==null){let I={width:k.intrinsicWidth,height:k.intrinsicHeight},G=I.width/I.height;if($n(k))k.set(uf(k,I,{aspectRatio:G}),d);else if($o(k)&&k.aspectRatio){k=k.set({aspectRatio:null},d);let y=k.updateForSize(I,B);y.aspectRatio=G,k.set(y,d)}else k.set(k.updateForSize(I,B),d)}})}vt.resetToIntrinsicSize=nv;function Yo(d,m,k,B){let I=d.getRect(m),G=d.getOriginPoint(m),y=d.convertPointToCanvas(m,{x:I.width*G.x,y:I.height*G.y});if(B){let _=d.transformMatrixToNode(B),O=Kl(B)?_:vj.flatProjectionMatrix(_);y=vj.convertPoint(O.inverse(),y)}let C={...I,x:y.x-I.width*G.x,y:y.y-I.height*G.y},b=m.updateForRect({rect:C,parentSizeInfo:d.getParentSizeInfo(m,B),constraintsLocked:!1,shouldGuessPinToBottom:B?It(d,m,B):!0,shouldGuessPinToRight:ae(d,m,B)});if(WA(B)||(b.widthType===3&&(b.widthType=0,b.width=I.width),b.heightType===3&&(b.heightType=0,b.height=I.height)),Ut(m)){let _=m.resolveValue("rotation")-GR(d,k,B);_!==0&&(b.rotation=_)}return B&&Ce(B)&&!Ma(m)&&!Da(m)&&(b.top=null,b.left=null,b.bottom=null,b.right=null),Object.assign(b,Io(m,B)),b}vt.convertNodeToNewParentUpdate=Yo;function iv(d,m,k,B,I=-1,G){let{tree:y}=d,C=m;if(oj(m)&&(C=Ye(y,m),!C))return null;let b=B;if(B&&gA(B)&&(b=Ye(y,B),!b))return null;let M=k;if(k&&gA(k)&&(M=Ye(y,k),!M))return null;let _=Yo(y,G??C,oj(m)?M:k,oj(m)?b:B);if(d.tree.current(C)?.set(_),d.moveNode(C.id,b?b.id:d.stores.scopeStore.active.id,I),C.id!==m.id){$(k,"Current parent must exist when editing variants");let fA=kA.getReplicaForTemplateNode(y,k);$(fA,"The current parent should located in a variant node");let dA=B?kA.getReplicaForTemplateNode(y,B):null;if(fA.id===dA?.id){let JA=Yo(y,m,k,B);y.current(m)?.set(JA)}}return{originalNode:C,originalCurrentParent:M,originalNewParent:b}}vt.convertNodeToNewParent=iv;function B7(d,m){if(!no(d)&&!Yt(d)&&(m.push(d.id),!!d.children))for(let k of d.children)B7(k,m)}function h7(d,m){let k=new Set;return m.forEach(B=>{let I=d.getParent(B.id);I&&k.add(I.id)}),k}function av(d,m){let k=d.withoutDescendants(d.getNodes(m));return h7(d,k).size>0}vt.canSelectAncestor=av;function sv(d,m){g7(d,m,"parent")}vt.selectParent=sv;function lv(d,m){g7(d,m,"groundNode")}vt.selectGroundNode=lv;function g7(d,m,k){let{tree:B}=d,I=B.withoutDescendants(B.getNodes(m)),G=null;if(k==="groundNode"){let _=new Set(I.map(O=>B.getGroundNodeFor(O).id));_.size>0&&(G=Array.from(_))}else{let _=h7(B,I);_.size>0&&(G=Array.from(_))}if(!G)return!1;let{selectionStore:y,overlayStore:C,treeStore:b}=d.stores;y.set(G,{sticky:!0,switchToLayers:!0});let M=I.length===1?I[0]:null;return M&&C.activeOverlays.has(M.id)&&C.exitEditMode(y,!1),b.setHighlight(null),!0}vt.selectAncestor=g7;function cv(d,m){let k=d.tree,B=[];if(d.tool.selectAll){d.tool.selectAll();return}else{let I=m.map(G=>{let y=k.get(G);if(nj(y)){let b=rf(k,y);return b&&k.isGroundNode(b)?b.id:Ij}let C=k.getGroundFrameAncestor(G,!0);return C!==null?C.id:Ij});if(new Set(I).size===1&&I[0]!==null){let G=I[0];B=k.getSubtreeNodes(G).filter(y=>Yt(y)?!1:y.id!==G).map(y=>y.id)}if(B.length===0)for(let G of d.stores.scopeStore.active.children)B7(G,B)}d.stores.selectionStore.set(B)}vt.selectAll=cv;function dv(d,m){let k=new Set;for(let B of m){let I=d.tree.get(B);if(!I)continue;let G=d.tree.getSiblingsIncludingSelf(I);for(let y of G)k.add(y.id)}d.stores.selectionStore.set(k)}vt.selectAllSiblings=dv;function uv(d,m){return d.tree.getNodes(m).some(k=>TA(k)&&k.children.length>0)}vt.canSelectChildren=uv;function pv(d,m){let k=new Set;for(let B of m){let I=d.tree.get(B);if(!I)continue;let G=Ro(I);for(let y of G)k.add(y.id)}k.size>0&&d.stores.selectionStore.set(k)}vt.selectAllChildren=pv;function kv(d,m){let k=m.length>0?d.tree.getNodes(m):d.stores.scopeStore.active.getGroundNodes(),B=[];k.map(C=>{qj(C)?B.push(...d.tree.getSiblingsIncludingSelf(C)):B.push(C)});let I=new Set,G=new Set,y=C=>{if(!I.has(C.id)){if(qj(C)&&G.add(C.id),C.children)for(let b of C.children)y(b);I.add(C.id)}};for(let C of B)y(C);d.stores.selectionStore.set(G)}vt.selectAllTextNodes=kv;function mv(d,m){let[k]=d.tree.getNodes(m);if(!k||!qj(k))return;let B=[],I=XA(k)?dt(k.getTextStylePresets(!1)):void 0,G=dt(k.getFonts(!1)),y=dt(k.getFontSizes(!1).map(b=>kn(b)?Ot(...b):Y(b)?Ot(b,"px"):b)),C=dt(k.getTextColors(!1));if(!(wt(I)||ke(I))&&!(wt(G)||ke(G))&&!(wt(y)||ke(y))&&!(wt(C)||ke(C))){for(let b of d.stores.scopeStore.active.walk())$j(b)||!qj(b)||(XA(b)?dt(b.getTextStylePresets(!1)):void 0)!==I||dt(b.getFonts(!1))!==G||dt(b.getFontSizes(!1).map(dA=>kn(dA)?Ot(...dA):Y(dA)?Ot(dA,"px"):dA))!==y||dt(b.getTextColors(!1))!==C||B.push(b);d.stores.selectionStore.set(B)}}vt.selectAllTextNodesWithSameFontStyles=mv;function fv(d,m){let k=d.tree.getNodes(m);$(m.length===1,"Cannot have multiple layers selected");let[B]=k;if(!B||!pA(B))return;let I=[],y=kp(d.tree,B.id)??d.stores.scopeStore.active;for(let C of y.walk())pA(C)&&RR(B,C,d.tree)&&I.push(C);d.stores.selectionStore.set(I)}vt.selectAllLayersWithSameFill=fv;function RR(d,m,k){if(Ht(d)&&!d.fillEnabled||Ht(m)&&!m.fillEnabled)return!1;let{fillType:B}=d;if(B!==m.fillType||B===void 0)return!1;switch(B){case"color":return!x(d.fillColor)||!x(m.fillColor)?!1:ja.equals(yc(d.fillColor,k,void 0),yc(m.fillColor,k,void 0));case"linear-gradient":return d.fillLinearGradient&&m.fillLinearGradient?d.fillLinearGradient.equals(m.fillLinearGradient):!1;case"radial-gradient":return d.fillRadialGradient&&m.fillRadialGradient?d.fillRadialGradient.equals(m.fillRadialGradient):!1;case"conic-gradient":return d.fillConicGradient&&m.fillConicGradient?d.fillConicGradient.equals(m.fillConicGradient):!1;case"image":return d.fillImage===m.fillImage;default:iA(B)}}function R7(d){return d.some(m=>Oa(m)?oj(m)?!Be(m):!1:!0)}function Zr(d){let m={};return d.forEach(k=>{let B=k.parentid?k.parentid:fn,I=m[B];I||(I=[],m[B]=I),I.push(k)}),m}function I7(d,m,k){let B=d.tree;for(let I in m){let G=I===fn?B.root:B.get(I);if(!G||!m[I])continue;let y=B.sortVisually(m[I]);k==="back"&&y.reverse();let C=k==="front"?-1:0,b=$j(G)&&Te(G);y.forEach(M=>{let _=M.originalid?B.get(M.originalid):M;$(_,"Cannot send",M.id,"backward/forward: original node must exist."),b&&Oa(_)?vl(_.id,G,C):d.tree.moveNodeIndex(_,C)})}}function IR(d,m,k){let B=d.tree.getParent(k.id);if(!B)return null;let I=B.children.indexOf(k),G=m==="backward"?I-1:I+1,y=B.children[G];if(!y||!ze(y))return null;let C=d.tree.convertFrameToCanvas(k),b=d.tree.convertFrameToCanvas(y);if(m==="backward")return{...C,y:b.y};let M=b.height-C.height;return{...C,y:b.y+M}}function FR(d,m,k){let B=IR(d,m,k),{canvasStore:I}=d.stores;!B||q.containsRect(I.getCanvasVisibleRectTakingOverlaysIntoAccount(),B)||I.zoomToCenter(B,{zoom:I.zoom,maxZoom:.5,animated:!0})}function F7(d,m,k){let B=d.tree,I=Object.keys(m).length===1;for(let G in m){let y=G===fn?B.root:B.get(G);if(!y||!TA(y))continue;let C=$j(y)&&Te(y),b=m[G],M=I&&b?.length===1,_=Gr(y)?y.getChildrenInVisualOrder():y.children,O=!1;for(let fA=0,dA=_.length;fA<dA;fA++){let JA=k===1?dA-fA-1:fA,EA=_[JA];if(!b?.includes(EA))O=!0;else if(O)if(C&&Oa(EA))$(EA.originalid,"Cannot send nodes: nodes in a replica variant parent must have originalid."),vl(EA.originalid,y,JA+k);else{M&&Ss(B,EA)&&FR(d,k===-1?"backward":"forward",EA);let SA=EA.originalid?B.get(EA.originalid):EA,aj=y.originalid?B.get(y.originalid):y;$(SA,"Cannot send node",EA.id,": original child node does not exist."),$(aj,"Cannot send node",y.id,": original parent node does not exist."),d.moveNode(SA.id,aj.id,JA+k)}}}}function G7(d,m,k){for(let B in m){let I=B===fn?d.root:d.get(B);if(!I||!TA(I))continue;let G=m[B],y=Gr(I)?I.getChildrenInVisualOrder():I.children,C=!1;for(let b=0,M=y.length;b<M;b++){let _=k===1?M-b-1:b,O=y[_];if(!G?.includes(O))C=!0;else if(C)return!0}}return!1}function GR(d,m,k){let B=0,I=0;return m&&(B=d.totalAncestorRotation(m)),k&&(I=d.totalAncestorRotation(k)),Math.round(I-B)}function Ev(d){if(d.length!==1)return!1;let m=d[0];return m&&xo(m)&&!m.originalid}vt.reversePathDirectionEnabled=Ev;function $v(d,m){let k=d.current(m);k&&k.set({pathSegments:Wj.reverse(k.pathSegments)})}vt.reversePathDirection=$v;function Bv(d,m){let k=Yn(m,d);return k.length===0?!1:k.every(B=>nj(B)&&!B.originalid&&Ro(B).length>0)}vt.canUngroup=Bv;function SR(d,m){if(m.length===0)return;let k=d.tree,B=k.sortVisually(Yn(m,k)),I=k.withoutDescendants(B),G=[];return I.forEach(y=>{if(!TA(y))return;let C=y,b=null;if(oj(y)){if(C=Ye(k,y),!C)return;b=kA.getReplicaForTemplateNode(k,y)}let M=k.getParent(y.id);if(y.children.length>0){let _=k.getIndex(y),O=C?.id??y.id;[...Ro(y)].forEach((dA,JA)=>{let EA=dA;if(oj(dA)&&(EA=Ye(k,dA),!EA))return;if(ie(EA)){k.removeNode(EA);return}let uA=M,SA=uA;if(uA&&gA(uA)&&(SA=Ye(k,uA),!SA))return;let aj=vt.convertNodeToNewParentUpdate(k,EA,C,SA);if(d.moveNode(EA.id,SA?.id??null,_+JA,O),d.tree.current(EA)?.set(aj),O=EA.id,b){let MA=vt.convertNodeToNewParentUpdate(k,dA,y,uA);d.tree.current(dA)?.set(MA)}G.push(dA.id)}),d.deleteNode(C.id)}}),d.stores.selectionStore.set(G),G}vt.ungroup=SR;function hv(d){return!d.hasPreferredSize(L)}vt.canSetDefaultSize=hv;function gv(d,m){if(m.hasPreferredSize(L))return;let k=m.getPreferredSize(L),B={aspectRatio:null};k.width==="auto"?(B.width=1,B.widthType=2):Y(k.width)&&(B.width=k.width,B.widthType=0),k.height==="auto"?(B.height=1,B.heightType=2):Y(k.height)&&(B.height=k.height,B.heightType=0),$A(m)&&Y(m.top)&&Y(m.bottom)&&(B.bottom=null),$A(m)&&Y(m.left)&&Y(m.right)&&(B.right=null),v$(m,B,"context_menu_default_size_item"),m.set(B,d.tree)}vt.setDefaultSize=gv;function yR(d,m){if(!d.stores.toolStore.isDefaultToolActive)return!1;let k=Yn(m,d.tree);return k.length===0?!1:k.every(B=>nj(B)&&!B.originalid)}vt.canJoinInGroup=yR;function Rv(d,m){let k=d.tree;if($(m.length>0,"No nodes"),!yR(d,m))return;let B=Yn(m,k),I=k.sortVisually(k.withoutDescendants(B)),G=I[0],y=G?k.getParent(G.id):void 0,C=y?y.id:Ij,b=G?k.getIndex(G):void 0,M=k.newId();d.createShapeGroup(C,{id:M},b),I.forEach(_=>{let O=vt.convertNodeToNewParentUpdate(k,_,k.getParent(_.id),y);d.moveNode(_.id,M),d.tree.current(_)?.set(O)}),d.stores.selectionStore.set(M)}vt.joinInGroup=Rv;function Iv(d,m){if(m.originalid)return null;let k={width:m.width,height:m.height},B=G$(m.svg,ts.createEmpty,k,m);if(B){B.name=m.name||m.originalFilename,B.parentid=m.parentid;let I=d.cloneNode(B),G=m.parentid===null,y=G?"rgb(255,255,255)":"transparent",{aspectRatio:C,...b}=m.constraintValues();d.tree.current(I)?.set({...b,width:B.width,height:B.height,fillEnabled:G,fillColor:y});let M=d.tree.getParent(m.id);if(M!==null&&TA(M)){let _=M.children.indexOf(m);d.moveNode(I.id,M.id,_)}return S7(d,I.id,k),d.deleteNode(m.id),I.id}return null}vt.convertSVGToShape=Iv;function S7(d,m,k){let B=d.tree.get(m);if(!RA(B))return;let I=B.width>=B.height?"width":"height",G=I==="width"?"height":"width",y=k[I]/B[I];if(y===1)return;uB(d,[B],y,pB(d,[B]),bR(B));let C=d.tree.current(B);$(C,"Node must exist after scaling");let b=k[G]-C[G];if(b===0)return;C.set({[G]:k[G]});let M=G==="width"?"x":"y";for(let _ of C.children){let O=d.tree.current(_);!O||!Va(O)||O.set({[M]:O[M]+b/2})}}vt.scaleVector=S7;function bR(d){let m=d.constraints(),k=0,B=0;return m.top===!1&&m.bottom===!1?B=.5:m.top===!1&&(B=1),m.left===!1&&m.right===!1?k=.5:m.left===!1&&(k=1),{x:k,y:B}}function Fv(d,m){if(m.length>1)return!1;let k=kA.getReplicaForTemplateNode(d,m[0]);if(!k)return!1;let B=kA.getMaster(d,k);if(no(B))return!1;for(let I=0,G=m.length;I<G;I++){let y=m[I];if(kA.overrideKeys(d,[y]).size>0)return!0}return!1}vt.canUpdateMasterFromInstance=Fv;function Gv({tree:d},m){function k(b,M){for(let _ of["id","update","cache","children","mutable","parentid","originalid","isMaster","isVariant","isBreakpoint","replicaInfo","duplicatedFrom","gesture"])delete b[_];if(M)for(let _ of kA.positionKeysToIgnore)delete b[_];return b}function B(b,M){let _;if(M)for(let O of kA.positionKeysToIgnore)b[O]!==void 0&&(_=_||{},_[O]=b[O]);return b.gesture&&(_||(_={}),_.gesture=b.gesture),_}let I=kA.getReplicaForTemplateNode(d,m[0]);if(!I)return;let G=kA.getMaster(d,I);if(no(G))return;let y={...I.replicaInfo.overrides},C={...I.replicaInfo,overrides:y};for(let b=0,M=m.length;b<M;b++){let _=m[b];if(!_?.originalid)continue;let O=d.get(_.originalid),fA=k(_.raw(),dj(_));O?.set(fA);let dA=B(y[_.originalid]??{},dj(_));dA?y[_.originalid]=dA:delete y[_.originalid]}I.asDraft().replicaInfo=C}vt.updateMasterFromInstance=Gv;function Sv(d,m){let k=y7(d,m);return!k||rn(k)?0:lu(k)?2:1}vt.canGoToMaster=Sv;let y7=(d,m)=>{let k=null;for(let I=0,G=m.length;I<G;I++){let y=m[I],C=kA.getReplicaForTemplateNode(d,y);if(C){if(!k)k=C.originalid;else if(k!==C.originalid)return null}}if(!k)return null;let B=d.getNode(k);return!B||!Zj(B)?null:B};function yv(d,m){if(m.length===1){let B=d.tree.getNode(m[0]?.originalid);if(!B)return;b7(d,B);return}let k=y7(d.tree,m);k&&(kA.showMaster(d.tree,k),b7(d,k))}vt.goToMaster=yv;function b7(d,m){let k=d.tree.getScopeNodeFor(m),B=d.stores.scopeStore.active;Zj(m)&&kA.showMaster(d.tree,m),k===null&&(d.moveNode(m.id,B.id),k=B),d.stores.scopeStore.select(k.id,{keepHistory:!1}),d.stores.selectionStore.set(m);let I=d.tree.convertFrameToCanvas(m);d.stores.canvasStore.scrollToCenter(q.center(I))}vt.showNodeOnCanvas=b7;function bv(d,m){d.exitMode(),d.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Component",parentId:m})}vt.createCodeComponent=bv;function Cv(d){d.exitMode(),d.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Override"})}vt.createCodeOverride=Cv;function vv(d,m,k,B,{gesture:I,overrides:G,overrideSize:y,variantName:C,viewportHeight:b,selectAndCenter:M=!0}={}){I&&$(Ia(k),"gesture variant should inherit from top level variant");let{treeStore:_,scopeStore:O,selectionStore:fA,canvasStore:dA}=d,JA=m.getPrimaryVariant(),EA=null;if(!I){let aj=new Set(m.getTopLevelVariants().map(MA=>MA.name??""));C?EA=Pj(C,aj):EA=Pj(IA(k)?"Breakpoint":"Variant",aj,{startIndex:aj.size+1,omitCountIfFirst:!1})}if(G||(G=I?void 0:k.replicaInfo?.overrides),EA&&IA(k)){let aj=TE(_,EA,k);aj&&(G?G=Fr(aj,G):G=aj);let MA={};k.children.forEach(bA=>{if(!Te(bA)||$A(bA)&&bA.widthType===2||!(bA.originalid?_.tree.getNode(bA.originalid):bA))return;let Gj=_.tree.getRect(bA);Tc(_.tree,bA,Gj,k,B.width,MA)}),G||(G={}),G=Fr(G,MA)}let uA=kA.create(_.tree,JA,{overrides:G,inheritsFrom:I?k.id:void 0,duplicatedFrom:In(k)});if(O.insertNode(uA,m.id,-1),!uA)return;let SA={top:B.y,left:B.x,gesture:I,isBreakpoint:po(m)?!0:void 0,name:EA};if(b&&(SA.viewportHeight=b),y&&(SA.width=B.width,SA.widthType=0,IA(uA)||(SA.height=B.height,SA.heightType=0)),uA.set(SA),eA(m)){let aj=os(I)?"variant":I??"variant";eE({variantId:uA.id,variantType:aj,componentId:m.id})}else IA(uA)&&mA("breakpoint_create",{scopeId:m.id,breakpointId:uA.id,width:uA.width});return M&&(fA.set(uA.id),dA.scrollToCenter(q.center(B))),uA}vt.createVariant=vv;function CR(d,m){return d.filter(k=>Qa(k)?om(k)!==m:Ze(k)?RE(k)!==m:!0)}function Tv(d,m,k){for(let B of m.walk()){let I=za(B);for(let[G,y]of Object.entries(I)){let C=CR(y,k);if(C.length!==y.length){if(We(B))d.tree.current(B)?.set({[G]:C});else if(W(B)){let b={type:"eventhandler",value:C};d.tree.current(B)?.set({[G]:b})}}}}}vt.removeActionsWithTarget=Tv;function Pv(d,m){let k=d.tree.getParent(m.id)||d.stores.scopeStore.active;if(gA(k))return!1;let B=d.stores.treeStore.getPartialIndexes();return m.codeComponentIdentifier in B.localSmartComponentNameByIdentifier}vt.canDetachVariantInstance=Pv;function _v(d,m,k,B){if(!k)return null;let I={...gs(m,L),...J$(m)},G=new Map;k.getTopLevelVariants().forEach(MA=>G.set(MA.id,MA));let y=x(I.variant)&&G.get(I.variant)||k.getPrimaryVariant();$(pA(y),"Variant must be a frame node");let C=d.tree.getParent(m.id)||d.tree.getScopeNodeFor(m)||d.stores.scopeStore.active;if(gA(C))return null;let b=new Map,M=Jr(y,new Map,new Map,b);b.set(m.id,M.id);let _=d.tree.getScopeNodeFor(C);if(w(_)||eA(_)){let MA=_.getTopLevelReplicaVariants();for(let bA of MA){let Jj=he(bA.id,m.id),Gj=d.tree.getNode(Jj);if(!Gj||!W(Gj))continue;let cA=Gj.getResolvedControlPropValues(L).variant;if(!x(cA))continue;if(B){let Yj=B.get(cA);Yj&&(cA=Yj)}let pj=x(cA)?G.get(cA):void 0;if(!pj||!pA(pj)||!DA(pj))continue;let Hj=qo(V$(pj,d.tree,Gj,k.id),b),Aj={},jj=b.get(y.id)??y.id;if(Bn(pj)){let Yj=qo(pj.replicaInfo.overrides,b,!0);Object.assign(Aj,{...Yj,[jj]:K$(Yj[jj]??{})})}let Rj=Fr(Hj,Aj);if(Bn(pj)){let{opacity:Yj,rotation:we}=bA.replicaInfo.overrides?.[m.id]||{};Vs(Rj[jj]??{},{opacity:Yj,rotation:we})}else if(bA.replicaInfo.overrides?.[m.id]){let{opacity:Yj,rotation:we}=pj;Vs(bA.replicaInfo.overrides[m.id]??{},{opacity:Yj,rotation:we})}let Oe={};Gj.heightType===2&&(Oe.heightType=pj.heightType,Oe.height=pj.height),Gj.widthType===2&&(Oe.widthType=pj.widthType,Oe.width=pj.width),d.tree.current(bA)?.set({replicaInfo:{...bA.replicaInfo,overrides:Fr({...bA.replicaInfo.overrides,[m.id]:{}},{...Rj,[jj]:{...bA.replicaInfo.overrides[m.id],...Rj[jj],...Oe}})}})}}let O=Fs(d.tree,m,M,C);Vs(O,{opacity:aA(y.opacity)?I[y.opacity.id]:y.opacity,rotation:aA(y.rotation)?I[y.rotation.id]:y.rotation});let fA=m.constraintValues(),dA=y.constraintValues();fA.widthType===2&&dA.widthType!==2&&(fA.widthType=dA.widthType),fA.heightType===2&&dA.heightType!==2&&(fA.heightType=dA.heightType),M.set({...fA,...O,...C?Kt(m):void 0,isVariant:!1,isMaster:!1,gesture:void 0,replicaInfo:null,originalid:null,name:m.name??De(m)});let JA=Nm(k),EA=new Map([...JA??[],...Object.entries(I)]),uA=new Map;uA.set(k.id,EA);let SA={};for(let MA of M.walk()){if(MA.originalid=null,nm(MA))for(let[bA,Jj]of Object.entries(MA.getActions(L)))Jj&&MA.set({[bA]:Jj.filter(Gj=>ba(Gj)||fa(Gj))});if(EA.size>0){let bA=Za(d.tree,k.id,MA,uA,SA);bA&&MA.set(bA)}}$(M.id!==y.id);let aj=C.children.indexOf(m);d.tree.insertNode(M,C.id,aj);for(let MA of m.children)ie(MA)&&d.tree.moveNode(MA,SA[MA.id]??M.id);return Ne(d.tree,C,b,ie(C)||Pa(C)),d.deleteNode(m.id),bj(M)&&d.scheduler.runBeforeNextFrame(()=>{d.stores.overlayStore.showOverlay(d.stores.selectionStore,M,M.parentid)}),M}vt.detachSmartComponentOrWebPageInstance=_v;function xv(d){vR(d,{openLibrary:!0})}vt.toggleTeamLibrary=xv;function vR(d,{openLibrary:m}={}){let{modalStore:k,popoverStore:B}=d.stores;k.active.type==="QuickActions"?k.dismiss():(d.cancelTool(),B.active=0,k.set({type:"QuickActions",source:"main_menu",initialCategory:m?{type:"TeamLibraryCategory"}:void 0}),m?mA("ui_interaction",{page:"main-menu",id:"team-library"}):mA("ui_interaction",{page:"main-menu",id:"quick-actions"}))}vt.toggleQuickActions=vR;function Mv(d){return!!IA(d)}vt.canCreateBreakpoint=Mv;function Dv(d,m,k,B,I){let{modalStore:G}=d.stores;G.active.type!=="CustomBreakpoint"&&(d.cancelTool(),G.set({type:"CustomBreakpoint",actionType:m,baseNodeId:k,name:B,width:I,source:"undefined"}))}vt.showCustomBreakpointModal=Dv;function Nv(d,m,k,B,I,G,y,C){let b={...B,width:I},M=vt.createVariant(d.stores,k,m,b,{overrideSize:!0,variantName:G,viewportHeight:y,selectAndCenter:C});return $(IA(M),"Created node is not a breakpoint variant"),M}vt.createBreakpoint=Nv;function TR(d){return d.some(m=>m!==d&&Zj(m))}vt.containsMaster=TR;function PR(d){return pA(d)||xt(d)||RA(d)||qj(d)||aa(d)||bu(d)||sa(d)}vt.nodeTypeCanBePrimaryVariantSource=PR;function _R(d,m){return!(!PR(m)||yE(d,m)||DA(m)||dj(m)||Zj(m)||TR(m))}vt.canConvertNodeToSmartComponentPrimaryVariant=_R;function xR(d,m){let k=m.length;if(k===0)return!0;let B=m[0];return $(B,"node must be defined",m),k===1&&_R(d.tree,B)}vt.canMakeSmartComponent=xR;function MR(d,m){if(m.length!==1)return!1;let B=m[0];if($(B,"node must be defined",m),!pA(B)||gA(B))return!1;let I=d.tree.get(B.parentid);return oe(I)}vt.canMakeWebPagePrimaryBreakpoint=MR;async function Ov(d,m){if(!MR(d,m))return;let k=m[0];return $(k,"node must be defined",m),d.createWebPage({primaryBreakpointTemplateId:k.id,shouldRemovePanelOverrides:!1,startEditingPageTitle:!1,preferredPath:k.name?bf(k.name):void 0})}vt.convertNodeToWebPagePrimaryBreakpoint=Ov;function wv(d,m,k="Template",B,I){let G=new Me({...er,...mG(B),isMaster:!0,isVariant:!0,isBreakpoint:!0,widthType:0,heightType:0,width:B?.width??1200,name:B?.name??"Desktop"}),y=new nf;G.addChild(y);let C=Pj(k,fG(d)),b=new wm({baseVariantId:G.id,name:C});$(b.isLoaded(),"A newly created LayoutTemplateNode must be loaded."),b.addChild(G),d.latestTree().insertNode(b);let M=hs(d,C,I??Cn);return wr(d,M,b.id),mA("layout_template_create",{source:m}),b}vt.createLayoutTemplate=wv;function Lv(d,m,k=!0,B=null,I=Fj(),G="context_menu",y=0){let C=new Zl({name:m,id:I});if($(C.isLoaded(),"A newly created VectorSetNode must be loaded"),d.tree.latestTree().insertNode(C),wr(d.tree,B??go,C.id),k)for(let M of gG())d.tree.latestTree().insertNode(M,C.id);let b=d.tree.current(C);return $(b,"A newly created VectorSetNode must exist"),d.stores.codeGenerationStore.createVectorSet(b.getVectorSetItems()),mA("vector_set_create",{source:G,items:k?3:y}),C}vt.createVectorSet=Lv;async function qv(d,m,k){let B=d.tree.get(k);if(!Ee(B))return;let I=B.isLoaded()?B:await B.load();if(!I)return;let G=I.children.find(ht);if(!ht(G))return;let y=d.tree.getRect(G);d.scheduler.process(()=>{let C=gB(d,m),b=[],M=Ht(G)?{fillEnabled:G.fillEnabled,fillType:G.fillType,fillColor:G.fillColor}:void 0;for(let _ of C){let O=d.tree.get(_);if(!O)continue;let fA=d.tree.getIndex(O),dA=Qn(d.tree,I,O,y,y.width),JA=hB(O,dA,M);if(ht(JA)){if(d.tree.insertNode(JA,I.id),b.push(JA),S7(d,JA.id,y),mA("vector_set_item_create",{source:"context_menu"}),k!==d.stores.scopeStore.active.id){let EA=new xr({...RB(O),codeComponentIdentifier:pr("vector",JA.id,"default").value,width:O.width,height:O.height,widthType:0,heightType:0,slotsAreChildNodes:yA.isOn("componentSlotsAreChildNodes"),name:O.name});d.tree.insertNode(EA,O.parentid,fA)}d.tree.removeNode(O)}}b.length!==0&&(d.stores.scopeStore.select(B.id,{keepHistory:!1}),d.stores.selectionStore.set(b),d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",d.stores.codeGenerationStore.createVectorSet(b))})}vt.addToVectorSet=qv;function Vv(d,m,k="Icon Set",B="context_menu"){let I=new Zl({name:k});$(I.isLoaded(),"A newly created VectorSetNode must be loaded");let G=gB(d,m),y=0,C=[];for(let b of G){let M=d.tree.get(b);if(!M)continue;let _=d.tree.getRect(M),O=hB(M,{x:y,y:0});if(!ht(O))continue;let fA=d.tree.getIndex(M);C.push(O),I.addChild(O),y+=_.width*2;let dA=new xr({...RB(M),codeComponentIdentifier:pr("vector",O.id,"default").value,width:M.width,height:M.height,widthType:0,heightType:0,slotsAreChildNodes:yA.isOn("componentSlotsAreChildNodes"),name:M.name});d.tree.insertNode(dA,M.parentid,fA),d.tree.removeNode(M)}d.tree.latestTree().insertNode(I),wr(d.tree,go,I.id),d.stores.codeGenerationStore.createVectorSet(C),d.stores.scopeStore.select(I.id,{keepHistory:!1}),d.stores.selectionStore.set(C),d.stores.chromeStore.layersExpanded=!0,d.stores.chromeStore.contentPanelTab="Layers",mA("vector_set_create",{source:B,items:G.size})}vt.createVectorSetFromNodes=Vv;function Kv(d,m,k,B,I){let G=k.clone({children:[],name:"Vector"}),{scopeStore:y,codeGenerationStore:C,selectionStore:b,canvasStore:M}=d;y.insertNode(G,m.id),$($A(G),"Vector must be pinnable."),G.set({top:B.y,left:B.x}),C.createVectorSet([G]),b.set(G.id),M.scrollToCenter(q.center(B)),mA("vector_set_item_create",{source:I})}vt.createVectorSetItem=Kv})(rd||={});var er={height:Om,left:0,top:0,layout:"stack",stackDirection:"vertical",stackAlignment:"center",stackDistribution:"start",stackWrapEnabled:!1,gap:0,padding:0,paddingPerSide:!1,paddingLeft:0,paddingBottom:0,paddingTop:0,paddingRight:0,overflow:Ue()};function mG(j){if(!j||!Ke(j)||!lt(j)||!Ht(j))return;let A=Fo(j);return{gap:j.resolveValue("gap")??er.gap,padding:A.perSide?er.padding:A.top,paddingPerSide:A.perSide??er.paddingPerSide,paddingLeft:A.left??er.paddingLeft,paddingBottom:A.bottom??er.paddingBottom,paddingTop:A.top??er.paddingTop,paddingRight:A.right??er.paddingRight,fillEnabled:j.resolveValue("fillEnabled"),fillType:j.resolveValue("fillType"),fillColor:j.resolveValue("fillColor"),fillLinearGradient:j.resolveValue("fillLinearGradient"),fillRadialGradient:j.resolveValue("fillRadialGradient"),fillConicGradient:j.resolveValue("fillConicGradient"),fillImage:HA(j.fillImage)?void 0:j.fillImage,fillImageOriginalName:j.resolveValue("fillImageOriginalName"),fillImageResize:j.resolveValue("fillImageResize"),fillImagePixelWidth:j.resolveValue("fillImagePixelWidth"),fillImagePixelHeight:j.resolveValue("fillImagePixelHeight"),fillImagePositionX:j.resolveValue("fillImagePositionX"),fillImagePositionY:j.resolveValue("fillImagePositionY"),fillImageTileSize:j.resolveValue("fillImageTileSize")}}function fG(j){let A=new Set;return j.root.children.forEach(e=>{!tj(e)||!e.name||A.add(e.name)}),A}function FB(j){return!(uo(j)||ca(j)||at(j))}function td(j){return!(Ej(j)||ca(j)||at(j)||oj(j))}function EG(j){return Be(j)&&j.isVisible()?!0:td(j)}function BB(j){return FB(j)?oj(j)?Be(j):!0:!1}function si(j,A){if(Ae(A)){let e=gn(j.tree,A.dataIdentifier);if(e)return e.id}return null}function $G(j,A,e){if(e){let r=si(j,e);if(r)return r;for(let o of e.ancestors()){let n=si(j,o);if(n)return n}}let t=si(j,A);if(t)return t;if(e)for(let r of e.walk()){let o=si(j,r);if(o)return o}for(let{node:r,skipChildren:o}of A.walkWithSkipChildren())if(e&&r.id===e.id)o();else{let n=si(j,r);if(n)return n}return null}function hB(j,{x:A,y:e},t){if(nj(j)){let r=new Mr({...t,isVectorSetItem:!0,width:j.width,height:j.height,left:A,top:e,name:j.name}),o=j.clone({x:0,y:0});return r.addChild(o),r}return j.clone({...t,isVectorSetItem:!0,left:A,top:e})}function gB(j,A){return new Set(A.map(e=>{if(!e)return null;if(RA(e))return e.originalid??e.id;let t=j.tree.getAncestorThatMatches(e,o=>BG(j,o),!0,!0);if(!t)return null;let r=j.tree.getNodeParent(t);return r&&RA(r)?r.originalid??r.id:t.originalid??t.id}))}function BG(j,A){return nj(A)&&j.tree.isRootVectorNode(A)}function RB(j){return $A(j)?{top:j.top,bottom:j.bottom,left:j.left,right:j.right,centerAnchorX:j.centerAnchorX,centerAnchorY:j.centerAnchorY,constraintsLocked:j.constraintsLocked}:{top:j.y,left:j.x}}var hG="rgb(0, 153, 255)",jd={fillType:"color",fillColor:hG,fillEnabled:!0},ed={isVectorSetItem:!0,top:0,width:40,height:40,autoSize:!1},gG=()=>{let j=new tc({...jd,x:-3,y:-3,width:46,height:46,polygonSides:3,centered:!0,radius:1}),A=new tc({...jd,x:0,y:0,width:40,height:40,polygonSides:4,centered:!0,radius:1}),e=new sf({...jd,x:2,y:2,width:36,height:36}),t=new Mr({...ed,name:"Triangle"});t.addChild(j);let r=new Mr({...ed,left:80,name:"Diamond"});r.addChild(A);let o=new Mr({...ed,left:160,name:"Oval"});return o.addChild(e),[t,r,o]};function Us(j){let A={},e=j.getPresetsListNode();if(!e)return A;for(let t of e.children)if(!dj(t)){if(je(t)){let r=Km(t.tag);A[r]??=t.id;continue}if(Uj(t)){A.stylePresetLink??=t.id;continue}if(ne(t)){A.stylePresetInlineCode??=t.id;continue}if(He(t)){A.stylePresetImage??=t.id;continue}if(Dt(t)){A.stylePresetBlockquote??=t.id;continue}if(la(t)){A.stylePresetTable??=t.id;continue}if(so(t)){let r=Rn(t.componentIdentifier);A[r]??=t.id;continue}iA(t)}return A}function l3(j,A){let e=Us(j),t={};for(let r in e){let o=A[r];j.get(o)||(t[r]=e[r])}Object.keys(t).length>0&&A.set(t)}function c3(j,A,e="",t={}){let r=document.createElement(A);r.innerText=e;let o=js(j,A);if(o)xp(r,o.id);else{let n=Fk[A],a=n.fontSize,i;qu(a)?i=ua(a):Y(a)&&(i=[a,"px"]),bp(r.style,yp.transforms,{...n,fontSize:i})}return new Zm({html:r.outerHTML,...Us(j),...t})}function GB(j,A,e,t){let r=`${t}/${e.segment}`;j.add(r);for(let o of e.children)GB(j,A,o,r)}function SB(j){let A=new Set,e=mo(j);if(!e)return A;for(let t of e.children)GB(A,j,t,"");return A}function yB(j){j=[...j].sort((e,t)=>e[0]-t[0]||e[1]-t[1]);let A=[];for(let e of j){if(e[0]===e[1])continue;let t=A[A.length-1];if(!t){A.push(e);continue}if(e[0]<=t[1]){t[1]<e[1]&&(t[1]=e[1]);continue}A.push(e)}return A}function bB(j,A){let e=[],t=0;for(let[r,o]of j){if(r<=t){t=o;continue}e.push([t,r]),t=o}return A!==void 0&&t<A&&e.push([t,A]),e}var RG=/\/+/gu,IG=/\/{2,}/gu,FG=new RegExp(`-?${uu}-?`,"g"),GG=/\s+/gu,SG=/[?#[\]@!$&'()*+,;="<>%{}|\\^`]/gu;function yG(j){return j.startsWith("/")?j:"/"+j}function bG(j){return j.replace(IG,"/")}function CG(j){return j.toLowerCase().replaceAll(SG,"").replaceAll(GG,"-")}function Ws(j){let A=vG(j,RG,FG),e=bB(A,j.length);return j.startsWith("/")?j=CB(j,e,CG):j=CB(j,e,Nu),j=yG(j),j=bG(j),j}function vG(j,...A){let e=[];for(let t of A)for(let r of j.matchAll(t))$(r.index!==void 0),e.push([r.index,r.index+r[0].length]);return yB(e)}function CB(j,A,e){let t="",r=0;for(let[o,n]of A)o>r&&(t+=j.substring(r,o)),t+=e(j.substring(o,n)),r=n;return r<j.length&&(t+=j.substring(r)),t}var vB=":missing-slug";function od(j,A){if(!A)return"/unknown";let e=L.dataForIdentifier(j);if(!e)return A;let t=e.properties;if(!t)return A;let r=new Set(Object.keys(t)),o=0,n=A.replace(pu,(i,s)=>{if(o++,r.has(s))return i;for(let[c,u]of Object.entries(t))if(s.toLowerCase()===(u?.title??c).toLowerCase())return`:${c}`;let l=e.annotations?.framerSlug;return l?`:${l}`:vB});if(o>0)return n;n.endsWith("/")||(n+="/");let a=e.annotations?.framerSlug;return a?n+`:${a}`:n+vB}function TG(j){if(Ga(j.tree)){let A=SB(j.tree),e=new Set(j.stores.scopeStore.getWebPageNodesWithCollection().map(t=>Xt(j.tree,t)).filter(x));return new Set([...A,...e])}return new Set(j.stores.scopeStore.getWebPageNodes().map(A=>Xt(j.tree,A)).filter(x))}function PG(j){let A=j.split("/"),e=A[A.length-1];return e?Sa(e):!1}var nd=(j,A,e,t=!1)=>{j=Ws(j);let r=TG(A),o=A.tree.root.homePageNodeId,n=!!e&&e.id===o;j==="/"&&!n&&(j="/page"),e?.dataIdentifier&&(j=od(e.dataIdentifier,j));let a=j.endsWith("/")&&!n,i=j;a&&(i=j.slice(0,-1));let s=Xt(A.tree,e);return r.has(j)&&(t||j!==s)&&(r.add(i),PG(i)&&(i+="/copy"),i=Pj(i,r,{withDash:!0})),{path:a?`${i}/`:i,suggestedName:ns(j)}};var St=Dj(ro()),TB="dismissedInstantNPMToast",PB="showedInstantNPMToast",_B="instant-npm-toast",x3=()=>window.localStorage.getItem(PB)==="true",xB=()=>window.localStorage.getItem(TB)==="true";function _G(){return(0,St.jsxs)(St.Fragment,{children:[(0,St.jsx)(oc,{children:"You installed an external NPM library."}),(0,St.jsxs)("a",{href:"https://www.framer.com/developers/#faq",target:"_blank",children:[" ",(0,St.jsx)(oc,{children:"Learn More"})]})]})}function MB(){window.localStorage.setItem(PB,"true"),PA({type:"add",variant:"info",text:(0,St.jsx)(_G,{}),key:_B,duration:1/0,action:{title:"Dismiss",onClick:()=>window.localStorage.setItem(TB,"true")}})}function M3(){PA({type:"remove",key:_B})}function xG(j){if(j.length>=255)throw new TypeError("Alphabet too long");let A=new Uint8Array(256);for(let s=0;s<A.length;s++)A[s]=255;for(let s=0;s<j.length;s++){let l=j.charAt(s),c=l.charCodeAt(0);if(A[c]!==255)throw new TypeError(l+" is ambiguous");A[c]=s}let e=j.length,t=j.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function n(s){if(s instanceof Uint8Array||(ArrayBuffer.isView(s)?s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength):Array.isArray(s)&&(s=Uint8Array.from(s))),!(s instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(s.length===0)return"";let l=0,c=0,u=0,p=s.length;for(;u!==p&&s[u]===0;)u++,l++;let f=(p-u)*o+1>>>0,E=new Uint8Array(f);for(;u!==p;){let S=s[u],v=0;for(let P=f-1;(S!==0||v<c)&&P!==-1;P--,v++)S+=256*E[P]>>>0,E[P]=S%e>>>0,S=S/e>>>0;if(S!==0)throw new Error("Non-zero carry");c=v,u++}let F=f-c;for(;F!==f&&E[F]===0;)F++;let R=t.repeat(l);for(;F<f;++F)R+=j.charAt(E[F]);return R}function a(s){if(typeof s!="string")throw new TypeError("Expected String");if(s.length===0)return new Uint8Array;let l=0,c=0,u=0;for(;s[l]===t;)c++,l++;let p=(s.length-l)*r+1>>>0,f=new Uint8Array(p);for(;l<s.length;){let S=s.charCodeAt(l);if(S>255)return;let v=A[S];if(v===255)return;let P=0;for(let T=p-1;(v!==0||P<u)&&T!==-1;T--,P++)v+=e*f[T]>>>0,f[T]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");u=P,l++}let E=p-u;for(;E!==p&&f[E]===0;)E++;let F=new Uint8Array(c+(p-E)),R=c;for(;E!==p;)F[R++]=f[E++];return F}function i(s){let l=a(s);if(l)return l;throw new Error("Non-base"+e+" character")}return{encode:n,decodeUnsafe:a,decode:i}}var DB=xG;var id="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",MG=DB(id),DG=8/Math.log2(62),w3=j=>MG.encode(j).padStart(Math.ceil(j.length*DG),"0"),li=(j=20)=>Array(j).fill(0).map(()=>id[Math.floor(Math.random()*id.length)]).join("");var NB="https://app.framerstatic.com/framer_compiler_bg-UTRYLQ4Z.wasm";var yt=hA("compiler");async function j5(){await di()}function OB(j){return{code:`const err = new Error(${JSON.stringify(String(j))}); err.name = "CompilationError"; throw err;`,sourceMap:void 0,annotations:{},exportedNames:[],reExportedModules:[],imports:{absolute:[],relative:[],bare:[]}}}function wB(j,A,e){let t={...A.exports};e&&(t.__FramerMetadata__={type:"variable"},j=j.concat(`
export const __FramerMetadata__ = `,JSON.stringify({exports:t})));let r=Object.entries(t).filter(([,n])=>n.type!=="tsType").map(([n])=>n),o={};for(let[n,a]of Object.entries(A.exports))a.annotations&&(o[n]=a.annotations);return{moduleCode:j,annotations:o,exportedNames:r}}async function LB({localId:j,name:A,source:e,includeSourceMap:t=!0}){let r=await di();try{let{code:o,metadata:n,map:a}=await r.transformSync(e,{fileName:le(A).source,framerContractVersion:1,mediaType:"tsx",minify:!1,compress:!1,mangle:!1,sourceMap:t,useReactRefresh:!0}),i=`
if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = window.reactRefreshRuntime.getRefreshReg("${j}");
window.$RefreshSig$ = window.reactRefreshRuntime.createSignatureFunctionForTransform;

${o}

window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;`,{moduleCode:s,annotations:l,exportedNames:c}=wB(i,n,!0);return{code:s,sourceMap:a??void 0,imports:n.requestedModules,annotations:l,exportedNames:c,reExportedModules:n.reExportedModules}}catch(o){let n=`Failed to compile development module ${A}: ${o}`;return yt.debug(n,"(enable trace logging to see full source)"),yt.trace(e),j.startsWith("codeFile/")||(yt.reportCriticalError(new Error(n),{moduleName:A,moduleSource:e}),mA("application_error",{message:n,area:"compiler"})),OB(o)}}async function e5(j,A){await(await di()).transformSync(A,{fileName:le(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:!1,mangle:!1,sourceMap:!1,useReactRefresh:!1})}async function qB({name:j,source:A,type:e,includeSourceMap:t=!0,addFramerMetadata:r=!0,telemetrySession:o}){let n=li(10),a=`compile-${j}-${n}`,i=`\u{1F4DD} Compile ${j}`;yt.debug("Compiling module",j,"; with source map:",t),Jn(a);let s=await di(),l=o?.start("transform"),c=e==="collection";try{let{code:u,map:p,metadata:f}=await s.transformSync(A,{fileName:le(j).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:c,mangle:c,sourceMap:t,useReactRefresh:!1}),{moduleCode:E,annotations:F,exportedNames:R}=wB(u,f,r);return{code:E,sourceMap:p??void 0,imports:f.requestedModules,annotations:F,exportedNames:R,reExportedModules:f.reExportedModules}}catch(u){let p=`Failed to compile module ${j}: ${u}`;return yt.debug(p,"(enable trace logging to see full source)"),yt.trace(A),j.startsWith("codeFile/")||(yt.reportCriticalError(new Error(p),{moduleName:j,moduleSource:A}),mA("application_error",{message:p,area:"compiler"})),OB(u)}finally{l?.end(),KB(i,a)}}async function VB(j){let e=`analyze-imports-${li(10)}`,t="\u{1F575}\u{1F3FB} Analyze Imports";Jn(e);try{return{ok:!0,value:await(await di()).analyzeImports(j)}}catch(r){return yt.warn("Failed to analyze imports:",r),r instanceof Error?{ok:!1,error:r}:{ok:!1,error:new Error(`${r}`)}}finally{KB(t,e)}}var Xs;async function di(){if(!Xs){let j=new Worker(Dk("./modulesCompilerWorker.js")),A=xk(j);Xs=A.initWithPathToWasm(NB).then(()=>({transformSync:A.transformSync,analyzeImports:A.analyzeImports})),Xs.catch(()=>{if(gf()||!_7.isProduction)throw new Error(`\u274C Your dev setup is struggling to run the compiler\u2019s WASM binary.
To fix it, run "make clean" followed by "make dev".`)})}return Xs}function KB(j,A){is(j,A),performance.getEntriesByName(j,"measure").forEach(({name:e,duration:t})=>{yt.debug(e,"took",t.toFixed(2),"ms"),_f(e)}),as(A)}function JB(j,A){if(!W(j))return;let e=j.getSupportedLayout(L),t=j.getCurrentVariantSize(L);q6(e.width)&&t?.widthType!==0&&(A.widthType=2,A.left!==null&&A.right!==null&&(A.right=null)),q6(e.height)&&t?.heightType!==0&&(A.heightType=2,A.top!==null&&A.bottom!==null&&(A.bottom=null))}function HB(j,A,e=!0){j.scheduler.processWhenReady(()=>{let{overlayStore:t,selectionStore:r,scopeStore:o,canvasStore:n,persistedUserDefaults:a}=j.stores;o.selectByNode(A.id),r.set(A.id);let i=j.tree.get(A.cache.overlayAncestorId);if(ie(i)?t.showOverlay(r,i,i.parentid):t.hideAll(),e){let s=j.tree.getBoundingFrameForNodes([A]);n.zoomToCenter(s,{animated:a.animateOnZoom,maxZoom:1})}})}var Hr=class extends Error{constructor(e,t,r,o=!1){super(e);this.missing=t;this.error=r;this.wasTimeout=o}};function c5(j){return j instanceof Hr}var ad=hA("ensureComponentsInLoader"),OG=500,wG=30*1e3;async function Ys(j,A,e,t){let r=QB(A,j).length;if(r===0)return;let o=t??wG+r*2e3;ad.debug("modules:",A.length,", new:",r,", timeout:",o),await LG(j,e,o);let n=QB(A,j);if(n.length===0)return;let a=qG(A,j);throw ad.debug("components loaded, but some are missing",{missing:n,errors:a}),new Hr("ensureComponentsInLoader: Some modules are missing.",n,a)}async function LG(j,A,e){let t=performance.now(),r=await VG(async()=>(await M6(e),"timeout"),async()=>{await A.whenIdle();let o=A.revision;return $(o>=0,"moduleStore.revision cannot be negative"),await A.loadAllLocalModules(),o});if(r==="timeout")throw new Hr("ensureComponentsInLoader: Modules store not ready in time.",[],[],!0);for(let o=0;o<1e3;o++){let n=j.modulesRevision;if(r<=n)break;if(performance.now()-t>e)throw ad.debug("component loader not updated in time: want:",r,"got:",n),new Hr("ensureComponentsInLoader: Component loader not updated in time.",[],[],!0);await M6(OG)}}function QB(j,A){let e=new Set;for(let t of j)A.componentForIdentifier(t)||e.add(t);return Array.from(e)}function qG(j,A){let e=new Set;for(let t of j)wj(A.errorForIdentifier(t))||e.add(t);return Array.from(e)}async function VG(...j){return Promise.race(j.map(async A=>A()))}async function UB(j,A){let e=[];j.forEach(t=>{let r=oA(t);r&&r.kind==="externalModuleExport"&&e.push(r)}),e.length&&await A.preloadExternalModules(e),await Ys(L,j,A)}function Zs(j,A,e,t,r){if(aA(e.htmlContent))return;let o=j.getScopeNodeFor(A);$(o&&po(o),"Can't find scope with breakpoints");let a=o.getTopLevelVariants().map(i=>{let s=Ej(i)?e.id:he(i.id,e.id),l=j.get(s);return $(l&&XA(l),"Can't find rich text node in breakpoint"),[i,l]});for(let[i,s]of a){$(sj(i),"Can't read width attribute of node");let l=As(t,c=>(c.breakpointWidth??0)>i.width)??r;s.detachTextStylePreset(l,!0)}}var sd=["formButtonSuccessVariant","formButtonPendingVariant","formButtonErrorVariant","formButtonIncompleteVariant","whileOpenEffectVariant","appearEffectVisibleVariantId","appearEffectObscuredVariantId","dataLoaderLoadingVariant","dataLoaderDisabledVariant"];function zB(j,A,e){let t=A.tokenOverrides;!t||Le(t)||(XB(j,e,t),A.set({tokenOverrides:void 0}))}function XB(j,A,e){KG(j,A.id,e);let t=[];for(let r of A.variables){if(!A0(r)){t.push(r);continue}switch(r.type){case"border":t.push(Br(r.initialValue)?{...r,initialValue:{...r.initialValue,borderColor:OA(r.initialValue.borderColor,e)}}:r);break;case"color":t.push({...r,initialValue:OA(r.initialValue,e)});break;default:iA(r,"Unsupported variable type.")}}A.set({variables:t})}function KG(j,A,e){let t=j.tree.get(A);if(t)for(let{node:r,skipChildren:o}of t.walkWithSkipChildren()){if(gA(r)){o();continue}if(YB(j,r,e),JG(j,r,e),!W(r)||r.isVectorInstance)continue;let n=r.getLocalSmartComponentNodeId();if(!n){r.set({tokenOverrides:e});continue}let a=j.tree.get(n);eA(a)&&a.isLoaded()&&(XB(j,a,e),j.stores.codeGenerationStore.updateComponent(a.id))}}function JG(j,A,e){let t=Jt(j.tree,A);for(let r of t){let{relatedNode:o,replicaRoot:n}=r;n.replicaInfo.overrides[A.id]&&YB(j,o,e)}}function YB(j,A,e){if(_e(A)){let t=OA(A.fillColor,e);t&&A.set({fillColor:t})}if(Bt(A)){let t=OA(A.borderColor,e);t&&A.set({borderColor:t})}if(Ie(A)){let t=OA(A.strokeColor,e);t&&A.set({strokeColor:t})}if(XA(A))if(A.htmlContent)HG(j,A,e);else{let t=new Map;for(let r in e){if(!El(r))continue;let o=e[r],n=ip(r);n&&t.set(n,`var(${r}, ${o})`)}A.replaceColorTokenVariables(t),A.hasLinks()&&A.remapLinkStylePresets(r=>{let o=ZB(j,r,e);if(Uj(o))return o})}else if(W(A)){let t=L.componentForIdentifier(A.codeComponentIdentifier);if(!t)return;let r=A.getControlProps(t.properties);if(!r)return;for(let o in r){let n=r[o];if(!(!n||!A0(n)))switch(n.type){case"border":if(!Br(n.value))break;A.setControlProp(o,{...n,value:{...n.value,borderColor:OA(n.value.borderColor,e)}});break;case"color":A.setControlProp(o,{...n,value:OA(n.value,e)});break;default:iA(n,"Unsupported control type.")}}}}function HG(j,A,e){for(let t of _o){let r=A[t];if(!r)continue;let o=ZB(j,r,e);Ln(o)&&A.set({[t]:o.id})}}function ZB(j,A,e){let t=j.tree.getNodeWithTrait(A,Ln);if(!t)return;let r=QG(t,e);if(WB(t,r))return t;let o=Rt(j.tree),n=o.getStylePresets().filter(a=>a.id!==A&&WB(a,r));return n.length?n?.[0]:(j.tree.insertNode(r,o.id),j.stores.codeGenerationStore.createModuleFromComponentSource(r).catch(GA),r)}function WB(j,A){return j.__class!==A.__class?!1:je(j)&&je(A)||Uj(j)&&Uj(A)||Dt(j)&&Dt(A)||ne(j)&&ne(A)||He(j)&&He(A)?j.equals(A):!1}function QG(j,A){let e=j.clone();return UG(e,A),e}function UG(j,A){je(j)?(j.textColor=OA(j.textColor,A),j.textStrokeColor=OA(j.textStrokeColor,A),j.textDecorationColor=OA(j.textDecorationColor,A)):Uj(j)?(j.linkTextColor=OA(j.linkTextColor,A),j.linkTextDecorationColor=OA(j.linkTextDecorationColor,A),j.linkTextBackgroundColor=OA(j.linkTextBackgroundColor,A),j.linkHoverTextColor=OA(j.linkHoverTextColor,A),j.linkHoverTextDecorationColor=OA(j.linkHoverTextDecorationColor,A),j.linkHoverTextBackgroundColor=OA(j.linkHoverTextBackgroundColor,A),j.linkCurrentTextColor=OA(j.linkCurrentTextColor,A),j.linkCurrentTextDecorationColor=OA(j.linkCurrentTextDecorationColor,A),j.linkCurrentTextBackgroundColor=OA(j.linkCurrentTextBackgroundColor,A)):He(j)?j.borderColor=OA(j.borderColor,A):Dt(j)?(j.textColor=OA(j.textColor,A),j.textDecorationColor=OA(j.textDecorationColor,A),j.textStrokeColor=OA(j.textStrokeColor,A),j.borderColor=OA(j.borderColor,A),j.fillColor=OA(j.fillColor,A),j.lineColor=OA(j.lineColor,A)):ne(j)&&(j.inlineCodeTextColor=OA(j.inlineCodeTextColor,A),j.inlineCodeFillColor=OA(j.inlineCodeFillColor,A),j.borderColor=OA(j.borderColor,A))}function OA(j,A){if(wj(j)||!pt(j))return j;let{customProperty:e,metadata:t}=np(j);if(!El(e))return j;let r=A[e];if(!r)return j;let o=`var(${e}, ${r})`;return t?`${o} ${t}`:o}function A0(j){switch(j.type){case"color":case"border":return!0;case"array":case"boolean":case"number":case"string":case"richtext":case"eventhandler":case"image":case"file":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"gap":case"padding":case"borderradius":case"collectionreference":case"multicollectionreference":case"trackingid":case"vectorsetitem":case"date":case"enum":case"link":case"linkrelvalues":case"fusednumber":case"object":case"font":case"pagescope":case"slot":case"slug":case"controlReference":case"nodePropertyControlReference":return!1;default:iA(j,"Check if we support this variable type.")}}function j0(j){if(!w(j))return!1;for(let A of j.children)if(!IA(A)||TA(A)&&A.children.length>0)return!1;return!0}function e0(j,A,e){if(Ae(e))return;let t;j.stores.scopeStore.removeNode(A);let r=gr(j.tree,e.id);r&&j.tree.removeNode(r);let o=j.tree.root.homePageNodeId,n=gr(j.tree,A.id);n&&(A.id===o?j.tree.removeNode(n):n.set({webPageId:e.id})),j.tree.current(e)?.set({name:A.name,pagePath:A.pagePath}),j.tree.has(o)||(t??={},t.homePageNodeId=e.id),t&&j.tree.root.set(t)}function ui(j,A){return j.filter(e=>e.originalid===A.id).sort((e,t)=>(t.breakpointWidth??0)-(e.breakpointWidth??0))}function rQ(j,A){let e=j.getPresetsListNode();$(e,"Can't find PresetsListNode");let t=e.children.filter(je);return ui(t,A)}function CQ(j,A,e){if(!XA(e))return;let t=e.getStylePresetsForCodeGeneration(j);for(let r of t){let o=j.getNodes(r.cache.replicaInstances??[]);for(let n of o)A[n.id]??=n.toJS();A[r.id]??=r.toJS()}}function ld(j,A,e){for(let t of A){let r=j[t];if(!r)continue;let o=e(r);o&&o.id!==r&&j.set({[t]:o.id})}}function r0({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t,fromSameProject:r,breakpointVariantIds:o,shouldCreateNewPresets:n}){if(!t)return;let a={pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:n},i=c=>WG(j,c,a);if(ld(A,Vm,i),A.remapTextStylePresets(i),r)return;let s=on(A),l=j.tree.getGroundNodeFor(A);for(let c of A.getStylePresetIdsForCodeGeneration()){let u=t.find(f=>f.id===c);if(!u||!lo(u))continue;let p=ui(t,u);if(s){Zs(j.tree,s,A,p,u);continue}if(o?.has(l.id)&&sj(l)){let f=As(p,E=>(E.breakpointWidth??0)>l.width)??u;A.detachTextStylePreset(f,!1);continue}A.detachTextStylePreset(u,!1)}}function WG(j,A,{pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:r}){if(!t)return;let o=t.find(u=>u.id===A);if(!o)return;let n=j.tree.get(A);if(n&&lo(n)&&n.equals(o))return e.set(A,n),n;if(!r)return;let i=Rt(j.tree),s=i.getTextStylePresets().find(u=>u.equals(o));if(s&&lo(s))return e.set(A,s),s;let l=n?o.clone():o.cloneWithIds();j.tree.insertNode(l,i.id),e.set(A,l);let c=t.filter(u=>u.originalid===A);for(let u of c){let p=j.tree.get(A);if(p&&Cu(p)&&p.equals(u)){e.set(A,p);continue}let E=p?u.clone():u.cloneWithIds();j.tree.insertNode(E,i.id),e.set(A,E)}return l}function o0({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>zG(j,n,r);ld(A,Jm,o),A.remapLinkStylePresets(o)}function zG(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!Uj(r))return;let o=j.tree.get(A);if(o&&Uj(o)&&o.equals(r))return e.set(A,o),o;let a=Rt(j.tree),i=a.getLinkStylePresets().find(l=>l.equals(r));if(i&&Uj(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function n0({engine:j,node:A,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>XG(j,n,r);ld(A,Hm,o),A.remapInlineCodeStylePresets(o)}function XG(j,A,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(l=>l.id===A);if(!r||!ne(r))return;let o=j.tree.get(A);if(o&&ne(o)&&o.equals(r))return e.set(A,o),o;let a=Rt(j.tree),i=a.getInlineCodeStylePresets().find(l=>l.equals(r));if(i&&ne(i))return e.set(A,i),i;let s=o?r.clone():r.cloneWithIds();return j.tree.insertNode(s,a.id),e.set(A,s),s}function vQ(j){if(w(j))return{id:j.id,pagePath:j.pagePath,webMetadata:j.webMetadata,customHTML:j.customHTML,dataIdentifier:j.dataIdentifier}}function TQ(j,A,e,t){let r={},o=new Set;function n(a){Ls(a,i=>{if(t.has(i))return;let s=YG(j,i);s&&(r[i]=s);let l=rm(i,j.tree,j.stores.modulesStore,o);l&&Object.assign(r,l)})}for(let a of A.walk())n(a);return w(e)&&n(e),{moduleData:r}}function YG(j,A){let e=oA(A);if(e&&e.kind==="localModuleExport"){let t=j.stores.modulesStore.getPersistedModuleByLocalId(e.localId);return t?($(t.files.module,"expected module typed file in persisted module"),me(t.id,t.saveId,t.files.module,e.exportSpecifier)):void 0}if(e&&e.kind==="externalModuleExport")return e}function ZG(j,A,e){let t=oA(A);if(ej(t))return $(j.stores.modulesStore.initialized,"Cannot paste modules before modulesStore has been initialized."),j.stores.modulesStore.getPersistedModuleByLocalId(t.localId)?.id===e.moduleId?null:e.value;if(Fe(t)&&t.kind==="externalModuleExport"){let r=j.stores.modulesStore.getPersistedModuleByGlobalId(t.moduleId)?.localId;return r?eo(t,r).value:null}return null}function AS(j,A,e,t,r){let o=t.cloneWithIds();o.set(r),j.removeNode(t),j.insertNode(o,A,e)}function PQ(j,A,e){if(!e)return A;for(let t of A.root.walk())TA(t)&&t.children.forEach((r,o)=>{if(e){let n=qs(r,i=>{let s=e[i];if(!s)return;let l=ZG(j,i,s);return l||void 0});if(!n)return;let a=A.current(r);if(!a)return;AS(A,t.id,o,a,n)}});return A.commit()}function jS(j){return dj(j)&&sj(j)}function _Q(j,A,e){let t=j.get(e.id);if(!t)return;let r=on(t);if(!r||!IA(r))return;let o=j.getNodes(r.cache.replicaInstances??[]).filter(jS);for(let{width:n,replicaInfo:a}of o){let i=A.get(n)??{},s=a.overrides[e.id];s&&(i[e.id]=s),A.set(n,i)}sj(r)&&!A.get(r.width)&&A.set(r.width,{})}function KA(j,A,e,t){if(A){if(pt(A)){let r=ha(A),o=j.get(r);if(o&&!(o.id in e)){let n=o.cloneWithIds();e[n.id]=n.toJS(),t&&(t[o.id]=qt())}return}if(zu(A)){KA(j,A.color,e,t);return}if(Ek(A)||fk(A)||Bk(A)){for(let r of A.stops)KA(j,r.value,e,t);return}if(cj(A)){for(let r of A)KA(j,r,e,t);return}if(Br(A)){KA(j,A.borderColor,e,t);return}}}function xQ(j,A,e,t){if(XA(A)){let r=A.getInlineStyleTokenVariables();if(KA(j,r,e,t),A.htmlContent)eS(j,A,e,t);else if(A.hasLinks()){let o=A.getLinkStylePresets(!0);for(let n of o){let a=j.getNodeWithTrait(n,Uj);a&&i0(j,a,e,t)}}}for(let r in A)KA(j,A[r],e,t)}function eS(j,A,e,t){for(let r of _o){let o=A[r];if(!o)continue;let n=j.getNodeWithTrait(o,Ln);n&&(je(n)?(KA(j,n.textColor,e,t),KA(j,n.textStrokeColor,e,t),KA(j,n.textDecorationColor,e,t)):Uj(n)?i0(j,n,e,t):Dt(n)?(KA(j,n.textColor,e,t),KA(j,n.textDecorationColor,e,t),KA(j,n.textStrokeColor,e,t),KA(j,n.borderColor,e,t),KA(j,n.fillColor,e,t),KA(j,n.lineColor,e,t)):ne(n)?(KA(j,n.inlineCodeTextColor,e,t),KA(j,n.inlineCodeFillColor,e,t),KA(j,n.borderColor,e,t)):He(n)&&KA(j,n.borderColor,e,t))}}function i0(j,A,e,t){KA(j,A.linkTextColor,e,t),KA(j,A.linkTextDecorationColor,e,t),KA(j,A.linkTextBackgroundColor,e,t),KA(j,A.linkHoverTextColor,e,t),KA(j,A.linkHoverTextDecorationColor,e,t),KA(j,A.linkHoverTextBackgroundColor,e,t),KA(j,A.linkCurrentTextColor,e,t),KA(j,A.linkCurrentTextDecorationColor,e,t),KA(j,A.linkCurrentTextBackgroundColor,e,t)}function MQ(j,A,e){let t=e-A;return Math.ceil(j/100*t+A)}function t0({collectedCollections:j,node:A,tree:e}){if(Ae(A)){let t=oA(A.dataIdentifier);if(!ej(t))return;let r=e.getNodeWithTrait(t.localIdName,fj);r&&(j.set(A.dataIdentifier,r),t0({collectedCollections:j,node:r,tree:e}))}if(fj(A))for(let t of A.variables){if(!ga(t))continue;let r=oA(t.dataIdentifier);if(!ej(r))continue;let o=e.getNodeWithTrait(r.localIdName,fj);o&&(j.has(t.dataIdentifier)||(j.set(t.dataIdentifier,o),t0({collectedCollections:j,node:o,tree:e})))}}function VQ(j){return hj(j)?j.getGroundNodes().length===0:!1}function KQ(j){if(!w(j))return!1;let A=j.getGroundNodes();return A.length>1?!1:A.length===0?!0:A[0]?.children?.length===0}function JQ(j){return j?!j.children||j.children.length===0:!1}function cd(j,A=!0){let e=j.trim().split("/").filter(Boolean).map(t=>{let r="/"+t,o=Ws(r);return o.startsWith("/")?o.slice(1):o});return j.endsWith("/")&&A&&e.push(""),e}function HQ(j){return`/${cd(j).join("/")}`}function tS(j){return j===""}function QQ(j){return!!(j.webPageId&&tS(j.segment))}function rS(j,A){let e=A.get(j);if(!Nt(e))return;let t=A.get(e.webPageId);if(w(t)||e.children.length>0)return;let r=e.parentid;A.removeNode(e),r&&rS(r,A)}function UQ(j,A){if(!j)return;let e=L.dataForIdentifier(j);if(e)return Lf(void 0,e,A??Hu)}function a0(j,A,e,t,r){let o=cd(t,w(A,!0));$(o.length>0,"Path must have at least one segment");let n=mo(j.tree,{shouldAssert:!0});return o.forEach((a,i)=>{let s=i===o.length-1,l=s?r?.positionInParent:void 0,c=Sa(a)?e:void 0;c&&(a=od(c,a));let u=n.children.find(f=>f.segment===a),p=u&&s&&A;if(!u||p&&u.webPageId){let f=new jf({segment:a,webPageId:s?A?.id:void 0,dataIdentifier:c});j.tree.insertNode(f,n.id,l),n=f}else p&&u.set({webPageId:A.id,dataIdentifier:c}),n=u}),$(Nt(n),"Current parent should be the created RouteSegmentNode"),n}function s0(j,A){let e=gr(j,A);return j.get(e?.parentid)?.children.findIndex(r=>r.id===e?.id)}function oS(j,A,e){let t=new Set(j.stores.scopeStore.getSmartComponentNodes().map(r=>r.name).filter(x));return e||A===null?Pj(e??"Component",t):Pj(A,t)}function dd(j,A,e,t,{insertionIndex:r,preferredName:o,enterIsolation:n=!0,localIdsToExternalIdentifiers:a=new Map,externalModuleIdsToLocalIds:i=new Map,instance:s,renamedIds:l=new Map,isAutoDetach:c=!1,intrinsicSize:u,textStylePresets:p,linkStylePresets:f,inlineCodeStylePresets:E,pastedPresetMap:F=new Map,fromInsertSidebar:R=!1,abTesting:S=!1}={}){let v=c?ts.createEmpty():j.tree,P={children:[]};if(w(A)){let N=A.id===j.tree.root.homePageNodeId?"Home":Xt(j.tree,A),{suggestedName:z,path:J}=nd(o??N??"Page",j,A,!0);P.pagePath=J,P.name=z}else P.name=oS(j,A.name,o);let T=A.clone(P);l.set(A.id,T.id),eA(A)&&AE({componentId:T.id,source:t});let D=T.instanceIdentifier,K=IA(e),Q=Jr(e,a,i,l,K),Z=[Q];T.baseVariantId=Q.id,T.addChild(Q);for(let N of A.children)if(!(N.id===e.id||uo(N)))if(dj(N)&&DA(N)){let z=qo(N.replicaInfo.overrides,l,!0);if($A(N)){z[Q.id]??={};let nA=z[Q.id];nA.top=N.top,nA.left=N.left,nA.right=N.right,nA.bottom=N.bottom,nA.centerAnchorX=N.centerAnchorX,nA.centerAnchorY=N.centerAnchorY}let J=kA.create(j.tree,Q,{overrides:z,duplicatedFrom:In(N)});l.set(N.id,J.id),Z.push(J),T.addChild(J)}else{let z=Jr(N,a,i,void 0,K);Z.push(z),l.set(N.id,z.id),T.addChild(z)}v.insertNode(T,void 0,r);for(let N=0;N<A.children.length;N++){let z=A.children[N];if(!uo(z))continue;let J=kA.create(v,Q,{overrides:qo(z.replicaInfo.overrides,l,!0),inheritsFrom:l.get(z.replicaInfo.inheritsFrom),duplicatedFrom:In(z)});l.set(z.id,J.id),Z.push(J),v.insertNode(J,T.id,N)}let H=Us(v);for(let N of Z){if(Ne(v,N,l,!1),!p&&!f&&!E)continue;let z=[];for(let J of N.walk())XA(J)&&z.push(J);for(let J of z){let nA=J.getStylePresetIdsForCodeGeneration();if(f&&o0({engine:j,node:J,pastedPresetMap:F,stylePresetNodes:f}),E&&n0({engine:j,node:J,pastedPresetMap:F,stylePresetNodes:E}),p){if(R)r0({engine:j,node:J,pastedPresetMap:F,stylePresetNodes:p,fromSameProject:!0,shouldCreateNewPresets:R});else for(let BA of p)if(nA.has(BA.id))if(w(A)&&IA(N)){if(Zj(N)){let ZA=ui(p,BA);Zs(v,Q,J,ZA,BA)}}else(Zj(N)||YA(v,J,"html"))&&J.detachTextStylePreset(BA,!1)}}for(let J of z){YA(v,J,"html")&&(J.remapTextStylePresets((nA,BA)=>{let ZA=Ik(BA)?BA:"p",zA=J.getNodeTextStylePreset(v,ZA)??js(v,ZA)??Sk.createDefault(ZA);return Ym(j,zA),zA}),J.remapLinkStylePresets(()=>{let nA=J.getNodeLinkStylePreset(v)??zm(v)??Lm.createDefault();return Xm(j,nA),nA}),J.remapInlineCodeStylePresets(()=>{let nA=J.getNodeInlineCodeStylePreset(v)??Um(v)??new Tm;return Wm(j,nA),nA}));for(let nA in H)YA(v,J,nA)&&J.set({[nA]:H[nA]})}}let{codeGenerationStore:AA}=j.stores;for(let N of F.values())gA(N)||AA.createModuleFromComponentSource(N).catch(GA);if(c)return v.commit(),T.draftOrCurrent();{let N=v.get(T.baseVariantId);if(N&&Ej(N))for(let z of T.children)Bn(z)&&z.replicaInfo.master===N.id&&kA.registerInInheritedNode(N,z)}j.scheduler.process(()=>{if(!s)return;let N=j.tree.current(s);if(!N)return;let z={},J={},nA=s.getRawControlProps();if(nA.variant?.value&&x(nA.variant.value)){let BA=l.get(nA.variant.value)??Q.id,ZA={type:"enum",value:BA};z.variant=ZA}for(let BA of sd){let ZA=s[BA];x(ZA)&&(J[BA]=l.get(ZA)??void 0)}Jt(j.tree,N).forEach(({relatedNode:BA,replicaRoot:ZA})=>{let zA=ZA.replicaInfo.overrides[BA.originalid];if(!zA)return;let xj={};for(let pe of sd){if(!(pe in zA))continue;let cr=zA[pe];x(cr)&&(J[pe]=l.get(cr)??void 0)}if(BA.set(xj),!(QA("variant")in zA))return;let uj=BA.getRawControlProp("variant");if(!uj||!x(uj.value))return;let Mj=l.get(uj.value);if(!Mj)return;let ue={type:"enum",value:Mj};BA.set(co({variant:ue}))}),N.set({codeComponentIdentifier:D,...J,...co(z)})});let jA=AA.createModuleFromComponentSource(T,u);if(s&&jA.then(j.scheduler.wrapHandler(()=>{if(s=j.tree.get(s?.id),!s)return;let N=j.stores.treeStore.tree.getScopeNodeFor(s)?.loaded;if(!N||!Rr(N))return;let z=j.stores.treeStore.tree.get(N.baseVariantId);z&&Ej(z)&&AA.updateComponent(N.id).catch(GA)})).catch(GA),n&&(j.stores.chromeStore.contentPanelTab="Layers",j.stores.scopeStore.select(T.id,{keepHistory:!0})),Ga(j.tree)&&w(T)&&!S){$(x(P.pagePath),"pagePath should be a string");let N=s0(j.tree,A.id),z=Y(N)?N+1:void 0;a0(j,T,T.dataIdentifier,P.pagePath,{positionInParent:z})}return T.draftOrCurrent()}async function l0(j,{identifier:A,enterIsolation:e,instance:t,isAutoDetach:r,renamedIds:o=new Map,info:n}){let{node:a,dependencies:i}=await L$(j,A);$($s(a),"Should be a generated node.");let s=j.tree.get(t?.originalid??t?.id);$(!s||W(s),"instance should be a code component.");let l=a.children.find(R=>R.id===a.baseVariantId);$(l&&Ej(l),"Unlink: Can't unlink a tree which doesn't have a Primary Variant node");let{identifiers:c,localIdsToExternalIdentifiers:u,externalModuleIdsToLocalIds:p}=O$(a,j.stores.modulesStore,i);if(await UB(c.map(R=>R.value),j.stores.modulesStore),c.some(R=>{let S=L.dataForIdentifier(R.value);return S?ck(S):!1})){PA({type:"add",variant:"info",text:"Remove collection references before unlinking"});return}let E=await N$(i.imports);return await q$(j,i,A),await j.stores.modulesStore.addExternalModulesToProject(c,{onTreeUpdate:()=>{let R=j.tree.current(s),S=ft(n.module.metadata.intrinsicWidth)??200,v=ft(n.module.metadata.intrinsicHeight)??200,P=dd(j,a,l,"unlink",{enterIsolation:e,localIdsToExternalIdentifiers:u,externalModuleIdsToLocalIds:p,instance:R,renamedIds:o,isAutoDetach:r,intrinsicSize:{width:S,height:v},textStylePresets:E});return R&&eA(P)&&zB(j,R,P),P}})}async function c0(j,A){let e=await l0(j,A);if(!e)return;$(eA(e),"node should be a smart component");let{isAutoDetach:t}=A;return t||await j.stores.codeGenerationStore.untilCompiled(e.id),e.draftOrCurrent()}async function d0(j,A){let[e]=await j.stores.modulesStore.preloadExternalModules([A]);if(!e)return;let t=await l0(j,{identifier:A,enterIsolation:!1,info:e});$(w(t),"node should be a web page");let{path:r,suggestedName:o}=nd(t.name??"Page",j,t,!0);return j.scheduler.processWhenReady(()=>{j.tree.current(t)?.set({name:o,pagePath:r});let n=j.stores.scopeStore.active;j0(n)&&e0(j,n,t),j.stores.scopeStore.select(t.id,{keepHistory:!1})}),t}function u0(j,A,e,t){let r=dd(j,A,e,"duplicate",{enterIsolation:!1,preferredName:t,insertionIndex:j.tree.root.children.findIndex(o=>o.id===A.id)+1});j.stores.persistedUserDefaults.newContentAsDraft&&r.set({isDraft:!0,duplicatedFrom:ya(r.duplicatedFrom,A.id)}),j.stores.scopeStore.select(r.id,{keepHistory:!1})}async function iW(j,A){let e=new Map,t=new Set(j.stores.scopeStore.getDesignPageNodes().map(i=>i.name).filter(x)),r=Pj(A.name??"Design",t),o=A.isLoaded()?A:await A.load();if(!o)return;let n=o.clone({name:r,children:[]});e.set(o.id,n.id);let a=[];for(let i of o.children){let s=Jr(i,new Map,new Map,e,!1);a.push(s),e.set(i.id,s.id),n.addChild(s)}j.tree.insertNode(n,void 0,j.tree.root.children.findIndex(i=>i.id===A.id)+1);for(let i of a)Ne(j.tree,i,e,!1);return mA("design_page_create",{pageId:n.id,source:"duplicate"}),n}function p0(j,A){let[e,...t]=A.stores.selectionStore.ids;if(!e||t.length)return null;let r=A.tree,o=r.getNode(e),n=!1;for(;!n&&o&&(n=Qt(r,o,j,A.stores.scopeStore.active.id,L),!n);)o=r.getParent(o.id);return o}function ud(j){let A={};for(let[e,t]of j)f0(A,e,t);return A}function Jo(j,A,e){return ij(j,t=>{f0(t,A,e)})}function j6(j,A){return j[A]?ij(j,e=>{let t=e[A];if(t){for(let r of t.dependents){let o=e[r];o&&(o.dependencies.delete(A),A6(o)&&delete e[r])}for(let r of t.dependencies){let o=e[r];o&&(o.dependents.delete(A),A6(o)&&delete e[r])}delete e[A]}}):j}function Qr(j,A,e,t,r){let o=new Set,n=[A];for(t=t||new Set,r=r||new Set;n.length>0;){let a=n.pop();if(!a||o.has(a))continue;o.add(a);let i=j[a];if(i){if(t.has(a))r.add(a);else if(!t.size)e.add(a);else{let s=!1;for(let l of i.dependents)if(t.has(l)||r.has(l)){s=!0;break}s?r.add(a):e.add(a)}for(let s of i.dependents)o.has(s)||n.push(s)}}}function m0(j,A){let e=new Set,t=[A];for(;iS(t);){let r=t.shift(),o=j[r];if(o){for(let n of o.dependents)e.has(n)||(e.add(n),t.push(n));if(e.has(A))return!0}}return!1}function nS(j,A){let e=xe(j,A);if(e)return e.startsWith("collection")&&!A.startsWith("collection")&&!A.startsWith("draftCollection")?e.replace("collection","draftCollection"):e}function f0(j,A,e){let t=j[A];if(!t){if(e.length===0)return;t=k0(j,A)}let r=new Set(t.dependencies);for(let o of e){let n=nS(o,A);if(!n)continue;t.dependencies.add(n);let a=j[n];a||(a=k0(j,n)),a.dependents.add(A),t.dependencies.add(n),r.delete(n)}for(let o of r){let n=j[o];n&&(n.dependents.delete(A),A6(n)&&delete j[o])}A6(t)&&delete j[A]}function A6(j){return j.dependents.size===0&&j.dependencies.size===0}function k0(j,A){let e={dependents:new Set,dependencies:new Set};return j[A]=e,e}function iS(j){return j.length>0}var tr=".tsx";var aS=["arguments","await","break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","eval","export","extends","false","finally","for","function","if","implements","import","in","instanceof","interface","let","new","null","package","private","protected","public","return","static","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","Infinity","NaN","document","undefined","window"],sS=["toolbar"],lS=/^[$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10140}-\u{10174}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{1031F}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{103A0}-\u{103C3}\u{103C8}-\u{103CF}\u{103D1}-\u{103D5}\u{10400}-\u{1049D}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10860}-\u{10876}\u{10880}-\u{1089E}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{10900}-\u{10915}\u{10920}-\u{10939}\u{10980}-\u{109B7}\u{109BE}\u{109BF}\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A60}-\u{10A7C}\u{10A80}-\u{10A9C}\u{10AC0}-\u{10AC7}\u{10AC9}-\u{10AE4}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B60}-\u{10B72}\u{10B80}-\u{10B91}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10D00}-\u{10D23}\u{10F00}-\u{10F1C}\u{10F27}\u{10F30}-\u{10F45}\u{10FE0}-\u{10FF6}\u{11003}-\u{11037}\u{11083}-\u{110AF}\u{110D0}-\u{110E8}\u{11103}-\u{11126}\u{11144}\u{11150}-\u{11172}\u{11176}\u{11183}-\u{111B2}\u{111C1}-\u{111C4}\u{111DA}\u{111DC}\u{11200}-\u{11211}\u{11213}-\u{1122B}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A8}\u{112B0}-\u{112DE}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}\u{11350}\u{1135D}-\u{11361}\u{11400}-\u{11434}\u{11447}-\u{1144A}\u{1145F}\u{11480}-\u{114AF}\u{114C4}\u{114C5}\u{114C7}\u{11580}-\u{115AE}\u{115D8}-\u{115DB}\u{11600}-\u{1162F}\u{11644}\u{11680}-\u{116AA}\u{116B8}\u{11700}-\u{1171A}\u{11800}-\u{1182B}\u{118A0}-\u{118DF}\u{118FF}\u{119A0}-\u{119A7}\u{119AA}-\u{119D0}\u{119E1}\u{119E3}\u{11A00}\u{11A0B}-\u{11A32}\u{11A3A}\u{11A50}\u{11A5C}-\u{11A89}\u{11A9D}\u{11AC0}-\u{11AF8}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2E}\u{11C40}\u{11C72}-\u{11C8F}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D89}\u{11D98}\u{11EE0}-\u{11EF2}\u{12000}-\u{12399}\u{12400}-\u{1246E}\u{12480}-\u{12543}\u{13000}-\u{1342E}\u{14400}-\u{14646}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16AD0}-\u{16AED}\u{16B00}-\u{16B2F}\u{16B40}-\u{16B43}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16E40}-\u{16E7F}\u{16F00}-\u{16F4A}\u{16F50}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{17000}-\u{187F7}\u{18800}-\u{18AF2}\u{1B000}-\u{1B11E}\u{1B150}-\u{1B152}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E14E}\u{1E2C0}-\u{1E2EB}\u{1E800}-\u{1E8C4}\u{1E900}-\u{1E943}\u{1E94B}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{20000}-\u{2A6D6}\u{2A700}-\u{2B734}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2F800}-\u{2FA1D}]+/u,cS=/[\0-#%-/:-@[-^`{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0488\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u089F\u08B5\u08BE-\u08D2\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2-\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B72-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF0-\u0BFF\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B-\u0C5F\u0C64\u0C65\u0C70-\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0CFF\u0D04\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D58-\u0D5E\u0D64\u0D65\u0D70-\u0D79\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F2A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1715-\u171F\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u180A\u180E\u180F\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1ABE-\u1AFF\u1B4C-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1DFA\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u200C\u200E-\u203E\u2041-\u2053\u2055-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u20CF\u20DD-\u20E0\u20E2-\u20E4\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u220B\u220D-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31BB-\u31EF\u3200-\u33FF\u4DB6-\u4DFF\u9FF0-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA670-\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7C7-\uA7F6\uA828-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB68-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE32\uFE35-\uFE4C\uFE50-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3E\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF\u{1000C}\u{10027}\u{1003B}\u{1003E}\u{1004E}\u{1004F}\u{1005E}-\u{1007F}\u{100FB}-\u{1013F}\u{10175}-\u{101FC}\u{101FE}-\u{1027F}\u{1029D}-\u{1029F}\u{102D1}-\u{102DF}\u{102E1}-\u{102FF}\u{10320}-\u{1032C}\u{1034B}-\u{1034F}\u{1037B}-\u{1037F}\u{1039E}\u{1039F}\u{103C4}-\u{103C7}\u{103D0}\u{103D6}-\u{103FF}\u{1049E}\u{1049F}\u{104AA}-\u{104AF}\u{104D4}-\u{104D7}\u{104FC}-\u{104FF}\u{10528}-\u{1052F}\u{10564}-\u{105FF}\u{10737}-\u{1073F}\u{10756}-\u{1075F}\u{10768}-\u{107FF}\u{10806}\u{10807}\u{10809}\u{10836}\u{10839}-\u{1083B}\u{1083D}\u{1083E}\u{10856}-\u{1085F}\u{10877}-\u{1087F}\u{1089F}-\u{108DF}\u{108F3}\u{108F6}-\u{108FF}\u{10916}-\u{1091F}\u{1093A}-\u{1097F}\u{109B8}-\u{109BD}\u{109C0}-\u{109FF}\u{10A04}\u{10A07}-\u{10A0B}\u{10A14}\u{10A18}\u{10A36}\u{10A37}\u{10A3B}-\u{10A3E}\u{10A40}-\u{10A5F}\u{10A7D}-\u{10A7F}\u{10A9D}-\u{10ABF}\u{10AC8}\u{10AE7}-\u{10AFF}\u{10B36}-\u{10B3F}\u{10B56}-\u{10B5F}\u{10B73}-\u{10B7F}\u{10B92}-\u{10BFF}\u{10C49}-\u{10C7F}\u{10CB3}-\u{10CBF}\u{10CF3}-\u{10CFF}\u{10D28}-\u{10D2F}\u{10D3A}-\u{10EFF}\u{10F1D}-\u{10F26}\u{10F28}-\u{10F2F}\u{10F51}-\u{10FDF}\u{10FF7}-\u{10FFF}\u{11047}-\u{11065}\u{11070}-\u{1107E}\u{110BB}-\u{110CF}\u{110E9}-\u{110EF}\u{110FA}-\u{110FF}\u{11135}\u{11140}-\u{11143}\u{11147}-\u{1114F}\u{11174}\u{11175}\u{11177}-\u{1117F}\u{111C5}-\u{111C8}\u{111CD}-\u{111CF}\u{111DB}\u{111DD}-\u{111FF}\u{11212}\u{11238}-\u{1123D}\u{1123F}-\u{1127F}\u{11287}\u{11289}\u{1128E}\u{1129E}\u{112A9}-\u{112AF}\u{112EB}-\u{112EF}\u{112FA}-\u{112FF}\u{11304}\u{1130D}\u{1130E}\u{11311}\u{11312}\u{11329}\u{11331}\u{11334}\u{1133A}\u{11345}\u{11346}\u{11349}\u{1134A}\u{1134E}\u{1134F}\u{11351}-\u{11356}\u{11358}-\u{1135C}\u{11364}\u{11365}\u{1136D}-\u{1136F}\u{11375}-\u{113FF}\u{1144B}-\u{1144F}\u{1145A}-\u{1145D}\u{11460}-\u{1147F}\u{114C6}\u{114C8}-\u{114CF}\u{114DA}-\u{1157F}\u{115B6}\u{115B7}\u{115C1}-\u{115D7}\u{115DE}-\u{115FF}\u{11641}-\u{11643}\u{11645}-\u{1164F}\u{1165A}-\u{1167F}\u{116B9}-\u{116BF}\u{116CA}-\u{116FF}\u{1171B}\u{1171C}\u{1172C}-\u{1172F}\u{1173A}-\u{117FF}\u{1183B}-\u{1189F}\u{118EA}-\u{118FE}\u{11900}-\u{1199F}\u{119A8}\u{119A9}\u{119D8}\u{119D9}\u{119E2}\u{119E5}-\u{119FF}\u{11A3F}-\u{11A46}\u{11A48}-\u{11A4F}\u{11A9A}-\u{11A9C}\u{11A9E}-\u{11ABF}\u{11AF9}-\u{11BFF}\u{11C09}\u{11C37}\u{11C41}-\u{11C4F}\u{11C5A}-\u{11C71}\u{11C90}\u{11C91}\u{11CA8}\u{11CB7}-\u{11CFF}\u{11D07}\u{11D0A}\u{11D37}-\u{11D39}\u{11D3B}\u{11D3E}\u{11D48}-\u{11D4F}\u{11D5A}-\u{11D5F}\u{11D66}\u{11D69}\u{11D8F}\u{11D92}\u{11D99}-\u{11D9F}\u{11DAA}-\u{11EDF}\u{11EF7}-\u{11FFF}\u{1239A}-\u{123FF}\u{1246F}-\u{1247F}\u{12544}-\u{12FFF}\u{1342F}-\u{143FF}\u{14647}-\u{167FF}\u{16A39}-\u{16A3F}\u{16A5F}\u{16A6A}-\u{16ACF}\u{16AEE}\u{16AEF}\u{16AF5}-\u{16AFF}\u{16B37}-\u{16B3F}\u{16B44}-\u{16B4F}\u{16B5A}-\u{16B62}\u{16B78}-\u{16B7C}\u{16B90}-\u{16E3F}\u{16E80}-\u{16EFF}\u{16F4B}-\u{16F4E}\u{16F88}-\u{16F8E}\u{16FA0}-\u{16FDF}\u{16FE2}\u{16FE4}-\u{16FFF}\u{187F8}-\u{187FF}\u{18AF3}-\u{1AFFF}\u{1B11F}-\u{1B14F}\u{1B153}-\u{1B163}\u{1B168}-\u{1B16F}\u{1B2FC}-\u{1BBFF}\u{1BC6B}-\u{1BC6F}\u{1BC7D}-\u{1BC7F}\u{1BC89}-\u{1BC8F}\u{1BC9A}-\u{1BC9C}\u{1BC9F}-\u{1D164}\u{1D16A}-\u{1D16C}\u{1D173}-\u{1D17A}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D241}\u{1D245}-\u{1D3FF}\u{1D455}\u{1D49D}\u{1D4A0}\u{1D4A1}\u{1D4A3}\u{1D4A4}\u{1D4A7}\u{1D4A8}\u{1D4AD}\u{1D4BA}\u{1D4BC}\u{1D4C4}\u{1D506}\u{1D50B}\u{1D50C}\u{1D515}\u{1D51D}\u{1D53A}\u{1D53F}\u{1D545}\u{1D547}-\u{1D549}\u{1D551}\u{1D6A6}\u{1D6A7}\u{1D6C1}\u{1D6DB}\u{1D6FB}\u{1D715}\u{1D735}\u{1D74F}\u{1D76F}\u{1D789}\u{1D7A9}\u{1D7C3}\u{1D7CC}\u{1D7CD}\u{1D800}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA9A}\u{1DAA0}\u{1DAB0}-\u{1DFFF}\u{1E007}\u{1E019}\u{1E01A}\u{1E022}\u{1E025}\u{1E02B}-\u{1E0FF}\u{1E12D}-\u{1E12F}\u{1E13E}\u{1E13F}\u{1E14A}-\u{1E14D}\u{1E14F}-\u{1E2BF}\u{1E2FA}-\u{1E7FF}\u{1E8C5}-\u{1E8CF}\u{1E8D7}-\u{1E8FF}\u{1E94C}-\u{1E94F}\u{1E95A}-\u{1EDFF}\u{1EE04}\u{1EE20}\u{1EE23}\u{1EE25}\u{1EE26}\u{1EE28}\u{1EE33}\u{1EE38}\u{1EE3A}\u{1EE3C}-\u{1EE41}\u{1EE43}-\u{1EE46}\u{1EE48}\u{1EE4A}\u{1EE4C}\u{1EE50}\u{1EE53}\u{1EE55}\u{1EE56}\u{1EE58}\u{1EE5A}\u{1EE5C}\u{1EE5E}\u{1EE60}\u{1EE63}\u{1EE65}\u{1EE66}\u{1EE6B}\u{1EE73}\u{1EE78}\u{1EE7D}\u{1EE7F}\u{1EE8A}\u{1EE9C}-\u{1EEA0}\u{1EEA4}\u{1EEAA}\u{1EEBC}-\u{1FFFF}\u{2A6D7}-\u{2A6FF}\u{2B735}-\u{2B73F}\u{2B81E}\u{2B81F}\u{2CEA2}-\u{2CEAF}\u{2EBE1}-\u{2F7FF}\u{2FA1E}-\u{E00FF}\u{E01F0}-\u{10FFFF}]+/gu,dS=/^\.+$/u,fW=(j,A)=>{if(j===null||j.trim().length===0)return null;let e=1,t=j.replace(/_\d+$/u,""),r=j;for(;A.includes(r)||uS(r);)r=`${t}_${e}`,e++;return r},uS=j=>aS.includes(j)||window.hasOwnProperty(j)&&!sS.includes(j);function pd(j,A){if(!A)return null;let e=A.trim();if(e.length===0)return null;let t=j==="selector"?"_":"$";if(j==="directory"){if(dS.test(e))return null}else lS.test(e)||(e=t+e);return e=e.replace(cS,"_"),e=e.replace(/_+/gu,"_"),e=e.replace(/^\$_/u,t),e}function Ho(j){return pd("variable",j)}function EW(j){let A=pd("selector",j);return A&&(A=A.replace(/^\$/gu,"_")),A}function E0(j){return pd("directory",j)}function $0(j){let e=Ho(j)||"MyComponent",t=e+tr,r=pS(e);return{name:t,content:r}}function pS(j){return`// Get Started: https://www.framer.com/developers

import { addPropertyControls, ControlType } from "framer"
import { motion } from "framer-motion"

/**
 * @framerSupportedLayoutWidth auto
 * @framerSupportedLayoutHeight auto
 */
export default function ${j}(props) {
    const { tint } = props

    return (
        <motion.div
            style={{
                margin: 50,
                width: 100,
                height: 100,
                borderRadius: 25,
                backgroundColor: tint,
            }}
            animate={{ scale: 1.5 }}
            whileHover={{ rotate: 90 }}
        />
    )
}

addPropertyControls(${j}, {
    tint: {
        title: "Tint",
        type: ControlType.Color,
        defaultValue: "#09F",
    },
})
`}function kS(j){return`import { forwardRef, type ComponentType } from "react"
import { createStore } from "https://framer.com/m/framer/store.js@^1.0.0"
import { randomColor } from "https://framer.com/m/framer/utils.js@^0.9.0"

// Learn more: https://www.framer.com/developers/overrides/

const useStore = createStore({
    background: "#0099FF",
})

export function withRotate(Component): ComponentType {
    return forwardRef((props, ref) => {
        return (
            <Component
                ref={ref}
                {...props}
                animate={{ rotate: 90 }}
                transition={{ duration: 2 }}
            />
        )
    })
}

export function withHover(Component): ComponentType {
    return forwardRef((props, ref) => {
        return <Component ref={ref} {...props} whileHover={{ scale: 1.05 }} />
    })
}

export function withRandomColor(Component): ComponentType {
    return forwardRef((props, ref) => {
        const [store, setStore] = useStore()

        return (
            <Component
                ref={ref}
                {...props}
                animate={{
                    background: store.background,
                }}
                onClick={() => {
                    setStore({ background: randomColor() })
                }}
            />
        )
    })
}
`}function B0(j){let e=Ho(j)||"MyOverrides",t=e+tr,r=kS(e);return{name:t,content:r}}function pi(j){return j.endsWith(".json")?!0:/\.[tj]sx?$/u.test(j)}var mS=/^(?:[\w-]+\/)*[\w-]+(?:\.[\w-]+)*$/u;function TW(j){let{path:A}=h0(j);return mS.test(A)}function fS(j,A){if(pi(j))return j;let[e,t]=Zi(A);return t&&(t=`.${t}`),(!t||!pi(t))&&(t=tr),j+t}function PW(j){return pi(j)||(j+=".tsx"),j}function ES(j){let A=j.lastIndexOf("/");return A<0?"":j.slice(0,A)}function $S(j){let A=j.lastIndexOf("/")+1;return j.slice(A)}function kd(...j){let A="";return j.forEach(e=>{for(;e.startsWith("/");)e=e.slice(1);for(;e.endsWith("/");)e=e.slice(0,-1);e!==""&&(A!==""&&(A+="/"),A+=e)}),A}function h0(j,A=!0){j=j.trim();let[e,t]=Zi($S(j));t&&(t=`.${t}`);let r=ES(j).split("/").map(a=>E0(a)).filter(a=>!!a).join("/"),o=Ho(e)||"MyComponent";return(!pi(t)||t===tr)&&A&&(o=Eu(o)),{path:kd(r,o+t),dirName:r,name:o,extension:t}}function _W(j,A="component",e=!0){j=j.trim();let{dirName:t,name:r,extension:o}=h0(j,e);if(pi(o)&&o!==tr){let i=r+o;return{path:kd(t,i),content:""}}let n=A==="component"?$0(r):B0(r),a=fS(r+o,n.name);return{path:kd(t,a),content:n.content}}function g0(j,A){if(!j.has(A))return A;let e=1,t,[r,o]=Zi(A);o&&(o=`.${o}`);do t=r+"_"+String(e++)+o;while(j.has(t));return t}function xW(j){return j==="typescript"||j==="javascript"}var BS=1;function hS(j){return j==="screen"||j==="canvasComponent"}function md(j){let A=j.metadata.compatibleCmsVersion;return Y(A)?A:0}function gS(j){let A=CA(j);return j.imports.relative.some(e=>{let t=xe(e,A);return x(t)&&t.startsWith("collection")})}function fd(j){return hS(j.type)&&gS(j)}function LW(j){return fd(j)&&md(j)<BS}var Qo,ki,Uo=class{constructor(A){this.limit=A;LA(this,Qo,0);LA(this,ki,[])}async run(A,e){if(rA(this,Qo)===this.limit){let t=new Promise(r=>{rA(this,ki).push(r)});e&&(t=Promise.race([t,RS(e)])),await t}I0(e),x6(this,Qo)._++;try{return await A()}finally{x6(this,Qo)._--,rA(this,ki).shift()?.()}}};Qo=new WeakMap,ki=new WeakMap;var R0=new WeakMap;function RS(j){let A=R0.get(j);return A||(I0(j),A=new Promise((e,t)=>{j.addEventListener("abort",()=>{t(j.reason)},{once:!0})}),R0.set(j,A)),A}function I0(j){if(j?.aborted)throw j.reason}function mi(j){let A=new Set;if(!j)return A;if(w(j)&&Fa(j)){let e=F0(j.layoutTemplateIdentifier);e&&A.add(e)}for(let{node:e,skipChildren:t}of j.walkWithSkipChildren()){if(!W(e))continue;if(gA(e)){t();continue}let r=F0(e.codeComponentIdentifier);r&&A.add(r)}return A}function F0(j){let A=oA(j);if(!(!A||!ej(A)))return CA({type:A.type,name:A.localIdName})}var G0;(function(j){j[j.Static=1]="Static",j[j.Dynamic=2]="Dynamic",j[j.ImportMeta=3]="ImportMeta",j[j.StaticSourcePhase=4]="StaticSourcePhase",j[j.DynamicSourcePhase=5]="DynamicSourcePhase"})(G0||(G0={}));var IS=new Uint8Array(new Uint16Array([1]).buffer)[0]===1;function $d(j,A="@"){if(!wA)return Bd.then(()=>$d(j));let e=j.length+1,t=(wA.__heap_base.value||wA.__heap_base)+4*e-wA.memory.buffer.byteLength;t>0&&wA.memory.grow(Math.ceil(t/65536));let r=wA.sa(e-1);if((IS?GS:FS)(j,new Uint16Array(wA.memory.buffer,r,e)),!wA.parse())throw Object.assign(new Error(`Parse error ${A}:${j.slice(0,wA.e()).split(`
`).length}:${wA.e()-j.lastIndexOf(`
`,wA.e()-1)}`),{idx:wA.e()});let o=[],n=[];for(;wA.ri();){let i=wA.is(),s=wA.ie(),l=wA.it(),c=wA.ai(),u=wA.id(),p=wA.ss(),f=wA.se(),E;wA.ip()&&(E=a(j.slice(u===-1?i-1:i,u===-1?s+1:s))),o.push({n:E,t:l,s:i,e:s,ss:p,se:f,d:u,a:c})}for(;wA.re();){let i=wA.es(),s=wA.ee(),l=wA.els(),c=wA.ele(),u=j.slice(i,s),p=u[0],f=l<0?void 0:j.slice(l,c),E=f?f[0]:"";n.push({s:i,e:s,ls:l,le:c,n:p==='"'||p==="'"?a(u):u,ln:E==='"'||E==="'"?a(f):f})}function a(i){try{return(0,eval)(i)}catch{}}return[o,n,!!wA.f(),!!wA.ms()]}function FS(j,A){let e=j.length,t=0;for(;t<e;){let r=j.charCodeAt(t);A[t++]=(255&r)<<8|r>>>8}}function GS(j,A){let e=j.length,t=0;for(;t<e;)A[t]=j.charCodeAt(t++)}var wA,Bd=WebAssembly.compile((Ed="AGFzbQEAAAABKwhgAX8Bf2AEf39/fwBgAAF/YAAAYAF/AGADf39/AX9gAn9/AX9gA39/fwADMTAAAQECAgICAgICAgICAgICAgICAgIAAwMDBAQAAAUAAAAAAAMDAwAGAAAABwAGAgUEBQFwAQEBBQMBAAEGDwJ/AUHA8gALfwBBwPIACwd6FQZtZW1vcnkCAAJzYQAAAWUAAwJpcwAEAmllAAUCc3MABgJzZQAHAml0AAgCYWkACQJpZAAKAmlwAAsCZXMADAJlZQANA2VscwAOA2VsZQAPAnJpABACcmUAEQFmABICbXMAEwVwYXJzZQAUC19faGVhcF9iYXNlAwEKm0EwaAEBf0EAIAA2AoAKQQAoAtwJIgEgAEEBdGoiAEEAOwEAQQAgAEECaiIANgKECkEAIAA2AogKQQBBADYC4AlBAEEANgLwCUEAQQA2AugJQQBBADYC5AlBAEEANgL4CUEAQQA2AuwJIAEL0wEBA39BACgC8AkhBEEAQQAoAogKIgU2AvAJQQAgBDYC9AlBACAFQSRqNgKICiAEQSBqQeAJIAQbIAU2AgBBACgC1AkhBEEAKALQCSEGIAUgATYCACAFIAA2AgggBSACIAJBAmpBACAGIANGIgAbIAQgA0YiBBs2AgwgBSADNgIUIAVBADYCECAFIAI2AgQgBUEANgIgIAVBA0EBQQIgABsgBBs2AhwgBUEAKALQCSADRiICOgAYAkACQCACDQBBACgC1AkgA0cNAQtBAEEBOgCMCgsLXgEBf0EAKAL4CSIEQRBqQeQJIAQbQQAoAogKIgQ2AgBBACAENgL4CUEAIARBFGo2AogKQQBBAToAjAogBEEANgIQIAQgAzYCDCAEIAI2AgggBCABNgIEIAQgADYCAAsIAEEAKAKQCgsVAEEAKALoCSgCAEEAKALcCWtBAXULHgEBf0EAKALoCSgCBCIAQQAoAtwJa0EBdUF/IAAbCxUAQQAoAugJKAIIQQAoAtwJa0EBdQseAQF/QQAoAugJKAIMIgBBACgC3AlrQQF1QX8gABsLCwBBACgC6AkoAhwLHgEBf0EAKALoCSgCECIAQQAoAtwJa0EBdUF/IAAbCzsBAX8CQEEAKALoCSgCFCIAQQAoAtAJRw0AQX8PCwJAIABBACgC1AlHDQBBfg8LIABBACgC3AlrQQF1CwsAQQAoAugJLQAYCxUAQQAoAuwJKAIAQQAoAtwJa0EBdQsVAEEAKALsCSgCBEEAKALcCWtBAXULHgEBf0EAKALsCSgCCCIAQQAoAtwJa0EBdUF/IAAbCx4BAX9BACgC7AkoAgwiAEEAKALcCWtBAXVBfyAAGwslAQF/QQBBACgC6AkiAEEgakHgCSAAGygCACIANgLoCSAAQQBHCyUBAX9BAEEAKALsCSIAQRBqQeQJIAAbKAIAIgA2AuwJIABBAEcLCABBAC0AlAoLCABBAC0AjAoL3Q0BBX8jAEGA0ABrIgAkAEEAQQE6AJQKQQBBACgC2Ak2ApwKQQBBACgC3AlBfmoiATYCsApBACABQQAoAoAKQQF0aiICNgK0CkEAQQA6AIwKQQBBADsBlgpBAEEAOwGYCkEAQQA6AKAKQQBBADYCkApBAEEAOgD8CUEAIABBgBBqNgKkCkEAIAA2AqgKQQBBADoArAoCQAJAAkACQANAQQAgAUECaiIDNgKwCiABIAJPDQECQCADLwEAIgJBd2pBBUkNAAJAAkACQAJAAkAgAkGbf2oOBQEICAgCAAsgAkEgRg0EIAJBL0YNAyACQTtGDQIMBwtBAC8BmAoNASADEBVFDQEgAUEEakGCCEEKEC8NARAWQQAtAJQKDQFBAEEAKAKwCiIBNgKcCgwHCyADEBVFDQAgAUEEakGMCEEKEC8NABAXC0EAQQAoArAKNgKcCgwBCwJAIAEvAQQiA0EqRg0AIANBL0cNBBAYDAELQQEQGQtBACgCtAohAkEAKAKwCiEBDAALC0EAIQIgAyEBQQAtAPwJDQIMAQtBACABNgKwCkEAQQA6AJQKCwNAQQAgAUECaiIDNgKwCgJAAkACQAJAAkACQAJAIAFBACgCtApPDQAgAy8BACICQXdqQQVJDQYCQAJAAkACQAJAAkACQAJAAkACQCACQWBqDgoQDwYPDw8PBQECAAsCQAJAAkACQCACQaB/ag4KCxISAxIBEhISAgALIAJBhX9qDgMFEQYJC0EALwGYCg0QIAMQFUUNECABQQRqQYIIQQoQLw0QEBYMEAsgAxAVRQ0PIAFBBGpBjAhBChAvDQ8QFwwPCyADEBVFDQ4gASkABELsgISDsI7AOVINDiABLwEMIgNBd2oiAUEXSw0MQQEgAXRBn4CABHFFDQwMDQtBAEEALwGYCiIBQQFqOwGYCkEAKAKkCiABQQN0aiIBQQE2AgAgAUEAKAKcCjYCBAwNC0EALwGYCiIDRQ0JQQAgA0F/aiIDOwGYCkEALwGWCiICRQ0MQQAoAqQKIANB//8DcUEDdGooAgBBBUcNDAJAIAJBAnRBACgCqApqQXxqKAIAIgMoAgQNACADQQAoApwKQQJqNgIEC0EAIAJBf2o7AZYKIAMgAUEEajYCDAwMCwJAQQAoApwKIgEvAQBBKUcNAEEAKALwCSIDRQ0AIAMoAgQgAUcNAEEAQQAoAvQJIgM2AvAJAkAgA0UNACADQQA2AiAMAQtBAEEANgLgCQtBAEEALwGYCiIDQQFqOwGYCkEAKAKkCiADQQN0aiIDQQZBAkEALQCsChs2AgAgAyABNgIEQQBBADoArAoMCwtBAC8BmAoiAUUNB0EAIAFBf2oiATsBmApBACgCpAogAUH//wNxQQN0aigCAEEERg0EDAoLQScQGgwJC0EiEBoMCAsgAkEvRw0HAkACQCABLwEEIgFBKkYNACABQS9HDQEQGAwKC0EBEBkMCQsCQAJAAkACQEEAKAKcCiIBLwEAIgMQG0UNAAJAAkAgA0FVag4EAAkBAwkLIAFBfmovAQBBK0YNAwwICyABQX5qLwEAQS1GDQIMBwsgA0EpRw0BQQAoAqQKQQAvAZgKIgJBA3RqKAIEEBxFDQIMBgsgAUF+ai8BAEFQakH//wNxQQpPDQULQQAvAZgKIQILAkACQCACQf//A3EiAkUNACADQeYARw0AQQAoAqQKIAJBf2pBA3RqIgQoAgBBAUcNACABQX5qLwEAQe8ARw0BIAQoAgRBlghBAxAdRQ0BDAULIANB/QBHDQBBACgCpAogAkEDdGoiAigCBBAeDQQgAigCAEEGRg0ECyABEB8NAyADRQ0DIANBL0ZBAC0AoApBAEdxDQMCQEEAKAL4CSICRQ0AIAEgAigCAEkNACABIAIoAgRNDQQLIAFBfmohAUEAKALcCSECAkADQCABQQJqIgQgAk0NAUEAIAE2ApwKIAEvAQAhAyABQX5qIgQhASADECBFDQALIARBAmohBAsCQCADQf//A3EQIUUNACAEQX5qIQECQANAIAFBAmoiAyACTQ0BQQAgATYCnAogAS8BACEDIAFBfmoiBCEBIAMQIQ0ACyAEQQJqIQMLIAMQIg0EC0EAQQE6AKAKDAcLQQAoAqQKQQAvAZgKIgFBA3QiA2pBACgCnAo2AgRBACABQQFqOwGYCkEAKAKkCiADakEDNgIACxAjDAULQQAtAPwJQQAvAZYKQQAvAZgKcnJFIQIMBwsQJEEAQQA6AKAKDAMLECVBACECDAULIANBoAFHDQELQQBBAToArAoLQQBBACgCsAo2ApwKC0EAKAKwCiEBDAALCyAAQYDQAGokACACCxoAAkBBACgC3AkgAEcNAEEBDwsgAEF+ahAmC/4KAQZ/QQBBACgCsAoiAEEMaiIBNgKwCkEAKAL4CSECQQEQKSEDAkACQAJAAkACQAJAAkACQAJAQQAoArAKIgQgAUcNACADEChFDQELAkACQAJAAkACQAJAAkAgA0EqRg0AIANB+wBHDQFBACAEQQJqNgKwCkEBECkhA0EAKAKwCiEEA0ACQAJAIANB//8DcSIDQSJGDQAgA0EnRg0AIAMQLBpBACgCsAohAwwBCyADEBpBAEEAKAKwCkECaiIDNgKwCgtBARApGgJAIAQgAxAtIgNBLEcNAEEAQQAoArAKQQJqNgKwCkEBECkhAwsgA0H9AEYNA0EAKAKwCiIFIARGDQ8gBSEEIAVBACgCtApNDQAMDwsLQQAgBEECajYCsApBARApGkEAKAKwCiIDIAMQLRoMAgtBAEEAOgCUCgJAAkACQAJAAkACQCADQZ9/ag4MAgsEAQsDCwsLCwsFAAsgA0H2AEYNBAwKC0EAIARBDmoiAzYCsAoCQAJAAkBBARApQZ9/ag4GABICEhIBEgtBACgCsAoiBSkAAkLzgOSD4I3AMVINESAFLwEKECFFDRFBACAFQQpqNgKwCkEAECkaC0EAKAKwCiIFQQJqQbIIQQ4QLw0QIAUvARAiAkF3aiIBQRdLDQ1BASABdEGfgIAEcUUNDQwOC0EAKAKwCiIFKQACQuyAhIOwjsA5Ug0PIAUvAQoiAkF3aiIBQRdNDQYMCgtBACAEQQpqNgKwCkEAECkaQQAoArAKIQQLQQAgBEEQajYCsAoCQEEBECkiBEEqRw0AQQBBACgCsApBAmo2ArAKQQEQKSEEC0EAKAKwCiEDIAQQLBogA0EAKAKwCiIEIAMgBBACQQBBACgCsApBfmo2ArAKDwsCQCAEKQACQuyAhIOwjsA5Ug0AIAQvAQoQIEUNAEEAIARBCmo2ArAKQQEQKSEEQQAoArAKIQMgBBAsGiADQQAoArAKIgQgAyAEEAJBAEEAKAKwCkF+ajYCsAoPC0EAIARBBGoiBDYCsAoLQQAgBEEGajYCsApBAEEAOgCUCkEBECkhBEEAKAKwCiEDIAQQLCEEQQAoArAKIQIgBEHf/wNxIgFB2wBHDQNBACACQQJqNgKwCkEBECkhBUEAKAKwCiEDQQAhBAwEC0EAQQE6AIwKQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0AQQAgA0EIajYCsAogAEEBEClBABArIAJBEGpB5AkgAhshAwNAIAMoAgAiA0UNBSADQgA3AgggA0EQaiEDDAALC0EAIANBfmo2ArAKDAMLQQEgAXRBn4CABHFFDQMMBAtBASEECwNAAkACQCAEDgIAAQELIAVB//8DcRAsGkEBIQQMAQsCQAJAQQAoArAKIgQgA0YNACADIAQgAyAEEAJBARApIQQCQCABQdsARw0AIARBIHJB/QBGDQQLQQAoArAKIQMCQCAEQSxHDQBBACADQQJqNgKwCkEBECkhBUEAKAKwCiEDIAVBIHJB+wBHDQILQQAgA0F+ajYCsAoLIAFB2wBHDQJBACACQX5qNgKwCg8LQQAhBAwACwsPCyACQaABRg0AIAJB+wBHDQQLQQAgBUEKajYCsApBARApIgVB+wBGDQMMAgsCQCACQVhqDgMBAwEACyACQaABRw0CC0EAIAVBEGo2ArAKAkBBARApIgVBKkcNAEEAQQAoArAKQQJqNgKwCkEBECkhBQsgBUEoRg0BC0EAKAKwCiEBIAUQLBpBACgCsAoiBSABTQ0AIAQgAyABIAUQAkEAQQAoArAKQX5qNgKwCg8LIAQgA0EAQQAQAkEAIARBDGo2ArAKDwsQJQvcCAEGf0EAIQBBAEEAKAKwCiIBQQxqIgI2ArAKQQEQKSEDQQAoArAKIQQCQAJAAkACQAJAAkACQAJAIANBLkcNAEEAIARBAmo2ArAKAkBBARApIgNB8wBGDQAgA0HtAEcNB0EAKAKwCiIDQQJqQZwIQQYQLw0HAkBBACgCnAoiBBAqDQAgBC8BAEEuRg0ICyABIAEgA0EIakEAKALUCRABDwtBACgCsAoiA0ECakGiCEEKEC8NBgJAQQAoApwKIgQQKg0AIAQvAQBBLkYNBwsgA0EMaiEDDAELIANB8wBHDQEgBCACTQ0BQQYhAEEAIQIgBEECakGiCEEKEC8NAiAEQQxqIQMCQCAELwEMIgVBd2oiBEEXSw0AQQEgBHRBn4CABHENAQsgBUGgAUcNAgtBACADNgKwCkEBIQBBARApIQMLAkACQAJAAkAgA0H7AEYNACADQShHDQFBACgCpApBAC8BmAoiA0EDdGoiBEEAKAKwCjYCBEEAIANBAWo7AZgKIARBBTYCAEEAKAKcCi8BAEEuRg0HQQBBACgCsAoiBEECajYCsApBARApIQMgAUEAKAKwCkEAIAQQAQJAAkAgAA0AQQAoAvAJIQQMAQtBACgC8AkiBEEFNgIcC0EAQQAvAZYKIgBBAWo7AZYKQQAoAqgKIABBAnRqIAQ2AgACQCADQSJGDQAgA0EnRg0AQQBBACgCsApBfmo2ArAKDwsgAxAaQQBBACgCsApBAmoiAzYCsAoCQAJAAkBBARApQVdqDgQBAgIAAgtBAEEAKAKwCkECajYCsApBARApGkEAKALwCSIEIAM2AgQgBEEBOgAYIARBACgCsAoiAzYCEEEAIANBfmo2ArAKDwtBACgC8AkiBCADNgIEIARBAToAGEEAQQAvAZgKQX9qOwGYCiAEQQAoArAKQQJqNgIMQQBBAC8BlgpBf2o7AZYKDwtBAEEAKAKwCkF+ajYCsAoPCyAADQJBACgCsAohA0EALwGYCg0BA0ACQAJAAkAgA0EAKAK0Ck8NAEEBECkiA0EiRg0BIANBJ0YNASADQf0ARw0CQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0JC0EAIANBCGo2ArAKAkBBARApIgNBIkYNACADQSdHDQkLIAEgA0EAECsPCyADEBoLQQBBACgCsApBAmoiAzYCsAoMAAsLIAANAUEGIQBBACECAkAgA0FZag4EBAMDBAALIANBIkYNAwwCC0EAIANBfmo2ArAKDwtBDCEAQQEhAgtBACgCsAoiAyABIABBAXRqRw0AQQAgA0F+ajYCsAoPC0EALwGYCg0CQQAoArAKIQNBACgCtAohAANAIAMgAE8NAQJAAkAgAy8BACIEQSdGDQAgBEEiRw0BCyABIAQgAhArDwtBACADQQJqIgM2ArAKDAALCxAlCw8LQQBBACgCsApBfmo2ArAKC0cBA39BACgCsApBAmohAEEAKAK0CiEBAkADQCAAIgJBfmogAU8NASACQQJqIQAgAi8BAEF2ag4EAQAAAQALC0EAIAI2ArAKC5gBAQN/QQBBACgCsAoiAUECajYCsAogAUEGaiEBQQAoArQKIQIDQAJAAkACQCABQXxqIAJPDQAgAUF+ai8BACEDAkACQCAADQAgA0EqRg0BIANBdmoOBAIEBAIECyADQSpHDQMLIAEvAQBBL0cNAkEAIAFBfmo2ArAKDAELIAFBfmohAQtBACABNgKwCg8LIAFBAmohAQwACwuIAQEEf0EAKAKwCiEBQQAoArQKIQICQAJAA0AgASIDQQJqIQEgAyACTw0BIAEvAQAiBCAARg0CAkAgBEHcAEYNACAEQXZqDgQCAQECAQsgA0EEaiEBIAMvAQRBDUcNACADQQZqIAEgAy8BBkEKRhshAQwACwtBACABNgKwChAlDwtBACABNgKwCgtsAQF/AkACQCAAQV9qIgFBBUsNAEEBIAF0QTFxDQELIABBRmpB//8DcUEGSQ0AIABBKUcgAEFYakH//wNxQQdJcQ0AAkAgAEGlf2oOBAEAAAEACyAAQf0ARyAAQYV/akH//wNxQQRJcQ8LQQELLgEBf0EBIQECQCAAQaYJQQUQHQ0AIABBlghBAxAdDQAgAEGwCUECEB0hAQsgAQtGAQN/QQAhAwJAIAAgAkEBdCICayIEQQJqIgBBACgC3AkiBUkNACAAIAEgAhAvDQACQCAAIAVHDQBBAQ8LIAQQJiEDCyADC4MBAQJ/QQEhAQJAAkACQAJAAkACQCAALwEAIgJBRWoOBAUEBAEACwJAIAJBm39qDgQDBAQCAAsgAkEpRg0EIAJB+QBHDQMgAEF+akG8CUEGEB0PCyAAQX5qLwEAQT1GDwsgAEF+akG0CUEEEB0PCyAAQX5qQcgJQQMQHQ8LQQAhAQsgAQu0AwECf0EAIQECQAJAAkACQAJAAkACQAJAAkACQCAALwEAQZx/ag4UAAECCQkJCQMJCQQFCQkGCQcJCQgJCwJAAkAgAEF+ai8BAEGXf2oOBAAKCgEKCyAAQXxqQcoIQQIQHQ8LIABBfGpBzghBAxAdDwsCQAJAAkAgAEF+ai8BAEGNf2oOAwABAgoLAkAgAEF8ai8BACICQeEARg0AIAJB7ABHDQogAEF6akHlABAnDwsgAEF6akHjABAnDwsgAEF8akHUCEEEEB0PCyAAQXxqQdwIQQYQHQ8LIABBfmovAQBB7wBHDQYgAEF8ai8BAEHlAEcNBgJAIABBemovAQAiAkHwAEYNACACQeMARw0HIABBeGpB6AhBBhAdDwsgAEF4akH0CEECEB0PCyAAQX5qQfgIQQQQHQ8LQQEhASAAQX5qIgBB6QAQJw0EIABBgAlBBRAdDwsgAEF+akHkABAnDwsgAEF+akGKCUEHEB0PCyAAQX5qQZgJQQQQHQ8LAkAgAEF+ai8BACICQe8ARg0AIAJB5QBHDQEgAEF8akHuABAnDwsgAEF8akGgCUEDEB0hAQsgAQs0AQF/QQEhAQJAIABBd2pB//8DcUEFSQ0AIABBgAFyQaABRg0AIABBLkcgABAocSEBCyABCzABAX8CQAJAIABBd2oiAUEXSw0AQQEgAXRBjYCABHENAQsgAEGgAUYNAEEADwtBAQtOAQJ/QQAhAQJAAkAgAC8BACICQeUARg0AIAJB6wBHDQEgAEF+akH4CEEEEB0PCyAAQX5qLwEAQfUARw0AIABBfGpB3AhBBhAdIQELIAEL3gEBBH9BACgCsAohAEEAKAK0CiEBAkACQAJAA0AgACICQQJqIQAgAiABTw0BAkACQAJAIAAvAQAiA0Gkf2oOBQIDAwMBAAsgA0EkRw0CIAIvAQRB+wBHDQJBACACQQRqIgA2ArAKQQBBAC8BmAoiAkEBajsBmApBACgCpAogAkEDdGoiAkEENgIAIAIgADYCBA8LQQAgADYCsApBAEEALwGYCkF/aiIAOwGYCkEAKAKkCiAAQf//A3FBA3RqKAIAQQNHDQMMBAsgAkEEaiEADAALC0EAIAA2ArAKCxAlCwtwAQJ/AkACQANAQQBBACgCsAoiAEECaiIBNgKwCiAAQQAoArQKTw0BAkACQAJAIAEvAQAiAUGlf2oOAgECAAsCQCABQXZqDgQEAwMEAAsgAUEvRw0CDAQLEC4aDAELQQAgAEEEajYCsAoMAAsLECULCzUBAX9BAEEBOgD8CUEAKAKwCiEAQQBBACgCtApBAmo2ArAKQQAgAEEAKALcCWtBAXU2ApAKC0MBAn9BASEBAkAgAC8BACICQXdqQf//A3FBBUkNACACQYABckGgAUYNAEEAIQEgAhAoRQ0AIAJBLkcgABAqcg8LIAELPQECf0EAIQICQEEAKALcCSIDIABLDQAgAC8BACABRw0AAkAgAyAARw0AQQEPCyAAQX5qLwEAECAhAgsgAgtoAQJ/QQEhAQJAAkAgAEFfaiICQQVLDQBBASACdEExcQ0BCyAAQfj/A3FBKEYNACAAQUZqQf//A3FBBkkNAAJAIABBpX9qIgJBA0sNACACQQFHDQELIABBhX9qQf//A3FBBEkhAQsgAQucAQEDf0EAKAKwCiEBAkADQAJAAkAgAS8BACICQS9HDQACQCABLwECIgFBKkYNACABQS9HDQQQGAwCCyAAEBkMAQsCQAJAIABFDQAgAkF3aiIBQRdLDQFBASABdEGfgIAEcUUNAQwCCyACECFFDQMMAQsgAkGgAUcNAgtBAEEAKAKwCiIDQQJqIgE2ArAKIANBACgCtApJDQALCyACCzEBAX9BACEBAkAgAC8BAEEuRw0AIABBfmovAQBBLkcNACAAQXxqLwEAQS5GIQELIAELnAQBAX8CQCABQSJGDQAgAUEnRg0AECUPC0EAKAKwCiEDIAEQGiAAIANBAmpBACgCsApBACgC0AkQAQJAIAJFDQBBACgC8AlBBDYCHAtBAEEAKAKwCkECajYCsAoCQAJAAkACQEEAECkiAUHhAEYNACABQfcARg0BQQAoArAKIQEMAgtBACgCsAoiAUECakHACEEKEC8NAUEGIQAMAgtBACgCsAoiAS8BAkHpAEcNACABLwEEQfQARw0AQQQhACABLwEGQegARg0BC0EAIAFBfmo2ArAKDwtBACABIABBAXRqNgKwCgJAQQEQKUH7AEYNAEEAIAE2ArAKDwtBACgCsAoiAiEAA0BBACAAQQJqNgKwCgJAAkACQEEBECkiAEEiRg0AIABBJ0cNAUEnEBpBAEEAKAKwCkECajYCsApBARApIQAMAgtBIhAaQQBBACgCsApBAmo2ArAKQQEQKSEADAELIAAQLCEACwJAIABBOkYNAEEAIAE2ArAKDwtBAEEAKAKwCkECajYCsAoCQEEBECkiAEEiRg0AIABBJ0YNAEEAIAE2ArAKDwsgABAaQQBBACgCsApBAmo2ArAKAkACQEEBECkiAEEsRg0AIABB/QBGDQFBACABNgKwCg8LQQBBACgCsApBAmo2ArAKQQEQKUH9AEYNAEEAKAKwCiEADAELC0EAKALwCSIBIAI2AhAgAUEAKAKwCkECajYCDAttAQJ/AkACQANAAkAgAEH//wNxIgFBd2oiAkEXSw0AQQEgAnRBn4CABHENAgsgAUGgAUYNASAAIQIgARAoDQJBACECQQBBACgCsAoiAEECajYCsAogAC8BAiIADQAMAgsLIAAhAgsgAkH//wNxC6sBAQR/AkACQEEAKAKwCiICLwEAIgNB4QBGDQAgASEEIAAhBQwBC0EAIAJBBGo2ArAKQQEQKSECQQAoArAKIQUCQAJAIAJBIkYNACACQSdGDQAgAhAsGkEAKAKwCiEEDAELIAIQGkEAQQAoArAKQQJqIgQ2ArAKC0EBECkhA0EAKAKwCiECCwJAIAIgBUYNACAFIARBACAAIAAgAUYiAhtBACABIAIbEAILIAMLcgEEf0EAKAKwCiEAQQAoArQKIQECQAJAA0AgAEECaiECIAAgAU8NAQJAAkAgAi8BACIDQaR/ag4CAQQACyACIQAgA0F2ag4EAgEBAgELIABBBGohAAwACwtBACACNgKwChAlQQAPC0EAIAI2ArAKQd0AC0kBA39BACEDAkAgAkUNAAJAA0AgAC0AACIEIAEtAAAiBUcNASABQQFqIQEgAEEBaiEAIAJBf2oiAg0ADAILCyAEIAVrIQMLIAMLC+wBAgBBgAgLzgEAAHgAcABvAHIAdABtAHAAbwByAHQAZgBvAHIAZQB0AGEAbwB1AHIAYwBlAHIAbwBtAHUAbgBjAHQAaQBvAG4AcwBzAGUAcgB0AHYAbwB5AGkAZQBkAGUAbABlAGMAbwBuAHQAaQBuAGkAbgBzAHQAYQBuAHQAeQBiAHIAZQBhAHIAZQB0AHUAcgBkAGUAYgB1AGcAZwBlAGEAdwBhAGkAdABoAHIAdwBoAGkAbABlAGkAZgBjAGEAdABjAGYAaQBuAGEAbABsAGUAbABzAABB0AkLEAEAAAACAAAAAAQAAEA5AAA=",typeof Buffer<"u"?Buffer.from(Ed,"base64"):Uint8Array.from(atob(Ed),j=>j.charCodeAt(0)))).then(WebAssembly.instantiate).then(({exports:j})=>{wA=j}),Ed;function hd(j){return j!==void 0?{ok:!0,value:j}:{ok:!0}}function gd(j){return{ok:!1,error:j}}function S0(j){return j.then(A=>hd(A),A=>gd(A))}var SS=/^\s*(['"](\..*)['"])\s*$/mu,fi=class extends Error{constructor(e){super();this.persistedMissingRelativeImports=e;this.name="RewriteRelativeImportsError"}};function e6(j){return j instanceof fi}async function t6(j,A){await Bd;let[e]=$d(j),t=j,r=new Set,o=[...e].reverse();for(let{s:n,e:a,d:i}of o){if(i===-2)continue;if(i===-1){let F=j.substring(n,a);if(!F.startsWith("."))continue;let R=A[F];R===void 0&&(r.add(F),R=b0(F)),t=y0(t,R,n,a);continue}let s=j.substring(n,a),c=s.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1").trim().match(SS);if(!c)continue;let u=c[1],p=c[2];if(u===void 0||p===void 0)continue;let f=A[p];f===void 0&&(r.add(p),f=b0(p));let E=s.replace(new RegExp(Rd(u),"g"),JSON.stringify(f));t=y0(t,E,n,a)}return r.size>0?gd({partiallyProcessedCode:t,unresolvedRelativeImports:r,parsedImports:e}):hd(t)}function y0(j,A,e,t){return j.slice(0,e)+A+j.slice(t)}function Rd(j){return j.replace(/[.*+\-?^${}()|[\]\\]/gu,"\\$&")}function b0(j){return`!missing/${j}`}var X=hA("modules-storage"),v0=Object.freeze({}),T0=Object.freeze({});function Nz(j){return j&&j.type==="codeFile"?($(x(j.sourceContent),"code module entry is missing source content"),!0):!1}function Id(j){return j.name===N6&&j.type===N7}function yS(j){return j.id===rt}function P0(j,A){return!!j&&j.saveId===A.saveId&&j.id===A.moduleId}var r6=class extends Error{constructor(){super("A circular dependency was detected."),this.name="CircularDependencyError"}},Ei="update-modules-storage",bS=0;async function rj(j){let A=performance.now(),e=`acquire-modules-storage-lock-${bS++}`;return Jn(e),lc.request(Ei,()=>{let t=performance.now()-A;return is(`\u{1F513} Acquire ${Ei} lock`,e),as(e),X.debug("\u{1F513} Acquired the",Ei,"lock in",t.toFixed(2),"ms"),t>1e3&&X.warn("\u2757 Long wait: it took",t.toFixed(0),"ms to acquire the",Ei,"lock."),j()})}var o6=class{constructor(A,e,t,r){this.storage=A;this.localId=e;this.type=t;this.debugModuleStoreAndComponentLoaderRevisionsMatch=r}get id(){let A=this.storage.getPersistedModuleByLocalId(this.localId);if(A)return A.id;let e=this.storage.getModuleTreeData(this.localId);return $(e,"Module must exist"),e.moduleId}get saveId(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.saveId;let e=this.storage.getPersistedModuleByLocalId(this.localId);return $(e,"Module must exist"),e.saveId}get transientSVGIcon(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.svgIcon}externalModuleIdentifier(A="default"){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e){let r=le(e.name);return me(this.id,e.saveId,r.module,A)}let t=this.storage.getPersistedModuleByLocalId(this.localId);return $(t?.files.module,"ModulesStorage: Expected module typed file in persisted module."),me(this.id,t.saveId,t.files.module,A)}delete(){return this.storage.delete(this.localId)}publish(A,e,t){return this.storage.publish(this.localId,{namespace:A,name:e,version:t})}sourceRevision(){let A=this.storage.getTransientSaveByLocalId(this.localId);if(A)return A.sourceRevision;let e=this.storage.getPersistedModuleByLocalId(this.localId);if(e)return yd(e)}annotations(A,e){let t=this.storage.getTransientSaveByLocalId(this.localId),r=t?.annotations?bo(t.annotations):this.storage.getModuleTreeData(this.localId)?.annotations;return A&&this.debugModuleStoreAndComponentLoaderRevisionsMatch()&&CS(r,A),e?r?.[e]:r}},Gd=class extends o6{constructor(e,t,r,o,n){super(e,t,r,o);this.name=n}currentSourceEquals(e,t){let r=this.storage.getPersistedModuleByLocalId(this.localId);return!r||r.submodules.length||t.submodules?.size?!1:r.sourceContent===e}updateSource(e,t={}){return this.storage.updateSources([{localId:this.localId,source:e,options:{...t,stableName:!0}}])}persist(e){return this.storage.upsert(this.localId,{...e,type:this.type,name:this.name})}getKitSectionsStructure(){let e=this.storage.getTransientSaveByLocalId(this.localId);return e?e.kitSectionsStructure:this.storage.getKitSectionsStructure(this.name)}};function CS(j,A){if(!j)return;let e=oA(A.identifier);$(ej(e)&&Sj(e),"Entity must have an identifier."),A.annotations&&e.exportSpecifier in j&&!oo(j[e.exportSpecifier],bo({default:A.annotations}).default,!0)&&X.reportError("Static annotations are not synchronized with runtime annotations.",{identifier:A.identifier})}function yd(j){let A=j?.metadata.sourceRevision;return Y(A)?A:void 0}var Sd=class extends o6{updateSource(A,e){return this.storage.updateSources([{localId:this.localId,source:A,options:e??{}}])}persist(A){return this.storage.update(this.localId,A)}rename(A){return this.storage.rename(this.localId,A)}},n6=class{constructor(A,e,t=()=>!0){this.storage=A;this.type=e;this.moduleStoreAndComponentLoaderRevisionsMatch=t}async create(A){return this.storage.create({...A,type:this.type})}getByStableName(A){return new Gd(this.storage,tt(this.type,A),this.type,this.moduleStoreAndComponentLoaderRevisionsMatch,A)}getByLocalId(A){return new Sd(this.storage,A,this.type,this.moduleStoreAndComponentLoaderRevisionsMatch)}getUniqueName(A){return this.storage.getUniqueNameForType(this.type,A)}},i6=class{constructor(A,e,t,r,o,n,a,i){this.getModulesService=A;this.compile=e;this.process=t;this.processWhenReady=r;this.runWhenIdle=o;this.treeStore=n;this.getActiveScope=a;this.makeDocumentReadOnly=i;g(this,"useTreeAsLocalModuleList",!1);g(this,"writeLocalModulesToTree",!1);g(this,"dependenciesModule");g(this,"persistedModules",new Map);g(this,"persistedLocalIdsByTypeSlashNameCache",new WeakMap);g(this,"transientSaves",new Map);g(this,"lastSnapshot",{dependenciesModule:void 0,modules:new Map,depsGraph:{},initialized:!1});g(this,"modulesService");g(this,"lazyServerModulesForTransientSaves",new Map);g(this,"backgroundJob",null);g(this,"backgroundAbortController",null);g(this,"initialized",!1);g(this,"initializationStarted",!1);g(this,"readOnlyTree",!1);g(this,"resolveInitialization",()=>{throw new Error("initializationPromise has not executed yet")});g(this,"rejectInitialization",()=>{throw new Error("initializationPromise has not executed yet")});g(this,"initializationPromise",new Promise((A,e)=>{this.resolveInitialization=A,this.rejectInitialization=e}));g(this,"didSetupModuleEventStream",!1);g(this,"transientInfo",null);g(this,"previousLocalModuleNodes",[]);g(this,"treeNodesToUpdate",new Map);g(this,"treeNodesToDelete",[]);g(this,"goingToStartUsingLocalModulesInTree",!1);g(this,"listeners",new Set);g(this,"transientSaveRetries",new Map);g(this,"transientSaveRelativeImportRetries",new Set);g(this,"downloadQueue",new Uo(1200))}hasPendingServerModules(){return this.lazyServerModulesForTransientSaves.size>0}processOnePendingServerModule(){return this.lazyServerModulesForTransientSaves.size===0?Promise.resolve(!1):rj(async()=>{for(let[,A]of this.lazyServerModulesForTransientSaves)for(let e of A){let t=this.persistedModules.get(e)?.localId;if(!t)continue;let r=this.persistedModules.get(t);if(r?.kind!=="server")continue;X.debug("\u{1F343} Process one server \u2192 local module",e);let o=await this.createLocalModuleFromModule(r),n=ij(this.persistedModules,a=>{a.set(r.localId,o)});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1,transientSaves:this.transientSaves}),!0}return!1})}async changeScope(A){if(!this.hasPendingServerModules())return;let e=mi(A);!e||e.size===0||(await rj(async()=>{let t=new Set,r=this.lastSnapshot.depsGraph;for(let[i,s]of this.lazyServerModulesForTransientSaves)Qr(r,i,s,e,t);let o=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&o.push(this.createLocalModuleFromModule(s))}if(X.debug("\u{1F343} Prioritizing making visible modules local after changing scope:",A.id,"/ Visible:",e,"/ Visible Dependencies:",t,"/ Server modules:",o.length),o.length===0)return;let n=await Promise.all(o),a=ij(this.persistedModules,i=>{for(let s of n)i.set(s.localId,s)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,depsGraph:r,didRemoteChange:!1,transientSaves:this.transientSaves})}),this.makeLazyServerModulesLocalWhenIdle().catch(GA))}async makeVisibleDependentServerModulesLocal(A){if(!yA.isOn("prioritizedModuleEvaluation"))return;let e=this.getActiveScope(),t=new Set,r=mi(e),o=new Set;for(let i of A){let s=this.typeAndNameFromLocalId(i.localId,i.options.stableName),l=CA(s),c=this.lastSnapshot.depsGraph;Qr(c,l,o,r,t),this.lazyServerModulesForTransientSaves.set(l,o),t.delete(l)}let n=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&n.push(this.createLocalModuleFromModule(s))}X.debug("\u{1F343} Prioritizing dependent server modules after updating:",A.map(i=>i.localId),"/ Visible:",t,"/ Lazy:",o,"/ Server modules:",n.length);let a=this.persistedModules;if(n.length>0){let i=await Promise.all(n);a=ij(a,s=>{for(let l of i)s.set(l.localId,l)})}this.persistedModules=a}async makeLazyServerModulesLocalWhenIdle(){this.cancelBackgroundJob(),this.backgroundAbortController=new AbortController;let{signal:A}=this.backgroundAbortController;return this.backgroundJob=(async()=>{try{for(;this.hasPendingServerModules()&&!A.aborted;){let e=new Qi;if(this.runWhenIdle(()=>{if(A.aborted){e.resolve(!1);return}this.processOnePendingServerModule().then(e.resolve,e.reject)}),!await e)break}}finally{this.backgroundJob=null,this.backgroundAbortController=null}})(),this.backgroundJob}cancelBackgroundJob(){this.backgroundAbortController&&this.backgroundAbortController.abort()}getTransientSave(A){return this.transientSaves.get(A)}resetModuleStateAndPermissions(A){this.readOnlyTree=A==="readonly",this.useTreeAsLocalModuleList=this.readOnlyTree,!this.readOnlyTree&&this.modulesService&&this.setupModuleEventStreamIfNeeded(),this.treeNodesToUpdate.clear(),this.treeNodesToDelete=[],this.transientSaves.size>0&&(X.reportErrorOncePerMinute(new Error("Discarding transient saves"),{count:this.transientSaves.size}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:new Map,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}))}async waitForModulesToSave(){let A=Array.from(this.transientSaves.keys());for(let t of A)this.transientSaves.has(t)&&await this.update(t,{});let e=this.transientSaves.size;e>0&&X.warn("waitForModulesToSave: transientSaves seems to be growing, ignoring rest:",e)}async initialize(){return this.initializationStarted?this.initializationPromise:(this.initializationStarted=!0,this.initializeInternal().then(this.resolveInitialization,A=>{X.reportError(A,{context:"Failed to initialize ModulesStorage: "}),this.rejectInitialization(A)}),this.initializationPromise)}setupModuleEventStreamIfNeeded(){this.didSetupModuleEventStream||(this.didSetupModuleEventStream=!0,$(this.modulesService,"ModulesStorage.useModuleEventStream: expected modules service to be initialized"),this.modulesService.moduleEventsStream().read(async({events:A})=>{let e=A.filter(PS);this.handleRemoteModuleSaveEvents(e).catch(X.reportError);let t=A.filter(_S);this.handleRemoteModuleDeleteEvents(t).catch(X.reportError)}).catch(A=>{X.reportError(A,{context:"Failed to read ModulesAPI event stream: "})}))}async initializeInternal(){if(this.modulesService=await this.getModulesService(),!this.modulesService)return;let A=this.treeStore.tree.getLocalModuleNodes();this.writeLocalModulesToTree=!!A,this.useTreeAsLocalModuleList||this.setupModuleEventStreamIfNeeded();let e,t=performance.now();if(ss("modulesStorageStart"),this.useTreeAsLocalModuleList&&A){X.info("init from tree data"),this.previousLocalModuleNodes=A;let s=A.map(l=>({moduleId:l.save.moduleId,saveId:l.save.saveId}));e=await this.modulesService.lookUpModules({queries:s})}else X.info("init from module list"),e=await this.modulesService.list({});ss("modulesStorageInit"),X.debug("listing modules took:",performance.now()-t,"millis");let r=e.data.find(Id);r&&await this.updateDependenciesModule(r);let o=new Map,n=0,a=new Set;await Promise.all(e.data.map(async s=>{if(CA(s)===rt)return;let l=await this.createServerModuleFromData(s);X.trace("init - create module",l.localId,l.id,l.saveId,l.savedAt),o.set(l.localId,l),MS(A,s)&&(n+=1),a.add(l.localId)}));let i=this.createDependencyGraph(o);this.initialized=!0,this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:o,transientSaves:this.transientSaves,depsGraph:i,didRemoteChange:!0}),ss("modulesStorageFirstPublish"),this.processTreeUpdates(),n>0&&X.reportError("Data loss detected based on modules saves and modules in tree.",{dataLossCount:n})}createDependencyGraph(A){let e=[];for(let t of A.values()){let r=CA(t),o=t.imports.relative;e.push([r,o])}return ud(e)}processTreeUpdates(){if(this.initialized){if(this.readOnlyTree)if(this.useTreeAsLocalModuleList){if(!this.treeStore.tree.has(Re)){X.info("detected removal of local modules list node, stopping to use tree as local module list"),this.useTreeAsLocalModuleList=!1,this.setupModuleEventStreamIfNeeded();return}}else{if(!this.treeStore.tree.has(Re))return;X.info("detected insertion of a local modules list node, starting to use tree as local module list"),this.useTreeAsLocalModuleList=!0}this.syncLocalModules(),this.tryWriteTreeData()}}async syncLocalModules(){if(!this.useTreeAsLocalModuleList)return;let A=this.treeStore.tree.getLocalModulesListNode()?.children;if(!A||this.previousLocalModuleNodes===A)return;let e=[],t=P7(this.previousLocalModuleNodes,r=>[r.id,r]);this.previousLocalModuleNodes=A;for(let r of A){let o=t.get(r.id);if(t.delete(r.id),o===r)continue;let n=r.save,a=this.persistedModules.get(r.id);P0(a,n)||yS(r)&&P0(this.dependenciesModule,n)||(e.push({moduleId:n.moduleId,saveId:n.saveId}),X.debug("syncLocalModules to update:",r.id))}if(t.size>0&&(X.debug("syncLocalModules removing:",t.keys()),this.handleRemoteModuleDeletes(Array.from(t.values()).map(r=>r.save.moduleId))),e.length>0){X.debug("syncLocalModules updating:",e),$(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let r=performance.now(),o=await this.modulesService.lookUpModules({queries:e});X.debug("lookupModules took:",performance.now()-r,"millis"),await this.handleRemoteModuleSaves(o.data)}}canWriteTree(){return!this.treeStore.tree.isViewOnly}tryWriteTreeData(){this.canWriteTree()&&(this.treeNodesToUpdate.size===0&&this.treeNodesToDelete.length===0||this.processWhenReady(()=>{if(!this.canWriteTree())return;let A=this.treeStore.tree;A.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(A);for(let e of this.treeNodesToDelete)this.persistedModules.get(e)||(X.debug("tryWriteTreeData, remove:",e),A.remove(e));this.treeNodesToDelete=[];for(let[e,{treeVersion:t,errors:r,persistedModule:o}]of this.treeNodesToUpdate.entries())this.persistedModules.get(e)?.saveId===o.saveId&&(X.debug("tryWriteTreeData, write:",e,t,o.id,o.saveId,r),this.updateNode(A,e,t,o,r));this.treeNodesToUpdate.clear()},"nonUserEvent"))}updateTreeNodeWithOwnTreeVersion(A,e){!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()||this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree);let r=this.treeStore.tree.get(A)?.save.treeVersion??this.treeStore.remoteTreeVersion;X.debug("updateTreeNodeWithCurrentTreeVersion:",A,r,e.id,e.saveId),this.updateNode(this.treeStore.tree,A,r,e)},"nonUserEvent")}updateTreeNode(A,e,t,r,o){return!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()?!0:this.canWriteTree()?(this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree),X.debug("updateTreeNode:",A,e,t.id,t.saveId),this.updateNode(this.treeStore.tree,A,e,t,r,o)},"nonUserEvent"),!0):(X.debug("updateTreeNode - readonly, buffering change"),this.treeNodesToUpdate.set(A,{treeVersion:e,persistedModule:t,errors:r,kitSectionsStructure:o}),!0)}removeTreeNode(A){this.writeLocalModulesToTree&&(this.canWriteTree()?this.process(()=>{X.debug("removeTreeNode:",A),this.treeStore.tree.remove(A)}):this.treeNodesToDelete.push(A))}updateNode(A,e,t,r,o,n){$(this.writeLocalModulesToTree,"not using tree for local modules");let a=A.get(e)?.asDraft()??new Ll({id:e});$(a instanceof Ll);let i=r.metadata.pluginId,s={treeVersion:t,moduleId:r.id,saveId:r.saveId,imports:r.imports?.relative,title:r.title,name:r.name,type:r.type,sourceRevision:r.sourceRevision,annotations:r.annotations?bo(r.annotations):a.save.annotations,pluginId:x(i)?i:a.save.pluginId};a.set({save:s}),a.tree()||A.insertNode(a,Re);let l=r.name;if(!A.has(l))return;if(cj(n)){let p=A.get(l);w(p)&&p.set({kitSectionsStructure:n})}if(!o)return;let c=A.get(hm);if(X.debug("Writing serialization errors from artifacts to tree for",l),c?.children?.forEach(p=>{let f=p.sourceNodeId??p.scopeId,E=sA(p.sourceNodeModuleType)||r.type===p.sourceNodeModuleType;!f||f!==l||!E||!gm(p.type)||A.remove(p.id)}),o.length===0)return;let u=A.ensureErrorListNode();o.forEach(p=>A.insertNode(p,u.id))}getModuleTreeData(A){return this.treeStore.tree.getNodeWithTrait(A,Tr)?.save}getKitSectionsStructure(A){return this.treeStore.tree.getNodeWithTrait(A,w)?.kitSectionsStructure}createLocalModulesListNodeIfNeeded(A){if($(this.writeLocalModulesToTree,"not using tree for local modules"),A.has(Re)||!this.canWriteTree())return;X.debug("ensureAllModulesExistInTree:",this.persistedModules.size),A.insertNode(new tm);let e=this.treeStore.remoteTreeVersion;this.persistedModules.forEach(t=>{this.updateNode(A,t.localId,e,t)}),this.dependenciesModule&&this.updateNode(A,rt,e,this.dependenciesModule)}usingLocalModulesInTree(){return this.treeStore.tree.has(Re)||this.goingToStartUsingLocalModulesInTree}async startUsingLocalModulesInTree(){if(!this.canWriteTree())throw Error("Project is read only.");this.goingToStartUsingLocalModulesInTree=!0,this.process(()=>{if(this.startUsingLocalModulesInTree){if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("startUsingLocalModulesInTree"),this.goingToStartUsingLocalModulesInTree=!1,this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}})}stopUsingLocalModulesInTree(){this.goingToStartUsingLocalModulesInTree=!1,this.process(()=>{if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("stopUsingLocalModulesInTree"),this.treeStore.tree.remove(Re),this.writeLocalModulesToTree=!1,this.setupModuleEventStreamIfNeeded()})}maybeUpgradeDocument(){return this.process(()=>{if(!this.canWriteTree()){X.warn("cannot upgrade document if we cannot write, but should not be saving modules either");return}X.info("upgrading document to use local modules list node"),this.treeStore.tree.lineage.setEditReason("maybeUpgradeDocument"),this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)},"nonUserEvent"),this.writeLocalModulesToTree}getModuleWithTypeSlashName(A){let e=this.findPersistedModuleLocalIdByTypeSlashName(this.persistedModules,A);if(e)return this.persistedModules.get(e)}async updateDependenciesModule(A){$(Id(A),"updateDependenciesModule called with non dependencies module data");let e=await this.getDependenciesFiles(A),t=e?.dependenciesMapContent;if(!t){let r=JSON.parse(e.importMapContent),o=yo(r);t=JSON.stringify(o),this.readOnlyTree?X.reportError(new Error("modules storage is read only"),{context:"modules storage is read only while calling updateDependenciesModule"}):(await this.updateDependenciesLocked(r,o),X.info("The missing dependencies file has now been created."))}this.dependenciesModule={kind:"dependencies",...A,id:A.id,localId:A.localId,type:"config",name:A.name,importMapContent:e.importMapContent,dependenciesMapContent:t}}async createServerModuleFromData(A){let e={kind:"server",...A,id:A.id,localId:A.localId,moduleURL:A.baseURL+(A.type==="kit"?A.files.source:A.files.module),update:performance.now()};if((e.type==="codeFile"||e.type==="webPageMetadata")&&(e.sourceContent=await this.fetchSourceContentFromData(A)),fd(e)&&md(e)===0){e.sourceContent=await this.fetchSourceContentFromData(A);let t=e.sourceContent.includes("useQueryData")?1:0;e.metadata={...e.metadata,compatibleCmsVersion:t}}return e}async fetchSourceContentFromData(A){return this.downloadQueue.run(async()=>{let e=A.baseURL+A.files.source;return(await fetch(e)).text()})}async refresh(){if(this.initialized&&!this.useTreeAsLocalModuleList)return X.debug("refresh: acquiring lock"),rj(()=>this.refreshLocked())}async refreshLocked(){X.debug("refresh: start"),$(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let{data:A}=await this.modulesService.list({});X.debug("refresh: there's",A.length,"modules to process");let e=new Map,t=new Set;await Promise.all(A.map(async o=>{let n=o.localId;if(Id(o)){this.dependenciesModule?.saveId!==o.saveId&&await this.updateDependenciesModule(o);return}let a=this.persistedModules.get(n);if(a?.saveId===o.saveId)e.set(n,a);else{let i=await this.createServerModuleFromData(o);X.debug("refresh - updating module",i.localId,i.id,i.saveId,i.savedAt),e.set(n,i)}t.add(n)}));let r=this.createDependencyGraph(e);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0}),X.debug("refresh: finish")}whenInitialized(){return this.initializationPromise}async whenIdle(){await Promise.all([this.whenInitialized(),rj(()=>{})])}isProcessing(){return!!(!this.initialized||this.transientSaves.size>0||lc.isLocked(Ei))}hasLocalChanges(){return this.transientSaves.size>0}hasLocalCodeFileChanges(){if(this.transientSaves.size===0)return!1;for(let A of this.transientSaves.values())if(A.type==="codeFile"||A.type==="config")return!0;return!1}addListener(A){this.listeners.add(A)}removeListener(A){this.listeners.delete(A)}notifyListeners(A){this.listeners.forEach(e=>{try{e(A)}catch(t){X.reportError(t)}})}subscribe(A){return this.addListener(A),A(_0(this.dependenciesModule,void 0,this.persistedModules,this.transientSaves,this.lastSnapshot.depsGraph,new Map,this.initialized,!1,!1)),()=>this.removeListener(A)}getDependentsOfModule(A){return this.lastSnapshot.depsGraph[A]?.dependents}getUniqueNameForType(A,e){let t=new Set;for(let r of this.persistedModules.values())r.type===A&&t.add(r.name);return g0(t,e)}async updateSources(A){return rj(async()=>{let e=!1;for(let{localId:t,source:r,options:o}of A){let n=Date.now();try{await this.updateSourceLocked(t,{...o,source:r}),e=!0}catch(a){a instanceof r6&&PA({type:"add",variant:"error",text:"Instances of your component won't update if they are nested within themselves.",key:"component-circular-dependency",icon:"error",duration:Number.POSITIVE_INFINITY}),X.reportError(a)}finally{let a=Date.now()-n;X.debug("\u23F1 update source",t,"in",a,"ms")}}return await this.makeVisibleDependentServerModulesLocal(A),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1}),this.makeLazyServerModulesLocalWhenIdle().catch(GA),e})}async updateDependenciesSource(A,e){return rj(async()=>{$(this.dependenciesModule,"Dependency files must already exist to be updated.");let t=A===O7?e:this.dependenciesModule.importMapContent,r=A===w7?e:this.dependenciesModule.dependenciesMapContent;return this.updateDependenciesLocked(JSON.parse(t),JSON.parse(r))})}async compileSubmodules(A,e){let t={};return await Promise.all([...e].map(async([r,o])=>{let n=await this.compile({name:r,source:o,type:A,includeSourceMap:!1,addFramerMetadata:!1});for(let i of n.imports.relative){let s=Nf(i);if(!(s&&e.has(s)))throw new Error("Submodules only support relative imports of other submodules")}let a=ls(r);t[a]=n.code})),t}typeAndNameFromLocalId(A,e=!1){if(e)return Ji(A);for(let t of this.lastSnapshot.modules.values())if(t?.localId===A)return t;throw new Error(`Module entry for local id ${A} missing in internal snapshot`)}async updateSourceLocked(A,{source:e,submodules:t,binaryAssets:r=T0,stableName:o=!1,assets:n,preventCircularImports:a,telemetrySession:i,treeVersion:s,sourceRevision:l,svgIcon:c,kitSectionsStructure:u}){await this.whenInitialized();let p=this.typeAndNameFromLocalId(A,o),f=CA(p),E=await this.compile({localId:A,name:f,source:e,type:p.type,includeSourceMap:Fd(p.type),telemetrySession:i}),F=v0;t&&(F=await this.compileSubmodules(p.type,t));let R=Jo(this.lastSnapshot.depsGraph,f,E.imports.relative);if(a&&m0(R,f))throw new r6;let S=xS(p.type,E.annotations),v=ij(this.transientSaves,P=>{let T=P.get(A),D,K=S?.framerIntrinsicWidth;K&&(D={...D,intrinsicWidth:Number.parseInt(K,10)});let Q=S?.framerIntrinsicHeight;if(Q&&(D={...D,intrinsicHeight:Number.parseInt(Q,10)}),D={...D,compilerContractVersion:1,treeAnnotations:!0,localModuleImportMapEntries:this.moduleUsesLocalImportMapSpecifiers(f)},T)T.saveId=Ur(),T.moduleContent=E.code,T.sourceContent=e,T.sourceMapContent=E.sourceMap,T.submoduleContents=F,T.binaryAssetContents=r,T.imports=E.imports,T.exports=E.exportedNames,T.reExportedModules=E.reExportedModules,T.treeVersion=s??this.treeStore.remoteTreeVersion,T.sourceRevision=l??T.sourceRevision,T.annotations=E.annotations,T.svgIcon=c??T.svgIcon,T.kitSectionsStructure=u??T.kitSectionsStructure,T.update=performance.now(),n&&(T.assets=Array.from(n)),D&&(T.metadata={...T.metadata,...D});else{let Z={localId:A,type:p.type,name:p.name,saveId:Ur(),moduleContent:E.code,sourceContent:e,sourceMapContent:E.sourceMap,submoduleContents:F,binaryAssetContents:r,imports:E.imports,exports:E.exportedNames,reExportedModules:E.reExportedModules,treeVersion:s,sourceRevision:l,svgIcon:c,kitSectionsStructure:u,annotations:E.annotations,update:performance.now()};n&&(Z.assets=Array.from(n)),D&&(Z.metadata=D),P.set(A,Z)}});this.transientInfo||=new Set,this.transientInfo.add(A),this.transientSaves=v,this.lastSnapshot={...this.lastSnapshot,depsGraph:R}}async create(A){return rj(()=>this.createLocked(A))}async createLocked(A){await this.whenInitialized();let{type:e,name:t,source:r,...o}=A,n=CA({type:e,name:t}),a=await this.compile({name:n,source:r,type:e,includeSourceMap:Fd(e)}),i={localId:void 0,type:e,name:t,saveId:Ur(),moduleContent:a.code,sourceContent:r,sourceMapContent:a.sourceMap,submoduleContents:v0,binaryAssetContents:T0,imports:a.imports,exports:a.exportedNames,reExportedModules:a.reExportedModules,treeVersion:A.treeVersion||this.treeStore.remoteTreeVersion,sourceRevision:A.sourceRevision,svgIcon:A.svgIcon,kitSectionsStructure:A.kitSectionsStructure,annotations:a.annotations,update:performance.now()},s=await this.createBatchSaveForUpdatedModule("$new",i,this.persistedModules,new Map,new Map,{type:e,name:t,...o});$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:l}=await this.modulesService.saveBatch({batch:[s]}),{updatedModuleLocalId:c,nextPersistedModules:u}=this.processTransientSaveData({nextPersistedModules:this.persistedModules,transientSave:i,data:l}),p=Jo(this.lastSnapshot.depsGraph,n,a.imports.relative);return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:u,transientSaves:this.transientSaves,depsGraph:p,didRemoteChange:!0}),c}async update(A,e){let t=this.persistedModules.get(A);return $(t,"Trying to update an unknown module with localId:",A),rj(async()=>{let r=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:{...e,name:t.name,type:t.type}})}finally{let o=Date.now()-r;X.debug("\u23F1 update",A,"in",o,"ms")}})}async rename(A,e){return rj(()=>this.renameLocked(A,e))}async renameLocked(A,e){await this.whenInitialized();let t=this.persistedModules,r=this.lastSnapshot.depsGraph,o=t.get(A);$(o,"Trying to rename an unknown module with localId:",A);let n=this.treeStore.remoteTreeVersion,a=CA(o);$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let i=await this.modulesService.update({moduleId:o.id,name:e});$(i,"invalid update reply");let s=r[a]?.dependents,l=[],c={},u=CA(i);if(a!==u&&(r=j6(r,a),r=Jo(r,u,o.imports.relative)),s){let p=[],f=[];for(let R of t.values()){let S=CA(R);s.has(S)&&(R.kind==="local"?p.push(R):f.push(R))}if(f.length>0){let R=await Promise.all(f.map(S=>this.createLocalModuleFromModule(S)));t=ij(t,S=>{for(let v of R)S.set(v.localId,v),p.push(v)})}let E=[];for(let R of p){let S=CA(R),v=Ol(S,`${o.type}/${e}`);$(v,"Failed to create relative path to",o.type,"/",e);let P=Ol(S,a);$(P);let T=R.imports.relative.indexOf(P);if(T===-1){X.warn(R.localId,"doesn't import",P);continue}let D=[...R.imports.relative];D[T]=v;let K={absolute:R.imports.absolute,bare:R.imports.bare,relative:D},Q=D0(R.sourceContent,P,v),Z=D0(R.moduleContent,P,v);c[R.localId]={sourceContent:Q,moduleContent:Z,imports:K},$(R.files.source);let H={type:R.type,moduleId:R.id,name:R.name,saveId:Ur(),patchSaveId:R.saveId,files:[{name:R.files.source,type:"source",content:Q}],imports:K};E.push(H)}$(!this.readOnlyTree,"modules storage is read only");let{data:F}=await this.modulesService.saveBatch({batch:E});l=F}t=ij(t,p=>{if(this.updateTreeNode(A,n,i)){o.kind==="server"?p.set(A,{...i,kind:"server",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,update:performance.now()}):p.set(A,{...i,kind:"local",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,moduleContent:o.moduleContent,sourceMapContent:o.sourceMapContent,submoduleContents:o.submoduleContents,binaryAssetContents:o.binaryAssetContents,update:performance.now()});for(let E of l){let F=E.localId,R=p.get(F);$(R?.kind==="local","dependent module must be local:",F);let S=c[F];$(S,"dependent module update must exist:",F),this.updateTreeNode(F,n,E)&&(p.set(F,{...E,kind:"local",localId:F,id:E.id,moduleURL:E.baseURL+E.files.module,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:R.sourceMapContent,submoduleContents:R.submoduleContents,binaryAssetContents:R.binaryAssetContents,imports:S.imports,exports:E.exports,reExportedModules:E.reExportedModules,submodules:E.submodules,binaryAssets:E.binaryAssets,sourceRevision:R.sourceRevision,update:R.update}),r=Jo(r,CA(E),S.imports.relative))}}}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:t,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0})}async upsert(A,e){return rj(async()=>{let t=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[A]:e})}finally{let r=Date.now()-t;X.debug("\u23F1 upsert",A,"in",r,"ms")}})}async upsertBatch(A){return rj(async()=>{let e=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked(A)}finally{let t=Date.now()-e;X.debug("\u23F1 upsert batch in",t,"ms")}})}async delete(A){return rj(()=>this.deleteLocked(A))}async deleteLocked(A){let e=Array.isArray(A)?A:[A];if(!e.length)return;await this.whenInitialized();let t=e.map(c=>{let u=this.persistedModules.get(c);return $(u,"Trying to delete an unknown module",c,"It was never persisted."),u}),{modulesService:r}=this;$(r);let o=await Promise.allSettled(t.map(c=>r.delete({moduleId:c.id}))),n=new Set,a=new Set;for(let c of o){if(c.status==="rejected"){X.warn(String(c.reason));continue}n.add(c.value.localId),a.add(c.value.id)}e=e.filter(c=>n.has(c)),t=t.filter(c=>a.has(c.id)),$(e.length>0,"Failed to delete module(s)");let i=this.lastSnapshot.depsGraph;for(let c of t){let u=CA(c);i=j6(i,u)}let s=ij(this.persistedModules,c=>{for(let u of e)c.delete(u),this.removeTreeNode(u)}),l=ij(this.transientSaves,c=>{for(let u of e)c.delete(u)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:s,transientSaves:l,depsGraph:i,didRemoteChange:!0})}async publish(A,e){return rj(()=>this.publishLocked(A,e))}async publishLocked(A,{namespace:e,name:t,version:r}){await this.whenInitialized();let o=this.persistedModules.get(A);$(o,"Trying to publish an unknown module",A,"It was never persisted."),$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let n=await this.modulesService.publish({moduleId:o.id,saveId:o.saveId,namespace:e,name:t,version:r}),a=ij(this.persistedModules,i=>{let s=i.get(A);s&&i.set(A,{...s,lastPublish:{namespaceId:n.namespaceId,name:n.name,version:n.version,importURL:n.importURL}})});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),n}async addNpmDependencies(A){return rj(async()=>{await this.whenInitialized();let e;this.dependenciesModule?.importMapContent?e=JSON.parse(this.dependenciesModule?.importMapContent):e={imports:{}};let t;this.dependenciesModule?.dependenciesMapContent?t=JSON.parse(this.dependenciesModule?.dependenciesMapContent):t={dependencies:{}};let r=Array.isArray(A)?A:[A];if(r=r.filter(i=>{if(_n.has(i.target)||Dn(i.target))return!1;let s=Mn(i);return!e.imports[s]}),r.length===0)return{dependenciesMap:t};r=r.map(i=>{if(t.dependencies[i.target]){let l=e.imports[i.target]??Object.entries(e?.imports).find(([u])=>u.startsWith(i.target))?.[1];$(l,"The import map should contain a import that is in the dependencies map");let c=Kk(l)?.version;return c?{...i,target:`${i.target}@${c}`}:i}let s=xn[i.target];return s?{...i,target:`${i.target}@${s}`}:i});let{importMap:o,resolvedDependencies:n}=await Nk(e,r,_n,xn),a=await this.extendCurrentDependenciesMap(n);return n.forEach(({name:i,version:s})=>mA("npm_dependency_add",{name:i,semver:s})),X.debug({newImportMap:o,newDependenciesMap:a}),await this.updateDependenciesLocked(o,a),{dependenciesMap:a}})}async reinstallNpmDependencies(){return rj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies();delete A.scopes;let{importMap:t}=await Ok(A,_n,xn);return await this.updateDependenciesLocked(t,e),t})}async uninstallBlockedNpmDependencies(){return rj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=Nl(e),r=await Lk(A);return await this.updateDependenciesLocked(r,t),r})}async clearNpmDependencies(){return rj(async()=>this.updateDependenciesLocked({imports:{}},{dependencies:{}}))}async removeBlockedNpmDependencies(){return rj(async()=>{let{currentImportMap:A,currentDependenciesMap:e}=this.getCurrentDependencies(),t=Nl(e);return await this.updateDependenciesLocked(A,e),t})}async rebuildImportMapFromDependencies(){return rj(async()=>{let A=this.dependenciesModule?.dependenciesMapContent,e=A?JSON.parse(A):{dependencies:{}},t=await Vk(e,_n,xn);return await this.updateDependenciesLocked(t,e),t})}async unsafeUpgradeDependency(A,e,t){return rj(async()=>{let{currentImportMap:r,currentDependenciesMap:o}=this.getCurrentDependencies(),n=await qk(r,A,e,t),a=yo(n),i=So(a,o);return await this.updateDependenciesLocked(n,i),n})}async extendCurrentImportMap(A,e){return rj(async()=>{let{currentImportMap:t,currentDependenciesMap:r}=this.getCurrentDependencies(),o=Go(t,A),n=So(r,e);return this.updateDependenciesLocked(o,n)})}async extendCurrentDependenciesMap(A){let e={};for(let r of A)e[r.name]=r.version;let t=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return t.dependencies=Object.assign(e,t.dependencies),t}getCurrentDependencies(){let A=this.dependenciesModule?.importMapContent?JSON.parse(this.dependenciesModule?.importMapContent):{imports:{}},e=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return{currentImportMap:A,currentDependenciesMap:e}}async updateDependenciesLocked(A,e){let t=JSON.stringify(A,null,4),r=JSON.stringify(e,null,4);if(t===this.dependenciesModule?.importMapContent&&r===this.dependenciesModule?.dependenciesMapContent)return;let o={moduleId:"$upsertName",name:N6,saveId:Ur(),type:"config",files:[{name:"importMap.json",type:"importMap",content:t},{name:"dependencies.json",type:"dependencies",content:r}],imports:{absolute:[],relative:[],bare:[]}};$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:[n]}=await this.modulesService.saveBatch({batch:[o]});$(n,"Modules API must return an updated import map after savebatch"),this.updateTreeNodeWithOwnTreeVersion(rt,n);let a={kind:"dependencies",importMapContent:t,dependenciesMapContent:r,...n,id:n.id,localId:n.localId,type:n.type,name:n.name};this.setNextInternalState({dependenciesModule:a,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})}getPersistedDependenciesModule(){return this.dependenciesModule}getPersistedModuleByGlobalId(A){for(let e of this.persistedModules.values())if(e.id===A)return e}getPersistedModuleByLocalId(A){return this.persistedModules.get(A)}getTransientSaveByLocalId(A){return this.transientSaves.get(A)}async handleRemoteModuleDeleteEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleDeletes(A.map(e=>e.id))}async handleRemoteModuleDeletes(A){await rj(async()=>{let e=[],t=[];for(let a of A){let i=this.getPersistedModuleByGlobalId(a);i&&(t.push(CA(i)),e.push(i.localId))}let r=ij(this.persistedModules,a=>{for(let i of e)a.delete(i)}),o=ij(this.transientSaves,a=>{for(let i of e)a.delete(i)}),n=this.lastSnapshot.depsGraph;for(let a of t)n=j6(n,a);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:r,transientSaves:o,depsGraph:n,didRemoteChange:!0})})}async handleRemoteModuleSaveEvents(A){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleSaves(A.map(e=>e.module))}async handleRemoteModuleSaves(A){let e=[],t=[];for(let n of A)CA(n)===rt?e.push(n):t.push(n);let r,o=e.length>0?e[e.length-1]:void 0;if(o){let{importMapContent:n,dependenciesMapContent:a}=await this.getDependenciesFiles(o);$(a,"No dependencies file exists for the remote update!"),r={kind:"dependencies",...o,id:o.id,localId:o.localId,type:"config",name:o.name,importMapContent:n,dependenciesMapContent:a}}await rj(async()=>{r&&(this.dependenciesModule=r);let n=this.persistedModules,a=this.lastSnapshot.depsGraph,i=await Promise.all(t.map(s=>this.createServerModuleFromData(s)));for(let s of i){let l=CA(s),c=s.localId;n=ij(n,u=>{u.set(c,s)}),this.transientSaves.has(c)||(a=Jo(this.lastSnapshot.depsGraph,l,s.imports.relative))}this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0,multiplayerChange:!0})})}getPatchTransientSave(A,e,t){return{saveId:t,type:e.type,name:e.name,localId:A,moduleContent:e.moduleContent,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,imports:e.imports,exports:e.exports,reExportedModules:e.reExportedModules,sourceRevision:e.sourceRevision,update:e.update}}async upsertBatchLocked(A){if(this.readOnlyTree)return;let e=this.persistedModules,t=new Map,r=[],o=new Map;for(let c of e.values()){let u=CA(c);o.set(u,c.localId),r.push([u,c.imports.relative])}let n=new Map;for(let c in A){let u=c,p=A[u];$(p,"No persist params found for",u);let f=this.transientSaves.get(u),E=f??e.get(u);$(E,"No module found for",u);let F=CA(E);n.set(F,f?.saveId??Ur()),t.set(F,le(p.name)),o.set(F,u),f&&r.push([F,f.imports.relative])}let a=ud(r),i=new Map,s=ij(this.transientSaves,c=>{for(let u in A)c.delete(u)}),l;try{let{batch:c,nextPersistedModules:u}=await this.createBatch(A,i,e,a,o,n,t);$(!this.readOnlyTree,"modules storage is read only"),$(this.modulesService);let{data:p}=await this.modulesService.saveBatch({batch:c});e=ij(u,f=>{for(let E of p.values()){let F=E.localId,R=i.get(F);if(!R){let K=f.get(F);$(K,F,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(F,E),K.saveId=E.saveId,K.moduleURL=E.baseURL+E.files.module;continue}let S={kind:"local",...E,id:E.id,localId:E.localId,imports:R.imports,moduleURL:E.baseURL+E.files.module,sourceContent:R.sourceContent,sourceMapContent:R.sourceMapContent,moduleContent:R.moduleContent,submoduleContents:R.submoduleContents,binaryAssetContents:R.binaryAssetContents,sourceRevision:R.sourceRevision,annotations:R.annotations,update:R.update},v=A[F]?.errors,P=R.kitSectionsStructure,T=R.treeVersion??this.treeStore.remoteTreeVersion;if(!this.updateTreeNode(E.localId,T,S,v,P))return;f.set(F,S)}})}catch(c){e=this.persistedModules;let u=Array.from(i.values()).map(F=>F.saveId).join("-"),p=this.transientSaveRetries.get(u)??0,{error:f,dropTransient:E}=this.handlePersistenceError(c,p,()=>{this.transientSaveRetries.set(u,p+1),setTimeout(async()=>{let F=Object.entries(i).every(([R,S])=>{let v=R,P=this.transientSaves.get(v);return P&&P.saveId===S.saveId});e6(f)&&(this.transientSaveRelativeImportRetries.add(u),await this.refresh()),F&&(X.debug("retrying saving batchId with id:",u),this.upsertBatchLocked(A))},1e3+p*1e3)});if(!E)return;l=f}if(this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:s,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),l)throw l}async createBatch(A,e,t,r,o,n,a){let i=[];for(let u in A){let p=u,f=A[p];$(f,"No persist params found for",p);let E=this.transientSaves.get(p);if(!E){let R=t.get(p);$(R,`Trying to persist ${p} but it doesn't have neither a corresponding transient save nor an existing persisted module.`),R.kind==="server"&&(R=await this.createLocalModuleFromModule(R),t=ij(t,v=>{R&&v.set(R.localId,R)}));let S=n.get(p);$(S,"No save id found for",p),E=this.getPatchTransientSave(p,R,S)}e.set(p,E);let F=await this.createBatchSaveForUpdatedModule(this.persistedModules.get(p)?.id??"$upsertName",E,t,n,a,f);i.push(F)}let s=new Map;for(let u in A){let p=u,f=A[p];$(f,"No persist params found for",p);let E=CA(f),F=new Set;Qr(r,E,F),s.set(p,F)}let l=[];for(let u of s.values())for(let p of u){let f=o.get(p);$(f,"Cannot find localId for",p);let E=t.get(f);E?.kind==="server"&&l.push(this.createLocalModuleFromModule(E))}if(l.length>0){let u=await Promise.all(l);t=ij(t,p=>{for(let f of u)p.set(f.localId,f)})}for(let u of s.values())for(let p of u)n.has(p)||n.set(p,Ur());let c=new Set;for(let[u,p]of s){let[f]=Ja(u);for(let E of p){let F=o.get(E);if($(F,"Cannot find localId for",E),e.has(F)||c.has(E)||t.get(F)?.metadata.localModuleImportMapEntries===!0&&this.moduleUsesLocalImportMapSpecifiers(E)&&(f!=="codeFile"||!r[E]?.dependencies.has(u)))continue;c.add(E);let v=await this.createBatchSaveForDependentModule(F,t,n,a);i.push(v)}}return{batch:i,nextPersistedModules:t}}handlePersistenceError(A,e,t){let r=A instanceof Error?A.message:"",o=A instanceof O6?A.code:0,n=A instanceof O6?A.status:0,a=o===1002,i=o===-1e3,s=n>=300&&n!==400&&n!==403,l=i||s||e6(A),c=20,u=2;if(e6(A)&&yA.isOn("retryRelativeImportRewriting"))return!l||e>=u?(X.reportError("Relative imports error, exceeded max retries, making document read only:",{missing:A.persistedMissingRelativeImports}),this.makeDocumentReadOnly(),PA({type:"add",variant:"warning",text:"Framer can\u2019t save your latest changes. Please reload the page to continue working.",key:"client-outdated",duration:Number.POSITIVE_INFINITY,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>{X.reportError("ModulesStorage: Reloaded due to relative imports error.",{missing:A.persistedMissingRelativeImports}),window.top.location.reload()}}}),{error:A,dropTransient:!0}):(X.debug("Relative imports error, will retry:",{missing:A.persistedMissingRelativeImports}),t(),{error:A,dropTransient:!1});if(a&&e>0)X.debug("Ignoring duplicated save id.");else{if(a)return X.debug("Duplicate save id error, will drop transient save:",A),{error:A,dropTransient:!0};if(l&&e<c)return X.info("Connection error, will retry:",{message:r,code:o,status:n,retryCount:e}),t(),{dropTransient:!1};if(l)X.error("Error saving: too many retries, will drop transient save:",{message:r,code:o,status:n,retryCount:e});else return X.debug("Error saving, will drop transient save:",A),{error:A,dropTransient:!0}}return{dropTransient:!1}}moduleUsesLocalImportMapSpecifiers(A){let[e,t]=Ja(A);if(e==="layoutTemplate")return!0;if(e==="collection")return yA.isOn("collectionLocalModuleImportMapEntries");if(e==="screen"){let r=this.treeStore.tree.get(t);if(wj(r)||w(r))return!0}return!1}processTransientSaveData({nextPersistedModules:A,transientSave:e,data:t},r,o){let n=e.treeVersion??this.treeStore.remoteTreeVersion,a;return A=ij(A,i=>{let s=t.values(),l=s.next().value;a=l.localId;let c={kind:"local",...l,id:l.id,localId:a,imports:e.imports,moduleURL:l.baseURL+l.files.module,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,moduleContent:e.moduleContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,sourceRevision:e.sourceRevision,annotations:e.annotations,update:e.update};if(this.updateTreeNode(l.localId,n,c,r,o)){i.set(a,c);for(let p of s){let f=i.get(p.localId);$(f,p.localId,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(p.localId,p),f.saveId=p.saveId,f.moduleURL=p.baseURL+p.files.module}}}),$(a,"Updated module",e,"is not found in the response"),{nextPersistedModules:A,updatedModuleLocalId:a}}setNextInternalState({dependenciesModule:A,persistedModules:e,transientSaves:t,depsGraph:r,didRemoteChange:o,multiplayerChange:n=!1}){this.dependenciesModule=A,this.persistedModules=e,this.transientSaves=t;let a=_0(A,this.lastSnapshot.dependenciesModule,e,t,r,this.lastSnapshot.modules,this.initialized,o,n),i=this.lastSnapshot.initialized;this.lastSnapshot={dependenciesModule:a.dependenciesModule,modules:a.modules,depsGraph:a.depsGraph,initialized:a.initialized},!(a.metadata.patches.length===0&&a.initialized===i)&&this.notifyListeners(a)}async createLocalModuleFromModule(A){X.debug("compiling server module:",A.localId);let e=A.sourceContent;e||(e=await this.fetchSourceContentFromData(A));let t={},r={},o=this.downloadQueue,n=new Array;for(let s of A.submodules)n.push(o.run(async()=>{let l=await fetch(A.baseURL+s);t[s]=await l.text()}));for(let s of A.binaryAssets)n.push(o.run(async()=>{let c=await(await fetch(A.baseURL+s)).arrayBuffer();r[s]=new Uint8Array(c)}));await Promise.all(n);let a=CA(A),i=await this.compile({localId:A.localId,name:a,source:e,type:A.type,includeSourceMap:Fd(A.type)});for(let[s,l]of this.lazyServerModulesForTransientSaves)l.delete(a),l.size===0&&this.lazyServerModulesForTransientSaves.delete(s);return{...A,kind:"local",id:A.id,localId:A.localId,sourceContent:e,moduleContent:i.code,sourceMapContent:i.sourceMap,submoduleContents:t,binaryAssetContents:r,imports:i.imports,sourceRevision:yd(A),annotations:i.annotations}}async createBatchSaveForUpdatedModule(A,e,t,r,o,n){let a=CA(e),{localId:i,moduleContent:s,sourceContent:l,sourceMapContent:c,submoduleContents:u={},binaryAssetContents:p={},metadata:f,sourceRevision:E,imports:F,type:R,name:S,annotations:v,update:P,...T}=e;switch(A){case"$new":$(i===void 0,`Attempted to create ${a} but it already has localId: ${i}`);break;case"$upsertName":default:$(i!==void 0,`The transient save for the provided moduleId: ${A} doesn't have localId`)}let{type:D,name:K,metadata:Q,files:Z,...H}=n;$(D===R&&K===S,`Mismatched type/name between save and parameters: ${D}/${K} !== ${R}/${S}`);let AA=le(K),jA=s;F.relative.length>0&&(jA=await this.replaceRelativeImportsWithAbsolute(a,s,F.relative,t,r,nn(u),o)),c&&(jA+=`
//# sourceMappingURL=./${AA.sourceMap}`);let N=(Z??[]).concat([{name:AA.module,type:"module",content:jA},{name:AA.source,type:"source",content:l}]);c&&N.push({name:AA.sourceMap,type:"sourceMap",content:c});for(let[J,nA]of Object.entries(u))N.push({name:J,type:"submodule",content:nA});for(let[J,nA]of Object.entries(p))N.push({name:J,type:"binaryAsset",bytes:nA});let z={};if(f||Q)if(i){let J=t.get(i);$(J||A==="$upsertName",`Cannot safely update metadata for ${A} (${i})`),z.metadata={...J?.metadata,...f,...Q,sourceRevision:E}}else z.metadata={...f,...Q,sourceRevision:E};return{...T,moduleId:A,type:D,name:K,files:N,imports:F,...H,...z}}async createBatchSaveForDependentModule(A,e,t,r){let o=e.get(A);$(o,A,"is not found in persistedModules"),$(o.kind==="local","persisted module is not a local module");let n=CA(o),a=le(o.name),i=o.imports,s=o.moduleContent;i.relative.length>0&&(s=await this.replaceRelativeImportsWithAbsolute(n,o.moduleContent,i.relative,e,t,nn(o.submoduleContents),r));let l=t.get(n);$(l,"newSaveIds don't contain saveId for",n);let c={},u=this.moduleUsesLocalImportMapSpecifiers(n);return o.metadata.localModuleImportMapEntries!==u&&(c.metadata={...o.metadata,localModuleImportMapEntries:u}),{type:o.type,moduleId:o.id,name:o.name,saveId:l,patchSaveId:o.saveId,files:[{name:a.module,type:"module",content:s}],imports:i,...c}}findPersistedModuleLocalIdByTypeSlashName(A,e){return this.ensurePersistedLocalIdsByTypeSlashNameCacheFor(A).get(e)}ensurePersistedLocalIdsByTypeSlashNameCacheFor(A){let e=this.persistedLocalIdsByTypeSlashNameCache.get(A);if(!e){e=new Map;for(let[t,r]of A.entries())e.set(CA(r),t);this.persistedLocalIdsByTypeSlashNameCache.set(A,e)}return e}async replaceRelativeImportsWithAbsolute(A,e,t,r,o,n,a){let{modulesCDN:i}=qe(),s={};for(let E of n){let F=cs(E);s[F]=F}let l=this.moduleUsesLocalImportMapSpecifiers(A),c=new Set;for(let E of t){if(E in s)continue;let F=xe(E,A);if(!F)continue;let R=this.findPersistedModuleLocalIdByTypeSlashName(r,F);if(!R){c.add(F),X.error("Cannot resolve",E,"from",A);continue}let S=r.get(R);$(S);let{id:v,files:P}=S,T=o.get(F)??S.saveId,D=a?.get(F)?.module??P.module;$(x(D),"Must have a module file name to build a local module import map specifier."),s[E]=l?Hi(R,D):`${i}/${v}/${T}/${D}`}let u=await t6(e,s);if(u.ok)return u.value;if(A.startsWith("codeFile"))return u.error.partiallyProcessedCode;let p=new Set,f=this.treeStore.tree;for(let E of u.error.unresolvedRelativeImports){let F=xe(E,A);if(!F)continue;let[R]=Ja(F);if(!(R==="codeFile"||!f.getNodeWithTrait(F,Tr))){p.add(F);break}}if(p.size===0)return X.reportError("Failed to rewrite relative imports due to unpersisted relative dependencies",{relativeImports:t,unresolved:Array.from(u.error.unresolvedRelativeImports)}),u.error.partiallyProcessedCode;if(X.reportError("Failed to rewrite relative imports",{typeSlashName:A,missing:Array.from(p)}),!yA.isOn("retryRelativeImportRewriting"))return u.error.partiallyProcessedCode;throw new fi(p)}async getDependenciesFiles({baseURL:A,files:e}){let[t,r]=await Promise.allSettled([this.downloadQueue.run(async()=>{let a=await fetch(A+e.importMap);if(a.ok!==!0)throw new Error("failed to load importMap file");return a.text()}),this.downloadQueue.run(async()=>{let a=await fetch(A+e.dependencies);if(a.ok!==!0)throw new Error("failed to load dependencies file");return a.text()})]);$(t.status==="fulfilled","The importMap has to exist on the module");let o=t.value,n;return r.status==="fulfilled"?n=r.value:X.warn("No dependencies file was found!"),{importMapContent:o,dependenciesMapContent:n}}async upsertKit(A,e,t){return rj(async()=>{let r=JSON.stringify(A),o=[{name:"kit.json",type:"source",content:r},...e.map(l=>({name:`${l.id}.json`,type:"kitSection",content:JSON.stringify(l.content)}))],n=performance.now(),a="kit/kit",i={type:"kit",files:o,saveId:t,name:"kit",moduleId:this.persistedModules.get(a)?.id??"$upsertName",metadata:{title:A.title,icon:A.icon,prompt:A.prompt},imports:{absolute:[],relative:[],bare:[]}};$(this.modulesService);let{data:s}=await this.modulesService.saveBatch({batch:[i]});this.setNextInternalState({dependenciesModule:this.dependenciesModule,transientSaves:this.transientSaves,persistedModules:ij(this.persistedModules,l=>{for(let c of s.values()){if(c.localId!==a)continue;let u={kind:"local",...c,id:c.id,localId:c.localId,imports:c.imports,moduleURL:c.baseURL+c.files.source,sourceContent:r,sourceMapContent:void 0,moduleContent:r,submoduleContents:{},binaryAssetContents:{},sourceRevision:void 0,annotations:void 0,update:n};l.set(a,u)}}),depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})})}};function vS(j,A){return`${qe().modulesCDN}/${A.id}/${j.saveId}/${A.files.module}`}function _0(j,A,e,t,r,o,n,a,i){let s=new Set(o.keys()),l=new Set(t.keys()),c=[],[u,p]=us(o,F=>{for(let R of e.values()){let S=R.localId,v=CA(R),P=t.get(S),T=P?.type??R.type;if(!Qk(T))continue;let D;if(P)D={kind:"local",localId:S,type:P.type,name:P.name,moduleURL:vS(P,R),moduleContent:P.moduleContent,sourceContent:P.sourceContent,sourceMapContent:P.sourceMapContent,submoduleContents:P.submoduleContents,binaryAssetContents:P.binaryAssetContents,relativeImports:P.imports.relative,files:R.files,sourceRevision:P.sourceRevision,kitSectionsStructure:P.kitSectionsStructure,svgIcon:P.svgIcon,update:P.update};else{let K=yd(R);D=R.kind==="local"?{kind:"local",localId:S,type:R.type,name:R.name,moduleURL:R.moduleURL,moduleContent:R.moduleContent,sourceContent:R.sourceContent,sourceMapContent:R.sourceMapContent,submoduleContents:R.submoduleContents,binaryAssetContents:R.binaryAssetContents,relativeImports:R.imports.relative,files:R.files,sourceRevision:K,svgIcon:void 0,kitSectionsStructure:void 0,update:R.update}:{kind:"server",localId:S,type:R.type,name:R.name,moduleURL:R.moduleURL,sourceContent:R.sourceContent,relativeImports:R.imports.relative,files:R.files,sourceRevision:K,update:R.update}}x0(F,v,D),l.delete(S),s.delete(v)}for(let R of l){let S=t.get(R);if($(S),!S.localId)continue;let v=le(S.name),P={kind:"local",localId:S.localId,type:S.type,name:S.name,moduleURL:`./transient/${S.saveId}/${v.module}`,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:S.sourceMapContent,submoduleContents:S.submoduleContents,binaryAssetContents:S.binaryAssetContents,relativeImports:S.imports.relative,files:v,sourceRevision:S.sourceRevision,svgIcon:S.svgIcon,kitSectionsStructure:S.kitSectionsStructure,update:S.update};x0(F,R,P),s.delete(CA(P))}for(let R of s)F.delete(R),c.push(R)}),f={};for(let F of c){let R=o.get(F);R&&(f[F]=R.localId)}let E=ij(A,F=>{if(j){if(!F)return{kind:"dependencies",localId:rt,type:j.type,name:j.name,importMapContent:j.importMapContent,dependenciesMapContent:j.dependenciesMapContent};F.importMapContent=j.importMapContent,F.dependenciesMapContent=j.dependenciesMapContent}});return E&&E!==A&&p.push({op:A?"replace":"add",path:[CA(E)],value:E}),{dependenciesModule:E,modules:u,deletedLocalIdsByTypeSlashNames:f,depsGraph:r,initialized:n,metadata:{patches:p,hasLocalChanges:t.size>0,didRemoteChange:a,multiplayerChange:i}}}function x0(j,A,e){let t=j.get(A);if(!t){j.set(A,e);return}if(t.kind!==e.kind){j.set(A,e);return}if(t.kind==="server"){$(e.kind==="server"),M0(t,e);return}$(e.kind==="local"),TS(t.relativeImports,e.relativeImports)||(t.relativeImports=e.relativeImports),fu(t.files,e.files)||(t.files=e.files);let{relativeImports:r,files:o,...n}=e;M0(t,n)}function M0(j,A){Object.assign(j,A)}function TS(j,A){if(!j&&!A)return!0;if(j&&A){let e=j.length;if(e!==A.length)return!1;for(let t=0;t<e;t++)if(j[t]!==A[t])return!1;return!0}else return!1}function PS(j){return j.type==="save"}function _S(j){return j.type==="delete"}function Ur(){return li()}function Fd(j){return j==="codeFile"||j==="canvasComponent"}function D0(j,A,e){return j.replace(new RegExp(`\\b(from\\s*)(["'])${Rd(A)}\\2`,"g"),`$1${JSON.stringify(e)}`)}function xS(j,A){switch(j){case"canvasComponent":case"layoutTemplate":case"screen":case"prototype":case"collection":case"draftCollection":case"webPageMetadata":case"siteMetadata":case"vector":case"vectorSet":case"kit":return A.default;case"codeFile":case"css":case"componentPresets":case"config":case"localization":case"design":return Object.values(A)[0];default:iA(j)}}var N0={start:new Date("2025-09-03T10:00:00Z").getTime(),end:new Date("2025-09-07T13:00:00Z").getTime()};function MS(j,A){for(let e of j){if(e.id!==A.localId)continue;if(e.save.saveId===A.saveId)return!1;let t=new Date(A.savedAt).getTime();return Number.isNaN(t)?!1:t>N0.start&&t<N0.end}return!1}function O0(j,A){if(!j||j.length===0)return A?.placeholder??"";if(j.length===1)return j[0]&&j[0]!==""?j[0]:A?.placeholder??"";let e=[...j],t="";if(A?.max&&A.max<j.length){let r=j.length-A.max;e=e.slice(0,A.max),t=`${r} ${r>1?"others":"other"}`}else t=e.pop()??"";return e.length>1?`${e.join(", ")}, and ${t}`:`${e.join(", ")} and ${t}`}var Xz=tt("componentPresets","componentPresets");function w0(j,A){let e=j.getPresetsListNode();return e?e.getComponentPresets().find(t=>t.componentIdentifier===A)??null:null}function L0(j,A){let{treeStore:e}=j.stores;if(e.tree.has(A.id))return;let t=w0(e.tree,A.componentIdentifier),r=Rt(e.tree),o=Qm(r.children,a=>so(a)&&a.componentIdentifier!==A.componentIdentifier);o!==-1&&(o+=1),e.tree.insertNode(A,r.id,o),ko(j)&&j.stores.codeGenerationStore.createModuleFromComponentSource(r).catch(GA),Fe(A.componentIdentifier)&&j.stores.modulesStore.addExternalModulesToProject([A.componentIdentifier],{onTreeUpdate(){}});let n=Rn(A.componentIdentifier);t||j.scheduler.runWithFullyLoadedTree(()=>{let a=e.getLoadedIndexes();for(let i of a.richTextNodes)i.htmlContent&&YA(e.tree,i,n)&&i.setComponentPreset(A.componentIdentifier,A.id)},{runInBackground:!0,name:"insertComponentPreset"})}function DS(j,A){if(w0(j.tree,A.componentIdentifier))return;let t=Ul.createDefault(A);L0(j,t)}function Yz(j,A,e){j.scheduler.processWhenReady(()=>{let r=Rt(j.tree).getComponentPresets(),o=new Set;for(let a of r)a.name&&o.add(a.name);let n=Ul.createDefault(A,{name:Pj(A.name,o)});L0(j,n);try{e&&e(n)}catch{}})}function Zz(j,A){return j.getPresetsListNode()?.getComponentPresets().filter(t=>t.componentIdentifier===A)??[]}function q0(j,A,e){let t=oA(A);function r(n){let a=oA(n);return a.kind==="externalModuleExport"&&t.kind==="externalModuleExport"&&a.moduleId===t.moduleId&&a.exportSpecifier===t.exportSpecifier}let o=j.getPresetsListNode();if(o){let n=o.getComponentPresets();for(let a of n)r(a.componentIdentifier)&&a.set({componentIdentifier:e})}$(!j.getService("loader"),"Tree should be fully loaded");for(let n of j.root.walk()){if(!XA(n))continue;let a=n.getComponentPresets();for(let[i,s]of a){let l=Rn(i);r(i)&&YA(j,n,l)&&(n.setComponentPreset(e,s),n.setComponentPreset(i,void 0))}}}function A9(j,A,e){let t=A.find(r=>r.componentIdentifier===e);t&&DS(j,t)}function $i(j){let A=oA(j);if(!(!A||!Sj(A)||!Fe(A)))return`${A.moduleId}:${A.exportSpecifier}`}function V0(j){let A=new Map;for(let e of j){let t=$i(e);t&&A.set(t,e)}return A}function K0(j,A){let e=j.getRawControlProps();for(let t in e){let r=e[t]?.type,o=e[t]?.value;if(r!=="vectorsetitem"||!x(o)||!Sj(o))continue;let n=$i(o);if(!n||!A.has(n))continue;let a=A.get(n);a&&j.setControlProp(t,{type:"vectorsetitem",value:a})}}function J0(j,A){for(let e of A){K0(e,j);let t=$i(e.codeComponentIdentifier);if(!t||!j.has(t))continue;let r=j.get(t);r&&e.set({codeComponentIdentifier:r})}}function H0(j,A){let e=A.getContentManagementNode();if(e){$(e.isLoaded(),"CMS Should always be loaded.");for(let{node:t,skipChildren:r}of e.walkWithSkipChildren()){if(fj(t)){if(!t.variables.some(a=>a.type==="vectorsetitem")){r();continue}Q0(t,j)}if(!$e(t))continue;let o=t.getControlProps();for(let n in o){let a=o[n]?.value;if(o[n]?.type!=="vectorsetitem"||!x(a)||!Sj(a))continue;let s=$i(a);if(!s||!j.has(s))continue;let l=j.get(s);l&&t.setControlProp(n,{...o[n],value:l})}}}}function Q0(j,A){let e=!1,t=j.variables.map(r=>{if(r.type!=="vectorsetitem")return r;let{initialValue:o}=r,n=o.identifier;if(!n)return r;let a=$i(n);if(!a||!A.has(a))return r;let i=A.get(a);return i?(e=!0,{...r,initialValue:{...o,identifier:i}}):r});e&&j.set({variables:t})}function U0(j,A){for(let e of A.root.children){if(w(e)){K0(e,j);continue}(eA(e)||tj(e))&&Q0(e,j)}}var _j=hA("modules-store"),W0=new Set(["codeFile","canvasComponent","screen","layoutTemplate","vector"]),NS=500;function bd(j){let{module:A,exportSpecifier:e}=j,{id:t,saveId:r,files:o}=A;return $(o.module,"module file must exist for a saved module"),me(t,r,o.module,e)}var Wo,Bi,hi,rr,z0=class extends ge{constructor(e,t,r,o,n,a,i,s){super();this.scheduler=e;this.treeStore=t;this.loadedExternalModulesStore=r;this.chromeStore=o;this.modulesAPIServicePromise=n;this.makeDocumentReadOnly=a;this.insertTemporaryImportMap=i;this.loadAllLocalModules=s;g(this,"dependenciesModule");g(this,"localModules",new Map);g(this,"fastRefreshModules",new Map);g(this,"externalModulesDynamicInfo",new Map);g(this,"revision",0);LA(this,Wo,new Map);g(this,"moduleDepsGraph",{});g(this,"modulesStorage");g(this,"moduleUpdatesEmitter",new ot);g(this,"fastRefreshModulesEmitter",new ot);LA(this,Bi);LA(this,hi,new Map);LA(this,rr,new Map);g(this,"debugModuleStoreAndComponentLoaderRevisionsMatch",()=>this.revision===L.modulesRevision);g(this,"checkForExternalModuleUpdates",async()=>{if(this.treeStore.tree.isViewOnly)return;let e=this.treeStore.tree.getExternalModulesListNode();if(!e||!e.children?.length)return;let t=[],r=new Map;e.children.forEach(i=>{let s=oA(i.codeComponentIdentifier);if($(s?.kind==="externalModuleExport","expected ExternalModuleNode identifier to be of kind externalModuleExport"),i.type==="vector"){let l=i.annotation("framerVector");if(!qa(l))return;let c=l.set.moduleId,u=r.get(c)??[];u.push(s),r.set(c,u)}else t.push(s)});for(let[i,s]of r){let l=this.treeStore.tree.get(i);if(!st(l))continue;let c=l.annotation("framerVectorSet");_l(c)&&(Ck(c)||t.push(...s))}let o=t.map(({moduleId:i,saveId:s})=>({moduleId:i,saveId:s}));if(!o.length)return;let n=[],a=[];for(let i=0;i<o.length;i++){let s=o[i];if($(s,"query is expected to be defined."),n.push(s),n.length<NS&&i<o.length-1)continue;let{modules:l}=await this.lookUpModules(n,{includeStatus:!0});a.push(...l),n=[]}this.treeStore.tree.isViewOnly||this.updateExternalModuleNodes(a.map((i,s)=>{let l=t[s];return $(l,"External module missing a matching identifier"),{module:i,exportSpecifier:l.exportSpecifier}}),{onTreeUpdate(){}}).catch(GA)});g(this,"updatesPollId");g(this,"compileFastRefreshModule",async({localId:e,name:t,source:r,includeSourceMap:o=!0})=>{let{type:n,name:a}=Ji(e);if(!W0.has(n))return;let i=n==="codeFile"?le(t).source:a,{code:s,imports:l,sourceMap:c}=await LB({localId:e,source:r,name:i,includeSourceMap:o}),u={kind:"fast-refresh",localId:e,type:n,name:i,sourceContent:r,moduleContent:s,relativeImports:l.relative,sourceMapContent:c,binaryAssetContents:void 0,submoduleContents:{},update:0},[p,f]=us(this.fastRefreshModules,E=>{E.set(t,u)});this.fastRefreshModules=p,this.fastRefreshModulesEmitter.emit({patches:f,dependentModules:[],prioritizedModules:[],revision:++this.revision,initialized:!0})});g(this,"compile",({localId:e,name:t,source:r,includeSourceMap:o=!0,type:n,telemetrySession:a})=>{let i=qB({name:t,source:r,includeSourceMap:o,type:n,telemetrySession:a});return this.fastRefreshEnabled&&e&&this.compileFastRefreshModule({localId:e,name:t,source:r,includeSourceMap:o}).catch(GA),i});this.modulesStorage=new i6(()=>this.modulesAPIServicePromise.catch(l=>{throw _j.error(l,{context:"Failed to discover ModulesAPI service:"}),l}),this.compile,this.scheduler.process.bind(this.scheduler),this.scheduler.processWhenReady.bind(this.scheduler),this.scheduler.runWhenIdle.bind(this.scheduler),t,()=>this.getActiveScope(),()=>this.makeDocumentReadOnly()),this.fastRefreshModulesEmitter.onNewStream=l=>(_j.debug("onNewStream - fast refresh",l),{latest:this.getAllModulesAsUpdateEvent(!0)}),this.moduleUpdatesEmitter.onNewStream=l=>(_j.debug("onNewStream - module updates",l),{latest:this.getAllModulesAsUpdateEvent(!1)}),this.modulesStorage.subscribe(l=>{let c=l.dependenciesModule?.importMapContent,u=this.dependenciesModule?.importMapContent,p=!1,f=!1,E=!1,F=!1;if(c&&u&&c!==u){let Z=JSON.parse(c),H=u?JSON.parse(u):void 0;for(let[AA,jA]of Object.entries(Z.imports??{})){rA(this,Wo).set(AA,"success");let N=H?.imports?.[AA];if(!N){p=!0;continue}N!==jA&&(f=!0)}E=!f&&!p,F=l.metadata.multiplayerChange||f||E}F&&l.metadata.multiplayerChange,this.dependenciesModule=l.dependenciesModule,this.localModules=l.modules;let R=this.moduleDepsGraph;this.moduleDepsGraph=l.depsGraph;let S=l.metadata.patches,v=new Set,P=[],T=[],D;for(let Z of S){let H=Z.path[0];if($(typeof H=="string"),H===rt){D=Z;for(let AA of l.modules.keys())v.add(AA);break}Z.op==="remove"&&Z.path.length===1?T.push(H):P.push(H)}let K=new Set;if(!D){let Z=this.getActiveScope(),H=mi(Z);_j.debug("Calculated visible code component module typeSlashNames",H);for(let AA of P)Qr(l.depsGraph,AA,v,H,K);for(let AA of T)Qr(R,AA,v,H,K);P.forEach(AA=>{v.delete(AA)}),T.forEach(AA=>{v.delete(AA),K.delete(AA)})}_j.debug("prioritized evaluation sending to sandbox",{dependentModules:v,visibleDependentModules:K},"highprio size",K.size,"dep size",v.size);let Q={patches:S,dependentModules:Array.from(v),prioritizedModules:Array.from(K),revision:++this.revision,initialized:l.initialized};this.moduleUpdatesEmitter.emit(Q),this.fastRefreshEnabled&&D&&this.fastRefreshModulesEmitter.emit({patches:[D],dependentModules:[],prioritizedModules:[],revision:Q.revision,initialized:l.initialized})})}getActiveScope(){if(this.chromeStore.mainView===5)return;let e=this.treeStore.tree.getNode(rA(this,Bi));if(e)return $(e?.loaded,"Active scope node should be loaded"),e.loaded}setActiveScope(e){FA(this,Bi,e)}getLatestDependencyGraph(){return this.moduleDepsGraph}initialize(){return this.initialized?this.modulesStorage.refresh():(this.setupPollingExternalModulesUpdates(),this.modulesStorage.initialize())}get initialized(){return this.modulesStorage.initialized}whenInitialized(){return this.modulesStorage.whenInitialized()}whenIdle(){return this.modulesStorage.whenIdle()}refresh(){return this.modulesStorage.refresh()}deleteModules(e){return this.modulesStorage.delete(e)}upsertBatch(e){return this.modulesStorage.upsertBatch(e)}forType(e){return new n6(this.modulesStorage,e,this.debugModuleStoreAndComponentLoaderRevisionsMatch)}getNpmDependencyInstallStatus(e){return rA(this,Wo).get(Mn(e))??"unknown"}async addNpmDependencies(e){let r=typeof this.dependenciesModule>"u"&&!xB(),o=await S0(this.modulesStorage.addNpmDependencies(e)),n=Array.isArray(e)?e:[e],a=n.filter(({target:l})=>!Dn(l));for(let l of a)rA(this,Wo).set(Mn(l),o.ok?"success":"failure");if(!o.ok)throw o.error;r&&MB();let i=Object.keys(o.value.dependenciesMap.dependencies),s=n.map(({target:l})=>l).filter(l=>!i.includes(l)&&Dn(l));if(s.length>0){let l=O0(s,{max:5,placeholder:"package"});PA({type:"add",variant:"warning",text:`${l} ${s.length===1?"is":"are"} incompatible with Framer`,duration:5e3})}return o.value}changeScope(e){this.setActiveScope(e.id),this.modulesStorage.changeScope(e)}async reinstallNpmDependencies(){return{importMap:await this.modulesStorage.reinstallNpmDependencies()}}async uninstallBlockedNpmDependencies(){return{importMap:await this.modulesStorage.uninstallBlockedNpmDependencies()}}async unsafeUpgradeDependency(e,t,r){return{importMap:await this.modulesStorage.unsafeUpgradeDependency(e,t,r)}}async clearNpmDependencies(){return this.modulesStorage.clearNpmDependencies()}async removeBlockedNpmDependencies(){return{dependenciesMap:await this.modulesStorage.removeBlockedNpmDependencies()}}async rebuildImportMapFromDependencies(){return{importMap:await this.modulesStorage.rebuildImportMapFromDependencies()}}async updateSources(e){return this.modulesStorage.updateSources(e)}async updateKit(...e){return this.modulesStorage.upsertKit(...e)}async updateDependenciesSource(e,t){await this.modulesStorage.updateDependenciesSource(e,t)}getDependentsOfModule(e){return this.modulesStorage.getDependentsOfModule(e)}subscribeToModulesStorage(e){return this.modulesStorage.subscribe(e)}async getModuleDependencies(e){let t=await this.modulesAPIServicePromise;return $(t,"Modules API service not initialized correctly"),await t.getModuleDependencies(e)}getModuleEntryByLocalId(e){for(let t of this.localModules.values())if(t.localId===e)return t}getModuleEntryByUniqueName(e){for(let t of this.localModules.values())if(t.name===e)return t}getPersistedDependenciesModule(){return this.modulesStorage.getPersistedDependenciesModule()}getPersistedModuleByGlobalId(e){return this.modulesStorage.getPersistedModuleByGlobalId(e)}getPersistedModuleByLocalId(e){return this.modulesStorage.getPersistedModuleByLocalId(e)}getPersistedModuleByLocalIdentifier(e){let t=oA(e);if(ej(t))return this.getPersistedModuleByLocalId(t.localId)}tryConvertExternalCodeComponentIdentifierToLocal(e){let t=oA(e);if(t?.kind!=="externalModuleExport")return;let r=this.getPersistedModuleByGlobalId(t.moduleId);if(r)return Ki(r.localId,t.exportSpecifier).value}async listNamespaces(){let e=await this.modulesAPIServicePromise;return $(e,"Modules API service not initialized correctly"),await e.listNamespaces()}async lookUpModule(e,t){let{modules:r,dependencies:o}=await this.lookUpModules([e],t),n=r[0];$(n,"Module does not exist, looking up:",e);let a={module:n};return o&&(a.dependencies=o[n.ownerType]?.[n.ownerId]),a}async lookUpModules(e,t){let r=await this.modulesAPIServicePromise;if(!r)return _j.error("Modules API service not initialized correctly"),{modules:[],dependencies:{}};let{data:o,dependencies:n}=await r.lookUpModules({queries:e,...t}),a=new Map(this.externalModulesDynamicInfo);for(let s of o){let l=s.id,{localId:c,title:u,description:p,lastPublish:f,status:E}=s;a.set(l,{localId:c,title:u,description:p,lastPublish:f,status:E??a.get(l)?.status})}this.externalModulesDynamicInfo=a;let i={modules:o};return n&&(i.dependencies=n),i}trackExternalComponentInsert(e,t){let r=qt();for(let o of e)tE({insertId:r,insertType:t,codeComponentId:o})}async installExternalModulesDependencies(e){let t=[],r=[];for(let o of e){let n=rA(this,hi).get(o);n?r.push(n):t.push(o)}if(t.length>0){let o=this.installDependenciesForModuleURLs(t);for(let n of t)rA(this,hi).set(n,o);r.push(o)}return Promise.allSettled(r).then(o=>{for(let n of o)n.status!=="fulfilled"&&_j.error("Failed to install external module",n.reason)})}isProcessingModules(){return this.modulesStorage.isProcessing()}hasLocalCodeFileChanges(){return this.modulesStorage.hasLocalCodeFileChanges()}resetModuleStateAndPermissions(e){this.modulesStorage.resetModuleStateAndPermissions(e)}getTransientSave(e){return this.modulesStorage.getTransientSave(e)}startUsingLocalModulesInTree(){return this.modulesStorage.startUsingLocalModulesInTree()}stopUsingLocalModulesInTree(){return this.modulesStorage.stopUsingLocalModulesInTree()}usingLocalModulesInTree(){return this.modulesStorage.usingLocalModulesInTree()}createFastRefreshModuleFromModule(e){if(W0.has(e.type)){if(e.kind==="server"){let t=this.getPersistedModuleByLocalId(e.localId);$(t?.kind==="server","Only server modules should have no sourceContent"),this.modulesStorage.createLocalModuleFromModule(t).catch(GA);return}this.compileFastRefreshModule({name:CA(e),localId:e.localId,source:e.sourceContent}).catch(GA)}}getModuleWithTypeSlashName(e){return this.modulesStorage.getModuleWithTypeSlashName(e)}waitForModulesToSave(){return this.modulesStorage.waitForModulesToSave()}installDependenciesForModuleURLs(e){return _j.info(`\u{1F986} Installing external modules:
	`,e.join(`
	`)),this.lookUpModules(e.map(t=>({url:t})),{includeDependencies:!0}).then(async({dependencies:t={}})=>{let r=Object.values(t).flatMap(a=>Object.values(a)),o,n;for(let{dependencies:a,importMap:i}of r)if(i){o=Go(o??{imports:{}},i);let s=a??yo(i);n=So(n??{dependencies:{}},s)}o&&n&&await this.modulesStorage.extendCurrentImportMap(o,n)})}async addOrUpdateExternalVectors(e){await this.modulesStorage.whenInitialized();let{modules:t}=await this.lookUpModules(e.filter(n=>{let a=this.treeStore.tree.getNodeWithTrait(n.moduleId,st);return a?oA(a.codeComponentIdentifier).saveId!==n.saveId:!0}),{includeDependencies:!1,includeStatus:!0}),r=new Map,o="default";for(let n of t){let a=bd({module:n,exportSpecifier:o}),i=this.treeStore.tree.getNodeWithTrait(n.id,st);Sj(i?.codeComponentIdentifier)&&oA(i.codeComponentIdentifier).saveId===n.saveId||r.set(a.value,{module:n,exportSpecifier:o})}await Promise.all(Array.from(r.keys(),n=>{let a=oA(n);return $(a,"Identifier must be a valid module identifier"),this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(a).catch(i=>{_j.error(`Failed to evaluate external module "${n}"`,i)})})),await new Promise((n,a)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes(Array.from(r.values()),{onTreeUpdate:()=>{let i=V0(r.keys());J0(i,this.treeStore.getLoadedIndexes().codeComponents),H0(i,this.treeStore.tree),U0(i,this.treeStore.tree)},updateSave:!0}).then(n).catch(a)},{name:"update_external_module_version",runInBackground:!0})})}async addOrUpdateVectorSetAndVectors(e){await this.addOrUpdateExternalVectors([e]);let r=this.treeStore.tree.getNodeWithTrait(e.moduleId,st)?.annotation("framerVectorSet");_l(r)&&await this.addOrUpdateExternalVectors(r.items.map(o=>({moduleId:o.moduleId,saveId:o.saveId??""})))}async addExternalModulesToProject(e,t){let r=e.map(n=>typeof n=="string"?oA(n):n),o=await this.preloadExternalModules(r);return this.updateExternalModuleNodes(o,t)}async preloadExternalModules(e){await this.modulesStorage.whenInitialized();let t=new Map;for(let s of e)t.set(s.bareValue,s);let r=[],o=[],n=[];for(let[s,l]of t){let{moduleId:c,saveId:u}=l;if(!!this.modulesStorage.getPersistedModuleByGlobalId(c)){_j.reportError("Attempted to treat local module as external module",{identifier:l});continue}let f=this.treeStore.tree.getNode(c);if(f&&oA(f.codeComponentIdentifier).saveId===u&&!this.loadedExternalModulesStore.hasModuleForIdentifier(l)){o.push(l);continue}let E=rA(this,rr).get(s);if(E){n.push({identifier:l,preloadPromise:E});continue}rA(this,rr).set(s,kr()),r.push(l)}let a=new Map;for(let{identifier:s,preloadPromise:l}of n)try{let c=await l;a.set(s.value,c)}catch{rA(this,rr).set(s.bareValue,kr()),r.push(s)}if(r.length)try{let s=Array.from(r.values(),({moduleId:p,saveId:f})=>({moduleId:p,saveId:f})),{modules:l,dependencies:c}=await this.lookUpModules(s,{includeDependencies:!0,includeStatus:!0}),u=0;for(let p of r){let f=l[u++];$(f,"Module must be defined"),a.set(p.value,{module:f,dependencies:c?.[f.ownerType]?.[f.ownerId],exportSpecifier:p.exportSpecifier}),o.push(p)}}catch(s){_j.reportError(s);for(let l of r)rA(this,rr).get(l.bareValue)?.reject(s);throw Error(`Failed to preload modules: ${s}`)}let i;for(let s of o){let l=a.get(s.value);if(!l)continue;let{dependencies:c}=l;c?.importMap&&(i=Go(i??{imports:{}},c.importMap))}i&&await this.insertTemporaryImportMap(i),await Promise.all(Array.from(o.values(),s=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(l=>{_j.error(`Failed to evaluate external module "${s.value}"`,l)})));for(let s of r){let l=a.get(s.value);$(l,"Expected to have module information for:",s.value);let c=rA(this,rr).get(s.bareValue);$(c,"Expected to find a preload promise for:",s.bareValue),c.resolve(l)}return[...a.values()]}async updateExternalModuleNodes(e,{onTreeUpdate:t,updateSave:r=!1}){let o,n;for(let{dependencies:a}of e)if(a?.importMap){o=Go(o??{imports:{}},a.importMap);let i=a.dependencies??yo(a?.importMap);n=So(n??{dependencies:{}},i)}return o&&!wk(o)&&n&&await this.modulesStorage.extendCurrentImportMap(o,n),await Promise.all(e.map(a=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(bd(a)))),this.scheduler.processWhenReadyAsync(()=>{if(this.treeStore.tree.isViewOnly)throw Error("unable to edit");for(let a of e){let{id:i,type:s,metadata:l,ownerId:c,ownerType:u}=a.module,p=bd(a),{title:f,status:E}=this.externalModulesDynamicInfo.get(p.moduleId)??a.module,F=this.treeStore.tree.getExternalModulesListNode();F||(F=new Im,this.treeStore.tree.insertNode(F,this.treeStore.tree.root.id)),$(_u(F));let R=l.pluginId,S={codeComponentIdentifier:p.value,type:s,scopeNodeId:Hk(a.module),intrinsicWidth:ft(l.intrinsicWidth)??200,intrinsicHeight:ft(l.intrinsicHeight)??200,ownerId:c,ownerType:u,group:E?.group,updateSaveId:E?.updateSaveId,namespaceId:a.module.lastPublish?.namespaceId,pluginId:x(R)?R:void 0},v=L.componentForIdentifier(p.value);$(v,"Component not found in the component loader",p.value);let P=v.annotations??void 0;S.annotations=Fm(s)?bo({default:P}).default:P;let T=v.name??f;S.title=T;let D=this.treeStore.tree.getNode(i);if(D)if(r)D.set(S);else{let{group:K,updateSaveId:Q}=S;D.set({group:K,updateSaveId:Q})}else D=new Gm({id:i,...S}),this.treeStore.tree.insertNode(D,F.id)}return t()})}setupPollingExternalModulesUpdates(){let e=qf(()=>{this.checkForExternalModuleUpdates().catch(_j.reportError)},1e4),t=()=>{e(),this.updatesPollId===void 0&&(this.updatesPollId=window.setInterval(this.checkForExternalModuleUpdates,6e4))},r=()=>{window.clearInterval(this.updatesPollId),this.updatesPollId=void 0};function o(){return!document.hidden&&navigator.onLine}o()&&t();function n(){setTimeout(()=>{o()?t():r()},500)}document.addEventListener("visibilitychange",n),window.addEventListener("offline",n),window.addEventListener("online",n)}getCodeComponentNodesForExternalModuleExport(e){return this.treeStore.getLoadedIndexes().codeComponents.filter(t=>{if(!W(t)||gA(t)&&!t.isVectorInstance)return!1;let r=oA(t.codeComponentIdentifier);return r?.kind!=="externalModuleExport"?!1:r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier})}get fastRefreshEnabled(){return this.chromeStore.codeEditorPreviewVisible}async updateExternalModuleComponentInstances(e){let t=oA(e);$(t?.kind==="externalModuleExport","parsed 'ExternalModuleNodes.id' should be of kind externalModuleExport");let{moduleId:r,exportSpecifier:o}=t,n=this.externalModulesDynamicInfo.get(r)?.status?.updateSaveId;if(!n){_j.warn("Could not update module",r,"latest status missing");return}let{module:a,dependencies:i}=await this.lookUpModule({moduleId:r,saveId:n},{includeDependencies:!0,includeStatus:!0});$(a.files.module,"Module file must be defined");let s=me(r,n,a.files.module,o);try{await this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(_j.reportError),await new Promise((l,c)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes([{module:a,dependencies:i,exportSpecifier:o}],{onTreeUpdate:()=>{this.getCodeComponentNodesForExternalModuleExport(t).forEach(p=>p.set({codeComponentIdentifier:s.value})),Tf(this.treeStore.tree,t.value,s.value),q0(this.treeStore.tree,t.value,s.value)},updateSave:!0}).then(l).catch(c)},{name:"update_external_module_version",modalTitle:"Updating the module version"})}),this.trackExternalComponentInsert([s.value],"update")}catch(l){_j.reportError(l)}}async replaceRelativeImportsWithImportMapSpecifiers(e,t,r){let o={};for(let a of r){let i=xe(a,e);if(!i)continue;let s;if(s=this.fastRefreshModules.get(i),s||(s=this.modulesStorage.getModuleWithTypeSlashName(i)),!s){_j.error("Cannot resolve",a,"from",e);continue}let l,{name:c,localId:u}=s;if(s.kind==="fast-refresh")l=le(c).module;else{let{files:p}=s;$(x(p.module),"Must have a module file name to build a local module import map specifier."),l=p.module}o[a]=Hi(u,l)}let n=await t6(t,o);return $(n.ok),n.value}getModules(e=!1){let t={};for(let[r,o]of this.localModules)t[r]=o;if(e)for(let[r,o]of this.fastRefreshModules)t[r]=o;return{dependenciesModule:this.dependenciesModule,modules:t,revision:this.revision,initialized:this.modulesStorage.initialized}}getAllModulesAsUpdateEvent(e=!1){let{dependenciesModule:t,modules:r,initialized:o,revision:n}=this.getModules(e),a=[];t&&a.push({op:"add",path:[`${t.type}/${t.name}`],value:t});for(let i of Object.values(r))a.push({op:"add",path:[`${i.type}/${i.name}`],value:i});return{patches:a,dependentModules:[],prioritizedModules:[],initialized:o,revision:n}}getModulesUpdatesService(e=!1){return{moduleUpdatesStream:()=>e?this.fastRefreshModulesEmitter.newStream({replay:"latest"}):this.moduleUpdatesEmitter.newStream({replay:"latest"})}}hasScreenModuleLoaded(e){let t=pr("screen",e,"default").value;return L.componentForIdentifier(t)!==null}postProcess(){this.modulesStorage.processTreeUpdates()}};Wo=new WeakMap,Bi=new WeakMap,hi=new WeakMap,rr=new WeakMap;var wS={defaultComponent:{insert:"insert-default",drag:"insert-default-drag"},libraryModule:{insert:"insert-library",drag:"insert-library-drag"},externalModuleComponent:{insert:"insert",drag:"insert-drag"}},Cd="default_component_",a6="external_",vd="local_",X0="legacy_design_component",Y0="legacy_code_component",Z0=`${vd}${Y0}`,LS=`${a6}${Y0}`,Ah=`${vd}${X0}`,jh=`${a6}${X0}`;var qS=new Set(["form","frame","image-frame","stack","repeater"]),VS=j=>j.startsWith(Cd),eh=j=>j===Ah||j===jh,KS=j=>qS.has(j);function th({canvasNode:j,source:A,isDrag:e,engine:t}){let r=JS(j,t);switch(mA("component_instance",{componentType:r.type,source:A}),A){case"insert_menu":{let o=HS(r);mA("insert_menu_add",{type_added:o});break}}if(r.type==="local_module_canvasComponent_component"&&mA("component_canvas_instance",{componentId:j.id}),eh(r.type)&&mA("component_design_instance",{}),W(j)&&Fe(j.codeComponentIdentifier)){let o=r.type.startsWith(Cd)?"defaultComponent":A==="team_library"?"libraryModule":"externalModuleComponent",n=wS[o][e?"drag":"insert"];t.stores.modulesStore.trackExternalComponentInsert([j.codeComponentIdentifier],n)}}function JS(j,A){if(W(j)){let r=j.codeComponentIdentifier,o=oA(r);if(!o)return{type:j.codeComponentIdentifier.startsWith(".")?Z0:LS,codeComponentIdentifier:r};if(ej(o))return{type:`${vd}module_${o.type}_component`,codeComponentIdentifier:r};if(Fe(o)){let n=A.stores.treeStore.tree.getNode(o.moduleId);return ds(A.stores.treeStore.tree,r)?{type:`${Cd}${n?.title}`,codeComponentIdentifier:r}:{type:`${a6}module_${n?.type??"unknown"}_component`,codeComponentIdentifier:r}}}let t=j.replicaInfo?.master&&A.tree.getNode(j.replicaInfo.master)||j;return Zj(t)?rn(t)?{type:jh}:{type:Ah}:na(j)?{type:"repeater"}:Eo(j)?{type:"form"}:WA(j)?{type:"stack"}:pA(j)?j.fillType==="image"?{type:"image-frame"}:{type:"frame"}:{type:"unknown"}}function HS({type:j}){return j.startsWith("local_module_")||j===Z0?"code_component":eh(j)?"design_component":j.startsWith(a6)?"package":VS(j)||KS(j)?j:"unknown"}function Td(j,A){let e=j.children;return Ce(j)?!e||e.length===0?[]:A.getChildrenRects(j.id)??[]:null}function Z9(j,A,e){if(!j||!TA(j))return;let t=[];for(let r=0,o=j.children.length+1;r<o;r++){let n=j.children[r];if(!ze(n,j))continue;let a=Td(j,e);if(!a||a.length===0)return;let i=a.splice(r,A.length),s=q.merge(...i);t.push(s)}return t}function rh(j,A,e){if(j>=A&&j<=e||j<=A&&j>=e)return 0;let t=Math.abs(A-j),r=Math.abs(e-j);return Math.min(t,r)}function QS(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=A[t],n=0,a=1/0;return e.forEach((i,s)=>{if(a===0)return;let l=i[t],c=l+i[r],u=rh(o,l,c);u<a&&(n=s,a=u)}),n}function US(j,A,e,t){let r=Math.max(j,e),o=Math.min(A,t);return r<o}function WS(j,A,e){let t=j?"y":"x",r=j?"height":"width",o=e[A];$(o,"Out of bound access to childRects:",A,e);let n=o[t],a=n+o[r],i=new Set([A]);return e.forEach((s,l)=>{if(l===A)return;let c=s[t],u=c+s[r];US(n,a,c,u)&&i.add(l)}),{startIndex:Math.min(...i),endIndex:Math.max(...i)}}function zS(j,A,e,t,r,o){if(r)return t.startIndex;if(o)return t.endIndex;let n=A?"x":"y",a=A?"width":"height",i=j[n],s=1/0,l=t.startIndex;for(let c=t.startIndex;c<=t.endIndex;c++){let u=e[c];$(u,"Ouf of bound access to childRects:",c,t,e);let p=u[n],f=p+u[a],E=rh(i,p,f);E<s&&(s=E,l=c)}return l}function XS(j,A){let e=[];for(let t=A.startIndex;t<=A.endIndex;t++){let r=j[t];$(r,"Ouf of bound access to childRects:",t,A,j),e.push(r)}return q.merge(...e)}function YS(j,A,e,t){let r=it(j)||j.resolveValue("stackDirection")==="horizontal",o=q.merge(...A),n=r?"x":"y",a=r?"y":"x",i=r?"width":"height",s=r?"height":"width",l=e[n],c=e[a],u=o[a],p=u+o[s],f=c<u,E=!f&&c>p,F=QS(r,e,A),R=WS(r,F,A),S=zS(e,r,A,R,f,E),v=A[S];$(v,"Closest rect is not defined:",S);let P=v[n]+v[i]/2,T=f||E?f:l<P,D=T?S:S+1;f&&(D=0),E&&(D=A.length);let K=v[n],Q=K+v[i],Z=T?K:Q,H=null,AA=T?S-1:S+1;if(AA>=R.startIndex&&AA<=R.endIndex){let uj=A[AA];if(uj){let Mj=uj[n],ue=Mj+uj[i];H=T?ue:Mj}}let jA=Z;Y(H)&&(jA=Math.round((jA+H)/2));let N=XS(A,R),z=Math.round(N[a]+N[s]/2),J={[n]:jA,[a]:z},nA={...J},BA={...J},ZA=t[s],zA=Math.round(ZA/2);return r?(nA.y-=zA,BA.y+=zA):(nA.x-=zA,BA.x+=zA),{index:D,line:{a:nA,b:BA}}}function oh(j,A,e,t,r){if($(A.length,"childInsertion only works correctly if there are more than 0 child rects"),it(j)||j.stackWrapEnabled)return YS(j,A,t,r);let o=1/0,n=null,a=j.stackDirection==="vertical";A.forEach((c,u)=>{let p=Math.abs(a?t.y-c.y:t.x-c.x);p>o||(o=p,n=u)});let i=0;if(n!==null){let c=A[n];$(c,"Closest child rect is not defined:",n);let u=q.center(c);(a?t.y>u.y:t.x>u.x)&&n++,i=Math.min(Math.max(0,n),A.length)}let s=Ay(j),l=jy(j.resolveValue("stackDirection"),j.resolveValue("stackAlignment"),s,e,A,i,r);return{index:ZS(j,i),line:l}}function ZS(j,A){$(TA(j),"A node must support children to consider an insertion index.");let e=A;for(let t=0;t<j.children.length&&t!==A;t++){let r=j.children[t];r&&(ze(r)||e++)}return e}function Ay(j){let A=j.resolveValue("stackDirection"),e=j.resolveValue("stackAlignment");if(e==="center")return 0;let t=Fo(j);if(!t.perSide)return t.top;let r=e==="start";return A==="vertical"?r?t.left:t.right:r?t.top:t.bottom}function jy(j,A,e,t,r,o,n){let a=r[o-1],i=r[o],s=j==="vertical",l={x:t.width/2,y:t.height/2};if(!(!a&&!i)){if(r.length===1){let c=a||i;$(c,"Child rect must be defined"),o===0?s?l.y=c.y-10:l.x=c.x-10:s?l.y=c.y+c.height+10:l.x=c.x+c.width+10}else if(a&&i){let c=Math.abs(s?a.y+a.height-i.y:a.x+a.width-i.x);s?l.y=i.y-c/2:l.x=i.x-c/2}else if(a){let c=r[o-2];$(c,"Child rect must be defined");let u=Math.abs(s?c.y+c.height-a.y:c.x+c.width-a.x);s?l.y=a.y+a.height+u/2:l.x=a.x+a.width+u/2}else if(i){let c=r[o+1];$(c,"Child rect must be defined");let u=Math.abs(s?i.y+i.height-c.y:i.x+i.width-c.x);s?l.y=i.y-u/2:l.x=i.x-u/2}}return l.x=Math.min(Math.max(4,l.x),t.width-4),l.y=Math.min(Math.max(4,l.y),t.height-4),ey(j,A,e,l,t,n)}function ey(j,A,e,t,r,o){let n=j==="vertical",a,i,s=e??0;switch(A){case"center":a={x:n?t.x-o.width/2:t.x,y:n?t.y:t.y-o.height/2},i={x:n?t.x+o.width/2:t.x,y:n?t.y:t.y+o.height/2};break;case"start":a={x:n?s:t.x,y:n?t.y:s},i={x:n?o.width+s:t.x,y:n?t.y:o.height+s};break;case"end":default:a={x:n?r.width-o.width-s:t.x,y:n?t.y:r.height-o.height-s},i={x:n?r.width-s:t.x,y:n?t.y:r.height-s};break}return{a,b:i}}var nh=6;function ty(j,A){for(let e of j)if(A.includes(e))return!0;return!1}function ry(j,A,e,t,r){if(r.length===0||j.stackWrapEnabled||DA(j)||gA(j))return null;let{tree:o}=A,{zoom:n}=A.stores.canvasStore,a=o.getParent(j.id);if(a&&WA(a)&&(a.stackDirection!==j.stackDirection||a.stackWrapEnabled))return null;let i=o.convertPointToNode(j,e),s=o.getRect(j),l=j.stackDirection==="vertical",c=l?"x":"y",u=l?"y":"x",p=l?"width":"height",f=l?"height":"width",E=s[p],F=s[f],R=E*n,S=E*n;if(R<40||S<40)return null;let v=i[c],P=10/n,T=q.merge(...r),D=T[c],K=D+T[p],Q=Math.max(P,D/2),Z=Math.max(P,(E-K)/2),H=v<=Q,AA=v>=E-Z;if(!H&&!AA)return null;let jA=H?0:1,N=t[f],z=4/n,J=H?z:E-z,nA=F/2,BA=N/2,ZA=F/3,zA=i[u],xj="end";N>F?xj="center":zA<ZA?xj="start":zA<2*ZA&&(xj="center");let uj,Mj;switch(xj){case"start":{uj=0,Mj=N;break}case"end":{Mj=F,uj=Mj-N;break}case"center":default:{uj=nA-BA,Mj=nA+BA;break}}let ue={[c]:J,[u]:uj},pe={[c]:J,[u]:Mj},cr=o.convertPointToCanvas(j,ue),wi=o.convertPointToCanvas(j,pe);return{insertionIndex:jA,insertionLine:{a:cr,b:wi},wrap:{wrapAlignment:xj}}}function Pd(j,A,e,t,{allowWrapping:r=!0}={}){if(!TA(j))return{insertionIndex:null,insertionLine:null};let o=Td(j,A.stores.layoutCache);if(!o)return{insertionIndex:null,insertionLine:null};if(WA(j)&&r){let u=ry(j,A,e,t,o);if(u)return u}let n=A.tree,a=n.getRect(j),i=n.convertPointToNode(j,e);if(o.length===0)return{insertionIndex:0,insertionLine:null};let{index:s,line:l}=oh(j,o,a,i,t),c={a:n.convertPointToCanvas(j,l.a),b:n.convertPointToCanvas(j,l.b)};return{insertionIndex:s,insertionLine:c}}var oy={width:10,height:10};function ih(j,A,e,t,r,o=!1){$(e.length,"getStackOrGridInRange(): expects at least a single selected node");let n=j.stores.scopeStore.active;if(e.some(bj))return null;let i=j.tree.getNodesAtPoint(n,A).filter(c=>!(Pr(c)&&c.locked||!TA(c)||Q$(c)||Zp(j.tree,j.stores.overlayStore.activeOverlays,c))).reverse();if(t){let c=t.id,u=i.find(p=>p.id===c);if(u)return u}let s=null,l=e.map(c=>c.id);for(let c of i){if(!ep(c)||o&&!IA(c))continue;let u=j.tree.getAncestors(c.id);if(u.push(c.id),ty(u,l)||(s||(s=c),!Te(c)))continue;let{insertionLine:f}=Pd(c,j,A,oy);if(!f)continue;if(f.a.x===f.b.x){if(Math.abs(A.x-f.a.x)*j.stores.canvasStore.zoom>nh)continue}else if(f.a.y===f.b.y){if(Math.abs(A.y-f.a.y)*j.stores.canvasStore.zoom>nh)continue}else continue;if(e.every(F=>Qt(j.tree,c,F,n.id,r)))return c}if(Te(s)){let c=s;if(e.every(p=>Qt(j.tree,c,p,n.id,r)))return s}return null}function ah(j,A,{wrapAlignment:e}){let t=rd.addStack(j,[A]);if(!t)return null;let r=j.tree.getNode(t);return!r||!WA(r)?null:(r.set({stackDirection:A.stackDirection==="horizontal"?"vertical":"horizontal",stackAlignment:e}),r)}function _d(j,A){let{width:e,height:t}=j.tree.getRect(A);return $A(A)&&sj(A)&&(A.widthType===2&&A.width>0&&(e=A.width),A.heightType===2&&A.height>0&&(t=A.height)),{width:e,height:t}}function ny(j,A,e){let t=_d(j,A);return{...t,x:e.x-t.width/2,y:e.y-t.height/2}}function iy(j,A){let e=_d(j,A),t=j.stores.scopeStore.active,r=j.tree.getCommonGroundNode(j.stores.selectionStore.nodes),o,n;if(r){let i=j.tree.convertFrameToCanvas(r);o=q.center(i).x-e.width/2,n=i.y}else if(w(t)||eA(t)){let i=t.getPrimaryVariant(),s=j.tree.convertFrameToCanvas(i);o=q.center(s).x-e.width/2,n=s.y}else{let i=j.stores.canvasStore.getCanvasCenter();o=i.x-e.width/2,n=i.y-e.height/2}let a={x:o,y:n};for(;;){let i={...e,...a},s=j.tree.getNodesInRect(t,i,!0);if(s.length===0)return i;let l=j.tree.getBoundingFrameForNodes(s);a.x=l.x-e.width-100}}function ay(j,A,e,t=!1){let{tree:r}=j,o=r.getPotentialParents(j.stores.scopeStore.active,j.stores.overlayStore.activeOverlays,q.cornerPoints({...e,width:1,height:1}),e,L,A);return t&&(o=o.filter(IA)),o=r.sortVisually(o).reverse(),o.length>0&&o[0]?o[0]:null}var sh={width:1,widthType:1,heightType:2,left:0,right:null};function lh({engine:j,component:A,canvasPoint:e,source:t,type:r,shouldBecomeFullWidthForVariants:o=new Set,isLayoutSection:n=!1,notDraggedOntoCanvas:a=!1,insertAsGroundNode:i=!1,insertAsOverlayType:s,imageToUpload:l}){th({canvasNode:A,source:r==="libraryModule"?"team_library":t,isDrag:!0,engine:j});let{selectionStore:c,canvasStore:u,scopeStore:p}=j.stores,f=i?iy(j,A):ny(j,A,e);s===1&&Vt(A)&&A.set({floatingPositionEnabled:!0,floatingPlacement:Ca,floatingAlignment:va,floatingOffsetX:0,floatingOffsetY:10});let E=Ks(j,A),F=ih(j,e,[E],null,L,n);if(a&&n&&!F){let jA=u.getCanvasVisibleRectTakingOverlaysIntoAccount(),N=c.ids.length===1&&c.ids[0]?j.tree.getNode(c.ids[0]):null,z=N?j.tree.getGroundNodeFor(N):null;Te(z)&&q.intersects(j.tree.convertFrameToCanvas(z),jA)&&(F=z)}let R=F??ay(j,A,e,n),S=c.ids.length===0,v=p.active,P=po(v)?v.getPrimaryVariant():null;if(a&&n&&P&&S&&(R=P),s===1&&R&&Vt(E)&&!IA(R)){$(R,"Parent should exist");let jA=R.originalid??R.id,N=xs(j.stores,"framer/useShowRelativeOverlay",jA,E.draftOrCurrent());if(!N)return;j.tree.move(N.id,jA);return}else Vt(E)&&E.set(Wp);if(i&&(R=null,F=null,!q.containsRect(u.getCanvasVisibleRectTakingOverlaysIntoAccount(),f))){let jA=q.center(f),N=u.zoom,z=Math.min(N,1);u.scrollToCenter(jA,{animate:!0,zoom:z})}let T=-1,D=null;if(R){zE(j,R,A,f),XE(j,R,A);let jA=R.draftOrCurrent();WA(jA)&&(F=jA)}if(F){let jA=_d(j,A),{insertionIndex:N,wrap:z}=Pd(F,j,e,jA);if(z&&(D=z),Y(N)&&(T=N),a&&n){if(T=F.children.length,c.ids.length===1){let T6=c.ids[0],Li=T6&&j.tree.getNode(T6);if(Li){let qi=new Set([Li.id]);for(let Vi of Li.ancestors())qi.add(Vi.id);let Xo=F.children.findIndex(Vi=>qi.has(Vi.id));Xo>=0&&(T=Xo+1)}}let J,nA=F.children[T-1];nA?(J=j.tree.convertFrameToCanvas(nA),J.y+=J.height):J=j.tree.convertFrameToCanvas(F),J.height=jA.height;let BA=j.tree.convertFrameToCanvas(F),ZA=Math.min(J.x,BA.x),zA=Math.max(q.maxX(J),q.maxX(BA));J.x=ZA,J.width=zA-ZA;let{zoom:xj}=u,uj=u.getCanvasVisibleRectTakingOverlaysIntoAccount(),Mj=uj.width*xj,ue=uj.height*xj,pe=40,cr=Math.max(Mj-pe*2,100),wi=Math.max(ue-pe*2,100),v6=cr/(J.width||1),k7=wi/(J.height||1),m7=Math.min(v6,k7,.5),f7=q.center(J);u.scrollToCenter(f7,{animate:!0,zoom:m7})}YE(j,F,A,f)}let K;if(R){let{width:jA,height:N}=f;K={...j.tree.convertCanvasFrameToNode(R,f),width:jA,height:N}}else K=f;let Q=E.updateForRect({rect:K,parentSizeInfo:null,constraintsLocked:!1,shouldGuessPinToBottom:R?It(j.tree,E,R):!0,shouldGuessPinToRight:R?ae(j.tree,E,R):!0});R&&WA(R)&&sj(E)&&$A(E)&&(Q=ly(E,Q)),JB(E,Q),E.set(Q,j.tree);let Z=E.id,H=!1,AA=null;if(R){if(AA=R,$j(R)&&(AA=j.tree.getNode(R.originalid),H=!0,$(AA,"Fail to insert node into variants: the original parent should exist")),D&&!gA(AA)&&WA(AA)){let z=ah(j,AA,D);if(!z)return;AA=z}j.moveNode(E.id,AA.id,T),H&&($(gA(R),"Fail to insert node into variants: the new parent should be a replica node"),Z=zn(j,E,R,AA));let jA=j.tree.getGroundNodeFor(AA),N=!!(jA.name&&o.has(jA.name.toLowerCase()));if(pA(E)&&N&&E.set({left:0,width:1,widthType:1},j.tree),W(E)&&Ej(jA)&&IA(jA)){let J={width:E.width,widthType:E.widthType,left:E.left,right:E.right};N&&E.set(sh);let nA=Cc(E);if(nA){let BA=j.tree.getScopeNodeFor(jA);w(BA)&&BA.getTopLevelReplicaVariants().forEach(zA=>{if(!zA.name)return;let xj=vc(zA.name,nA);if(!xj||xj===nA.defaultVariant)return;let uj={...zA.replicaInfo.overrides},Mj={...zA.replicaInfo,overrides:uj},ue={...uj[E.id]},pe=sy(N,o,zA.name,J);pe&&Object.assign(ue,pe),ue[QA(nA.key)]={type:"enum",value:xj},uj[E.id]=ue,zA.set({replicaInfo:Mj})})}}it(R)&&Ir(E)&&(N||E.set({gridItemFillCellWidth:!0}),E.set({gridItemFillCellHeight:!0}))}l&&pA(A)&&Mf(l,A,j).catch(GA),c.set(Z,{switchToLayers:!0})}function sy(j,A,e,t){let r=A.has(e.toLowerCase());if(j!==r)return r?sh:t}function ly(j,A){let e={...A};return(j.widthType===3||j.widthType===1)&&Y(A.width)&&A.widthType!==j.widthType&&(delete e.width,delete e.widthType),(j.heightType===3||j.heightType===1)&&Y(A.height)&&A.heightType!==j.heightType&&(delete e.height,delete e.heightType),e}function s6({engine:j,module:A,identifier:e,position:t,centerInParent:r,insertAsGroundNode:o,update:n}){let a={width:ft(A.metadata.intrinsicWidth)??200,height:ft(A.metadata.intrinsicHeight)??200},i=new xr({codeComponentIdentifier:e,slotsAreChildNodes:yA.isOn("componentSlotsAreChildNodes"),...a});n&&n(i);let s=t;if(r&&!o){let l=p0(i,j),c=l?q.center(j.tree.convertFrameToCanvas(l)):null,u=j.stores.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount();c&&q.containsPoint(u,c)&&(s=c)}return lh({engine:j,component:i,canvasPoint:s,source:"context_menu",insertAsGroundNode:o}),i}var gi=hA("unlinking");async function cy(j,A,e){let{codeEditorStore:t,selectionStore:r,treeStore:o}=j.stores;t.closeEditor();let[n]=r.nodes;if(r.nodes.length===1&&W(n)&&n.codeComponentIdentifier===A)return!0;let a=await j.runWithFullyLoadedTreeAsync(()=>{for(let i of o.treeIndex.codeComponentNodeIds){let s=j.tree.getNodeWithTrait(i,W);if(s?.codeComponentIdentifier===A)return s}},{runInBackground:!0,name:`findCodeComponentInstance: ${A}`});return a?(HB(j,a),!0):(PA({type:"add",variant:"info",key:"add-component-instance-to-edit-in-plugin",text:`Add this Component to Canvas to edit in ${e.name}`}),!1)}async function ch(j,A,e){return await cy(j,A,e)?(j.stores.pluginStore.openPlugin(e,j,{mode:"canvas"}),!0):!1}function dh(j,A){let e=j.componentForIdentifier(A);if(e)return e;let t=oA(A);return!ej(t)||!Sj(t)?null:j.componentForIdentifier(M7(t))}function dy(j,A,e){let t=ej(e)?e.localId:e?.moduleId,r=j.get(t);if(st(r))return r.pluginId;if(!Tr(r))return;if(!sA(r.save.pluginId))return r.save.pluginId;let o=A.getPersistedModuleByLocalId(r.id);if(!o)return;let n=o.metadata.pluginId;if(x(n))return n}function uh(j,A,e,t){let r=dy(j.tree,A,t);if(!sA(r))return e.manifestById.get(r)}function gY(j){return`Edit in ${j.name}`}var uy=0;async function l6(j,A,e=uy){if(e===0){let r=oA(A),o=uh(j.stores.treeStore,j.stores.modulesStore,j.stores.pluginStore,r);if(o&&await ch(j,A,o))return}let t=dh(L,A);t&&j.stores.codeEditorStore.editFile(t.file)}async function ph(j,{identifier:A,info:e,instance:t,enterIsolation:r,codeComponentIsolationMode:o}){let n=e.module.baseURL+e.module.files.source,i=await(await fetch(n)).text(),[s,l]=await Promise.all([VB(i),j.stores.modulesStore.getModuleDependencies(A)]);if(s.ok){let E=new Map;for(let R of s.value.relative){let S=xe(R.specifier,`${e.module.type}/`);if(!S){gi.warn("Failed to normalize relative import",R.specifier);continue}let v=E.get(S)??[];v.push(R),E.set(S,v)}let F;for(let R of l.imports){if(R.type!=="local")continue;let S=`${R.moduleType}/${R.moduleName}`,v=E.get(S);if(!v){gi.warn("Unable to get source location of import",S,"when unlinking");continue}for(let P of v){F||(F=i.split(`
`));let T=P.specifierLine;F[T]=F[T].replace(JSON.stringify(P.specifier),JSON.stringify(R.importURL))}}F&&(i=F.join(`
`))}let c=j.stores.modulesStore.forType("codeFile"),u=c.getUniqueName(e.module.name),p=await c.create({name:u,source:i,metadata:{pluginId:e.module.metadata.pluginId}}),f=eo(A,p).value;return t&&j.scheduler.processWhenReady(()=>{let E=j.tree.get(t.originalid??t.id);E&&E.set({codeComponentIdentifier:f})}),r&&(j.stores.chromeStore.contentPanelTab="Assets",l6(j,f,o)),f}var kh={canvasComponent:c0,codeFile:ph};function py(j){return x(j)?j in kh:!1}async function Md(j,{identifier:A,moduleType:e,instance:t,enterIsolation:r=!0,codeComponentIsolationMode:o,renamedIds:n=new Map,isAutoDetach:a=!1}){if(!py(e))throw Error(`Cannot import external module of type ${e}`);let[i]=await j.stores.modulesStore.preloadExternalModules([A]);$(i,"external module must exist on preload");let s={identifier:A,info:i,instance:t,enterIsolation:r,codeComponentIsolationMode:o,renamedIds:n,isAutoDetach:a},l=kh[e],c=await l(j,s);if(!sA(c))return!x(c)&&eA(c)?{...i,codeComponentIdentifier:c.instanceIdentifier,node:c}:{...i,codeComponentIdentifier:c,node:void 0}}var xd=new Set;async function ky(j,A){let{instance:e,withUnlinkModal:t,...r}=A,o=ds(j.stores.treeStore.tree,A.identifier),n=j.stores.insertSidebarStore.getEditBehavior(A.identifier.moduleId);if(t&&n!=="autoUnlink"&&(!o||Xe.isOn("openPrimaryForBuiltInModules"))){j.stores.modalStore.set({type:"UnlinkComponent",source:"edit_action",...r,nodeId:e?.id});return}if(!xd.has(A.identifier)){xd.add(A.identifier),j.scheduler.process(()=>{j.beginUndoGroup()});try{return(await Md(j,{instance:e,enterIsolation:n!=="autoDetach",...r}))?.codeComponentIdentifier}catch(a){gi.reportError(a),PA({type:"add",variant:"error",text:"Failed to unlink component",key:"external-component-unlink-error",icon:"error"})}finally{j.scheduler.processWhenReady(()=>{j.endUndoGroup()}),xd.delete(A.identifier)}}}async function tZ(j,A){let{instance:e,moduleType:t,enterIsolation:r,codeComponentIsolationMode:o}=A;if(!W(e))return;let n=await ky(j,{...A,enterIsolation:!1});if(!n)return;await Ys(L,[n],j.stores.modulesStore);let a=L.componentForIdentifier(n);if(!a)return;let i=Z$(a);i&&j.scheduler.processWhenReady(()=>{if(j.tree.getNodes(Array.from(j.stores.treeStore.treeIndex.codeComponentNodeIds)).forEach(l=>{if(!i||i.id===l.id||!W(l)||l.codeComponentIdentifier!==e.codeComponentIdentifier||gA(l)||!Js(l,{allowLockedNodes:!0}))return;let c=j.cloneNode(i,!1,!1);Y$(j,l,c).catch(GA)}),!!r)if(t==="canvasComponent"){let l=xa(n);l&&j.stores.scopeStore.select(l,{keepHistory:!1})}else t==="codeFile"&&l6(j,n,o)})}var my=hA("clipboard:modules");async function fZ(j,A,e){if(!A||!Jk(A))return!1;let t="insert-external-component";try{await Ey({engine:j,moduleURL:A,position:e,centerInParent:!0,toastKey:t}),PA({type:"remove",key:t})}catch(r){console.error("Failed to insert external component",r),PA({type:"add",variant:"error",key:t,text:"Failed to insert external component",icon:"error"})}return!0}async function fy(j,A){let e=new URL(A),t=e.hash.substring(1).split(","),r=t[0]||"default",o=t.some((c,u)=>u>0&&c==="unlink"),{module:n}=await j.stores.modulesStore.lookUpModule({url:e.href}),a=n.id,i=j.stores.modulesStore.getPersistedModuleByGlobalId(a);$(n.files.module,"Module file must be defined");let s=me(a,n.saveId,n.files.module,r),l=i?Ki(i.localId,r):s;return{module:n,moduleIdentifier:l,externalIdentifier:s,insertUnlinked:o}}async function Ey({engine:j,moduleURL:A,position:e,centerInParent:t,insertAsGroundNode:r,toastKey:o,update:n}){let{module:a,moduleIdentifier:i,externalIdentifier:s,insertUnlinked:l}=await fy(j,A);if(a.type==="screen")if(ej(i)){let c=xa(i.value);if(!c)return;let u=j.tree.getNode(c);if(!w(u))return;await j.loadScopesThenProcess([u],([p])=>{p&&u0(j,p,p.getPrimaryVariant())})}else o&&PA({type:"add",variant:"progress",key:o,text:"Inserting Web Page",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),await d0(j,s);else if(l){o&&PA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"});let c=await Md(j,{identifier:s,moduleType:a.type,enterIsolation:!1});await j.scheduler.processWhenReadyAsync(()=>{c&&s6({engine:j,module:a,identifier:c.codeComponentIdentifier,position:e,centerInParent:t,insertAsGroundNode:r,update:n})})}else{if(o&&PA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),!Fe(i)){await j.scheduler.processWhenReadyAsync(()=>{s6({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n})});return}await j.stores.modulesStore.addExternalModulesToProject([i],{onTreeUpdate:()=>{if(s6({engine:j,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n}),a.type!=="vector")return;let c=j.tree.getNodeWithTrait(a.id,st)?.annotation("framerVector");qa(c)&&j.stores.modulesStore.addOrUpdateVectorSetAndVectors({moduleId:c.set.moduleId,saveId:""}).catch(GA)}}).catch(my.reportError),j.stores.modulesStore.trackExternalComponentInsert([i.value],"paste-url")}return a}function mh(j,A){let e=yA.isOn("newPricing");if(j.stores.projectStore.projectLicenseType===pf(e))return j.stores.modalStore.set({type:"UpsellEnterprise",source:"upsell",description:"Sign up for an Enterprise plan to increase your file upload limit to 150MB and unlock other powerful features that help scale your site.",upsell:"file-limit-enterprise-upsell",upsellFeatures:["Advanced Permissions","Custom Limits","Custom Hosting","Custom Proxy Support","Enterprise Security","Dedicated Support"]});let t=j.stores.projectStore.resourceLimits?.fileUploadLimitInMB;$(typeof t=="number","fileUploadLimitInMB is not a number");let r=t.toLocaleString()+"MB",o=(A/Vf).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:1})+"MB";return j.stores.modalStore.set({source:"upsell",type:"UpsellFeature",upsellFeature:"fileUploadLimitInMB",title:"File Upload Limit",description:`Your current plan limits file uploads to ${r}, and you\u2019re trying to upload a file that\u2019s ${o}. Upgrade your site to increase the limit and upload your file.`})}var fh=class{constructor(A,{concurrency:e=5,silent:t=!1}={}){this.engine=A;g(this,"uploads",new Map);g(this,"completed",0);g(this,"failed",0);g(this,"generating",!1);g(this,"resolveStatusUpdate");g(this,"limiter");g(this,"silent");this.limiter=new Uo(e),this.silent=t}add(A){return this.createTask(A,e=>e)()}createTask(A,e){let t=this.uploads.get(A);t||(t={task:async()=>{try{return typeof A=="string"?A.startsWith("data:")?await this.uploadFile(await xf(A,"imported")):await Hn.uploadAssetByURL(A,{silent:this.silent,refreshAssetService:!1}):await this.uploadFile(A)}catch(n){throw this.failed++,n}finally{this.completed++,this.resolveStatusUpdate?.()}}},this.uploads.set(A,t));let r=t;return async()=>{r.resultPromise||(r.resultPromise=this.limiter.run(r.task),this.resolveStatusUpdate?.());let o=await r.resultPromise;return this.engine.stores.assetStore.assetService?.addAssets([o.asset]),e(o)}}async uploadFile(A){let e=this.engine.stores.projectStore.resourceLimits?.fileUploadLimitInMB??void 0,t={silent:this.silent,maxFileSize:e,onExceedsCustomMaxSize:o=>mh(this.engine,o),refreshAssetService:!1},r;if(A.type.startsWith("image/")?r=await Hn.uploadImage(A,t):A.type.startsWith("video/")?r=await Hn.uploadVideo(A,t):r=await Hn.uploadFile(A,t),!r)throw Error("Failed to upload file");return r}get active(){return[...this.uploads.values()].map(({resultPromise:A})=>A).filter(fe)}get status(){let{active:A,completed:e,failed:t}=this;return{started:A.length,completed:e,failed:t}}async*statusUpdates(){if(this.generating)throw Error("`statusUpdates` is in use by another call");for(this.generating=!0,yield this.status;this.completed<this.active.length;)await new Promise(A=>{this.resolveStatusUpdate=()=>{A(),this.resolveStatusUpdate=void 0}}),yield this.status;await this.engine.stores.assetStore.assetService?.refresh().catch(GA),this.generating=!1}async results(){let A=await Promise.allSettled(this.active).then(e=>e.filter(nu).map(t=>t.value));return await this.engine.stores.assetStore.assetService?.refresh().catch(GA),A}};function or(j,A){return`${j??""}.${A}`}function Ri(j,A){return`${j??""}[${A}]`}function OZ(j){let A=[],e=j.split(".");for(let t of e){let[r,o]=t.split("[");if(r.length!==0&&A.push({type:"object",key:r}),o){let n=o.slice(0,-1);$(n.length>0),A.push({type:"array",id:n})}}return A}function Eh(j){return eA(j)||w(j)||tj(j)}var $y=512,nr,Dd,Nd,Ii=class{constructor(A){this.assetMap=A;LA(this,nr);g(this,"keys",new Set)}addAsset(A){this.keys.add(A)}resolve(A){if(!jn(this,nr,Dd).call(this,A))return;let e=jn(this,nr,Nd).call(this,A);if(e!==null)return e&&(A=e.identifier),{src:W7(A)}}resolveResponsiveImage(A,e,t){if(!jn(this,nr,Dd).call(this,A))return;let r=jn(this,nr,Nd).call(this,A);if(r===null)return;let o;r&&(A=r.identifier,o=r.preferredSize);let n=this.assetMap.assetForKey(A),a=n?.properties?.image,i=r?.intrinsicSize??a,s=X7(a?.width,a?.height),c={src:n?Y7(n,o,e,s).url:U7(A,void 0,void 0,i),positionX:void 0,positionY:void 0,srcSet:this.generateSrcSet(n,s,o),pixelWidth:i?.width,pixelHeight:i?.height};return t&&x(t.positionX)&&x(t.positionY)&&(c.positionX=t.positionX,c.positionY=t.positionY),c}generateSrcSet(A,e,t){if(!A)return;let r;if((!t||t==="auto"||t==="lossless")&&e?.length&&A.properties?.image){r="";for(let{maxSideSize:n,width:a}of e)a<$y||(r+=`${J6(A,n,t)} ${a}w,`);r+=`${J6(A,void 0,t)} ${A.properties.image.width}w`}return r}};nr=new WeakSet,Dd=function(A){return!(ye(A)||A.startsWith("https:"))},Nd=function(A){let e=z7(A);return e&&(A=e.identifier),A===""?null:(this.addAsset(A),e)};function Od(j,A){let e=[],t=mu(j,o=>{let n=A.create(o);return e.push(o),"${"+n+"}"});return{templatedUrl:new V("`"+t+"`"),usedVariables:e}}function c6(j,A,e,t=void 0){if(HA(j.value))return mr(!io(j.value),"Computed values should not be possible in fetch fallback"),A.create(j.value);switch(j.type){case"color":return j.value?h`${j.value}`:h`undefined`;case"string":return h`${j.value}`;case"boolean":return new V(j.value);case"number":return new V(j.value);case"image":{if(j.value===void 0)return h`undefined`;let r=e.resolveResponsiveImage(j.value,void 0,void 0);return r?h`${r.src}`:h`undefined`}case"link":{if(!j.value||!t)return h`undefined`;let r=t.create(j.value);return r?new V(VA(r)):h`undefined`}default:Xi(j)}}function d6(j,A,e,t=void 0){let{templatedUrl:r}=Od(j,A),o=ta(j);return new Lj({url:r,resultKeyPath:j.resultKeyPath,fallbackValue:c6(o.controlProp,A,e,t),errorFallbackValue:o.errorControlProp?c6(o.errorControlProp,A,e,t):void 0,resultOutputType:o.controlProp.type,cacheDuration:j.cacheDuration,credentials:j.credentials})}var Fi=class{constructor(A,e,t,r,o){this.bindings=A;this.variables=e;this.preload=t;this.assets=r;this.links=o;g(this,"fetchesByNode",new Map);g(this,"resultBindingsByNode",new Map)}createFetchBinding(A,e){let t=ta(e);if(!ku(t))return c6(t.controlProp,this.variables,this.assets,this.links);let r=A.originalid??A.id,o=this.resultBindingsByNode.get(r)??this.bindings.create("fetchResult");this.resultBindingsByNode.set(r,o),this.preload.addFetch(A,t);let n=this.fetchesByNode.get(A.id)??[];return n.push(d6(t,this.variables,this.assets,this.links)),this.fetchesByNode.set(A.id,n),h`${o}[${n.length-1}]`}getResultBinding(A){return this.resultBindingsByNode.get(A.originalid??A.id)}getFetchesForNode(A){return this.fetchesByNode.get(A.id)}};var wd=class{constructor(A,e,t,r){this.moduleType=A;this.modulesStore=e;this.submoduleName=t;this.sourceCode=r;g(this,"submoduleFilename");g(this,"submoduleImport");g(this,"bindings",new Cr);g(this,"imports");g(this,"declarations",new _r(this.bindings));this.submoduleFilename=ls(this.submoduleName),this.submoduleImport=cs(this.submoduleFilename),this.imports=new vr(this.moduleType,this.modulesStore,this.bindings)}get estimatedSize(){return this.declarations.declarationsByteSize}serialize(){let A=Cj.linesFrom(this.imports.statements),e=this.declarations.list();return Cj.sections(A,this.sourceCode,...e)}},u6=class{constructor(A,e,t){this.moduleType=A;this.modulesStore=e;this.componentSourceNodeId=t;g(this,"submodules",new Set)}create(A){let e=Df(this.componentSourceNodeId,this.submodules.size),t=new wd(this.moduleType,this.modulesStore,e,A);return this.submodules.add(t),t}delete(A){this.submodules.delete(A)}serialize(){let A=new Map;for(let e of this.submodules){let t=e.serialize();A.set(e.submoduleName,t)}return A}};function $h(j){return`${j}ToDisplayName`}var Bh="enumToDisplayNameFunctions";function hh(j){if(j?.type!=="enum"||!j.optionTitles)return h`(value) => value`;let A=j.optionTitles;return new V(Cj.lines(h`(value, _locale) => {`,h`switch (value) {`,...j.options.map((e,t)=>{let r=A[t];return h`case ${e}: return ${sA(r)?h`undefined`:r};`}),h`default: return "";`,h`}`,h`}`))}function gh(j){let{locale:A,grouping:e,notation:t,compactDisplay:r,style:o,currency:n,currencyDisplay:a,unit:i,unitDisplay:s,minimumFractionDigits:l,maximumFractionDigits:c,minimumIntegerDigits:u}=j,p={locale:A,notation:t,style:o};switch(Pt(e)&&(p.useGrouping=e),Y(l)&&(p.minimumFractionDigits=l),Y(c)&&(p.maximumFractionDigits=c),Y(u)&&(p.minimumIntegerDigits=u),t==="compact"&&(p.compactDisplay=r),o){case"currency":p.currency=n,p.currencyDisplay=a;break;case"unit":p.unit=i,p.unitDisplay=s;break}return new Lj(p)}var Rh=h`(value, options = {}, activeLocale) => {
    const fallbackLocale = "en-US";
    const locale = options.locale || activeLocale || fallbackLocale;
    const {
        useGrouping,
        notation,
        compactDisplay,
        style,
        currency,
        currencyDisplay,
        unit,
        unitDisplay,
        minimumFractionDigits,
        maximumFractionDigits,
        minimumIntegerDigits,
    } = options;
    const formatOptions = {useGrouping, notation, compactDisplay, style, currency, currencyDisplay, unit, unitDisplay, minimumFractionDigits, maximumFractionDigits, minimumIntegerDigits};
    const number = Number(value);
    try {
        return number.toLocaleString(locale, formatOptions);
    } catch {
        try {
            return number.toLocaleString(fallbackLocale, formatOptions);
        } catch {
            return number.toLocaleString();
        }
    }
};
`;function Ih(j,A){if(A.length===0)return null;$(j);let e=new Set;for(let r of A){let o=j.create(r);e.add(VA(o))}let t=`{${Array.from(e).join(", ")}}`;return new V(t)}function Fh(j,A,e,t){let r=j.name;switch(r){case"contains":case"endsWith":case"equals":case"startsWith":case"greaterThan":case"lessThan":case"isBefore":case"isAfter":case"isIncludedIn":return aA(j.value)?($(e),[e.create(j.value)]):[sA(j.value)?h`undefined`:j.value];case"prefix":case"suffix":{if(aA(j.value))return $(e),[e.create(j.value)];let n=sA(j.value)?h`undefined`:j.value;return j.valueLocalized?($(t,"LocalizedValueCollector is required"),[t.add(n,j.valueLocalized,a=>j.valueLocalized?.[a]?.value)]):[n]}case"toDateString":return[A.getActiveLocaleCode()];case"extractDateSegment":return[j.segment];case"numberToString":return[gh(j),A.getActiveLocaleCode()];case"offsetAndLimitArray":return[j.startOffset,Y(j.limit)?j.limit:h`undefined`];case"isBetweenDates":{let n=[];return aA(j.start)?($(e),n.push(e.create(j.start))):n.push(sA(j.start)?h`undefined`:j.start),aA(j.end)?($(e),n.push(e.create(j.end))):n.push(sA(j.end)?h`undefined`:j.end),n}case"convertFromEnum":case"convertFromString":{let a=function(l){ee(l)&&ct(l,c=>a(c)),aA(l)&&n.push(l)};var o=a;let n=[];a(j.default);for(let l of j.cases)a(l.to);let i=Ih(e,n),s=e?.getLocale()??h`undefined`;return i?[s,i]:[s]}case"convertFromBoolean":{let a=function(c){ee(c)&&ct(c,u=>a(u)),aA(c)&&n.push(c)};var o=a;let n=[];a(j.truthy),a(j.falsy);let i=e?.getLocale()??h`undefined`,s=Ih(e,n);return s?[i,s]:[i]}case"enumToDisplayName":return A.variables?[A.variables.getLocale()]:[];case"toString":case"toBoolean":case"toNumber":case"isSet":case"negate":case"reverseArray":case"toResponsiveImage":case"toImageSrc":case"jsonStringify":case"htmlEscape":case"htmlUnescape":case"addImageAlt":case"toZIndex":case"toAxisOverflow":case"toOverflowWithClipFallback":case"numberToPixelString":case"radiusForCorner":case"arrayToArray":case"arrayLength":case"isEven":case"isOdd":case"getGridColumnCSSValue":case"getGridRowCSSValue":case"getNumericColumnGap":return[];default:iA(r,"All value transforms should define their arguments")}}var Gh=h`(image, alt) => {
    if (!image || typeof image !== "object") {
        return;
    };
    return { ...image, alt };
};
`;var Sh=h`(value) => {
    return Array.isArray(value) ? value.length : 0
}
`;function yh(j){let A=h`item`,e={[Or]:h`${A}?.[${Or}]`};for(let t in j.mapping){let r=j.mapping[t];if($(fe(r)),$u(r.value)){e[t]=h`${A}?.[${r.value.id}]`;continue}r.value}return h`(value) => {
      if (!Array.isArray(value)) return
      return value.map((${A}) => (${e}))
    }`}var bh=h`(a, b) => {
    if (typeof a === "string" && typeof b === "string") {
        return a.toLowerCase().includes(b.toLowerCase());
    }

    if (Array.isArray(a) && typeof b === "string") {
        return a.includes(b);
    }

    return false;
};
`;function By(j){let A=Lt(j.outputType);return VA(h`return ${gt(A)?A:h`undefined`};`)}function Ch(j,A,e,t,r,o,n){if(e==="link")return!n||!ee(j)&&!aA(j)?void 0:n.create(j);if(!ee(j))return aA(j)?r.create(j):Ip(e,j,t)?o&&A&&e==="string"?o.add(j,A,a=>A?.[a]?.value):j:Fp(e,t)}function hy(j,A,e,t,r){if(!Rp(j.outputType))return By(j);let o=Ch(j.truthy,j.truthyLocalized,j.outputType,A,e,t,r),n=Ch(j.falsy,j.falsyLocalized,j.outputType,A,e,t,r);return Cj.lines(h`if (value) {`,h`return ${o===void 0?h`undefined`:o};`,h`} else {`,h`return ${n===void 0?h`undefined`:n};`,h`}`)}function vh(j,A,e,t,r){$(e),$(t),$(r);let o=new Set;function n(i){if(ee(i)&&ct(i,s=>n(s)),aA(i)){$(e);let s=e.create(i);o.add(VA(s))}}n(j.truthy),n(j.falsy);let a=[h`value`,NA.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new V(i))}return new V(Cj.lines(h`(${new V(a.map(VA).join(", "))}) => {`,new V(hy(j,A,e,t,r)),h`}`))}function zo(j,A,e,t,r,o,n){if(e==="link")return!n||!ee(j)&&!aA(j)?void 0:n.create(j);if(!ee(j))return aA(j)?r.create(j):hp(e,j,t)?o&&e==="string"&&x(j)&&A?o.add(j,A,a=>A?.[a]?.value):j:gp(e,t)}function Th(j){let A=Lt(j.outputType);return VA(h`return ${gt(A)?A:h`undefined`};`)}function gy(j,A,e,t,r,o){if(A?.type!=="enum"||!$p(j.outputType))return Th(j);let n=new Set,a=zo(j.default,j.defaultLocalized,j.outputType,e,t,r,o);return Cj.lines(h`switch (value) {`,...j.cases.filter(i=>n.has(i.from)||!A.options.includes(i.from)?!1:(n.add(i.from),!0)).map(i=>{let s=zo(i.to,i.toLocalized,j.outputType,e,t,r,o);return h`case ${i.from}: return ${s===void 0?h`undefined`:s};`}),h`default: return ${a===void 0?h`undefined`:a};`,h`}`)}function Ph(j,A,e,t,r,o){$(t),$(r),$(o);let n=new Set;function a(s){if(ee(s)&&ct(s,l=>a(l)),aA(s)){$(t);let l=t.create(s);n.add(VA(l))}}j.cases.forEach(s=>{a(s.to)}),a(j.default);let i=[h`value`,NA.activeLocale];if(n.size>0){let s=`{${Array.from(n).join(", ")}}`;i.push(new V(s))}return new V(Cj.lines(h`(${new V(i.map(VA).join(", "))}) => {`,new V(gy(j,A,e,t,r,o)),h`}`))}function Ry(j){let A=Lt(j.outputType);return VA(h`return ${gt(A)?A:h`undefined`};`)}function Iy(j,A,e,t,r){if(!Bp(j.outputType))return Ry(j);let o=new Set,n=zo(j.default,j.defaultLocalized,j.outputType,A,e,t,r);return Cj.lines(h`switch (typeof value === "string" ? value.toLowerCase() : value) {`,...j.cases.filter(a=>{let i=a.from.toLowerCase();return o.has(i)?!1:(o.add(i),!0)}).map(a=>{let i=zo(a.to,a.toLocalized,j.outputType,A,e,t,r);return h`case ${a.from.toLowerCase()}: return ${i===void 0?h`undefined`:i};`}),h`default: return ${n===void 0?h`undefined`:n};`,h`}`)}function _h(j,A,e,t,r){$(e),$(t),$(r);let o=new Set;function n(i){if(ee(i)&&ct(i,s=>n(s)),aA(i)){$(e);let s=e.create(i);o.add(VA(s))}}j.cases.forEach(i=>{n(i.to)}),n(j.default);let a=[h`value`,NA.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new V(i))}return new V(Cj.lines(h`(${new V(a.map(VA).join(", "))}) => {`,new V(Iy(j,A,e,t,r)),h`}`))}var xh=h`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().endsWith(b.toLowerCase());
};
`;var Mh=h`(a, b) => {
    return (typeof a === "string" && typeof b === "string") ? a.toLowerCase() === b.toLowerCase() : a === b;
};
`;var Dh=h`(value, segment = "year") => {
    if (typeof value !== "string") return;
    const date = new Date(value);
    if (isNaN(date.getTime())) return;
    if (segment === "year") return date.getUTCFullYear();
    if (segment === "month") return date.getUTCMonth() + 1;
    if (segment === "day") return date.getUTCDate();
    if (segment === "hour24") return date.getUTCHours();
    if (segment === "hour12") {
        const hour = date.getUTCHours();
        return hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
    }
    if (segment === "minute") return date.getUTCMinutes();
};
`;var Ld=h`spanCount`,p6=h`optionalColumnCount`,Nh=h`(columnSpan, ${p6}) => {
    if (columnSpan === "all") return "-1 / 1";
    const ${Ld} = Number.isFinite(columnSpan) && columnSpan > 0 ? columnSpan : 1;
    if (Number.isFinite(${p6}) && ${Ld} > ${p6}) {
        return ${Sr`span ${p6}`};
    }
    return ${Sr`span ${Ld}`};
};
`;var Oh=h`spanCount`,wh=h`(rowSpan) => {
    const ${Oh} = Number.isFinite(rowSpan) && rowSpan > 0 ? rowSpan : 1;
    return ${Sr`span ${Oh}`}
};
`;var Lh=h`(gap) => {
    if (Number.isFinite(gap) && gap >= 0) return gap;
    if (typeof gap !== "string") return 0;
    const firstSegment = gap.split(" ")[0];
    const parsedGap = parseFloat(firstSegment);
    return Number.isFinite(parsedGap) && parsedGap >= 0 ? parsedGap : 0;
};
`;var qh=h`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a > b : false;
};
`;var Vh=h`(value) => {
    if (typeof value !== "string") return "";
    return value.replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;").replaceAll('"', "&quot;").replaceAll("'", "&#39;");
};
`;var Kh=h`(value) => {
    if (typeof value !== "string") return "";
    const entities = /&(?:[gl]t|quot|#39|amp|#6[02]|#34|apos|#38);/gu;
    const replacers = { "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'", "&amp;": "&", "&#60;": "<", "&#62;": ">", "&#34;": '"', "&apos;": "'", "&#38;": "&" };
    return value.replace(entities, match => replacers[match]);
};
`;var Jh=h`(dateString, minDateString) => {
    if (typeof dateString !== "string" || typeof minDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const minDate = new Date(minDateString);
    if (isNaN(minDate.getTime())) return false;

    return date >= minDate;
};
`;var Hh=h`(dateString, maxDateString) => {
    if (typeof dateString !== "string" || typeof maxDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const maxDate = new Date(maxDateString);
    if (isNaN(maxDate.getTime())) return false;

    return date <= maxDate;
};
`;var Qh=h`(value, start, end) => {
    if (typeof value !== "string" || typeof start !== "string" || typeof end !== "string") return false;

    const date = new Date(value);
    if (isNaN(date.getTime())) return false;

    const startDate = new Date(start);
    if (isNaN(startDate.getTime())) return false;

    const endDate = new Date(end);
    if (isNaN(endDate.getTime())) return false;

    return date >= startDate && date <= endDate;
};
`;var Uh=h`(value) => {
    return typeof value === "number" && value % 2 === 0;
};
`;var Wh=h`(a, b) => {
    return b.includes(a);
};
`;var zh=h`(value) => {
    return typeof value === "number" && value % 2 === 1;
};
`;var Xh=h`(value) => {
    if (Array.isArray(value)) return value.length > 0;
    return value !== undefined && value !== null && value !== "";
};
`;var Yh=h`(value) => {
    const result = JSON.stringify(value)
    if (typeof result === 'string') return result.replace(/<\\/(script|style)/gi, '<\\\\/$1')
    return result
};
`;var Zh=h`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a < b : false;
};
`;var Ag=h`(value) => {
    return !value;
};
`;var jg=h`(value) => {
    if (typeof value !== "number") return value;
    if (!Number.isFinite(value)) return undefined;
    return Math.max(0, value) + "px";
};
`;var eg=h`(value, offset, limit) => {
    if (!Array.isArray(value)) return []
    const end = typeof limit === "number" ? offset + limit : undefined
    return value.slice(offset, end);
};
`;var tg=h`(value, prefix) => {
    if (typeof value === "string" && typeof prefix === "string") {
        return prefix + value;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof prefix === "string") {
        return prefix;
    }
    return "";
};
`;var rg=h`(value, cornerIndex) => {
    if (typeof value === "number" && Number.isFinite(value)) return Math.max(0, value) + "px";
    if (typeof value !== "string" || typeof cornerIndex !== "number") return undefined;
    const segments = value.split(" ");
    return segments[cornerIndex] || segments[cornerIndex - 2] || segments[0];
};
`;var og=h`(value) => {
    return Array.isArray(value) ? Array.from(value).reverse() : [];
}
`;var ng=h`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().startsWith(b.toLowerCase());
};
`;var ig=h`(value, suffix) => {
    if (typeof value === "string" && typeof suffix === "string") {
        return value + suffix;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof suffix === "string") {
        return suffix;
    }
    return "";
};
`;var ag=h`(value, overflow) => {
    const isNonScrollable = (o) => o === "visible" || o === "clip" || o === undefined
    return isNonScrollable(value) === isNonScrollable(overflow) ? value : undefined
}`;var sg=h`(value) => {
    return Boolean(value);
};
`;var lg=h`value`,cg=h`activeLocale`;function dg(j,A){let e=A.dedupe("sharedDateFormatter",new V(Cj.lines(h`(value, formatOptions, locale) => {`,h`  if (typeof value !== "string") return "";`,h`  const date = new Date(value);`,h`  if (isNaN(date.getTime())) return "";`,h`  const fallbackLocale = "en-US";`,h`  try {`,h`      return date.toLocaleString(locale || fallbackLocale, formatOptions);`,h`  } catch {`,h`      return date.toLocaleString(fallbackLocale, formatOptions);`,h`  }`,h`};`))),t=Sp(j.display,j.format,j.dateStyle),r={...Gp[t].options,timeZone:"UTC"},o=A.dedupe("dateOptions",new V(VA(r)));return new V(Cj.lines(h`(${lg}, ${cg}) => {`,h`return ${V.fn(e,lg,o,j.locale||cg)};`,h`};`))}var ug=h`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value.src;
    };
    return typeof value === "string" ? value : undefined;
};
`;var pg=h`(value) => {
    if (typeof value === "number" && Number.isFinite(value)) return value;
    if (typeof value !== "string") return 0;
    const parsedNumber = parseFloat(value);
    return (typeof parsedNumber === "number" && Number.isFinite(parsedNumber)) ? parsedNumber : 0;
};
`;var Fy=`var(${tu}, clip)`,kg=h`(value) => {${h.joinLines(h`if (value === "clip") return ${Fy}`,h`return value`)}};`;var mg=h`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value;
    };
    return typeof value === "string" ? {src: value} : undefined;
};
`;var fg=h`(value) => {
    return typeof value === "string" ? value : String(value);
};
`;var Eg=h`(value) => {${h.joinLines(h`if (value < -1) return -1`,h`if (value > 11) return 11`,h`return value`)}};`;function $g(j){switch(j){case"isAfter":return Jh;case"isBefore":return Hh;case"isBetweenDates":return Qh;case"contains":return bh;case"endsWith":return xh;case"equals":return Mh;case"isSet":return Xh;case"greaterThan":return qh;case"lessThan":return Zh;case"negate":return Ag;case"numberToString":return Rh;case"startsWith":return ng;case"toString":return fg;case"toNumber":return pg;case"toBoolean":return sg;case"extractDateSegment":return Dh;case"reverseArray":return og;case"offsetAndLimitArray":return eg;case"arrayLength":return Sh;case"prefix":return tg;case"suffix":return ig;case"toResponsiveImage":return mg;case"toImageSrc":return ug;case"jsonStringify":return Yh;case"htmlEscape":return Vh;case"htmlUnescape":return Kh;case"addImageAlt":return Gh;case"toZIndex":return Eg;case"toAxisOverflow":return ag;case"toOverflowWithClipFallback":return kg;case"numberToPixelString":return jg;case"radiusForCorner":return rg;case"isIncludedIn":return Wh;case"isEven":return Uh;case"isOdd":return zh;case"getGridColumnCSSValue":return Nh;case"getGridRowCSSValue":return wh;case"getNumericColumnGap":return Lh;default:iA(j,"All constant transform names should be implemented")}}function Bg(j,A,e,t,r,o,n){switch(j.name){case"enumToDisplayName":return hh(A);case"convertFromEnum":return Ph(j,A,e,t,r,o);case"convertFromString":return _h(j,e,t,r,o);case"convertFromBoolean":return vh(j,e,t,r,o);case"arrayToArray":return yh(j);case"toDateString":return dg(j,n);default:iA(j,"All dynamic transform names should be implemented")}}var te=jo(),Gy={name:"toString"},Sy={name:"toNumber"},yy={name:"toBoolean"},by={name:"toResponsiveImage"},Cy={name:"toImageSrc"},vy={name:"toZIndex"},Ty={name:"numberToPixelString"},Py={name:"radiusForCorner"},_y={name:"toAxisOverflow"},xy={name:"toOverflowWithClipFallback"},My={name:"jsonStringify"},Dy={name:"htmlEscape"},Ny={name:"htmlUnescape"},Oy={name:"addImageAlt"},wy={name:"getGridColumnCSSValue"},Ly={name:"getGridRowCSSValue"},qy={name:"getNumericColumnGap"};function Vy(j){return hu(j.name)}var ir=class{constructor(A,e,t,r,o,n,a,i,s){this.fileDeclarations=A;this.componentDeclarations=e;this.imports=t;this.variables=r;this.localizedValues=o;this.links=n;this.fetches=a;this.modulesStore=i;this.type=s}wrapInTransformFunction(A,e,t,r,o){if(Bu(e.name)){let n=this.fileDeclarations.dedupe(e.name,$g(e.name));return V.fn(n,A,...t)}if(Vy(e)){if(e.name==="enumToDisplayName"&&r&&r.type==="enum"){let a=this.getImportedEnumToDisplayNameIfPossible(A,r);if(a)return a}let n=Bg(e,r,o,this.variables,this.localizedValues,this.links,this.fileDeclarations);return V.fn(new V(this.fileDeclarations.dedupe(e.name,n)),A,...t)}iA(e.name,"All value transforms should be handled in wrapInTransformFunction")}getImportedEnumToDisplayNameIfPossible(A,e){let t=this.imports,r=this.modulesStore;if(!t||!r)return;let o=Ak(e);if(!o)return;let{dataIdentifier:n,enumFieldKey:a}=o;if(n===tk)return a===ek?this.variables?.getLayoutDirectionName()??h`undefined`:this.variables?.getLocaleName()??h`undefined`;let i=L.dataForIdentifier(n);if(!i||!i.annotations)return;let s="framerEnumToDisplayNameUtils",l=i.annotations?.[s];if(!x(l))return;let c=Number.parseInt(l,10);if(!Y(c))return;let u=oA(n);if(!Sj(u))return;let{importSpecifier:p}=zk(u,this.type,r);if(!p)return;let f=this.variables?.getLocale()??h`undefined`;switch(c){case 1:{let E=$h(a),F=t.addImport(p,{exportSpecifier:E});return V.optionalFn(F,A,f)}case 2:{let E=Bh,F=t.addImport(p,{exportSpecifier:E});return V.optionalFn(h`${F}[${a}]`,A,f)}default:throw new Error(`Enum to display name utils, unsupported version: ${c}`)}}wrapInValueTransform(A,e,t,r){return this.wrapInTransformFunction(A,e,Fh(e,this,this.variables,this.localizedValues),t,r)}makeTypeSafe(A,e){switch(e){case"string":case"color":return this.wrapInTransformFunction(A,Gy,te);case"number":return this.wrapInTransformFunction(A,Sy,te);case"boolean":return this.wrapInTransformFunction(A,yy,te);case"array":case"enum":case"link":case"gap":case"padding":case"borderradius":case"image":return A;default:return A}}getActiveLocaleCode(){if(!this.componentDeclarations||!this.imports)return h`undefined`;let A=this.imports.addImport("framer",{exportSpecifier:"useLocaleCode"});return this.componentDeclarations.dedupe("activeLocaleCode",V.fn(A))}createComputedValue(A,e,t){$(this.variables);let r=an(A)?e.cache.getVariableControlByReference(A.startValue):void 0,o=an(A)?this.variables.create(A.startValue):this.fetches.createFetchBinding(e,A.startValue),n;A.transforms.forEach(i=>{gu(i.name)&&(o=this.wrapInValueTransform(o,i,r,t),n=i)});let a=n?Ru(n.name):null;return!a||a.length>1||a[0]!==A.outputType?this.makeTypeSafe(o,A.outputType):o}wrapInToResponsiveImage(A){return this.wrapInTransformFunction(A,by,te)}wrapInToImageSrc(A){return this.wrapInTransformFunction(A,Cy,te)}wrapInToZIndex(A){return this.wrapInTransformFunction(A,vy,te)}wrapInNumberToPixelString(A){return this.wrapInTransformFunction(A,Ty,te)}wrapInRadiusForCorner(A,e){return this.wrapInTransformFunction(A,Py,[e])}wrapInToAxisOverflow(A,e){return this.wrapInTransformFunction(A,_y,[e])}wrapInToOverflowWithClipFallback(A){return this.wrapInTransformFunction(A,xy,te)}wrapInAddImageAlt(A,e){return this.wrapInTransformFunction(A,Oy,[e])}wrapInClampRGB(A){return $(this.imports,"ValueTransformCollector: Must have imports to wrap in clampColor."),V.fn(this.imports.addImport("framer",{exportSpecifier:"clampRGB"}),A)}wrapInGetGridColumnCSSValue(A,e){return this.wrapInTransformFunction(A,wy,e?[e]:te)}wrapInGetGridRowCSSValue(A){return this.wrapInTransformFunction(A,Ly,te)}wrapInGetNumericColumnGap(A){return this.wrapInTransformFunction(A,qy,te)}wrapInTemplateFilters(A,e){return this.makeTypeSafe(_m(A,e,{json:t=>this.wrapInTransformFunction(t,My,te),escape:t=>this.wrapInTransformFunction(t,Dy,te),raw:t=>this.wrapInTransformFunction(t,Ny,te)}),"string")}};function Ky(j){return w(j)||fj(j)||eA(j)||_t(j)||tj(j)}function Rg(j,A){return h`(key, locale){${h.joinLines(h`while (locale) {${h.joinLines(h`const values = ${j}[locale.id]`,h`if (values) {${h.joinLines(h`const value = ${A?h`values.read()[key]`:h`values[key]`}`,h`if (value) return value`)}}`,h`locale = locale.fallback`)}}`)}}`}var Si,k6=class{constructor(A,e,t){this.entryNode=A;this.variables=e;this.treeStore=t;g(this,"cache",{});g(this,"valueCounter",0);LA(this,Si,!1)}freeze(){FA(this,Si,!0)}add(A,e,t){$(!rA(this,Si),"Cannot add values to a frozen LocalizedValuesCollector.");let r={};if(!e||!Ky(this.entryNode))return A;let o;this.variables&&(o=new On(this.entryNode));let n=this.treeStore.tree.root.locales??[];for(let c of n){if(!(c.id in e))continue;let u=this.createLocalizedValue(c.id,o,t);ye(u)||(r[c.id]=u)}if(Le(r))return A;this.variables&&o&&this.variables.merge(o);let a=VA({defaultValue:A,localizedValues:r}),i=this.cache[a];if(i)return i;let s=`v${this.valueCounter++}`,l=V.fn(this.getLocalizedValueBinding,s,NA.activeLocale);if(o&&o.variables.size>0){let c=h.listFrom(o.variables);for(let u in r){let p=r[u];$(!ye(p),"Localized should not be null or undefined"),r[u]=h`({ ${c} }) => ${p}`}l=h`${l}?.({ ${c} })`}for(let c in r){let u=r[c];$(!ye(u),"Localized should not be null or undefined"),this.recordLocalizedValue(c,s,u)}return sA(A)||(l=h`${l} ?? ${A}`),this.cache[a]=l}};Si=new WeakMap;var ar,gg=class extends k6{constructor(e,t,r,o,n,a,i,s){super(e,t,r);this.imports=o;this.declarations=n;this.fetches=a;this.modulesStore=i;this.moduleType=s;g(this,"submoduleByLocaleId",new Map);g(this,"identifier",`../${tt("localization",this.entryNode.id)}`);g(this,"submodules");g(this,"bindings",new Cr);LA(this,ar);this.submodules=new u6(this.moduleType,this.modulesStore,this.entryNode.id)}get getLocalizedValueBinding(){return this.imports.addImport(this.identifier,{exportSpecifier:"default",importBinding:"getLocalizedValue"})}canPreloadWithSuspense(){return!eA(this.entryNode)}preloadWithSuspense(){rA(this,ar)||(FA(this,ar,this.bindings.create("usePreloadLocalizedValues")),this.declarations.component.create(V.fn(this.imports.addImport(this.identifier,{exportSpecifier:VA(rA(this,ar))}),NA.activeLocale)))}createLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e)??this.submodules.create(),n=new Co(this.entryNode,o.imports,o.bindings,t,this.treeStore,this.modulesStore),a=r(e,{links:n,variables:t,imports:o.imports,declarations:o.declarations,valueTransforms:new ir(o.declarations,void 0,o.imports,t,this,n,this.fetches,this.modulesStore,this.moduleType)});if(ye(a)){o&&!this.submoduleByLocaleId.has(e)&&this.submodules.delete(o);return}return this.submoduleByLocaleId.set(e,o),this.canPreloadWithSuspense()&&this.preloadWithSuspense(),a}recordLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e);$(o,"Localization submodule must exist"),o.declarations.create(h`export const ${new V(t)} = ${r}`)}maybeGetUsePreloadDeclarations(e){if(!this.canPreloadWithSuspense()||!rA(this,ar))return[];let t=this.bindings.create("preload"),r=rA(this,ar);return[h`function ${t}(locale) {${h.joinLines(h`const promises = []`,h`while (locale) {${h.joinLines(h`const values = ${e}[locale.id]`,h`if (values) {${h.joinLines(h`const promise = values.preload()`,h`if (promise) promises.push(promise)`)}}`,h`locale = locale.fallback`)}}`,h`if (promises.length > 0) return Promise.all(promises)`)}}`,h`export function ${r}(locale) {${h.joinLines(h`const preloadPromise = ${t}(locale)`,h`if (preloadPromise) throw preloadPromise`)}}`]}values(e){let t={};for(let[r,o]of this.submoduleByLocaleId)if(this.canPreloadWithSuspense()){let n=e.addImport("framer",{exportSpecifier:"LazyValue"});t[r]=V.fn(h`new ${n}`,h`() => import(${o.submoduleImport})`)}else t[r]=e.addImport(o.submoduleImport,{exportSpecifier:"*",importBinding:"localizedValues"});return t}module(e){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0||this.submoduleByLocaleId.size===0)return;let r=new vr(this.moduleType,this.modulesStore,this.bindings),o=new _r(this.bindings),n=o.dedupe("valuesByLocaleId",this.values(r));return{type:"localization",revision:e,source:h.joinSections(h.joinLines(...r.statements),...o.list(),h`export default function getLocalizedValue${Rg(n,this.canPreloadWithSuspense())}`,...this.maybeGetUsePreloadDeclarations(n)),artifacts:{submodules:this.submodules.serialize()}}}};ar=new WeakMap;var yi,Gi=class extends k6{constructor(e,t,r,o,n,a,i,s,l){super(e,t,r);this.imports=o;this.bindings=n;this.declarations=a;this.fetches=i;this.modulesStore=s;this.moduleType=l;g(this,"valuesByLocaleId",{});LA(this,yi)}get getLocalizedValueBinding(){return rA(this,yi)||FA(this,yi,this.bindings.create("getLocalizedValue")),rA(this,yi)}recordLocalizedValue(e,t,r){let o=this.valuesByLocaleId[e]??{};o[t]=r,this.valuesByLocaleId[e]=o}createLocalizedValue(e,t,r){let o=new Co(this.entryNode,this.imports,this.bindings,t,this.treeStore,this.modulesStore);return r(e,{links:o,variables:t,imports:this.imports,declarations:this.declarations,valueTransforms:new ir(this.declarations,void 0,this.imports,t,this,o,this.fetches,this.modulesStore,this.moduleType)})}list(){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0)return[];let t=this.bindings.create("valuesByLocaleId");return[h`const ${t} = ${this.valuesByLocaleId}`,h`function ${this.getLocalizedValueBinding} ${Rg(t,!1)}`]}};yi=new WeakMap;var Ci,bi=class{constructor(A,e,t,r,o,n,a){this.entryNode=A;this.treeStore=e;this.variables=t;this.declarations=r;this.bindings=o;this.imports=n;this.assets=a;LA(this,Ci,new Map);g(this,"preloadDependencyTree",new Map)}command(A){let e=rA(this,Ci).get(A);if(e)return e;let t=this.bindings.create("pre"+A);return rA(this,Ci).set(A,t),t}addQuery(A,e,t){if(!eA(this.entryNode))return;let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=h`(${Fg(this.command("query"),r)}) => ${V.fn(this.command("query"),e)}`;this.addStatement("query",A,o,V.fn(this.declarations.dedupe("query",n),this.command("query"),r))}addFetch(A,e){if(!eA(this.entryNode))return;let{usedVariables:t}=Od(e,this.variables);aA(e.controlProp.value)&&t.push(e.controlProp.value);let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=h`(${Fg(this.command("fetch"),r)}) => ${V.fn(this.command("fetch"),d6(e,this.variables,this.assets,void 0))}`;this.addStatement("fetch",A,o,V.fn(this.declarations.dedupe("query",n),this.command("fetch"),r))}createPromiseList({fetches:A,children:e},t=!1){let r=[];if(t)for(let o of A)r.push(o);for(let[,o]of e){for(let a of o.fetches)r.push(a);if(!o.value)continue;let n=o.value;if(o.children.size===0){r.push(n);continue}r.push(h`${n}.then(async collection => {await Promise.all(collection.flatMap((${Uy(o.usedVariables)}) => (${this.createPromiseList(o)})))})`)}return h`[${h.listFrom(r)}]`}getHook(){if(!eA(this.entryNode))return{variants:new Set,hook:void 0};let A={},e=[],t=new Set;for(let[p,f]of this.preloadDependencyTree){if(f.children.size===0&&f.fetches.size===0||!f.variantHasAnyFetches)continue;t.add(p);let E=f.usedVariables.map(F=>this.variables.create(F));e.push(...E),A[p]=this.declarations.dedupe("preload",h`async (${this.command("query")}, ${this.command("fetch")}, ${qd(E)??h`props`}) => await Promise.all(${this.createPromiseList(f,!0)})`)}if(!t.size)return{variants:new Set,hook:void 0};let r=this.declarations.dedupe("preloadStatements",A),o=this.imports.addImport("react",{exportSpecifier:"*",importBinding:"React"}),n=this.imports.addImport("framer",{exportSpecifier:"usePreloadQuery"}),a=this.imports.addImport("framer",{exportSpecifier:"usePrefetch"}),i=h`variant`,s=h`gestures`,l=h`clearLoadingVariant`,c=h`setGestureState`,u=this.declarations.dedupe("useLoadingVariant",h`(${i}, ${s}, ${l}, ${c}, props?: Record<string, unknown>) => {${h.joinLines(h`const prequery = ${V.fn(n)}`,h`const prefetch = ${V.fn(a)}`,h`${o}.useEffect(() => {${h.joinLines(h`const promise = ${r}[${i}]`,h`if (!promise || !${s}?.[${i}]?.loading) return`,h`promise(prequery, prefetch, props)`,h`.then(() => ${V.fn(l)})`,h`.catch(() => ${V.fn(c,{isError:!0})})`)}}, [${i}])`)}}`);return{variants:t,hook:p=>V.fn(u,NA.baseVariant,p,NA.clearLoadingGesture,NA.setGestureState,qd(e))}}addStatement(A,e,t,r){let o=this.treeStore.treeIndex.getGroundNodeIdFor(e.id),n=this.treeStore.tree.get(o);if(!n||!DA(n)||os(n.gesture))return;let a=Ig(this.preloadDependencyTree,n.id);A==="fetch"&&(a.variantHasAnyFetches=!0);let i=t.get(this.entryNode.id);i&&a.usedVariables.push(...i);let s=a;for(let l of Jy(e,t,A==="fetch")){let c=Ig(s.children,l);if(l===e.id){A==="query"&&(c.value=r),A==="fetch"&&c.fetches.add(r);for(let[p,f]of t){let E=c.dependencies.get(p)??[];E.push(...f),c.dependencies.set(p,E)}}let u=t.get(l);u&&c.usedVariables.push(...u),s.children.set(l,c),s=c}this.preloadDependencyTree.set(n.id,a)}getVariableDependencies(A){let e=[],t=new Map;for(let r of A)e.push(this.variables.create(r)),Hy(t,r.providerId??this.entryNode.id,r);return{destructured:qd(e),dependencies:t}}};Ci=new WeakMap;function Jy(j,A,e){if(j.cache.ancestorRepeaterIds){if(e){let t=[...j.cache.ancestorRepeaterIds,j.id];for(let r=j.cache.ancestorRepeaterIds.length-1;r>=0;r--){let o=j.cache.ancestorRepeaterIds[r];if(o&&A.has(o))break;t.splice(r,1)}return t}return[...j.cache.ancestorRepeaterIds,j.id]}return[j.id]}function Hy(j,A,e){let t=j.get(A)??[];t.push(e),j.set(A,t)}function Qy(j){return{id:j,value:void 0,dependencies:new Map,usedVariables:[],children:new Map,fetches:new V.Set,variantHasAnyFetches:!1}}function Ig(j,A){return j.get(A)??Qy(A)}function Fg(...j){let A=[];for(let e of j)e&&A.push(VA(e));return new V(A.join(", "))}function qd(j){if(j.length!==0)return j.reduce((A,e)=>(A[VA(e)]=e,A),{})}function Uy(j){return j.length===0?h``:j.reduce((A,e)=>(A[e.id]=To(e.id,e.providerId,!1),A),new Lj)}function Vd(j,A){if(j===void 0)return"";let e=`<${A}>${j}</${A}>`,r=un(e).querySelector(A);return r instanceof HTMLElement?r.innerHTML:""}function Gg(j,A){let e={headStart:"",headEnd:"",bodyEnd:"",bodyStart:""};for(let t of Af){let r=[],o=j[t];if(o&&r.push(o),A)for(let n in A){let a=A[n]?.[t];a?.html&&!a.disabled&&r.push(`<!-- Plugin: ${n} --> ${a.html}`)}e[t]=r.map(n=>Wy(n,t)).join(`
`)}return e}function Wy(j,A){if(A==="headStart"||A==="headEnd")return Vd(j,"head");if(A==="bodyStart"||A==="bodyEnd")return Vd(j,"body");Xi(A)}var Kd=j=>j;function wrA(j){return j.filter(fe)}var m6=h`params`,Sg={type:"siteMetadata",localIdName:"siteMetadata",localId:tt("siteMetadata","siteMetadata")};function moA(j){return{type:"webPageMetadata",localIdName:j,localId:tt("webPageMetadata",j)}}var foA=Kd(async(j,A)=>{let{assetMap:e,treeStore:t,modulesStore:r}=A,o=new Ii(e),n=new Cr,a=new vr("siteMetadata",r,n),i=new On(j),s=new _r(n),l=new Co(j,a,n,void 0,t,r),c=new bi(j,t,i,s,n,a,o),u=new Fi(n,i,c,o,l),p=new Gi(j,i,t,a,n,s,u,r,"siteMetadata"),f=new ir(s,void 0,a,i,p,void 0,u,r,"siteMetadata"),E=yg(j,o,f,i,p,void 0,void 0,void 0);return[{type:"siteMetadata",revision:void 0,source:bg(j,E,a,s,p,f,i,void 0),artifacts:{assets:o.keys}}]}),EoA=Kd(async(j,A,e)=>{let{treeStore:t,modulesStore:r,assetMap:o}=A,{serializationId:n}=e,a=new Ii(o),i=new Cr,s=new vr("webPageMetadata",r,i),l=new On(j),c=new _r(i),u=new Co(j,s,i,void 0,t,r),p=new bi(j,t,l,c,i,s,a),f=new Fi(i,l,p,a,u),E=new Gi(j,l,t,s,i,c,f,r,"webPageMetadata"),F=new ir(c,void 0,s,l,E,void 0,f,r,"webPageMetadata"),R=j.getVariableControlMap(t.tree,L,L.activeBundleHash),S=yg(j,a,F,l,E,zy(t.tree,j,s),Xy(s),R);S.viewport=await Yy(j);let v=Object.entries(j.getBreakpointValues()).map(([T,D])=>({hash:Cp(T),mediaQuery:Pm(D)}));S.breakpoints=v;let P=_p(j);return S.elements=P,S.serializationId=n,[{type:"webPageMetadata",source:bg(j,S,s,c,E,F,l,R),artifacts:{assets:a.keys},revision:j.moduleSourceRevision}]});function $oA(j,A){let e=new Set;function t(r){let o=Xl(),n=r.matchAll(o);for(let[,a]of n)a&&A?.has(a)&&e.add(a)}for(let r in j.webMetadata){let o=r,n=j.webMetadata[o];switch(o){case"title":case"description":case"socialImage":x(n)&&t(n),aA(n)&&e.add(n.id);break;case"favicon":case"faviconDark":case"appleTouchIcon":case"googleAnalyticsTrackingId":case"reducedMotion":case"language":case"languageTitle":case"adaptLayoutToTextDirection":case"noIndex":case"noIndexSite":case"canonicalURL":case"customCanonicalURL":case"optOutOfHTMLPlugin":case"automaticLocale":case"preserveQueryParams":case"enableFormsUTMTracking":break;default:}}for(let r in j.customHTML){let o=r,n=j.customHTML[o];switch(o){case"headStart":case"headEnd":case"bodyStart":case"bodyEnd":x(n)&&t(n);break;default:}}if(j.titleLocalized)for(let r of Object.values(j.titleLocalized))x(r.value)&&t(r.value);if(j.descriptionLocalized)for(let r of Object.values(j.descriptionLocalized))x(r.value)&&t(r.value);return e}function yg(j,A,e,t,r,o,n,a){let i={},s=r.add(sr(j,j.webMetadata?.title,e,t,a)??o,j.titleLocalized,(p,f)=>($(f.variables),sr(j,j.titleLocalized?.[p]?.value,f.valueTransforms,f.variables,a)));sA(s)||(i.title=s);let l=r.add(sr(j,j.webMetadata?.description,e,t,a)??n,j.descriptionLocalized,(p,f)=>($(f.variables),sr(j,j.descriptionLocalized?.[p]?.value,f.valueTransforms,f.variables,a)));if(sA(l)||(i.description=l),j.webMetadata?.favicon){let p=A.resolve(j.webMetadata.favicon);$(p,"Favicon is not a valid asset reference"),i.favicon=p.src}let c=j.webMetadata?.socialImage;if(aA(c)){let p=re(c.id,j.id),f=t.create(p);i.socialImage=e.wrapInToImageSrc(f)}else if(c){let p=A.resolve(c);$(p,"Social image is not a valid asset reference"),i.socialImage=p.src}j.webMetadata?.noIndex===!0?i.robots="noindex":i.robots="max-image-preview:large",j.webMetadata?.noIndexSite!==void 0&&(i.framerSearch={index:!j.webMetadata?.noIndexSite});let u=Gg(j.customHTML??{},_t(j)?j.pluginCustomHTML:void 0);if(u.headStart){let p=sr(j,u.headStart,e,t,a,"escape");p&&(i.customHTMLHeadStart=p)}if(u.headEnd){let p=sr(j,u.headEnd,e,t,a,"escape");p&&(i.customHTMLHeadEnd=p)}if(u.bodyStart){let p=sr(j,u.bodyStart,e,t,a,"escape");p&&(i.customHTMLBodyStart=p)}if(u.bodyEnd){let p=sr(j,u.bodyEnd,e,t,a,"escape");p&&(i.customHTMLBodyEnd=p)}return i}function bg(j,A,e,t,r,o,n,a){let i=n.variableIdsByProviderId.get(j.id),s=[];for(let c of i??[]){let u=h`${m6}?.[${c}]`,p=a?.get(c);if(p&&p.type==="enum"){let F=o.wrapInValueTransform(u,{name:"enumToDisplayName"},p);u=h`${u} !== undefined ? ${F} : undefined`}let f=To(c,j.id,!0),E=h`const ${f} = ${u}`;s.push(E)}let l=h.joinLines(h`export default function metadata(${m6}, ${NA.activeLocale}) {`,...s,h`return ${A}`,h`}`);return h.joinSections(h.linesFrom(e.statements),...r.list(),...t.list(),l,h`export const metadataVersion = 1`)}function sr(j,A,e,t,r,o){if(ye(A))return;let n=Xl();return Sr.replaceAll(A,n,(a,i)=>{let[s,l]=xm(i,o);if(!r?.has(s))return a;let c=re(s,j.id),u=t.create(c),p=u;return r?.get(s)?.type==="responsiveimage"&&(p=e.wrapInToImageSrc(p)),p=e.wrapInTemplateFilters(p,l),h`${u} !== undefined ? ${p} : ${a}`})}function BoA(j,A,e){let t=e?.title,r=f6(j,A);return t||r}function zy(j,A,e){let t=e.addImport(`../${Sg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"}),r=h`${t}(${m6}, ${NA.activeLocale}).title`,o=f6(j,A);return h`${r} || ${o}`}function Xy(j){let A=j.addImport(`../${Sg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"});return h`${A}(${m6}, ${NA.activeLocale}).description`}function f6(j,A){if(Ae(A)){let r=L.dataForIdentifier(A.dataIdentifier);if(r?.name)return r.name+" Detail"}let e=Xk(j,A);return ns(e??"/")}async function Yy(j){if(w(j)){let A=j.isLoaded()?j:await j.load();return A?A.getReplicaVariants().length>0?"width=device-width":`width=${A.getPrimaryVariant().width}`:"width=device-width"}return"width=device-width"}function Bj(j,A=!1){let e=(A?Po(j):j).trim();return e===""?0:e.split(/\W+\b/).length}function boA(j){mr(pl(j),"Array gallery control must be Array of Object controls");let A=j.control,e;for(let t in A.controls){mr(!e,"Multiple item properties found in gallery control");let r=A.controls[t];mr(r?.type==="responsiveimage"),e=[t,r]}return mr(e,"Gallery control must have at least one item property"),e}function CoA(j,A){if(!mn(A)||!A.value)return;let e=A.value[j];if(e?.type==="image")return e}function voA(j){return j?j.filter(A=>!Zy(A)):[]}function Zy(j){if(!mn(j)||!j.value)return!1;let A=Object.values(j.value);if(A.length!==1)return!1;let e=A[0];return Wu(e)?sA(e.value):!1}function Cg(j){if(!pl(j))return!1;let A=Object.values(j.control.controls);return A.length!==1?!1:A[0]?.type==="responsiveimage"}function vg(j){return`${j??"Field"} is required`}function Tg(j,A){return`Exceeded max length by ${Mk(j-A,"character","characters")}`}function MoA(j){return`Must have at least ${j.minCount} ${Pg(j)}`}function DoA(j){return`Must have at most ${j.maxCount} ${Pg(j)}`}var NoA="Slug value is already taken and must be unique";function Pg(j){return Cg(j)?"images":"items"}function _g(j){let A=Em(j);for(let e of A.querySelectorAll("*"))e.tagName!=="BR"&&(e.removeAttribute("class"),e.removeAttribute("style"),e.removeAttribute("data-styles-preset"));return A.innerHTML}function vnA(j){return j==="hidden"?null:j}var TnA=["new","needsReview","done","hidden"],Ab="controlPropKey";function PnA(j){return Ab in j}function _nA(j){return"groups"in j}var jb="collectionNodeId";function xnA(j){return jb in j}var eb={string:!0,richtext:!0,image:!0,enum:!0,link:!0,slug:!0};function tb(j){return j in eb}function Dg(j){return tb(j.type)}var rb={string:!0,richtext:!0,image:!0,link:!0};function Ng(j){return j in rb}function ob(j){return j?j.type==="richtext"?!0:j.type==="RichTextNode"?j.textType==="rich-text":!1:!1}function MnA(j){return j?j.type==="image"||j.type==="FrameNode":!1}function DnA(j){return j?j.type==="nodeLink"||j.type==="link":!1}function NnA(j){return j?j.type==="RootNode"||j.type==="WebPageNode":!1}function OnA(j){return j?.type==="slug"||j?.type==="RouteSegmentNode"}function nb(j){return ye(j)||j===""||Of(j)}function wnA(j,A){if(!j||ob(j))return!1;if(j.value.includes(`
`))return!0;let e=j.localizedValues[A.id];return e?!!e.value?.includes(`
`):!1}function Og(j,A,e){return A?A.hash!==e||A.needsReview?"needsReview":"done":nb(j)?"done":"new"}function lj(j,A,e,t,r,o){return Object.fromEntries(A.map(n=>{let a=e[n.id];if(r?.[n.id])return[n.id,"warning"];if(o){let i=o(n);if(i)return[n.id,i]}return[n.id,Og(j,a,t)]}))}function Hd(j){return A=>j[A.id]?null:"done"}function Qd(j,A,e){return t=>{if(x(j)&&A){let r=A[t.id];if(r)return Og(j,r,e)}return null}}var UA={};Object.freeze(UA);function ib(j,A,e,t,r,o,n){let a=(i,s,l)=>{if(aA(s)||!x(s)||s.length===0&&!l)return;let c=qA(s),u=l??UA,p=lj(s,o,u,c);n.push({type:j.name,transformId:j.id,keyPath:or(A,i),nodeId:r.id,scopeId:t.id,property:i,value:s,controlPropKey:e,controlPropName:void 0,ancestorControlKeyPath:void 0,valueWordCount:Bj(s),hash:c,localizedValues:u,localizedValueStatuses:p,managedByPluginButUserEditable:!1})};a("truthy",j.truthy,j.truthyLocalized),a("falsy",j.falsy,j.falsyLocalized)}function ab(j,A,e,t,r,o,n,a){if(A.outputType!=="string")return;for(let c of A.cases){if(an(j)&&j.startValue.id===jk)break;if(aA(c.to)||!x(c.to)||c.to.length===0&&!c.toLocalized)continue;let u=qA(c.to),p=c.toLocalized??UA,f=lj(c.to,n,p,u),E=or(e,"cases");a.push({type:"convertFromEnum",transformId:A.id,keyPath:Ri(E,c.id),nodeId:o.id,scopeId:r.id,caseId:c.id,isDefaultCase:!1,value:c.to,ancestorControlKeyPath:void 0,controlPropKey:t,controlPropName:void 0,valueWordCount:Bj(c.to),hash:u,localizedValues:p,localizedValueStatuses:f,managedByPluginButUserEditable:!1})}if(!A.default||aA(A.default)||!x(A.default))return;let i=qA(A.default),s=A.defaultLocalized??UA,l=lj(A.default,n,s,i);a.push({type:"convertFromEnum",transformId:A.id,keyPath:or(e,"default"),nodeId:o.id,scopeId:r.id,caseId:null,isDefaultCase:!0,ancestorControlKeyPath:void 0,value:A.default,controlPropKey:t,controlPropName:void 0,valueWordCount:Bj(A.default),hash:i,localizedValues:s,localizedValueStatuses:l,managedByPluginButUserEditable:!1})}function $6(j,A,e,t,r,o,n){if(!(!Fu(e.outputType)||e.outputType!=="string")){for(let a of e.transforms)if(Iu(a))switch(a.name){case"convertFromEnum":{ab(e,a,t,r,j,A,o,n);break}case"convertFromBoolean":{ib(a,t,r,j,A,o,n);break}case"prefix":case"suffix":{if(aA(a.value)||a.value.length===0&&!a.valueLocalized)return;let i=qA(a.value),s=a.valueLocalized??UA,l=lj(a.value,o,s,i);n.push({type:a.name,transformId:a.id,keyPath:Ri(t,a.id),controlPropKey:r,controlPropName:void 0,ancestorControlKeyPath:void 0,nodeId:A.id,scopeId:j.id,value:a.value,valueWordCount:Bj(a.value),hash:i,localizedValues:s,localizedValueStatuses:l,managedByPluginButUserEditable:!1});continue}default:}}}function sb(j,A,e,t,r,o){if(io(e.textContent)){if(!YA(j,e,"textContent"))return;$6(A,e,e.textContent,e.id,e.id,t,r);return}if(HA(e.htmlContent)||HA(e.textContent))return;let n=YA(j,e,"html"),a=YA(j,e,"htmlLocalized");if(!n&&!a)return;let i=e.html,s=Po(i),l=wf(i),c=o==="canvasHtmlAsTextContentIfPossible"?l:"rich-text",u=c==="text"?s:_g(i);if(c==="text"&&!a&&oj(e)){let R=j.getNode(e.originalid);if(R&&Po(R.html)===s)return}let f=qA(l===c?u:s),E=e.htmlLocalized??UA,F=lj(u,t,E,f);r.push({type:"RichTextNode",keyPath:`${e.id}_html`,nodeId:e.id,scopeId:A.id,value:u,valueWordCount:Bj(u,!0),textType:c,hash:f,localizedValues:E,localizedValueStatuses:F,managedByPluginButUserEditable:!1,inherited:!a})}function xg(j){if(_t(j))return"RootNode";if(w(j))return"WebPageNode";iA(j)}function Mg(j,A,e){let t={};for(let r of j){let o=A[r.id];if(!o||!o.value)continue;let n=Mm({collectionData:e,getCollectionDataForIdentifier:L.dataForIdentifier.bind(L),includeCollectionReferences:yA.isOn("collectionReferencesInMetadata"),type:"id",value:o.value});n&&(t[r.id]=n)}return t}function wg(j,A,e,t,r){let o=null;if(w(e)&&(o=L.dataForIdentifier(e.dataIdentifier)),e.webMetadata?.title||e.titleLocalized){let n=e.webMetadata?.title??j.root.webMetadata?.title??"",a=qA(n),i=e.titleLocalized??UA,s=Mg(t,i,o),l=lj(n,t,i,a,s);r.push({type:xg(e),keyPath:`${e.id}_title`,nodeId:e.id,scopeId:A.id,value:n,valueWordCount:Bj(n),hash:a,localizedValues:i,localizedValueStatuses:l,managedByPluginButUserEditable:!1,key:"title",dataIdentifier:ao(e)?e.dataIdentifier:void 0,warnings:s})}if(e.webMetadata?.description||e.descriptionLocalized){let n=e.webMetadata?.description??j.root.webMetadata?.description??"",a=qA(n),i=e.descriptionLocalized??UA,s=Mg(t,i,o),l=lj(n,t,i,a,s);r.push({type:xg(e),keyPath:`${e.id}_description`,nodeId:e.id,scopeId:A.id,value:n,valueWordCount:Bj(n),hash:a,localizedValues:i,localizedValueStatuses:l,managedByPluginButUserEditable:!1,key:"description",dataIdentifier:ao(e)?e.dataIdentifier:void 0,warnings:s})}}function lb(j,A,e,t,r){if(!ho(e)||!x(e.fillImage)||e.fillImage.length===0)return;let o=YA(j,e,"fillImage"),n=YA(j,e,"fillImageLocalized"),a=YA(j,e,"altAttribute"),i=YA(j,e,"altAttributeLocalized");if(!o&&!n&&!a&&!i)return;let s=e.altAttribute??Ha,l=qA(s),c=e.altAttributeLocalized??UA,u=e.fillImage,p=qA(u),f=e.fillImageLocalized??UA,E=lj(s,t,c,l,void 0,Qd(u,f,p));r.push({type:"FrameNode",keyPath:`${e.id}_fillImageLocalized`,nodeId:e.id,scopeId:A.id,value:s,valueWordCount:Bj(s),hash:l,localizedValues:c,localizedValueStatuses:E,managedByPluginButUserEditable:!1,inherited:!i,supportsAlt:!0,image:u,imageHash:p,imageLocalizedValues:f,imageInherited:!n,positionX:z6(e.fillImagePositionX)?e.fillImagePositionX:void 0,positionY:z6(e.fillImagePositionY)?e.fillImagePositionY:void 0,supportsFocalPoint:!0})}function Lg(j,A,e,t){if(!yA.isOn("localizedLinks"))return;let r=A.getLink();if(!ma(r))return;let o=r.url,n=qA(o),a=A.linkLocalized??UA,i=lj(o,e,a,n,void 0,Hd(a));t.push({type:"nodeLink",keyPath:`${A.id}_linkLocalized`,nodeId:A.id,scopeId:j.id,value:o,valueWordCount:o?1:0,hash:n,localizedValues:a,localizedValueStatuses:i,managedByPluginButUserEditable:!1,aiTranslationDisabled:!0})}function cb(j,A,e,t,r){lb(j,A,e,t,r),Lg(A,e,t,r)}function B6(j){return!!(Ng(j)||j==="array"||j==="object")}function E6(j,A,e){return`${j}.${A}.${e??""}`}function db(j){if(w(j)&&Fa(j))return j.layoutTemplateIdentifier;if(W(j))return j.codeComponentIdentifier}function ub(j,A,e,t,r){let o=db(e);if(!o)return;let n=L.componentForIdentifier(o);if(!n)return;let a=e.getControlProps(n.properties);function i(s,l,c,u=void 0){let p=l.type;if(p==="array"&&ru(l.value)){if(c.type!=="array")return;let f=c.control;for(let E of l.value){if(!B6(E.type))continue;let F=Ri(u,E.id);i(s,E,f,F)}}if(p==="object"&&Oj(l.value)){if(c.type!=="object")return;for(let f in l.value){let E=l.value[f];if(!E||!B6(E.type))continue;let F=or(u,f),R=c.controls[f];R&&i(s,E,R,F)}}if(Ng(p))switch(p){case"string":{if(!YA(j,e,QA(s))||c.type==="string"&&c.preventLocalization||(io(l.value)&&$6(A,e,l.value,or(e.id,s),s,t,r),!x(l.value)))break;let f=l.value,E=qA(f),F=l.valueLocalized??UA,R=lj(f,t,F,E);r.push({type:"string",keyPath:E6(e.id,s,u),controlPropKey:s,controlPropName:c.title||nt(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:Bj(f),hash:E,localizedValues:F,localizedValueStatuses:R,managedByPluginButUserEditable:!1});break}case"link":{if(!yA.isOn("localizedLinks")||!YA(j,e,QA(s))||(io(l.value)&&$6(A,e,l.value,or(e.id,s),s,t,r),!ma(l.value)))break;let f=l.value.url,E=qA(f),F=l.valueLocalized??UA,R=lj(f,t,F,E,void 0,Hd(F));r.push({type:"link",keyPath:E6(e.id,s,u),controlPropKey:s,controlPropName:c.title||nt(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:f?1:0,hash:E,localizedValues:F,localizedValueStatuses:R,managedByPluginButUserEditable:!1,aiTranslationDisabled:!0});break}case"richtext":{if(p!=="richtext"||!x(l.value)||c.type==="richtext"&&c.preventLocalization||!YA(j,e,QA(s)))break;let f=l.value,E=qA(f),F=l.valueLocalized??UA,R=lj(f,t,F,E);r.push({type:"richtext",keyPath:E6(e.id,s,u),controlPropKey:s,controlPropName:c.title||nt(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:f,valueWordCount:Bj(f,!0),hash:E,localizedValues:F,localizedValueStatuses:R,managedByPluginButUserEditable:!1});break}case"image":{if(!l||l.type!=="image"||!x(l.value)||c.type!=="responsiveimage"&&c.type!=="image"||!YA(j,e,QA(s)))break;let f=c.type==="responsiveimage",E=l.alt??Ha,F=qA(E),R=f?l.altLocalized??UA:UA,S=l.value,v=qA(S),P=l.valueLocalized??UA,T=lj(E,t,R,F,void 0,Qd(S,P,v)),D=c.type==="responsiveimage";r.push({type:"image",keyPath:E6(e.id,s,u),controlPropKey:s,controlPropName:c.title||nt(s),ancestorControlKeyPath:u,nodeId:e.id,scopeId:A.id,value:E,valueWordCount:Bj(E),hash:F,localizedValues:R,localizedValueStatuses:T,managedByPluginButUserEditable:!1,supportsAlt:f,image:S,imageHash:v,imageLocalizedValues:P,supportsFocalPoint:D,positionX:D?l.positionX:void 0,positionY:D?l.positionY:void 0});break}default:}}for(let s in a){let l=a[s];if(!l)continue;let c=n.properties[s];c&&i(s,l,c)}}function pb(j,A,e,t){let r=A.formSelectOptions;if(!(!r||r?.length===0))for(let o of r){let n=o.title;if(!n)continue;let a=o.titleLocalized??UA,i=qA(n),s=lj(n,e,a,i);t.push({type:"FormSelectNode",keyPath:`${A.id}_${o.id}`,nodeId:A.id,optionId:o.id,scopeId:j.id,value:n,valueWordCount:Bj(n),hash:i,localizedValues:a,localizedValueStatuses:s,managedByPluginButUserEditable:!1})}}function kb(j,A,e,t,r){let o=`${e.id}_placeholder`;if(HA(e.formInputPlaceholder)){if(aA(e.formInputPlaceholder)||!YA(j,e,"formInputPlaceholder"))return;$6(A,e,e.formInputPlaceholder,o,e.id,t,r);return}if(!e.formInputPlaceholder||!YA(j,e,"formInputPlaceholder"))return;let n=qA(e.formInputPlaceholder),a=e.formInputPlaceholderLocalized??UA;r.push({keyPath:o,type:"FormPlainTextInputNode",nodeId:e.id,scopeId:A.id,value:e.formInputPlaceholder,valueWordCount:Bj(e.formInputPlaceholder),hash:qA(e.formInputPlaceholder),localizedValues:a,localizedValueStatuses:lj(e.formInputPlaceholder,t,a,n),managedByPluginButUserEditable:!1})}function mb(j,A,e,t,r,o){w(e)&&wg(j,A,e,t,r),XA(e)&&sb(j,A,e,t,r,o),(W(e)||w(e))&&ub(j,A,e,t,r),pA(e)&&cb(j,A,e,t,r),(xt(e)||RA(e))&&Lg(A,e,t,r),aa(e)&&kb(j,A,e,t,r),sa(e)&&pb(A,e,t,r)}function Ti(j,A,e,t,r,o){if(A.mutable)return;let n=A.cache.localizationSourceGroup;if(n&&!(n.update!==A.update||n.componentHash!==t||n.locales!==e||n.parentVariables!==r||!be(n.subGroups,o))&&!(Xa(j,A)&&n.includedLocales!==A.includedLocales))return n}function Pi(j,A,e,t,r,o,n){A.mutable||(A.cache.localizationSourceGroup={update:A.update,locales:t,componentHash:r,parentVariables:o,group:e,includedLocales:Xa(j,A)?A.includedLocales:void 0,subGroups:n})}function fb(j,A,e,t,r,o){let n=o==="canvasHtmlAsTextContentIfPossible";if(n){let l=Ti(j,A,e,t,$t,void 0);if(l){l.group&&r.push(l.group);return}}let a=[];for(let l of A.walk())mb(j,A,l,e,a,o);let i=Xa(j,A),s;if(a.length>0){let l=w(A)?f6(j,A):A.name??"Unknown";w(A)&&A.abTestingParentId&&(l=`${l} \xB7 ${A.name||De(A)}`),s={type:"sourceGroup",name:l,groupType:w(A)?"page":tj(A)?"template":"component",nodeId:A.id,supportsLocaleVisibility:i,includedLocaleIds:i?sc(j,A):void 0,items:a},r.push(s)}n&&Pi(j,A,s,e,t,$t,void 0)}function vi(j,A,e){return e?`${j}.${A}.${e}`:`${j}.${A}`}function Eb(j){return j.type!=="rich-text"?j.value.length:Po(j.value).length}function Jd(j,A,e){let t=e.required,r=e.type==="link"?void 0:e.options?.maxLength;if(!t&&!Y(r))return;let o={};for(let n of j){let a=A[n.id];if(!rl(a))continue;let i=Eb(a);t&&i===0?o[n.id]=vg(e.name):Y(r)&&i>r&&(o[n.id]=Tg(i,r))}return o}function $b(j,A,e){let t={};for(let r of j){let o=A[r.id];if(!rl(o))continue;let a=e[r.id]?.get(o.value);a&&a>1&&(t[r.id]="Each item in the Collection must have a unique slug")}return t}function Bb(j,A,e,t,r,o,n,a){let i=r.type;switch(i){case"string":{if(Ra(r))return;let s;if(n){if(n.type!==i||!x(n.value))return;s=n.value}else{if(dp(r))return;s=r.initialValue}let l=qA(s),c=n?.valueLocalized??UA,u=Jd(e,c,r),p=lj(s,e,c,l,u);return{type:"string",keyPath:vi(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:Bj(s),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"link":{if(!n||n.type!==i||!ma(n.value)||!yA.isOn("localizedLinks"))return;let s=n.value.url,l=qA(s),c=n?.valueLocalized??UA,u=Jd(e,c,r),p=lj(s,e,c,l,u);return{type:"link",keyPath:vi(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:s?1:0,hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u,aiTranslationDisabled:!0}}case"slug":{$(n?.type==="string","expected slug controlType to be a string"),$(x(n.value),"expected slug value to be a string");let s=n.value,l=qA(s),c=n?.valueLocalized??UA,u=$b(e,c,a),p=lj(s,e,c,l,u,Hd(c));return{type:"slug",keyPath:vi(A,o,t),controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,nodeId:A,scopeId:j,value:s,valueWordCount:Bj(s),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"richtext":{let s;if(Ra(r))return;if(n){if(n.type!==i||!x(n.value))return;s=n.value}else s=r.initialValue;let l=qA(s),c=n?.valueLocalized??UA,u=Jd(e,c,r),p=lj(s,e,c,l,u);return{type:"richtext",keyPath:vi(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:s,valueWordCount:Bj(s,!0),hash:l,localizedValues:c,localizedValueStatuses:p,managedByPluginButUserEditable:r.userEditable??!1,warnings:u}}case"image":{let s;if(n){if(n.type!==i||!x(n.value))return;s=n.value}else{if(!x(r.initialValue))return;s=r.initialValue}let l=qA(s),c=n?.valueLocalized??UA,u=n?.alt??Ha,p=qA(u),f=n?.altLocalized??UA,E=lj(u,e,f,p,void 0,Qd(s,c,l));return{type:"image",keyPath:vi(A,o,t),nodeId:A,scopeId:j,controlPropKey:o,controlPropName:r.name,ancestorControlKeyPath:t,value:u,valueWordCount:Bj(u),hash:p,localizedValues:f,localizedValueStatuses:E,supportsAlt:!0,image:s,imageHash:l,imageLocalizedValues:c,managedByPluginButUserEditable:r.userEditable??!1,supportsFocalPoint:!0,positionX:n?.positionX,positionY:n?.positionY}}case"enum":return;default:}}function hb(j,A,e,t,r){let o=A.id;function n(a,i,s,l=void 0){if(i&&i.type==="array"){if(s.type!=="array"||HA(i.value))return;for(let u of i.value){if(!B6(u.type)||!mn(u)||!u.value)continue;let p=Ri(l,u.id);for(let f of s.itemVariables){let E=u.value[f.id];if(!E||!B6(E.type))continue;let F=or(p,f.id);n(a,E,f,F)}}}if(!Dg(s))return;let c=Bb(o,A.id,e,l,s,a,i,r);c&&t.push(c)}for(let a of j.variables){if(a.type==="divider")continue;let i=A.getControlProp(a.id);n(a.id,i,a)}}function gb(j,A,e,t,r,o){let n=Ti(j,e,t,Et,A.variables,void 0);if(n){n.group&&o.push(n.group);return}let a=[],i=sc(j,e);if(hb(A,e,t,a,r),a.length>0){for(let l of a)l.insetLevel=1;let s={type:"sourceGroup",groupType:"collectionItem",collectionName:A.name??"Unknown",collectionNodeId:A.id,supportsLocaleVisibility:!0,includedLocaleIds:i,name:Cf(A,e)??"Unknown",nodeId:e.id,items:a};Pi(j,e,s,t,Et,A.variables,void 0),o.push(s)}}function Rb(j,A,e,t){let r=e.name,o=qA(r),n=e.nameLocalized??UA,a=lj(r,t,n,o);return{type:"enum",keyPath:`${j.id}_${A.id}_${e.id}`,nodeId:j.id,scopeId:j.id,variableId:A.id,enumCaseId:e.id,value:r,valueWordCount:Bj(r),hash:o,localizedValues:n,localizedValueStatuses:a,managedByPluginButUserEditable:!1}}function Ib(j,A,e,t){let r=[],o=Fb(e,A);for(let l of A.getUnsortedChildren())gb(j,A,l,e,o,r);let n=Ti(j,A,e,Et,$t,r);if(n){n.group&&t.push(n.group);return}let a=A.variables.filter(Dg);if(a.length===0)return;let i=[];for(let l of a){let c=l.type;switch(c){case"enum":{if(Ra(l))break;for(let u of l.cases)i.push(Rb(A,l,u,e));break}case"string":case"richtext":case"image":case"link":case"slug":break;default:}}let s=i.length>0||r.length>0?{type:"sourceGroup",groupType:"collection",name:A.name??"Unknown",nodeId:A.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:i,groups:r}:void 0;Pi(j,A,s,e,Et,$t,r),s&&t.push(s)}function Fb(j,A){let e={};for(let r of j)e[r.id]=new Map;let t=A.variables.find(sp);if(!t)return e;for(let r of A.getUnsortedChildren()){let o=r.getControlProp(t.id);if(o&&($(o.type==="string","expect slug control type to be be of type string"),$(x(o.value),"expected slug control prop value to be string"),!!o.valueLocalized))for(let n in o.valueLocalized){let a=o.valueLocalized[n],i=e[n];if(!i||!a?.value)continue;let s=(i.get(a.value)??0)+1;i.set(a.value,s)}}return e}function Gb(j,A,e){let t=Ti(j,j.root,A,Et,$t,void 0);if(t){t.group&&e.push(t.group);return}let r=[];wg(j,j.root,j.root,A,r);let o=r.length>0?{type:"sourceGroup",groupType:"settings",name:"Site Settings",nodeId:j.root.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:r}:void 0;Pi(j,j.root,o,A,Et,$t,void 0),o&&e.push(o)}function Sb(j,A,e,t){for(let r of A.children)Ib(j,r,e,t)}function yb(j,A,e,t){if(A.dataIdentifier)return;let r=qA(A.segment),o=A.segmentLocalized??UA;t.push({keyPath:A.id,type:"RouteSegmentNode",nodeId:A.id,scopeId:j.id,value:A.segment,valueWordCount:Bj(A.segment),hash:qA(A.segment),localizedValues:o,localizedValueStatuses:lj(A.segment,e,o,r),managedByPluginButUserEditable:!1})}function bb(j,A,e,t){let r=Ti(j,A,e,Et,$t,void 0);if(r){r.group&&t.push(r.group);return}let o=[];for(let a of A.walk())Nt(a)&&yb(A,a,e,o);let n;o.length>0&&(n={type:"sourceGroup",name:"Page Path Segments",groupType:"routeSegment",nodeId:A.id,supportsLocaleVisibility:!1,includedLocaleIds:void 0,items:o},t.push(n)),Pi(j,A,n,e,Et,$t,void 0)}function LnA(j,A,e,t){let r=[];if(!A||A.length===0)return r;Gb(j,A,r);for(let o of j.root.children)Eh(o)&&($(o.isLoaded(),"Scope node must be fully loaded"),fb(j,o,A,e,r,t)),sn(o)&&($(o.isLoaded(),"Scope node must be fully loaded"),Sb(j,o,A,r)),yA.isOn("localizedPagePaths")&&Tu(o)&&bb(j,o,A,r);return r}function qnA(j,A){return oo(j,A)}function VnA(j,A){return be(j,A)}function Yd(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var zr=Yd();function Qg(j){zr=j}var Mi={exec:()=>null};function xA(j,A=""){let e=typeof j=="string"?j:j.source,t={replace:(r,o)=>{let n=typeof o=="string"?o:o.source;return n=n.replace(Xj.caret,"$1"),e=e.replace(r,n),t},getRegex:()=>new RegExp(e,A)};return t}var Xj={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:j=>new RegExp(`^( {0,3}${j})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:j=>new RegExp(`^ {0,${Math.min(3,j-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:j=>new RegExp(`^ {0,${Math.min(3,j-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:j=>new RegExp(`^ {0,${Math.min(3,j-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:j=>new RegExp(`^ {0,${Math.min(3,j-1)}}#`),htmlBeginRegex:j=>new RegExp(`^ {0,${Math.min(3,j-1)}}<(?:[a-z].*>|!--)`,"i")},Cb=/^(?:[ \t]*(?:\n|$))+/,vb=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Tb=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Di=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Pb=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Zd=/(?:[*+-]|\d{1,9}[.)])/,Ug=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Wg=xA(Ug).replace(/bull/g,Zd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),_b=xA(Ug).replace(/bull/g,Zd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),A7=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xb=/^[^\n]+/,j7=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Mb=xA(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",j7).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Db=xA(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Zd).getRegex(),G6="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",e7=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Nb=xA("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",e7).replace("tag",G6).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),zg=xA(A7).replace("hr",Di).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",G6).getRegex(),Ob=xA(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",zg).getRegex(),t7={blockquote:Ob,code:vb,def:Mb,fences:Tb,heading:Pb,hr:Di,html:Nb,lheading:Wg,list:Db,newline:Cb,paragraph:zg,table:Mi,text:xb},qg=xA("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Di).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",G6).getRegex(),wb={...t7,lheading:_b,table:qg,paragraph:xA(A7).replace("hr",Di).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",qg).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",G6).getRegex()},Lb={...t7,html:xA(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",e7).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Mi,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:xA(A7).replace("hr",Di).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Wg).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},qb=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Vb=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Xg=/^( {2,}|\\)\n(?!\s*$)/,Kb=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,S6=/[\p{P}\p{S}]/u,r7=/[\s\p{P}\p{S}]/u,Yg=/[^\s\p{P}\p{S}]/u,Jb=xA(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,r7).getRegex(),Zg=/(?!~)[\p{P}\p{S}]/u,Hb=/(?!~)[\s\p{P}\p{S}]/u,Qb=/(?:[^\s\p{P}\p{S}]|~)/u,Ub=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,AR=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Wb=xA(AR,"u").replace(/punct/g,S6).getRegex(),zb=xA(AR,"u").replace(/punct/g,Zg).getRegex(),jR="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xb=xA(jR,"gu").replace(/notPunctSpace/g,Yg).replace(/punctSpace/g,r7).replace(/punct/g,S6).getRegex(),Yb=xA(jR,"gu").replace(/notPunctSpace/g,Qb).replace(/punctSpace/g,Hb).replace(/punct/g,Zg).getRegex(),Zb=xA("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Yg).replace(/punctSpace/g,r7).replace(/punct/g,S6).getRegex(),AC=xA(/\\(punct)/,"gu").replace(/punct/g,S6).getRegex(),jC=xA(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),eC=xA(e7).replace("(?:-->|$)","-->").getRegex(),tC=xA("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",eC).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),R6=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,rC=xA(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",R6).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),eR=xA(/^!?\[(label)\]\[(ref)\]/).replace("label",R6).replace("ref",j7).getRegex(),tR=xA(/^!?\[(ref)\](?:\[\])?/).replace("ref",j7).getRegex(),oC=xA("reflink|nolink(?!\\()","g").replace("reflink",eR).replace("nolink",tR).getRegex(),o7={_backpedal:Mi,anyPunctuation:AC,autolink:jC,blockSkip:Ub,br:Xg,code:Vb,del:Mi,emStrongLDelim:Wb,emStrongRDelimAst:Xb,emStrongRDelimUnd:Zb,escape:qb,link:rC,nolink:tR,punctuation:Jb,reflink:eR,reflinkSearch:oC,tag:tC,text:Kb,url:Mi},nC={...o7,link:xA(/^!?\[(label)\]\((.*?)\)/).replace("label",R6).getRegex(),reflink:xA(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",R6).getRegex()},Wd={...o7,emStrongRDelimAst:Yb,emStrongLDelim:zb,url:xA(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},iC={...Wd,br:xA(Xg).replace("{2,}","*").getRegex(),text:xA(Wd.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},h6={normal:t7,gfm:wb,pedantic:Lb},_i={normal:o7,gfm:Wd,breaks:iC,pedantic:nC},aC={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vg=j=>aC[j];function jt(j,A){if(A){if(Xj.escapeTest.test(j))return j.replace(Xj.escapeReplace,Vg)}else if(Xj.escapeTestNoEncode.test(j))return j.replace(Xj.escapeReplaceNoEncode,Vg);return j}function Kg(j){try{j=encodeURI(j).replace(Xj.percentDecode,"%")}catch{return null}return j}function Jg(j,A){let e=j.replace(Xj.findPipe,(o,n,a)=>{let i=!1,s=n;for(;--s>=0&&a[s]==="\\";)i=!i;return i?"|":" |"}),t=e.split(Xj.splitPipe),r=0;if(t[0].trim()||t.shift(),t.length>0&&!t.at(-1)?.trim()&&t.pop(),A)if(t.length>A)t.splice(A);else for(;t.length<A;)t.push("");for(;r<t.length;r++)t[r]=t[r].trim().replace(Xj.slashPipe,"|");return t}function xi(j,A,e){let t=j.length;if(t===0)return"";let r=0;for(;r<t;){let o=j.charAt(t-r-1);if(o===A&&!e)r++;else if(o!==A&&e)r++;else break}return j.slice(0,t-r)}function sC(j,A){if(j.indexOf(A[1])===-1)return-1;let e=0;for(let t=0;t<j.length;t++)if(j[t]==="\\")t++;else if(j[t]===A[0])e++;else if(j[t]===A[1]&&(e--,e<0))return t;return e>0?-2:-1}function Hg(j,A,e,t,r){let o=A.href,n=A.title||null,a=j[1].replace(r.other.outputLinkReplace,"$1");t.state.inLink=!0;let i={type:j[0].charAt(0)==="!"?"image":"link",raw:e,href:o,title:n,text:a,tokens:t.inlineTokens(a)};return t.state.inLink=!1,i}function lC(j,A,e){let t=j.match(e.other.indentCodeCompensation);if(t===null)return A;let r=t[1];return A.split(`
`).map(o=>{let n=o.match(e.other.beginningSpace);if(n===null)return o;let[a]=n;return a.length>=r.length?o.slice(r.length):o}).join(`
`)}var I6=class{constructor(j){g(this,"options");g(this,"rules");g(this,"lexer");this.options=j||zr}space(j){let A=this.rules.block.newline.exec(j);if(A&&A[0].length>0)return{type:"space",raw:A[0]}}code(j){let A=this.rules.block.code.exec(j);if(A){let e=A[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:A[0],codeBlockStyle:"indented",text:this.options.pedantic?e:xi(e,`
`)}}}fences(j){let A=this.rules.block.fences.exec(j);if(A){let e=A[0],t=lC(e,A[3]||"",this.rules);return{type:"code",raw:e,lang:A[2]?A[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):A[2],text:t}}}heading(j){let A=this.rules.block.heading.exec(j);if(A){let e=A[2].trim();if(this.rules.other.endingHash.test(e)){let t=xi(e,"#");(this.options.pedantic||!t||this.rules.other.endingSpaceChar.test(t))&&(e=t.trim())}return{type:"heading",raw:A[0],depth:A[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(j){let A=this.rules.block.hr.exec(j);if(A)return{type:"hr",raw:xi(A[0],`
`)}}blockquote(j){let A=this.rules.block.blockquote.exec(j);if(A){let e=xi(A[0],`
`).split(`
`),t="",r="",o=[];for(;e.length>0;){let n=!1,a=[],i;for(i=0;i<e.length;i++)if(this.rules.other.blockquoteStart.test(e[i]))a.push(e[i]),n=!0;else if(!n)a.push(e[i]);else break;e=e.slice(i);let s=a.join(`
`),l=s.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");t=t?`${t}
${s}`:s,r=r?`${r}
${l}`:l;let c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,o,!0),this.lexer.state.top=c,e.length===0)break;let u=o.at(-1);if(u?.type==="code")break;if(u?.type==="blockquote"){let p=u,f=p.raw+`
`+e.join(`
`),E=this.blockquote(f);o[o.length-1]=E,t=t.substring(0,t.length-p.raw.length)+E.raw,r=r.substring(0,r.length-p.text.length)+E.text;break}else if(u?.type==="list"){let p=u,f=p.raw+`
`+e.join(`
`),E=this.list(f);o[o.length-1]=E,t=t.substring(0,t.length-u.raw.length)+E.raw,r=r.substring(0,r.length-p.raw.length)+E.raw,e=f.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:t,tokens:o,text:r}}}list(j){let A=this.rules.block.list.exec(j);if(A){let e=A[1].trim(),t=e.length>1,r={type:"list",raw:"",ordered:t,start:t?+e.slice(0,-1):"",loose:!1,items:[]};e=t?`\\d{1,9}\\${e.slice(-1)}`:`\\${e}`,this.options.pedantic&&(e=t?e:"[*+-]");let o=this.rules.other.listItemRegex(e),n=!1;for(;j;){let i=!1,s="",l="";if(!(A=o.exec(j))||this.rules.block.hr.test(j))break;s=A[0],j=j.substring(s.length);let c=A[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,R=>" ".repeat(3*R.length)),u=j.split(`
`,1)[0],p=!c.trim(),f=0;if(this.options.pedantic?(f=2,l=c.trimStart()):p?f=A[1].length+1:(f=A[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,l=c.slice(f),f+=A[1].length),p&&this.rules.other.blankLine.test(u)&&(s+=u+`
`,j=j.substring(u.length+1),i=!0),!i){let R=this.rules.other.nextBulletRegex(f),S=this.rules.other.hrRegex(f),v=this.rules.other.fencesBeginRegex(f),P=this.rules.other.headingBeginRegex(f),T=this.rules.other.htmlBeginRegex(f);for(;j;){let D=j.split(`
`,1)[0],K;if(u=D,this.options.pedantic?(u=u.replace(this.rules.other.listReplaceNesting,"  "),K=u):K=u.replace(this.rules.other.tabCharGlobal,"    "),v.test(u)||P.test(u)||T.test(u)||R.test(u)||S.test(u))break;if(K.search(this.rules.other.nonSpaceChar)>=f||!u.trim())l+=`
`+K.slice(f);else{if(p||c.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||v.test(c)||P.test(c)||S.test(c))break;l+=`
`+u}!p&&!u.trim()&&(p=!0),s+=D+`
`,j=j.substring(D.length+1),c=K.slice(f)}}r.loose||(n?r.loose=!0:this.rules.other.doubleBlankLine.test(s)&&(n=!0));let E=null,F;this.options.gfm&&(E=this.rules.other.listIsTask.exec(l),E&&(F=E[0]!=="[ ] ",l=l.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:s,task:!!E,checked:F,loose:!1,text:l,tokens:[]}),r.raw+=s}let a=r.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let i=0;i<r.items.length;i++)if(this.lexer.state.top=!1,r.items[i].tokens=this.lexer.blockTokens(r.items[i].text,[]),!r.loose){let s=r.items[i].tokens.filter(c=>c.type==="space"),l=s.length>0&&s.some(c=>this.rules.other.anyLine.test(c.raw));r.loose=l}if(r.loose)for(let i=0;i<r.items.length;i++)r.items[i].loose=!0;return r}}html(j){let A=this.rules.block.html.exec(j);if(A)return{type:"html",block:!0,raw:A[0],pre:A[1]==="pre"||A[1]==="script"||A[1]==="style",text:A[0]}}def(j){let A=this.rules.block.def.exec(j);if(A){let e=A[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),t=A[2]?A[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=A[3]?A[3].substring(1,A[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):A[3];return{type:"def",tag:e,raw:A[0],href:t,title:r}}}table(j){let A=this.rules.block.table.exec(j);if(!A||!this.rules.other.tableDelimiter.test(A[2]))return;let e=Jg(A[1]),t=A[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=A[3]?.trim()?A[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:A[0],header:[],align:[],rows:[]};if(e.length===t.length){for(let n of t)this.rules.other.tableAlignRight.test(n)?o.align.push("right"):this.rules.other.tableAlignCenter.test(n)?o.align.push("center"):this.rules.other.tableAlignLeft.test(n)?o.align.push("left"):o.align.push(null);for(let n=0;n<e.length;n++)o.header.push({text:e[n],tokens:this.lexer.inline(e[n]),header:!0,align:o.align[n]});for(let n of r)o.rows.push(Jg(n,o.header.length).map((a,i)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:o.align[i]})));return o}}lheading(j){let A=this.rules.block.lheading.exec(j);if(A)return{type:"heading",raw:A[0],depth:A[2].charAt(0)==="="?1:2,text:A[1],tokens:this.lexer.inline(A[1])}}paragraph(j){let A=this.rules.block.paragraph.exec(j);if(A){let e=A[1].charAt(A[1].length-1)===`
`?A[1].slice(0,-1):A[1];return{type:"paragraph",raw:A[0],text:e,tokens:this.lexer.inline(e)}}}text(j){let A=this.rules.block.text.exec(j);if(A)return{type:"text",raw:A[0],text:A[0],tokens:this.lexer.inline(A[0])}}escape(j){let A=this.rules.inline.escape.exec(j);if(A)return{type:"escape",raw:A[0],text:A[1]}}tag(j){let A=this.rules.inline.tag.exec(j);if(A)return!this.lexer.state.inLink&&this.rules.other.startATag.test(A[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(A[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(A[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(A[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:A[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:A[0]}}link(j){let A=this.rules.inline.link.exec(j);if(A){let e=A[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let o=xi(e.slice(0,-1),"\\");if((e.length-o.length)%2===0)return}else{let o=sC(A[2],"()");if(o===-2)return;if(o>-1){let a=(A[0].indexOf("!")===0?5:4)+A[1].length+o;A[2]=A[2].substring(0,o),A[0]=A[0].substring(0,a).trim(),A[3]=""}}let t=A[2],r="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(t);o&&(t=o[1],r=o[3])}else r=A[3]?A[3].slice(1,-1):"";return t=t.trim(),this.rules.other.startAngleBracket.test(t)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?t=t.slice(1):t=t.slice(1,-1)),Hg(A,{href:t&&t.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},A[0],this.lexer,this.rules)}}reflink(j,A){let e;if((e=this.rules.inline.reflink.exec(j))||(e=this.rules.inline.nolink.exec(j))){let t=(e[2]||e[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=A[t.toLowerCase()];if(!r){let o=e[0].charAt(0);return{type:"text",raw:o,text:o}}return Hg(e,r,e[0],this.lexer,this.rules)}}emStrong(j,A,e=""){let t=this.rules.inline.emStrongLDelim.exec(j);if(!t||t[3]&&e.match(this.rules.other.unicodeAlphaNumeric))return;if(!(t[1]||t[2]||"")||!e||this.rules.inline.punctuation.exec(e)){let o=[...t[0]].length-1,n,a,i=o,s=0,l=t[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,A=A.slice(-1*j.length+o);(t=l.exec(A))!=null;){if(n=t[1]||t[2]||t[3]||t[4]||t[5]||t[6],!n)continue;if(a=[...n].length,t[3]||t[4]){i+=a;continue}else if((t[5]||t[6])&&o%3&&!((o+a)%3)){s+=a;continue}if(i-=a,i>0)continue;a=Math.min(a,a+i+s);let c=[...t[0]][0].length,u=j.slice(0,o+t.index+c+a);if(Math.min(o,a)%2){let f=u.slice(1,-1);return{type:"em",raw:u,text:f,tokens:this.lexer.inlineTokens(f)}}let p=u.slice(2,-2);return{type:"strong",raw:u,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(j){let A=this.rules.inline.code.exec(j);if(A){let e=A[2].replace(this.rules.other.newLineCharGlobal," "),t=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return t&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:A[0],text:e}}}br(j){let A=this.rules.inline.br.exec(j);if(A)return{type:"br",raw:A[0]}}del(j){let A=this.rules.inline.del.exec(j);if(A)return{type:"del",raw:A[0],text:A[2],tokens:this.lexer.inlineTokens(A[2])}}autolink(j){let A=this.rules.inline.autolink.exec(j);if(A){let e,t;return A[2]==="@"?(e=A[1],t="mailto:"+e):(e=A[1],t=e),{type:"link",raw:A[0],text:e,href:t,tokens:[{type:"text",raw:e,text:e}]}}}url(j){let A;if(A=this.rules.inline.url.exec(j)){let e,t;if(A[2]==="@")e=A[0],t="mailto:"+e;else{let r;do r=A[0],A[0]=this.rules.inline._backpedal.exec(A[0])?.[0]??"";while(r!==A[0]);e=A[0],A[1]==="www."?t="http://"+A[0]:t=A[0]}return{type:"link",raw:A[0],text:e,href:t,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(j){let A=this.rules.inline.text.exec(j);if(A){let e=this.lexer.state.inRawBlock;return{type:"text",raw:A[0],text:A[0],escaped:e}}}},bt=class zd{constructor(A){g(this,"tokens");g(this,"options");g(this,"state");g(this,"tokenizer");g(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=A||zr,this.options.tokenizer=this.options.tokenizer||new I6,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let e={other:Xj,block:h6.normal,inline:_i.normal};this.options.pedantic?(e.block=h6.pedantic,e.inline=_i.pedantic):this.options.gfm&&(e.block=h6.gfm,this.options.breaks?e.inline=_i.breaks:e.inline=_i.gfm),this.tokenizer.rules=e}static get rules(){return{block:h6,inline:_i}}static lex(A,e){return new zd(e).lex(A)}static lexInline(A,e){return new zd(e).inlineTokens(A)}lex(A){A=A.replace(Xj.carriageReturn,`
`),this.blockTokens(A,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(A,e=[],t=!1){for(this.options.pedantic&&(A=A.replace(Xj.tabCharGlobal,"    ").replace(Xj.spaceLine,""));A;){let r;if(this.options.extensions?.block?.some(n=>(r=n.call({lexer:this},A,e))?(A=A.substring(r.raw.length),e.push(r),!0):!1))continue;if(r=this.tokenizer.space(A)){A=A.substring(r.raw.length);let n=e.at(-1);r.raw.length===1&&n!==void 0?n.raw+=`
`:e.push(r);continue}if(r=this.tokenizer.code(A)){A=A.substring(r.raw.length);let n=e.at(-1);n?.type==="paragraph"||n?.type==="text"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.at(-1).src=n.text):e.push(r);continue}if(r=this.tokenizer.fences(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.heading(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.hr(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.blockquote(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.list(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.html(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.def(A)){A=A.substring(r.raw.length);let n=e.at(-1);n?.type==="paragraph"||n?.type==="text"?(n.raw+=`
`+r.raw,n.text+=`
`+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(A)){A=A.substring(r.raw.length),e.push(r);continue}if(r=this.tokenizer.lheading(A)){A=A.substring(r.raw.length),e.push(r);continue}let o=A;if(this.options.extensions?.startBlock){let n=1/0,a=A.slice(1),i;this.options.extensions.startBlock.forEach(s=>{i=s.call({lexer:this},a),typeof i=="number"&&i>=0&&(n=Math.min(n,i))}),n<1/0&&n>=0&&(o=A.substring(0,n+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){let n=e.at(-1);t&&n?.type==="paragraph"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):e.push(r),t=o.length!==A.length,A=A.substring(r.raw.length);continue}if(r=this.tokenizer.text(A)){A=A.substring(r.raw.length);let n=e.at(-1);n?.type==="text"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):e.push(r);continue}if(A){let n="Infinite loop on byte: "+A.charCodeAt(0);if(this.options.silent){console.error(n);break}else throw new Error(n)}}return this.state.top=!0,e}inline(A,e=[]){return this.inlineQueue.push({src:A,tokens:e}),e}inlineTokens(A,e=[]){let t=A,r=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(t))!=null;)a.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(t=t.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+t.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(t))!=null;)t=t.slice(0,r.index)+"++"+t.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(t))!=null;)t=t.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+t.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,n="";for(;A;){o||(n=""),o=!1;let a;if(this.options.extensions?.inline?.some(s=>(a=s.call({lexer:this},A,e))?(A=A.substring(a.raw.length),e.push(a),!0):!1))continue;if(a=this.tokenizer.escape(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.tag(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.link(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.reflink(A,this.tokens.links)){A=A.substring(a.raw.length);let s=e.at(-1);a.type==="text"&&s?.type==="text"?(s.raw+=a.raw,s.text+=a.text):e.push(a);continue}if(a=this.tokenizer.emStrong(A,t,n)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.codespan(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.br(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.del(A)){A=A.substring(a.raw.length),e.push(a);continue}if(a=this.tokenizer.autolink(A)){A=A.substring(a.raw.length),e.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(A))){A=A.substring(a.raw.length),e.push(a);continue}let i=A;if(this.options.extensions?.startInline){let s=1/0,l=A.slice(1),c;this.options.extensions.startInline.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(s=Math.min(s,c))}),s<1/0&&s>=0&&(i=A.substring(0,s+1))}if(a=this.tokenizer.inlineText(i)){A=A.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(n=a.raw.slice(-1)),o=!0;let s=e.at(-1);s?.type==="text"?(s.raw+=a.raw,s.text+=a.text):e.push(a);continue}if(A){let s="Infinite loop on byte: "+A.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return e}},F6=class{constructor(j){g(this,"options");g(this,"parser");this.options=j||zr}space(j){return""}code({text:j,lang:A,escaped:e}){let t=(A||"").match(Xj.notSpaceStart)?.[0],r=j.replace(Xj.endingNewline,"")+`
`;return t?'<pre><code class="language-'+jt(t)+'">'+(e?r:jt(r,!0))+`</code></pre>
`:"<pre><code>"+(e?r:jt(r,!0))+`</code></pre>
`}blockquote({tokens:j}){return`<blockquote>
${this.parser.parse(j)}</blockquote>
`}html({text:j}){return j}heading({tokens:j,depth:A}){return`<h${A}>${this.parser.parseInline(j)}</h${A}>
`}hr(j){return`<hr>
`}list(j){let A=j.ordered,e=j.start,t="";for(let n=0;n<j.items.length;n++){let a=j.items[n];t+=this.listitem(a)}let r=A?"ol":"ul",o=A&&e!==1?' start="'+e+'"':"";return"<"+r+o+`>
`+t+"</"+r+`>
`}listitem(j){let A="";if(j.task){let e=this.checkbox({checked:!!j.checked});j.loose?j.tokens[0]?.type==="paragraph"?(j.tokens[0].text=e+" "+j.tokens[0].text,j.tokens[0].tokens&&j.tokens[0].tokens.length>0&&j.tokens[0].tokens[0].type==="text"&&(j.tokens[0].tokens[0].text=e+" "+jt(j.tokens[0].tokens[0].text),j.tokens[0].tokens[0].escaped=!0)):j.tokens.unshift({type:"text",raw:e+" ",text:e+" ",escaped:!0}):A+=e+" "}return A+=this.parser.parse(j.tokens,!!j.loose),`<li>${A}</li>
`}checkbox({checked:j}){return"<input "+(j?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:j}){return`<p>${this.parser.parseInline(j)}</p>
`}table(j){let A="",e="";for(let r=0;r<j.header.length;r++)e+=this.tablecell(j.header[r]);A+=this.tablerow({text:e});let t="";for(let r=0;r<j.rows.length;r++){let o=j.rows[r];e="";for(let n=0;n<o.length;n++)e+=this.tablecell(o[n]);t+=this.tablerow({text:e})}return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+A+`</thead>
`+t+`</table>
`}tablerow({text:j}){return`<tr>
${j}</tr>
`}tablecell(j){let A=this.parser.parseInline(j.tokens),e=j.header?"th":"td";return(j.align?`<${e} align="${j.align}">`:`<${e}>`)+A+`</${e}>
`}strong({tokens:j}){return`<strong>${this.parser.parseInline(j)}</strong>`}em({tokens:j}){return`<em>${this.parser.parseInline(j)}</em>`}codespan({text:j}){return`<code>${jt(j,!0)}</code>`}br(j){return"<br>"}del({tokens:j}){return`<del>${this.parser.parseInline(j)}</del>`}link({href:j,title:A,tokens:e}){let t=this.parser.parseInline(e),r=Kg(j);if(r===null)return t;j=r;let o='<a href="'+j+'"';return A&&(o+=' title="'+jt(A)+'"'),o+=">"+t+"</a>",o}image({href:j,title:A,text:e,tokens:t}){t&&(e=this.parser.parseInline(t,this.parser.textRenderer));let r=Kg(j);if(r===null)return jt(e);j=r;let o=`<img src="${j}" alt="${e}"`;return A&&(o+=` title="${jt(A)}"`),o+=">",o}text(j){return"tokens"in j&&j.tokens?this.parser.parseInline(j.tokens):"escaped"in j&&j.escaped?j.text:jt(j.text)}},n7=class{strong({text:j}){return j}em({text:j}){return j}codespan({text:j}){return j}del({text:j}){return j}html({text:j}){return j}text({text:j}){return j}link({text:j}){return""+j}image({text:j}){return""+j}br(){return""}},Ct=class Xd{constructor(A){g(this,"options");g(this,"renderer");g(this,"textRenderer");this.options=A||zr,this.options.renderer=this.options.renderer||new F6,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new n7}static parse(A,e){return new Xd(e).parse(A)}static parseInline(A,e){return new Xd(e).parseInline(A)}parse(A,e=!0){let t="";for(let r=0;r<A.length;r++){let o=A[r];if(this.options.extensions?.renderers?.[o.type]){let a=o,i=this.options.extensions.renderers[a.type].call({parser:this},a);if(i!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){t+=i||"";continue}}let n=o;switch(n.type){case"space":{t+=this.renderer.space(n);continue}case"hr":{t+=this.renderer.hr(n);continue}case"heading":{t+=this.renderer.heading(n);continue}case"code":{t+=this.renderer.code(n);continue}case"table":{t+=this.renderer.table(n);continue}case"blockquote":{t+=this.renderer.blockquote(n);continue}case"list":{t+=this.renderer.list(n);continue}case"html":{t+=this.renderer.html(n);continue}case"paragraph":{t+=this.renderer.paragraph(n);continue}case"text":{let a=n,i=this.renderer.text(a);for(;r+1<A.length&&A[r+1].type==="text";)a=A[++r],i+=`
`+this.renderer.text(a);e?t+=this.renderer.paragraph({type:"paragraph",raw:i,text:i,tokens:[{type:"text",raw:i,text:i,escaped:!0}]}):t+=i;continue}default:{let a='Token with "'+n.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return t}parseInline(A,e=this.renderer){let t="";for(let r=0;r<A.length;r++){let o=A[r];if(this.options.extensions?.renderers?.[o.type]){let a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){t+=a||"";continue}}let n=o;switch(n.type){case"escape":{t+=e.text(n);break}case"html":{t+=e.html(n);break}case"link":{t+=e.link(n);break}case"image":{t+=e.image(n);break}case"strong":{t+=e.strong(n);break}case"em":{t+=e.em(n);break}case"codespan":{t+=e.codespan(n);break}case"br":{t+=e.br(n);break}case"del":{t+=e.del(n);break}case"text":{t+=e.text(n);break}default:{let a='Token with "'+n.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return t}},Ud,g6=(Ud=class{constructor(j){g(this,"options");g(this,"block");this.options=j||zr}preprocess(j){return j}postprocess(j){return j}processAllTokens(j){return j}provideLexer(){return this.block?bt.lex:bt.lexInline}provideParser(){return this.block?Ct.parse:Ct.parseInline}},g(Ud,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Ud),cC=class{constructor(...j){g(this,"defaults",Yd());g(this,"options",this.setOptions);g(this,"parse",this.parseMarkdown(!0));g(this,"parseInline",this.parseMarkdown(!1));g(this,"Parser",Ct);g(this,"Renderer",F6);g(this,"TextRenderer",n7);g(this,"Lexer",bt);g(this,"Tokenizer",I6);g(this,"Hooks",g6);this.use(...j)}walkTokens(j,A){let e=[];for(let t of j)switch(e=e.concat(A.call(this,t)),t.type){case"table":{let r=t;for(let o of r.header)e=e.concat(this.walkTokens(o.tokens,A));for(let o of r.rows)for(let n of o)e=e.concat(this.walkTokens(n.tokens,A));break}case"list":{let r=t;e=e.concat(this.walkTokens(r.items,A));break}default:{let r=t;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(o=>{let n=r[o].flat(1/0);e=e.concat(this.walkTokens(n,A))}):r.tokens&&(e=e.concat(this.walkTokens(r.tokens,A)))}}return e}use(...j){let A=this.defaults.extensions||{renderers:{},childTokens:{}};return j.forEach(e=>{let t={...e};if(t.async=this.defaults.async||t.async||!1,e.extensions&&(e.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let o=A.renderers[r.name];o?A.renderers[r.name]=function(...n){let a=r.renderer.apply(this,n);return a===!1&&(a=o.apply(this,n)),a}:A.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=A[r.level];o?o.unshift(r.tokenizer):A[r.level]=[r.tokenizer],r.start&&(r.level==="block"?A.startBlock?A.startBlock.push(r.start):A.startBlock=[r.start]:r.level==="inline"&&(A.startInline?A.startInline.push(r.start):A.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(A.childTokens[r.name]=r.childTokens)}),t.extensions=A),e.renderer){let r=this.defaults.renderer||new F6(this.defaults);for(let o in e.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let n=o,a=e.renderer[n],i=r[n];r[n]=(...s)=>{let l=a.apply(r,s);return l===!1&&(l=i.apply(r,s)),l||""}}t.renderer=r}if(e.tokenizer){let r=this.defaults.tokenizer||new I6(this.defaults);for(let o in e.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let n=o,a=e.tokenizer[n],i=r[n];r[n]=(...s)=>{let l=a.apply(r,s);return l===!1&&(l=i.apply(r,s)),l}}t.tokenizer=r}if(e.hooks){let r=this.defaults.hooks||new g6;for(let o in e.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let n=o,a=e.hooks[n],i=r[n];g6.passThroughHooks.has(o)?r[n]=s=>{if(this.defaults.async)return Promise.resolve(a.call(r,s)).then(c=>i.call(r,c));let l=a.call(r,s);return i.call(r,l)}:r[n]=(...s)=>{let l=a.apply(r,s);return l===!1&&(l=i.apply(r,s)),l}}t.hooks=r}if(e.walkTokens){let r=this.defaults.walkTokens,o=e.walkTokens;t.walkTokens=function(n){let a=[];return a.push(o.call(this,n)),r&&(a=a.concat(r.call(this,n))),a}}this.defaults={...this.defaults,...t}}),this}setOptions(j){return this.defaults={...this.defaults,...j},this}lexer(j,A){return bt.lex(j,A??this.defaults)}parser(j,A){return Ct.parse(j,A??this.defaults)}parseMarkdown(j){return(e,t)=>{let r={...t},o={...this.defaults,...r},n=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&r.async===!1)return n(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return n(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return n(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=j);let a=o.hooks?o.hooks.provideLexer():j?bt.lex:bt.lexInline,i=o.hooks?o.hooks.provideParser():j?Ct.parse:Ct.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(e):e).then(s=>a(s,o)).then(s=>o.hooks?o.hooks.processAllTokens(s):s).then(s=>o.walkTokens?Promise.all(this.walkTokens(s,o.walkTokens)).then(()=>s):s).then(s=>i(s,o)).then(s=>o.hooks?o.hooks.postprocess(s):s).catch(n);try{o.hooks&&(e=o.hooks.preprocess(e));let s=a(e,o);o.hooks&&(s=o.hooks.processAllTokens(s)),o.walkTokens&&this.walkTokens(s,o.walkTokens);let l=i(s,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(s){return n(s)}}}onError(j,A){return e=>{if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,j){let t="<p>An error occurred:</p><pre>"+jt(e.message+"",!0)+"</pre>";return A?Promise.resolve(t):t}if(A)return Promise.reject(e);throw e}}},Wr=new cC;function _A(j,A){return Wr.parse(j,A)}_A.options=_A.setOptions=function(j){return Wr.setOptions(j),_A.defaults=Wr.defaults,Qg(_A.defaults),_A};_A.getDefaults=Yd;_A.defaults=zr;_A.use=function(...j){return Wr.use(...j),_A.defaults=Wr.defaults,Qg(_A.defaults),_A};_A.walkTokens=function(j,A){return Wr.walkTokens(j,A)};_A.parseInline=Wr.parseInline;_A.Parser=Ct;_A.parser=Ct.parse;_A.Renderer=F6;_A.TextRenderer=n7;_A.Lexer=bt;_A.lexer=bt.lex;_A.Tokenizer=I6;_A.Hooks=g6;_A.parse=_A;var JnA=_A.options,HnA=_A.setOptions,QnA=_A.use,UnA=_A.walkTokens,WnA=_A.parseInline;var znA=Ct.parse,XnA=bt.lex;var dC=/^(#{1,6})\s+(.+)$/m,uC=/\*\*(.*?)\*\*/,pC=/\*(.*?)\*/,kC=/^\s*[-*+]\s+(.+)$/m,mC=/^\s*(\d+)\.\s+(.+)$/m,fC=/^>\s+(.+)$/m,EC=/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/,$C=/`([^`]+)`/,BC=/```[\s\S]*?```/,hC=/^\s*\|(.+\|)+\s*$/m,gC=/~~(.*?)~~/,RC=/^\s*[-*+]\s+\[[ x]\]\s+\S/m,IC=/^(-{3,}|_{3,})\s*$/m,FC=/!\[([^\]]*)\]\((https?:\/\/[^)]+)\)/,GC=/<(https?:\/\/[^>]+)>/;function iiA(j){return!j||j.length===0?!1:[dC,uC,pC,kC,mC,fC,EC,$C,BC,hC,gC,RC,IC,FC,GC].some(e=>e.test(j))}function SC(j,{async:A,...e}={}){return _A.parse(j,{async:!1,gfm:!0,breaks:!0,...e})}function aiA(j,A){let e=SC(j),t=document.createElement("div");return t.innerHTML=e,Pp.fromSchema(A).parseSlice(t,{preserveWhitespace:!0})}var yC=hA("wantsNativeTextActions");function rR(j=document.activeElement){if(!(j instanceof HTMLElement))return!1;if(j.classList.contains("wantsNativeTextAction")||j instanceof HTMLIFrameElement)return!0;if(j instanceof HTMLInputElement)switch(j.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return yC.reportErrorOncePerMinute("Unhandled input type: "+j.type),!1}return j instanceof HTMLTextAreaElement||yA.isOn("rightClickOnLinks")&&(j instanceof HTMLAnchorElement||j.closest("a"))?!0:j.isContentEditable}var lr=Dj(zi());var dR=Dj(ro());function i7(j){return j.wantsActions?j.wantsActions():!0}function a7(j,A,e){return j.wantsAction?j.wantsAction(A,e):!0}function nR(j,A){return j.optionsForAction?j.optionsForAction(A):void 0}var iR;(t=>{function j(r){return new e(r)}t.chain=j;function A(r,o){return r&&r instanceof e?r.actionToTargetMap[o]:r}t.functionTarget=A;class e{constructor(o){g(this,"actionToTargetMap",{});g(this,"wantedActions",[]);this.then(o)}then(o){this.wantedActions=this.wantedActions.concat(o.wantedActions);let n=this.actionToTargetMap,a=o.wantedActions;for(let i of a)n[i]=n[i]||o;return this}wantsAction(o,n){let a=this.actionToTargetMap[o];return!a||!i7(a)?!1:a7(a,o,n)}optionsForAction(o){let n=this.actionToTargetMap[o];if(n)return nR(n,o)}}})(iR||={});var Xr=class extends Event{constructor(){super(...arguments);g(this,"actionIdentifier");g(this,"actionArgument")}};g(Xr,"eventType","vekter-action-dispatch-event");var Yr=class extends Event{constructor(){super(...arguments);g(this,"invalidatedActions");g(this,"validatedActionStates");g(this,"validatedActionOptions")}};g(Yr,"eventType","vekter-action-validation-event");function miA({target:j,engine:A,children:e,style:t,global:r}){let o=(0,lr.useRef)(null),n=(0,lr.useCallback)(s=>{let l=s.actionIdentifier;if(!l)return;let c=iR.functionTarget(j,l);if(!c||!c.wantedActions.includes(l)||!i7(c))return;let u=c[l];if(!ou(u))return;let p=a7(c,l,s);if(!p||(s.preventDefault(),s.stopPropagation(),p!==!0))return;A.setEditReason(l);let f=u.bind(c);A.scheduler.wrapHandler(f)(s.actionArgument)},[A,j]),a=(0,lr.useCallback)(s=>{let{invalidatedActions:l,validatedActionStates:c,validatedActionOptions:u}=s;if(!(!l||!c||!u)&&j){for(let p of j.wantedActions)if(l.has(p)){l.delete(p);let f=i7(j)?a7(j,p,s):!1;if(c[p]=f,f===!0||f===!1){let E=nR(j,p);E&&(u[p]=E)}}l.size===0&&(s.preventDefault(),s.stopPropagation())}},[j]);(0,lr.useEffect)(()=>{if(!o.current)return;let s=(r?document.documentElement:null)||o.current;return s.addEventListener(Xr.eventType,n),s.addEventListener(Yr.eventType,a),()=>{s.removeEventListener(Xr.eventType,n),s.removeEventListener(Yr.eventType,a)}},[r,n,a]);let i=(0,lr.useCallback)(s=>{!rR(s.target)&&!Ge.isDebugBuild&&s.preventDefault()},[]);return(0,dR.jsx)("div",{ref:o,onContextMenu:i,style:t,children:e})}function aR(j,A){let e=document.activeElement;if(!e)throw Error("No active element for action dispatch");let t=new Xr(Xr.eventType,{bubbles:!0});return t.actionIdentifier=j,t.actionArgument=A,e.dispatchEvent(t)}function bC(j){let A=document.activeElement;if(!A)throw Error("No active element for action validation");let e=new Set;for(let n of j)e.add(n);let t={},r={},o=new Yr(Yr.eventType,{bubbles:!0});return o.invalidatedActions=e,o.validatedActionStates=t,o.validatedActionOptions=r,A.dispatchEvent(o),{states:t,options:r}}var sR=[],lR=[];function fiA(j){sR.push(j)}function EiA(j){lR.push(j)}function cR(j){let A=j==="*"?Object.keys(y6):[j];sR.forEach(r=>r());let{states:e,options:t}=bC(A);Object.assign(y6,e),Object.assign(oR,t);for(let r of A)y6[r]=e[r]||(r==="undo"||r==="redo"||r==="delete"?"native":!1);return lR.forEach(r=>r()),{states:y6,options:oR}}var y6={},oR={};function IiA({stackElement:j,tree:A}){return j?A.getNodeWithTrait(j.type==="temporary"?j.collectionId:A.getParent(j.itemId)?.id,fj):null}function FiA({treeStore:j,contentManagementStore:A,stackElement:e}){if(!e)return null;if(e.type==="existing")return j.tree.getNodeWithTrait(e.itemId,$e);if(e.type==="temporary")return A.temporaryItemCache.get(e.itemId)??null;iA(e)}function GiA(j,A=[]){let e=j.stores.selectionStore.ids.length===1?D6(j.stores.selectionStore.ids,0):void 0,t=vC(j,A),r=D6(t,0),o=j.tree.getNodeWithTrait(e,$e);if(o){if(!r)return[{itemId:o.id,type:"existing"}];if(r.type==="existing")return r.itemId===o.id?t:($(t.length===1,"Must dismiss overlay stack before changing selection"),[{itemId:o.id,type:"existing"}]);if(r.type==="temporary")throw new Error("Must save temporary item stack before selecting a collection item");iA(r)}if(!r||r.type==="temporary")return t;if(r.type==="existing")return j.stores.chromeStore.mainView!==2?t:($(t.length===1,"Must dismiss overlay stack before de-selecting collection item"),[]);iA(r)}function vC(j,A){let e=[];for(let t=0;t<A.length;t++){let r=A[t];if(!r)continue;if(r.type==="temporary"&&j.tree.has(r.itemId)&&(r={type:"existing",itemId:r.itemId}),!TC(j,r))break;e.push(r),t>0&&$(r.type==="existing"||!!r.saveAction,"Temporary items in the stack must have saveAction, except when they are the first")}return e}function TC(j,A){if(A.type==="temporary")return $(!j.tree.has(A.itemId),"Temporary stack element must not exist in the tree. It should be turned existing before passing it to validateOverlayStackElement."),j.tree.has(A.collectionId)&&j.stores.contentManagementStore.temporaryItemCache.has(A.itemId);if(A.type==="existing")return j.tree.has(A.itemId);iA(A)}function uR(j,A){let e=j.itemVariables.length===1&&j.itemVariables[0]?.type==="image"?j.itemVariables[0]:void 0,t=h`item`,r={[Or]:h`typeof ${t}?.[${Or}] === "string" ? ${t}[${Or}] : undefined`};for(let n of j.itemVariables){let a=$a(n.name);a?r[n.id]=h`${t}?.[${a}] ?? ${t}?.[${n.id}]`:r[n.id]=h`${t}?.[${n.id}]`}let o=A.bindings.create("arrayFromHumanReadable"+j.id);return A.declarations.file.create(h.joinLines(h`const ${o} = (value) => {${h.joinLines(h`if (!Array.isArray(value)) return`,h`return value.map(${t} => {${h.joinLines(e?h`if (typeof ${t} === "string") return { [${e.id}]: ${t} }`:void 0,h`return ${r}`)}})`)}}`)),o}function PC(j){return[j[1],j[0]]}var _C=new Map(Object.entries(vA).map(PC));function pR(j,A){let e=A.addImport("framer",{exportSpecifier:"ControlType"}),t=_C.get(j),r=new V(t);return h`${e}.${r}`}var xC={boolean:"boolean",number:"number",string:"string",richtext:"string",fusednumber:"any",enum:"string",segmentedenum:"string",color:"string",image:"string",responsiveimage:"{src: string; srcSet?: string; alt?: string}",file:"string",componentinstance:"any",slot:"any",array:"any[]",eventhandler:"any",transition:"Record<string, any>",link:"string",linkrelvalues:"string[] | undefined",pagescope:"string",date:"string",object:"Record<string, any>",font:"Record<string, any> | undefined",scrollsectionref:"React.MutableRefObject<HTMLElement>",customcursor:"string",border:"Record<string, any>",cursor:"string",boxshadow:"string",gap:"string",padding:"string",borderradius:"string",collectionreference:"string | undefined",multicollectionreference:"string[] | undefined",trackingid:"string | undefined",vectorsetitem:"React.ComponentType<any> | undefined"};function MC(j){return j?new V(xC[j]):h`any`}var kR="variant";function DC(j){return!sA(j?.defaultValue)}function NC(j,A){if(!eA(j))return{};$(j.isLoaded(),"Node must be loaded to generate controls");let e=j.getTopLevelVariants();if(e?.length<2)return{};let t=[],r=[];for(let o of e){let n=o.name??De(o);t.push(o.id),r.push(n)}return{[kR]:{type:pR("enum",A),title:"Variant",options:t,optionTitles:r}}}function OC(j,A,e,t,r){if(j.type==="responsiveimage"&&Z6(j)&&Y6(j.__vekterDefault)){let{assetReference:o,alt:n}=j.__vekterDefault,a=Ql(r?.width,r?.height),i=e.assets.resolveResponsiveImage(o,a,j.__vekterDefault);return i&&x(n)&&(i.alt=n),i}else if(X6(j))switch(j.type){case"responsiveimage":{let o=Ql(r?.width,r?.height),n=e.assets.resolveResponsiveImage(j.__defaultAssetReference,o);return n||void 0}case"file":{let o=e.assets.resolve(j.__defaultAssetReference);return o?o.src:void 0}}else{if(A?.type==="array")return A.initialValue?A.initialValue.map(o=>{let n={};if(!o||o.type!=="object"||!Oj(o.value))return n;for(let a in o.value){let i=o.value[a];if(!i||i.type!=="image"||!x(i.value))continue;let s=e.assets.resolveResponsiveImage(i.value,void 0,i);s&&(s.alt=i.alt??"",n[a]=s)}return n}):[];if(DC(j)){let o=j.defaultValue;if(j.type==="vectorsetitem")return $(ap(o),"Vector set item must be a module export identifier"),e.imports.addModuleImport(o.identifier);if(j.type==="richtext"&&x(o))return Kf(o,{collectors:e,useFramerMotion:t==="SmartComponent"});if(j.type==="boxshadow"&&Am(o))return jm(o,"emptyStringWhenEmpty",n=>pt(n)?ul(n):ja.toFormatString(n));if(gt(o))return pt(o)?ul(o):o}}}function b6(j,A){return h`${j}?: ${A};`}var mR=["id","width","height"],wC=Object.fromEntries(mR.map(j=>{let A=new V(j);return[A,A]}));function LC(j,A){let e=new Lj(j);return Lj.addSpreadAtEnd(e,A),e}var fR=[{name:NA.style,type:h`Record<string, unknown>`},{name:NA.className,type:h`string`},{name:NA.layoutId,type:h`string | number`}];function qC(j,{declarations:A}){if(!eA(j)&&!w(j)&&!tj(j)&&!Ee(j))return[];$(j.isLoaded(),"Node must be loaded to generate default values and types");let e=fR.map(({name:a,type:i})=>({key:VA(a),type:b6(a,i)})),t=Rr(j)?j.getTopLevelVariants():[],r=VA(NA.variant);if(t.length<2)return e.concat({key:r});$(Rr(j),"A scope with more than 1 variants must have replica variants.");let o=new Lj;for(let a of t)o[a.name??De(a)]=a.id;let n=A.file.dedupe("humanReadableVariantMap",o);return e.concat([{key:r,type:b6(NA.variant,h`keyof typeof ${n}`),value:h`${n}[props.${NA.variant}] ?? props.${NA.variant} ?? ${j.baseVariantId}`}])}function s7(j,A,e){let t=h`props.${new V(j)}`;return A&&(t=h`${A} ?? ${t}`),e&&(t=h`${t} ?? ${e}`),t}function VC(j,{treeStore:A}){if(!w(j)||!Xt(A.tree,j))return;let t=oA(j.dataIdentifier);if(!Sj(t))return;let r=j.getVariableDefinitions(A.tree,L,L.activeBundleHash);if(!r||r.length===0)return;let o=new Map;for(let n of r){let a=To(n.id,j.id,!0);o.set(VA(a),n)}return o}var KC=[...Uk,kR,...mR,...fR.map(({name:j})=>j.toString()),"name"];function JC(j,A,e,t,r,o){let n=new Set(KC),a=h`props`,i=Object.entries(j).map(([S,{control:v,variable:P}])=>{if(!v)return{key:S};let T=Wk($a(v.title)??S,n),D=new V(T),K=OC(v,P,t,r,o),Q=b6(D,MC(v.type)),Z;if(v.type==="enum"&&v.options&&v.optionTitles&&D){let H=new Lj;v.options.forEach((jA,N)=>{if(!x(jA)||!v.optionTitles)return;let z=v.optionTitles[N];x(z)&&(H[z]=jA)});let AA=t.declarations.file.dedupe("humanReadableEnumMap",H);Q=b6(D,h`keyof typeof ${AA}`),Z=s7(S,D,K),Z=h`${AA}[${D}] ?? ${Z}`}else if(P?.type==="array"){let H=uR(P,t),AA=V.fn(H,D);Z=s7(S,AA,K)}else Z=s7(S,D,K);return{key:S,name:T,type:Q,value:Z}}),s="",l=[],c=new Lj,u=VC(A,e),p={},f={...wC};for(let{key:S,type:v,value:P,name:T}of[...qC(A,t),...i]){let D=u?.get(S),K=new V(S);if(D){let Q=h`${K} = ${NA.getFromCurrentRouteData}(${D.id})`;if(Qu(D.type)){let Z=Lt(D.type);gt(Z)&&(Q=h`${Q} ?? ${Z}`)}l.push(Q)}else l.push(K);v&&(s+=v),P&&(c[S]=P),T&&(p[S]=T,f[T]=new V(T))}r==="DesignPage"&&l.push(NA.style),Lj.addSpreadAtStart(c,a);let E=t.declarations.file.dedupe("getProps",h`(${LC(f,a)}) => { return ${c} }`),F=l.join(", "),R=F.length>0?new V(`{ ${F}, ...${NA.restProps} }`):NA.restProps;return{variableMap:Le(p)?void 0:p,types:new V(s),props:h`const ${R} = ${V.fn(E,a)}`}}function HC(j,A,e=!1){let t=[],r=ER(j),o=new V.Set(A.variables);for(let n of r){if(n.type==="divider")continue;let a=new V(n.id);!e&&!A.variables.has(a)||(t.push({id:n.id,definition:n}),o.delete(a))}for(let n of o)t.push({id:String(n)});return t}function QC(j,A){let{hidden:e,...t}=j;if(!A)return t;let{description:r,...o}=t;return o}function UC(j,A,{modulesStore:e,treeStore:t},{imports:r,variables:o},n,a){let{id:i,type:s}=j;switch(s){case"controlReference":{let l=oA(lp(t.tree,j.entityIdentifier));if(!l||!j.entityIdentifier||!Sj(l))return;let c=r.addModuleImport(l,{composeWithImports:[r.addImport("framer",{exportSpecifier:"getPropertyControls"})]});if(!c)return;let u=new Lj({hidden:h`undefined`,description:h`undefined`});return Lj.addSpreadAtStart(u,h`${c}[${j.controlKey}]`),x(A.title)&&(u.title=A.title),x(A.description)&&(u.description=A.description),A.type==="responsiveimage"&&Z6(A)&&Y6(A.__vekterDefault)&&(u[au]=V.fromValue(A.__vekterDefault)),X6(A)?u[iu]=V.fromValue(A.__defaultAssetReference):sA(j.initialValue)||(u.defaultValue=V.fromValue(j.initialValue)),h`${c}?.[${j.controlKey}] && ${u}`}case"nodePropertyControlReference":case"array":case"vectorsetitem":case"boolean":case"color":case"date":case"enum":case"eventhandler":case"file":case"image":case"link":case"linkrelvalues":case"number":case"richtext":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"string":case"border":case"borderradius":case"gap":case"padding":case"collectionreference":case"multicollectionreference":case"trackingid":case"slug":{let l={...QC(A,n),type:pR(A.type,r)};if(a==="vector"&&o){let c=new V(i);l.hidden=!o.variables.has(c)}return l}default:iA(s)}}function ER(j){return kt(j)?j.variables:[]}function WC(j,A,e,t,r=ER(j)){let o=NC(j,e.imports),n=Ba(j),a=[...r];if(fj(j)){let i=ik();a.push(i);let s=ak();a.push(s);let l=ok(j);a.push(l);let c=nk(j);a.push(c)}for(let i of a){if(i.type==="divider")continue;let s=kl(A.treeStore.tree,i);if(wj(s))continue;$(s.type!=="image","Image variables should become responsive images");let l=UC(i,s,A,e,n,t);sA(l)||(o[i.id]=l)}if(!Le(o))return new Lj(o,1)}function laA(j,A,e,t,r,o){let n={},a=[];for(let{id:i,definition:s}of zC(j,e.variables)){let l=s?kl(A.treeStore.tree,s):void 0;n[i]={control:l,variable:s},s&&a.push(s)}return{propertyControls:WC(j,A,e,r,a),...JC(n,j,A,e,t,o)}}function zC(j,A){return HC(j,A,Ee(j))}var Oi=Dj(tl());function $R(){return document.body.dataset.framerTheme==="dark"}var BR=ce()?["Control","Option","Shift","CommandOrControl","Command"]:["CommandOrControl","Command","Control","Alt","Shift"];function l7(j){return j?j.split("+").sort((A,e)=>{let t=BR.indexOf(A),r=BR.indexOf(e);return t!==-1&&r!==-1?t-r:t!==-1?-1:r!==-1?1:0}).map(A=>{switch(A){case"Backspace":case"Delete":return ce()?"\u232B":"Del";case"Command":return"\u2318";case"CommandOrControl":return ce()?"\u2318":"Ctrl";case"Control":return ce()?"\u2303":"Ctrl";case"Down":return"\u2193";case"Enter":case"Return":return ce()?"\u21A9":"Enter";case"Left":return"\u2190";case"-":return"\u2013";case"Option":return ce()?"\u2325":"Alt";case"Plus":return ce()?"+":"=";case"Right":return"\u2192";case"Shift":return ce()?"\u21E7":"Shift";case"Up":return"\u2191";case"Escape":return"ESC"}return A}):[]}function c7(j,A){let e=[];return j.forEach(t=>{let{accelerator:r,acceleratorWindows:o,checked:n,mixed:a,enabled:i,ellipsis:s,role:l,type:c="normal",visible:u,requiresUserInteraction:p,acceleratorLabel:f,acceleratorLabelWindows:E,badge:F,icon:R}=t;if(c==="separator")e.push({type:"separator",visible:u});else if(c==="normal"){let S;i!==void 0&&(S=!i);let v=!ce()&&o!==void 0?o:r,P=!ce()&&E!==void 0?E:f,T=P?l7(P):v?l7(v):void 0,D=t.label;D&&s&&(D+="\u2026");let K={accelerator:v,acceleratorLabelTokens:T,tokenDelimiter:ce()?void 0:"+",checked:n||a,disabled:S,label:D||"",description:t.description,action:l,type:c,visible:u,requiresUserInteraction:p,badge:F,icon:R};K.submenu=t.submenu&&c7(t.submenu,A),A&&A(K),K.visible===void 0&&(K.visible=!0),e.push(K)}else throw Error(`Unhandled type: ${c}`)}),e}var C6={importFigma:"CommandOrControl+Shift+I",newProject:"Option+CommandOrControl+N",publishSite:"CommandOrControl+Shift+P",openPublishedSite:"CommandOrControl+Shift+O",uploadImage:"Option+CommandOrControl+I",quickActions:"CommandOrControl+K",toggleLocalization:"CommandOrControl+Shift+L",toggleContentManagement:"Option+C",toggleVersionHistory:"Shift+CommandOrControl+H",generateWebPage:yA.isOn("wireframerKits")?"A":"W",undo:"CommandOrControl+Z",redo:"CommandOrControl+Shift+Z",goBack:"CommandOrControl+[",goForward:"CommandOrControl+]",cut:"CommandOrControl+X",copy:"CommandOrControl+C",copyFill:"CommandOrControl+Shift+C",paste:"CommandOrControl+V",delete:"Delete",selectMostRecentPage:"Option+Escape",selectAll:"CommandOrControl+A",selectGroundNode:"CommandOrControl+Escape",selectParent:"Escape",copyStyle:"CommandOrControl+Option+C",pasteStyle:"CommandOrControl+Option+V",pasteInPlace:"CommandOrControl+Shift+V",duplicate:"CommandOrControl+D",toggleLayerLock:"CommandOrControl+L",toggleLayerVisible:"CommandOrControl+;",rename:"CommandOrControl+R",selectSiblings:"CommandOrControl+Shift+A",cycleSelection:"Tab",decycleSelection:"Shift+Tab",fakeSelectChildren:"Enter",zoomIn:"CommandOrControl+Plus",zoomOut:"CommandOrControl+-",resetZoom:"CommandOrControl+0",zoomToFitAll:"CommandOrControl+1",zoomToFitSelection:"CommandOrControl+2",openPanelSearch:"CommandOrControl+F",toggleInterface:"CommandOrControl+.",toggleRulers:"Control+R",toggleGrids:"Control+G",toggleAppearance:"Control+Command+N",showPages:"Option+1",showLayers:"Option+2",showAssets:"Option+3",collapseLayers:"Option+L",startLinkTool:"L",sampleColor:"Control+C",toggleInsert:"I",toggleLibraryModal:"CommandOrControl+/",toolCreateStack:"S",toolCreateFrame:"F",toolCreateRounded:"U",toolCreateImage:"Shift+I",toolCreateVideo:"Shift+V",toolCreateText:"T",toolComment:"C",toolChat:"/",toolZoom:"Z",toolPath:"P",toolScale:"K",toolCreateRectangleShape:"R",toolCreateOvalShape:"O",toolCreateRows:"Shift+R",toolCreateColumns:"Shift+C",toolCreateGrid:"Shift+G",addEnclosingFrame:"CommandOrControl+Return",addEnclosingStack:"CommandOrControl+Option+Return",autoSizeLayout:"Shift+A",removeFramePreservingChildren:"CommandOrControl+Delete",sizeToFitContent:"Control+Option+R",moveForward:"CommandOrControl+Option+Up",moveBackward:"CommandOrControl+Option+Down",moveToFront:"]",moveToBack:"[",alignLeft:"Option+A",alignCenter:"Option+H",alignRight:"Option+D",alignTop:"Option+W",alignMiddle:"Option+V",alignBottom:"Option+S",distributeHorizontal:"Control+Option+H",distributeVertical:"Control+Option+V",unite:"Option+Shift+U",subtract:"Option+Shift+S",intersect:"Option+Shift+I",exclude:"Option+Shift+E",join:"Option+Shift+J",saveCodeFile:"CommandOrControl+S",makeBold:"CommandOrControl+B",makeItalic:"CommandOrControl+I",makeUnderlined:"CommandOrControl+U",chooseFontFamily:"CommandOrControl+T",group:"CommandOrControl+G",ungroup:"CommandOrControl+Shift+G",makeComponent:"CommandOrControl+Option+K",makeCodeComponent:"CommandOrControl+Shift+K",showPreview:"CommandOrControl+P",openFullScreen:"CommandOrControl+Shift+F",toggleHighlightsInLivePreview:"CommandOrControl+Shift+H",reload:"CommandOrControl+R",toggleConsole:"CommandOrControl+I",handleResponsive:"Z",togglePreviewInterface:"CommandOrControl+Shift+F",previewNextBreakpoint:"CommandOrControl+.",previewPreviousBreakpoint:"CommandOrControl+,",runRecentPlugin:"CommandOrControl+Option+P",openDevelopmentPlugin:"CommandOrControl+Option+L",openTextSearchPlugin:"CommandOrControl+Shift+F",openSiteSettings:"Shift+,",saveSiteSettings:"CommandOrControl+S",previousCollectionItem:"CommandOrControl+Up",nextCollectionItem:"CommandOrControl+Down",newCollectionItem:"N",pasteCollection:"CommandOrControl+V"},d7={sampleColor:"",selectGroundNode:"",openFullScreen:"Control+Alt+F",resetZoom:"Shift+0",zoomToFitAll:"Shift+1",zoomToFitSelection:"Shift+2",toggleInterface:"Alt+.",toggleRulers:"Control+Shift+R",toggleGrids:"Alt+G",toggleAppearance:"Alt+N",distributeHorizontal:"Alt+Shift+H",distributeVertical:"Alt+Shift+V"},BaA=j=>Ka?C6[j]:d7[j]??C6[j];var XC=(0,Oi.List)();async function YC(j){return{indexPath:(await new Promise(e=>{let{location:t={x:0,y:0},within:r,className:o}=j,n=c7(j.items,a=>{if("action"in a&&a.action){let{states:i,options:s}=cR(a.action),l=i[a.action],{label:c,checked:u,visible:p}=s[a.action]??{};if(x(c)&&(a.label=c),a.checked===void 0&&Pt(u)&&(a.checked=u),a.visible===void 0&&Pt(p)&&(a.visible=p),a.submenu)return;a.disabled===void 0&&Pt(l)&&(a.disabled=!l)}});Jf.show(n,{location:t,within:r,className:o,isDarkMode:$R(),maxItemsPerMenu:24,expandRight:j.expandRight,onSelection:a=>{let i=ZC(n,a.path);i?.type==="normal"&&i.requiresUserInteraction&&e(a)},enableTranslate:!0}).then(e)}))?.path??[]}}function ZC(j,A){let e;for(let t of A){if(!j||(e=j[t],!e))return;j=e.type==="normal"&&e.submenu||[]}return e}var Ni=class Ni extends su("Menu"){constructor(){super();g(this,"_items");g(this,"handlePopupResponse",vp((e,t)=>{if(!e||e.length===0){t&&t();return}let r=this._items,o,n;for(let a of e){if(o=r.get(a),!o)throw Error("Could not find expected menu item");o.editReason!==void 0&&(n=o.editReason),r=o.submenu?._items??XC}n?$l()?.setEditReason(n):n!==!1&&$l()?.setEditReason(o?.role??Ap(o?.label)),o!==void 0&&o.click!==void 0?o.click():o?.role!==void 0&&aR(o.role,{fromContextMenu:!0})}));this._items=(0,Oi.List)()}static buildFromTemplate(e){let t=new Ni;for(let r of e)t.append(new p7(Ni.getItemTemplateWithShortcut(r)));return t}get items(){return this._items.toArray()}append(e){this._items=this._items.push(e)}insert(e,t){this._items=this._items.insert(e,t)}popup(e,t){return new Promise(r=>{let o=JSON.parse(JSON.stringify(this._items.toJS()));YC({items:o,location:e,within:t?.within,className:t?.className,expandRight:t?.expandRight}).then(n=>this.handlePopupResponse(n.indexPath,t?.onCancel)).catch(GA).finally(r)})}};g(Ni,"getItemTemplateWithShortcut",e=>{let{role:t}=e;if(!t)return e;let r={...e};return!Ka&&!e.acceleratorWindows&&(r.acceleratorWindows=d7[t]),e.accelerator||(r.accelerator=C6[t]),r});var u7=Ni,Av={enabled:void 0,visible:void 0,label:void 0,description:void 0,click:void 0,type:"normal",accelerator:void 0,acceleratorWindows:void 0,acceleratorLabel:void 0,acceleratorLabelWindows:void 0,submenu:void 0,checked:void 0,mixed:void 0,role:void 0,requiresUserInteraction:void 0,alternate:void 0,badge:void 0,icon:void 0,editReason:void 0},p7=class extends(0,Oi.Record)(Av){constructor(e){e.label&&e.ellipsis&&(e.label=`${e.label}\u2026`),e.submenu!==void 0&&!("__class"in e.submenu&&e.submenu.__class==="Menu")&&(e.submenu=u7.buildFromTemplate(e.submenu));super(e);g(this,"enabled");g(this,"visible");g(this,"label");g(this,"ellipsis");g(this,"checked");g(this,"mixed");g(this,"click");g(this,"role");g(this,"requiresUserInteraction");g(this,"alternate");g(this,"editReason");g(this,"submenu")}toJS(){let e=super.toJS();return e.submenu!==void 0&&(e.submenu=e.submenu._items.toJS()),e}};function PaA(j){return{...j,enabled:j.enabled(),click:()=>{j.enabled()&&j.click()}}}function _aA(j){return Array.isArray(j)}function DaA(j,A){let e=A.getItemIds(j.id);if(e)return e[0]}export{Zf as a,$c as b,oE as c,BE as d,Hv as e,HR as f,Wn as g,UR as h,Zv as i,Ye as j,__ as k,zn as l,Sc as m,x_ as n,gE as o,nE as p,gP as q,Qn as r,RP as s,aI as t,IP as u,FP as v,GP as w,SP as x,yP as y,K_ as z,J_ as A,Ze as B,H_ as C,Q_ as D,U_ as E,W_ as F,z_ as G,X_ as H,BI as I,Y_ as J,FE as K,yc as L,wr as M,lx as N,cx as O,gI as P,Bs as Q,hx as R,gx as S,Rx as T,bc as U,Ix as V,hs as W,_x as X,xx as Y,Mx as Z,xo as _,yE as $,Kx as aa,PP as ba,cE as ca,bE as da,dE as ea,vE as fa,wP as ga,Ic as ha,uE as ia,Fc as ja,sI as ka,Un as la,HP as ma,pE as na,e_ as oa,fE as pa,t_ as qa,r_ as ra,o_ as sa,n_ as ta,i_ as ua,a_ as va,d_ as wa,PE as xa,Is as ya,$M as za,U as Aa,Fs as Ba,xE as Ca,Vj as Da,BN as Ea,hN as Fa,gN as Ga,RN as Ha,wE as Ia,LE as Ja,qE as Ka,wI as La,HE as Ma,_c as Na,XN as Oa,Gs as Pa,mO as Qa,Ss as Ra,fO as Sa,zE as Ta,XE as Ua,YE as Va,ys as Wa,e$ as Xa,Cs as Ya,vs as Za,Mo as _a,o$ as $a,a$ as ab,s$ as bb,_s as cb,p$ as db,k$ as eb,j1 as fb,s1 as gb,m$ as hb,I1 as ib,f$ as jb,xs as kb,ri as lb,B$ as mb,h$ as nb,bw as ob,g$ as pb,Ms as qb,Ds as rb,oi as sb,G$ as tb,p_ as ub,k_ as vb,$E as wb,kI as xb,Es as yb,EF as zb,M4 as Ab,D4 as Bb,N4 as Cb,O4 as Db,v$ as Eb,qo as Fb,Os as Gb,Ne as Hb,$s as Ib,x$ as Jb,Jr as Kb,N$ as Lb,O$ as Mb,L$ as Nb,q$ as Ob,Bq as Pb,hq as Qb,H$ as Rb,Fq as Sb,U$ as Tb,X$ as Ub,wq as Vb,Lq as Wb,qq as Xb,Vq as Yb,Kq as Zb,Js as _b,Y$ as $b,bF as ac,Z$ as bc,jB as cc,N2 as dc,O2 as ec,eB as fc,w2 as gc,tB as hc,oB as ic,EV as jc,Xc as kc,wF as lc,$V as mc,BV as nc,hV as oc,ii as pc,nB as qc,ai as rc,zc as sc,gV as tc,RV as uc,IV as vc,FV as wc,qF as xc,GV as yc,SV as zc,aB as Ac,sB as Bc,UV as Cc,WV as Dc,lB as Ec,cB as Fc,uB as Gc,pB as Hc,rd as Ic,FB as Jc,EG as Kc,Td as Lc,Z9 as Mc,ty as Nc,Pd as Oc,ih as Pc,ah as Qc,Eh as Rc,Ii as Sc,Fi as Tc,u6 as Uc,$h as Vc,Bh as Wc,Gh as Xc,ir as Yc,gg as Zc,bi as _c,Gg as $c,Kd as ad,wrA as bd,Sg as cd,moA as dd,foA as ed,EoA as fd,$oA as gd,BoA as hd,f6 as id,Yy as jd,boA as kd,CoA as ld,voA as md,Zy as nd,Cg as od,vg as pd,Tg as qd,MoA as rd,DoA as sd,NoA as td,or as ud,Ri as vd,OZ as wd,vnA as xd,TnA as yd,PnA as zd,_nA as Ad,xnA as Bd,ob as Cd,MnA as Dd,DnA as Ed,NnA as Fd,OnA as Gd,nb as Hd,wnA as Id,mb as Jd,vi as Kd,Bb as Ld,hb as Md,Rb as Nd,Fb as Od,Sb as Pd,LnA as Qd,qnA as Rd,VnA as Sd,DaA as Td,Us as Ud,l3 as Vd,c3 as Wd,Hr as Xd,c5 as Yd,Ys as Zd,UB as _d,Zs as $d,KG as ae,A0 as be,j0 as ce,e0 as de,rQ as ee,CQ as fe,r0 as ge,o0 as he,n0 as ie,vQ as je,TQ as ke,PQ as le,jS as me,_Q as ne,KA as oe,xQ as pe,MQ as qe,t0 as re,yB as se,CG as te,Ws as ue,od as ve,nd as we,VQ as xe,KQ as ye,JQ as ze,HQ as Ae,QQ as Be,rS as Ce,UQ as De,a0 as Ee,dd as Fe,u0 as Ge,iW as He,p0 as Ie,x3 as Je,xB as Ke,MB as Le,M3 as Me,Qr as Ne,tr as Oe,fW as Pe,Ho as Qe,EW as Re,B0 as Se,pi as Te,TW as Ue,fS as Ve,PW as We,ES as Xe,$S as Ye,kd as Ze,h0 as _e,_W as $e,g0 as af,xW as bf,BS as cf,hS as df,LW as ef,DB as ff,w3 as gf,li as hf,hd as if,gd as jf,Rd as kf,Nz as lf,Ur as mf,j5 as nf,e5 as of,VB as pf,Xz as qf,w0 as rf,L0 as sf,Yz as tf,Zz as uf,A9 as vf,z0 as wf,JS as xf,HS as yf,JB as zf,_d as Af,ay as Bf,lh as Cf,ly as Df,HB as Ef,ch as Ff,dh as Gf,dy as Hf,uh as If,gY as Jf,py as Kf,Md as Lf,ky as Mf,tZ as Nf,fZ as Of,fy as Pf,Ey as Qf,iiA as Rf,SC as Sf,aiA as Tf,fh as Uf,rR as Vf,iR as Wf,miA as Xf,aR as Yf,fiA as Zf,EiA as _f,cR as $f,IiA as ag,FiA as bg,GiA as cg,vC as dg,pR as eg,KC as fg,WC as gg,laA as hg,C6 as ig,d7 as jg,BaA as kg,l7 as lg,c7 as mg,u7 as ng,PaA as og,_aA as pg};
//# sourceMappingURL=https://app.framerstatic.com/chunk-K34SIOE2.mjs.map
